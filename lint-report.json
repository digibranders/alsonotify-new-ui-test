[{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/AlsonotifyLayoutWrapper.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":44,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'perm' is defined but never used.","line":65,"column":75,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":79}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, ReactNode, useMemo } from 'react';\nimport { Sidebar } from '../components/common/Sidebar';\nimport { Header } from '../components/common/Topbar';\nimport { ProfileCompletionBanner } from '../components/common/ProfileCompletionBanner';\nimport { useUserDetails } from '@/hooks/useUser';\nimport { getRoleFromUser, UserRole } from '@/utils/roleUtils';\nimport { TimerProvider } from '../context/TimerContext';\nimport { GlobalTimerPlayer } from '../components/layout/GlobalTimerPlayer';\nimport { usePathname } from 'next/navigation';\nimport { navPermissionMap } from '@/utils/navUtils';\nimport { Shield24Regular } from '@fluentui/react-icons';\nimport { Button } from 'antd';\nimport Link from 'next/link';\nimport { InvitationPopup } from '../components/common/InvitationPopup';\n\ninterface AlsonotifyLayoutWrapperProps {\n  children: ReactNode;\n}\n\nexport function AlsonotifyLayoutWrapper({ children }: AlsonotifyLayoutWrapperProps) {\n  const { data: userDetailsData } = useUserDetails();\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  // Derive role and color using shared utility\n  const { userRole, userRoleColor } = useMemo<{ userRole: UserRole; userRoleColor: string | undefined }>(() => {\n    // During SSR or before mounting, return server-safe defaults\n    if (!isMounted) {\n      return { userRole: 'Employee', userRoleColor: undefined };\n    }\n\n    // Handle different API response structures or localStorage fallback if needed\n    let user = userDetailsData?.result?.user || userDetailsData?.result;\n\n    // Fallback to localStorage if API data not yet available\n    if (!user) {\n      try {\n        user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n      } catch (e) { /* ignore */ }\n    }\n\n    return {\n      userRole: getRoleFromUser(user || {}),\n      userRoleColor: user?.user_employee?.role?.color || user?.role?.color\n    };\n  }, [userDetailsData, isMounted]);\n\n  // Extract permissions\n  const permissions = useMemo(() => userDetailsData?.result?.access || {}, [userDetailsData]);\n\n  const pathname = usePathname();\n\n  // URL Access Protection Logic\n  const accessState = useMemo(() => {\n    // Admin always has access\n    if (userRole === 'Admin') return { authorized: true };\n\n    // Find if the current path matches any protected resource in navPermissionMap\n    const currentPath = pathname || '';\n    const protectedResource = Object.entries(navPermissionMap).find(([id, perm]) => {\n      // Check for exact match or child route match (e.g. /dashboard/tasks/1 matches /dashboard/tasks)\n      const pathToCheck = `/dashboard/${id}`;\n      return currentPath === pathToCheck || currentPath.startsWith(`${pathToCheck}/`);\n    });\n\n    if (protectedResource) {\n      const [id, permissionKey] = protectedResource;\n      const hasPermission = permissions?.Navigation?.[permissionKey];\n\n      // If the permission is explicitly false, block access\n      if (hasPermission === false) {\n        return { authorized: false, resource: id.charAt(0).toUpperCase() + id.slice(1) };\n      }\n    }\n\n    return { authorized: true };\n  }, [pathname, permissions, userRole]);\n\n  const renderContent = () => {\n    if (!accessState.authorized) {\n      return (\n        <div className=\"flex-1 flex flex-col items-center justify-center bg-white rounded-[24px] shadow-sm p-8 text-center animate-in fade-in duration-500\">\n          <div className=\"w-20 h-20 bg-[#FFF5F5] rounded-full flex items-center justify-center mb-6\">\n            <Shield24Regular className=\"w-10 h-10 text-[#FF3B3B]\" />\n          </div>\n          <h2 className=\"text-[24px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">\n            Access Restricted\n          </h2>\n          <p className=\"text-[15px] text-[#666666] font-['Manrope:Medium',sans-serif] max-w-md mb-8\">\n            You don't have the necessary permissions to access the <span className=\"font-['Manrope:Bold',sans-serif] text-[#111111]\">{accessState.resource}</span> module. Please contact your administrator if you believe this is an error.\n          </p>\n          <Link href=\"/dashboard\">\n            <Button\n              type=\"primary\"\n              className=\"bg-[#111111] hover:bg-black text-white font-['Manrope:SemiBold',sans-serif] h-11 px-8 rounded-full transition-all active:scale-95\"\n            >\n              Back to Dashboard\n            </Button>\n          </Link>\n        </div>\n      );\n    }\n\n    return children;\n  };\n\n  return (\n    <TimerProvider>\n      <div className=\"w-full h-screen bg-[#F7F7F7] p-5 flex overflow-hidden\">\n        {/* Main Layout - Visible on all screens */}\n        <div className=\"flex gap-5 w-full h-full overflow-hidden\">\n          {/* Left Sidebar - Hidden on mobile, visible on lg+ */}\n          <div className=\"hidden lg:block w-[292px] shrink-0 h-full overflow-y-auto\">\n            <Sidebar userRole={userRole} permissions={permissions} />\n          </div>\n\n          {/* Main Content Area */}\n          <div className=\"flex-1 flex flex-col gap-5 h-full overflow-hidden\">\n            {/* Header/Taskbar - Fixed Height */}\n            <div className=\"shrink-0\">\n              <Header userRole={userRole} roleColor={userRoleColor} />\n            </div>\n\n            {/* Profile Completion Banner */}\n            <ProfileCompletionBanner />\n\n            {/* Page Content */}\n            {renderContent()}\n          </div>\n        </div>\n      </div>\n      <GlobalTimerPlayer />\n      <InvitationPopup />\n    </TimerProvider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/company-details/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is defined but never used.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Steps' is defined but never used.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":24,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4067,4070],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4067,4070],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5079,5082],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5079,5082],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, Suspense, useEffect } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { UploadCloud, User, Check, ArrowRight, Loader2 } from \"lucide-react\";\nimport {\n  message,\n  Select,\n  Steps,\n  Button,\n  Upload,\n  Input,\n  App,\n} from \"antd\";\nimport { useCompleteSignup, useVerifyToken } from \"@/hooks/useAuth\";\nimport { industryToBusinessType, commonCountries, commonTimezones } from \"@/data/defaultData\";\nimport AuthLayout from \"@/components/auth/AuthLayout\";\nimport PhoneNumberInput from \"@/components/ui/PhoneNumberInput\";\n\nconst { Option } = Select;\n\nfunction CompanyDetailsForm() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const { message } = App.useApp();\n  const token = searchParams.get(\"t\");\n  const completeSignupMutation = useCompleteSignup();\n  const { data: userData } = useVerifyToken(token);\n\n  const [currentStep, setCurrentStep] = useState<\"company\" | \"admin\">(\"company\");\n\n  const accountType = searchParams.get(\"type\") || \"organization\";\n  const isIndividual = accountType === \"individual\";\n\n  const [companyData, setCompanyData] = useState({\n    companyName: \"\",\n    website: \"\", // Optional - not sent to API\n    industry: \"\",\n    companySize: \"\", // Optional - not sent to API\n    country: \"\",\n    timezone: \"\",\n    logo: null as File | null, // Optional - not sent to API\n  });\n\n  const [adminData, setAdminData] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    country: \"\",\n    countryCode: \"+91\",\n    phone: \"\",\n    photo: null as File | null,\n  });\n\n  // Auto-fill for Individual\n  useEffect(() => {\n    if (isIndividual) {\n      setCompanyData((prev) => ({\n        ...prev,\n        companyName: \"My Workspace\",\n        industry: \"other\",\n        companySize: \"1-10\",\n      }));\n    }\n  }, [isIndividual]);\n\n  // Pre-fill Admin Details from token data\n  useEffect(() => {\n    if (userData?.success && userData.result) {\n      const { name } = userData.result;\n      if (name) {\n        const parts = name.split(\" \");\n        setAdminData((prev) => ({\n          ...prev,\n          firstName: parts[0] || \"\",\n          lastName: parts.slice(1).join(\" \") || \"\",\n        }));\n      }\n    }\n  }, [userData]);\n\n\n  // Map country name to country code\n  const getCountryCode = (countryName: string): string => {\n    const countryMap: Record<string, string> = {\n      india: \"IN\",\n      usa: \"US\",\n      \"united states\": \"US\",\n      uk: \"GB\",\n      \"united kingdom\": \"GB\",\n      canada: \"CA\",\n      australia: \"AU\",\n      germany: \"DE\",\n      france: \"FR\",\n    };\n    return countryMap[countryName.toLowerCase()] || countryName.toUpperCase();\n  };\n\n  const formVariants = {\n    hidden: { opacity: 0, x: 20 },\n    visible: { opacity: 1, x: 0, transition: { duration: 0.4 } },\n    exit: { opacity: 0, x: -20, transition: { duration: 0.3 } },\n  };\n\n  const itemVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: {\n      opacity: 1,\n      y: 0,\n      transition: { duration: 0.5, ease: [0.22, 1, 0.36, 1] as const },\n    },\n  };\n\n  const handleCompanyNext = async (e: React.FormEvent) => {\n    e.preventDefault();\n    // Validation\n    if (\n      !companyData.companyName ||\n      !companyData.industry ||\n      !companyData.country ||\n      !companyData.timezone\n    ) {\n      message.error(\"Please fill in all required fields\");\n      return;\n    }\n\n    // For organization, move to next step. For individual, complete signup.\n    if (isIndividual) {\n      // Map industry to businessType\n      const businessType = industryToBusinessType[companyData.industry] || 21; // Default to \"Others\"\n      const countryCode = getCountryCode(companyData.country);\n\n      try {\n        await completeSignupMutation.mutateAsync({\n          registerToken: token,\n          companyName: companyData.companyName,\n          businessType: String(businessType),\n          accountType: \"INDIVIDUAL\",\n          country: countryCode,\n          timezone: companyData.timezone,\n        });\n      } catch (error: any) {\n        const errorMessage =\n          error?.response?.data?.message || \"Failed to complete signup. Please try again.\";\n        message.error(errorMessage);\n      }\n    } else {\n      setCurrentStep(\"admin\");\n    }\n  };\n\n  const handleComplete = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!adminData.firstName || !adminData.lastName) {\n      message.error(\"Please fill in required admin fields\");\n      return;\n    }\n\n    const businessType = industryToBusinessType[companyData.industry] || 21;\n    const countryCode = getCountryCode(companyData.country);\n\n    try {\n      await completeSignupMutation.mutateAsync({\n        registerToken: token,\n        companyName: companyData.companyName,\n        businessType: String(businessType),\n        accountType: \"ORGANIZATION\",\n        country: countryCode,\n        timezone: companyData.timezone,\n        firstName: adminData.firstName,\n        lastName: adminData.lastName,\n        phone: adminData.phone,\n      });\n    } catch (error: any) {\n      const errorMessage =\n        error?.response?.data?.message || \"Failed to complete signup. Please try again.\";\n      message.error(errorMessage);\n    }\n  };\n\n  return (\n    <AuthLayout>\n      <motion.div\n        initial=\"hidden\"\n        animate=\"visible\"\n        className=\"w-full max-w-[680px] space-y-8\"\n      >\n        {/* Header */}\n        <motion.div variants={itemVariants} className=\"space-y-2\">\n          <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n            Complete your profile\n          </h2>\n          <p className=\"text-[#666666]\">\n            Tell us more about your company to get started.\n          </p>\n        </motion.div>\n\n        {/* Progress Indicator - Only show for Organization */}\n        {!isIndividual && (\n          <motion.div variants={itemVariants} className=\"flex items-center gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <div\n                className=\"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors bg-[#ff3b3b] text-white\"\n              >\n                {currentStep === \"admin\" ? (\n                  <Check className=\"w-4 h-4\" />\n                ) : (\n                  \"1\"\n                )}\n              </div>\n              <span\n                className=\"text-sm font-medium text-[#111111]\"\n              >\n                Company Details\n              </span>\n            </div>\n            <div className=\"h-[1px] flex-1 bg-gray-200\">\n              <div\n                className=\"h-full bg-[#ff3b3b] transition-all duration-500\"\n                style={{ width: currentStep === \"admin\" ? \"100%\" : \"0%\" }}\n              />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div\n                className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors ${currentStep === \"admin\"\n                  ? \"bg-[#ff3b3b] text-white\"\n                  : \"bg-gray-100 text-gray-400\"\n                  }`}\n              >\n                2\n              </div>\n              <span\n                className={`text-sm font-medium ${currentStep === \"admin\" ? \"text-[#111111]\" : \"text-gray-400\"\n                  }`}\n              >\n                Admin Details\n              </span>\n            </div>\n          </motion.div>\n        )}\n\n        <form\n          onSubmit={currentStep === \"company\" ? handleCompanyNext : handleComplete}\n        >\n          <AnimatePresence mode=\"wait\">\n            {/* COMPANY DETAILS STEP */}\n            {currentStep === \"company\" && (\n              <motion.div\n                key=\"company\"\n                variants={formVariants}\n                initial=\"hidden\"\n                animate=\"visible\"\n                exit=\"exit\"\n                className=\"space-y-8\"\n              >\n                {!isIndividual && (\n                  <motion.div variants={itemVariants}>\n                    {/* Company Logo Upload */}\n                    <div className=\"flex items-center gap-6\">\n                      <div className=\"w-24 h-24 rounded-full bg-[#F5F5F5] flex items-center justify-center border-2 border-dashed border-gray-300 cursor-pointer hover:border-[#ff3b3b] hover:bg-[#FFF5F5] transition-colors group relative overflow-hidden\">\n                        <UploadCloud className=\"w-8 h-8 text-gray-400 group-hover:text-[#ff3b3b] transition-colors\" />\n                        <input\n                          type=\"file\"\n                          accept=\"image/*\"\n                          className=\"absolute inset-0 opacity-0 cursor-pointer\"\n                          onChange={(e) => {\n                            const file = e.target.files?.[0];\n                            if (file) setCompanyData({ ...companyData, logo: file });\n                          }}\n                        />\n                      </div>\n                      <div className=\"space-y-1\">\n                        <h3 className=\"font-bold text-[#111111]\">Company Logo</h3>\n                        <p className=\"text-sm text-[#666666]\">\n                          Upload your company logo. Recommended size: 400x400px.\n                        </p>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {!isIndividual && (\n                  <motion.div variants={itemVariants} className=\"grid grid-cols-2 gap-6\">\n                    <div className=\"space-y-2\">\n                      <label htmlFor=\"company-name\" className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                        Company Name <span className=\"text-[#ff3b3b]\">*</span>\n                      </label>\n                      <input\n                        id=\"company-name\"\n                        type=\"text\"\n                        placeholder=\"Acme Inc.\"\n                        value={companyData.companyName}\n                        onChange={(e) =>\n                          setCompanyData({ ...companyData, companyName: e.target.value })\n                        }\n                        className=\"w-full h-12 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black px-4\"\n                        required\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <label htmlFor=\"website\" className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                        Website\n                      </label>\n                      <input\n                        id=\"website\"\n                        type=\"url\"\n                        placeholder=\"https://acme.com\"\n                        value={companyData.website}\n                        onChange={(e) =>\n                          setCompanyData({ ...companyData, website: e.target.value })\n                        }\n                        className=\"w-full h-12 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black px-4\"\n                      />\n                    </div>\n                  </motion.div>\n                )}\n\n                {!isIndividual && (\n                  <motion.div variants={itemVariants} className=\"grid grid-cols-2 gap-6\">\n                    <div className=\"space-y-2\">\n                      <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                        Industry <span className=\"text-[#ff3b3b]\">*</span>\n                      </label>\n                      <Select\n                        showSearch={{\n                          filterOption: (input, option) =>\n                            (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                        }}\n                        value={companyData.industry}\n                        onChange={(v) =>\n                          setCompanyData({ ...companyData, industry: String(v) })\n                        }\n                        placeholder=\"Select Industry\"\n                        className=\"w-full h-12 company-details-select\"\n                        suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                      >\n                        {Object.keys(industryToBusinessType).map((industry) => (\n                          <Option key={industry} value={industry}>\n                            {industry.charAt(0).toUpperCase() + industry.slice(1)}\n                          </Option>\n                        ))}\n                      </Select>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                        Company Size\n                      </label>\n                      <Select\n                        showSearch={{\n                          filterOption: (input, option) =>\n                            (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                        }}\n                        value={companyData.companySize}\n                        onChange={(v) =>\n                          setCompanyData({ ...companyData, companySize: String(v) })\n                        }\n                        placeholder=\"Select Size\"\n                        className=\"w-full h-12 company-details-select\"\n                        suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                      >\n                        <Option value=\"1-10\">1-10 Employees</Option>\n                        <Option value=\"11-50\">11-50 Employees</Option>\n                        <Option value=\"51-200\">51-200 Employees</Option>\n                        <Option value=\"201-500\">201-500 Employees</Option>\n                        <Option value=\"500+\">500+ Employees</Option>\n                      </Select>\n                    </div>\n                  </motion.div>\n                )}\n\n                <motion.div variants={itemVariants} className=\"grid grid-cols-2 gap-6\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                      Country <span className=\"text-[#ff3b3b]\">*</span>\n                    </label>\n                    <Select\n                      showSearch={{\n                        filterOption: (input, option) =>\n                          (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                      }}\n                      value={companyData.country}\n                      onChange={(v) =>\n                        setCompanyData({ ...companyData, country: String(v) })\n                      }\n                      placeholder=\"Select Country\"\n                      className=\"w-full h-12 company-details-select\"\n                      suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                    >\n                      {commonCountries.map((country) => (\n                        <Option key={country.code} value={country.name.toLowerCase()}>\n                          {country.name}\n                        </Option>\n                      ))}\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                      Timezone <span className=\"text-[#ff3b3b]\">*</span>\n                    </label>\n                    <Select\n                      showSearch={{\n                        filterOption: (input, option) =>\n                          (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                      }}\n                      value={companyData.timezone}\n                      onChange={(v) =>\n                        setCompanyData({ ...companyData, timezone: String(v) })\n                      }\n                      placeholder=\"Select Timezone\"\n                      className=\"w-full h-12 company-details-select\"\n                      suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                    >\n                      {commonTimezones.map((tz) => (\n                        <Option key={tz} value={tz}>\n                          {tz}\n                        </Option>\n                      ))}\n                    </Select>\n                  </div>\n                </motion.div>\n              </motion.div>\n            )}\n\n            {/* ADMIN DETAILS STEP - Only for Organization (conceptually, or if specific fields needed later) */}\n            {currentStep === \"admin\" && (\n              <motion.div\n                key=\"admin\"\n                variants={formVariants}\n                initial=\"hidden\"\n                animate=\"visible\"\n                exit=\"exit\"\n                className=\"space-y-8\"\n              >\n                <motion.div variants={itemVariants}>\n                  {/* Admin Photo Upload */}\n                  <div className=\"flex items-start gap-6\">\n                    <div className=\"w-32 h-32 rounded-full bg-[#F5F5F5] border-2 border-dashed border-gray-300 flex flex-col items-center justify-center text-gray-400 cursor-pointer hover:border-[#ff3b3b] hover:text-[#ff3b3b] transition-colors group relative overflow-hidden\">\n                      <User className=\"w-8 h-8 mb-2 group-hover:scale-110 transition-transform\" />\n                      <span className=\"text-xs font-semibold\">Upload Photo</span>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        className=\"absolute inset-0 opacity-0 cursor-pointer\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          if (file) setAdminData({ ...adminData, photo: file });\n                        }}\n                      />\n                    </div>\n\n                    {/* Form Fields */}\n                    {/* Input Fields */}\n                    <div className=\"flex-1 space-y-6\">\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                          <label className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider\">\n                            First Name <span className=\"text-[#ff3b3b]\">*</span>\n                          </label>\n                          <Input\n                            placeholder=\"e.g. John\"\n                            value={adminData.firstName}\n                            onChange={(e) =>\n                              setAdminData({ ...adminData, firstName: e.target.value })\n                            }\n                            className=\"h-12 bg-white/50 border-[#EEEEEE] focus:border-[#ff3b3b] focus:ring-1 focus:ring-[#ff3b3b] rounded-xl font-['Manrope:Medium',sans-serif]\"\n                          />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <label className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider\">\n                            Last Name\n                          </label>\n                          <Input\n                            placeholder=\"e.g. Doe\"\n                            value={adminData.lastName}\n                            onChange={(e) =>\n                              setAdminData({ ...adminData, lastName: e.target.value })\n                            }\n                            className=\"h-12 bg-white/50 border-[#EEEEEE] focus:border-[#ff3b3b] focus:ring-1 focus:ring-[#ff3b3b] rounded-xl font-['Manrope:Medium',sans-serif]\"\n                          />\n                        </div>\n                      </div>\n\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                          <label className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider\">\n                            Country <span className=\"text-[#ff3b3b]\">*</span>\n                          </label>\n                          <Select\n                            showSearch\n                            placeholder=\"Select country\"\n                            value={adminData.country || undefined}\n                            onChange={(val) => setAdminData({ ...adminData, country: val })}\n                            className=\"w-full text-left\"\n                            size=\"large\"\n                          >\n                            {commonCountries.map((c) => (\n                              <Option key={c.code} value={c.name}>\n                                {c.name}\n                              </Option>\n                            ))}\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                            Phone Number\n                          </label>\n                          <PhoneNumberInput\n                            placeholder=\"98765 43210\"\n                            value={adminData.phone}\n                            onChange={(val) =>\n                              setAdminData({ ...adminData, phone: val })\n                            }\n                            className=\"w-full h-12 bg-[#FAFAFA] border border-transparent focus-within:bg-white focus-within:border-[#ff3b3b] rounded-xl\"\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </motion.div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Submit Button */}\n          <motion.div variants={itemVariants} className=\"mt-8 flex justify-end\">\n            <button\n              type=\"submit\"\n              disabled={\n                completeSignupMutation.isPending ||\n                (currentStep === \"company\" &&\n                  (!companyData.companyName ||\n                    !companyData.industry ||\n                    !companyData.country ||\n                    !companyData.timezone))\n              }\n              className=\"h-12 px-8 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n            >\n              {completeSignupMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 animate-spin\" />\n                  {currentStep === \"company\" ? \"Submitting...\" : \"Completing...\"}\n                </>\n              ) : (\n                <>\n                  {currentStep === \"company\" ? (isIndividual ? \"Complete Setup\" : \"Next Step\") : \"Complete Setup\"}\n                  {!isIndividual && currentStep === \"admin\" && <ArrowRight className=\"w-4 h-4\" />}\n                </>\n              )}\n            </button>\n          </motion.div>\n        </form>\n      </motion.div>\n\n      <style jsx global>{`\n        .company-details-select .ant-select-selector {\n          height: 48px !important;\n          background-color: #FAFAFA !important;\n          border-color: transparent !important;\n          border-radius: 12px !important;\n          padding: 0 16px !important;\n        }\n        .company-details-select .ant-select-selection-item {\n          line-height: 48px !important;\n          font-weight: 500 !important;\n          color: #111111 !important;\n        }\n        .company-details-select .ant-select-selection-placeholder {\n          line-height: 48px !important;\n          color: #999999 !important;\n        }\n        .company-details-select.ant-select-focused .ant-select-selector {\n          background-color: white !important;\n          border-color: #ff3b3b !important;\n          box-shadow: 0 0 0 4px rgba(255, 59, 59, 0.1) !important;\n        }\n        .company-details-select:hover .ant-select-selector {\n          background-color: white !important;\n        }\n        .company-details-select .ant-select-arrow {\n          display: none !important;\n        }\n      `}</style>\n    </AuthLayout>\n  );\n}\n\nexport default function CompanyDetailsPage() {\n  return (\n    <Suspense fallback={<div className=\"min-h-screen flex items-center justify-center\">Loading...</div>}>\n      <CompanyDetailsForm />\n    </Suspense>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/calendar/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/employees/[employeeId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/employees/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/feedback/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5744,5747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5744,5747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":187,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6210,6213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6210,6213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useMemo, useState } from 'react';\nimport { Select, Modal, Empty, Popconfirm, App, Switch, Skeleton } from 'antd';\nimport { PageLayout } from '@/components/layout/PageLayout';\nimport { \n  Eye, \n  Trash2, \n  Bug, \n  Lightbulb, \n  TrendingUp, \n  MessageCircle,\n  CheckCircle,\n  Clock,\n  XCircle,\n  ThumbsUp,\n  Loader2,\n  ShieldAlert\n} from 'lucide-react';\nimport { \n  useAdminFeedbackList, \n  useUpdateFeedbackStatus, \n  useSoftDeleteFeedback \n} from '@/hooks/useFeedback';\nimport { FeedbackItem, FeedbackStatus, FeedbackType } from '@/services/feedback';\nimport { useUserDetails } from '@/hooks/useUser';\nimport { getRoleFromUser } from '@/utils/roleUtils';\nimport { AlsonotifyLayoutWrapper } from '../../AlsonotifyLayoutWrapper';\nimport { PaginationBar } from '@/components/ui/PaginationBar';\n\n/* ---------- Helpers & Config ---------- */\n\nconst getFeedbackTypeConfig = (type: FeedbackType) => {\n  switch (type) {\n    case FeedbackType.BUG:\n      return { label: 'Bug', color: '#EF4444', bgColor: '#FEE2E2', icon: <Bug className=\"w-4 h-4\" /> };\n    case FeedbackType.FEATURE:\n      return { label: 'Feature', color: '#F59E0B', bgColor: '#FEF3C7', icon: <Lightbulb className=\"w-4 h-4\" /> };\n    case FeedbackType.IMPROVEMENT:\n      return { label: 'Improvement', color: '#10B981', bgColor: '#D1FAE5', icon: <TrendingUp className=\"w-4 h-4\" /> };\n    case FeedbackType.OTHER:\n    default:\n      return { label: 'Other', color: '#6366F1', bgColor: '#E0E7FF', icon: <MessageCircle className=\"w-4 h-4\" /> };\n  }\n};\n\nconst getStatusConfig = (status: FeedbackStatus) => {\n  switch (status) {\n    case FeedbackStatus.IN_PROGRESS:\n      return { color: '#3B82F6', bgColor: '#DBEAFE', icon: <Loader2 className=\"w-3 h-3 animate-spin\" />, label: 'In Progress' };\n    case FeedbackStatus.PLANNED:\n      return { color: '#8B5CF6', bgColor: '#EDE9FE', icon: <Clock className=\"w-3 h-3\" />, label: 'Planned' };\n    case FeedbackStatus.COMPLETED:\n      return { color: '#10B981', bgColor: '#D1FAE5', icon: <CheckCircle className=\"w-3 h-3\" />, label: 'Completed' };\n    case FeedbackStatus.DECLINED:\n      return { color: '#EF4444', bgColor: '#FEE2E2', icon: <XCircle className=\"w-3 h-3\" />, label: 'Declined' };\n    case FeedbackStatus.UNDER_REVIEW:\n      return { color: '#F59E0B', bgColor: '#FEF3C7', icon: <Eye className=\"w-3 h-3\" />, label: 'Under Review' };\n    case FeedbackStatus.OPEN:\n    default:\n      return { color: '#6B7280', bgColor: '#F3F4F6', icon: null, label: 'Open' };\n  }\n};\n\nconst formatDateTime = (iso: string) =>\n  new Date(iso).toLocaleString(undefined, {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n\nconst STATUS_OPTIONS: FeedbackStatus[] = [\n  FeedbackStatus.OPEN,\n  FeedbackStatus.UNDER_REVIEW,\n  FeedbackStatus.PLANNED,\n  FeedbackStatus.IN_PROGRESS,\n  FeedbackStatus.COMPLETED,\n  FeedbackStatus.DECLINED,\n];\n\nconst TYPE_OPTIONS: FeedbackType[] = [\n  FeedbackType.FEATURE,\n  FeedbackType.BUG,\n  FeedbackType.IMPROVEMENT,\n  FeedbackType.OTHER,\n];\n\n// --- User Avatar Helper ---\nconst stringToColor = (str: string) => {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const c = (hash & 0x00ffffff).toString(16).toUpperCase();\n  return '#' + '00000'.substring(0, 6 - c.length) + c;\n};\n\nconst UserAvatar = ({ name, email }: { name?: string | null; email?: string | null }) => {\n  const displayName = name || email || '?';\n  const initials = displayName.slice(0, 2).toUpperCase();\n  const bgColor = stringToColor(displayName);\n\n  return (\n    <div\n      className=\"w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold text-white shrink-0\"\n      style={{ backgroundColor: bgColor }}\n      title={displayName}\n    >\n      {initials}\n    </div>\n  );\n};\n\n/* ---------- Main Component ---------- */\n\nexport default function AdminFeedbackPage() {\n  const { message } = App.useApp();\n  const { data: userDetails, isLoading: isLoadingUser } = useUserDetails();\n  \n  // --- State ---\n  const [statusFilter, setStatusFilter] = useState<FeedbackStatus | undefined>();\n  const [typeFilter, setTypeFilter] = useState<FeedbackType | undefined>();\n  const [showDeleted, setShowDeleted] = useState(false);\n  const [selected, setSelected] = useState<FeedbackItem | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n\n  // --- Data & Mutations ---\n  const { data, isLoading, refetch } = useAdminFeedbackList({\n    status: statusFilter,\n    type: typeFilter,\n    includeDeleted: showDeleted,\n  });\n\n  const { mutate: mutateStatus, isPending: statusUpdating } = useUpdateFeedbackStatus();\n  const { mutate: mutateDelete, isPending: deleting } = useSoftDeleteFeedback();\n\n  // Loading States for specific rows\n  const [rowUpdatingId, setRowUpdatingId] = useState<number | null>(null);\n  const [rowDeletingId, setRowDeletingId] = useState<number | null>(null);\n\n  // Sorting\n  const sortedFeedbacks = useMemo(\n    () =>\n      (data ?? [])\n        .slice()\n        .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime()),\n    [data]\n  );\n\n  // Pagination\n  const paginatedFeedbacks = useMemo(() => {\n    const start = (currentPage - 1) * pageSize;\n    return sortedFeedbacks.slice(start, start + pageSize);\n  }, [sortedFeedbacks, currentPage, pageSize]);\n\n  // --- Handlers ---\n  const handleStatusChange = (id: number, status: FeedbackStatus) => {\n    setRowUpdatingId(id);\n    mutateStatus(\n      { id, status },\n      {\n        onSuccess: () => {\n          message.success('Status updated');\n          setRowUpdatingId(null);\n          refetch();\n        },\n        onError: (err: any) => {\n          const errorMessage = err?.response?.data?.message || err?.message || 'Failed to update status';\n          message.error(errorMessage);\n          setRowUpdatingId(null);\n        },\n      }\n    );\n  };\n\n  const handleSoftDelete = (id: number) => {\n    setRowDeletingId(id);\n    mutateDelete(id, {\n      onSuccess: () => {\n        message.success('Feedback deleted');\n        setRowDeletingId(null);\n        refetch();\n      },\n      onError: (err: any) => {\n        const errorMessage = err?.response?.data?.message || err?.message || 'Failed to delete feedback';\n        message.error(errorMessage);\n        setRowDeletingId(null);\n      },\n    });\n  };\n\n  // Check if user is Admin\n  const isAdmin = useMemo(() => {\n    const userData = userDetails?.result?.user || userDetails?.result || {};\n    return getRoleFromUser(userData) === 'Admin';\n  }, [userDetails]);\n\n  // Show loading state while checking user\n  if (isLoadingUser) {\n    return (\n      <AlsonotifyLayoutWrapper>\n        <PageLayout title=\"Feedback Admin\">\n          <div className=\"flex items-center justify-center h-[60vh]\">\n            <div className=\"text-center\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-[#ff3b3b] mx-auto mb-4\" />\n              <p className=\"text-[#666666] text-[14px]\">Checking permissions...</p>\n            </div>\n          </div>\n        </PageLayout>\n      </AlsonotifyLayoutWrapper>\n    );\n  }\n\n  // Show unauthorized message if not Admin\n  if (!isAdmin) {\n    return (\n      <AlsonotifyLayoutWrapper>\n        <PageLayout title=\"Feedback Admin\">\n          <div className=\"flex items-center justify-center h-[60vh]\">\n            <div className=\"text-center max-w-md\">\n              <div className=\"w-20 h-20 rounded-full bg-[#FEE2E2] flex items-center justify-center mx-auto mb-6\">\n                <ShieldAlert className=\"w-10 h-10 text-[#EF4444]\" />\n              </div>\n              <h2 className=\"text-[24px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">\n                Access Denied\n              </h2>\n              <p className=\"text-[#666666] text-[15px] font-['Manrope:Regular',sans-serif]\">\n                You are not authorized to access this page. Only Admin users can view and manage feedback.\n              </p>\n            </div>\n          </div>\n        </PageLayout>\n      </AlsonotifyLayoutWrapper>\n    );\n  }\n\n  /* ----- Render ----- */\n  return (\n    <AlsonotifyLayoutWrapper>\n      <PageLayout \n        title=\"Feedback Management\"\n      customFilters={\n        <div className=\"flex items-center gap-3\">\n          <Select\n            showSearch={{\n              filterOption: (input, option) =>\n                (option?.label?.toString() ?? '').toLowerCase().includes(input.toLowerCase())\n            }}\n            allowClear\n            placeholder=\"Status\"\n            style={{ width: 150 }}\n            value={statusFilter}\n            onChange={(val) => setStatusFilter(val)}\n            className=\"feedback-admin-select\"\n            options={STATUS_OPTIONS.map((s) => ({\n              value: s,\n              label: getStatusConfig(s).label,\n            }))}\n          />\n          \n          <Select\n            showSearch={{\n              filterOption: (input, option) =>\n                (option?.label?.toString() ?? '').toLowerCase().includes(input.toLowerCase())\n            }}\n            allowClear\n            placeholder=\"Type\"\n            style={{ width: 140 }}\n            value={typeFilter}\n            onChange={(val) => setTypeFilter(val)}\n            className=\"feedback-admin-select\"\n            options={TYPE_OPTIONS.map((t) => ({\n              value: t,\n              label: getFeedbackTypeConfig(t).label,\n            }))}\n          />\n          \n          <div className=\"flex items-center gap-2 bg-white px-3 py-1.5 rounded-full border border-[#EEEEEE]\">\n            <span className=\"text-[12px] text-[#666666] font-medium\">Include Deleted</span>\n            <Switch size=\"small\" checked={showDeleted} onChange={setShowDeleted} />\n          </div>\n        </div>\n      }\n    >\n      <div className=\"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-4 pt-1\">\n        {/* Banner/Intro */}\n        {!isLoading && sortedFeedbacks.length > 0 && (\n          <div className=\"mb-2\">\n            <p className=\"text-[14px] text-[#666666] font-['Manrope:Regular',sans-serif]\">\n              Triage and manage feedback from your team to improve the application.\n            </p>\n          </div>\n        )}\n\n        {/* List Section */}\n        <div className=\"space-y-3 pb-8\">\n          {isLoading ? (\n            <div className=\"bg-white rounded-2xl border border-[#EEEEEE] p-6\">\n              <Skeleton active avatar paragraph={{ rows: 2 }} />\n            </div>\n          ) : !sortedFeedbacks.length ? (\n            <div className=\"bg-white rounded-2xl border border-[#EEEEEE] p-12 text-center\">\n              <Empty description=\"No feedback items found matching your filters.\" />\n            </div>\n          ) : (\n            <>\n              {paginatedFeedbacks.map((item) => {\n                const isUpdating = rowUpdatingId === item.id && statusUpdating;\n                const isDeleting = rowDeletingId === item.id && deleting;\n                const typeConfig = getFeedbackTypeConfig(item.type);\n\n                return (\n                  <div\n                    key={item.id}\n                    className={`bg-white rounded-2xl border border-[#EEEEEE] p-4 hover:shadow-lg hover:border-[#ff3b3b]/10 transition-all ${\n                      item.is_deleted ? 'opacity-60' : ''\n                    }`}\n                  >\n                    <div className=\"flex items-start gap-4\">\n                      {/* Vote Count Pill */}\n                      <div className=\"w-12 shrink-0\">\n                        <div className=\"bg-[#F7F7F7] rounded-xl p-2 text-center border border-[#EEEEEE]\">\n                          <ThumbsUp className=\"w-4 h-4 text-[#ff3b3b] mx-auto mb-1\" />\n                          <span className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                            {item.voteCount || 0}\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* Main Content */}\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-start justify-between gap-4 mb-2\">\n                          <h3 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                            {item.title}\n                          </h3>\n                          <span className=\"text-[12px] text-[#999999] shrink-0 font-['Manrope:Regular',sans-serif]\">\n                            {formatDateTime(item.created_at)}\n                          </span>\n                        </div>\n\n                        <p className=\"text-[14px] text-[#666666] line-clamp-2 mb-3 font-['Manrope:Regular',sans-serif]\">\n                          {item.description}\n                        </p>\n\n                        <div className=\"flex items-center gap-3 flex-wrap\">\n                          <UserAvatar name={item.createdBy?.name} email={item.createdBy?.email} />\n                          \n                          <div\n                            className=\"px-2 py-0.5 rounded-lg text-[12px] font-['Manrope:SemiBold',sans-serif] flex items-center gap-1.5\"\n                            style={{ backgroundColor: typeConfig.bgColor, color: typeConfig.color }}\n                          >\n                            {typeConfig.icon}\n                            {typeConfig.label}\n                          </div>\n\n                          {item.is_deleted && (\n                            <span className=\"px-2 py-0.5 rounded-lg text-[12px] font-['Manrope:SemiBold',sans-serif] bg-[#FEE2E2] text-[#EF4444]\">\n                              DELETED\n                            </span>\n                          )}\n                        </div>\n                      </div>\n\n                      {/* Actions */}\n                      <div className=\"flex flex-col gap-2 items-end shrink-0\">\n                        <Select\n                          size=\"small\"\n                          loading={isUpdating}\n                          value={item.status}\n                          style={{ width: 140 }}\n                          className=\"feedback-status-select\"\n                          onChange={(val) => handleStatusChange(item.id, val)}\n                          options={STATUS_OPTIONS.map((s) => ({\n                            value: s,\n                            label: getStatusConfig(s).label,\n                          }))}\n                        />\n\n                        <div className=\"flex items-center gap-2\">\n                          <button\n                            onClick={() => setSelected(item)}\n                            className=\"w-8 h-8 rounded-lg bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-colors border border-[#EEEEEE]\"\n                            title=\"View Details\"\n                          >\n                            <Eye className=\"w-4 h-4 text-[#666666]\" />\n                          </button>\n\n                          <Popconfirm\n                            title=\"Delete this feedback?\"\n                            description=\"This hides it from users but keeps it in the database.\"\n                            onConfirm={() => handleSoftDelete(item.id)}\n                            okText=\"Yes\"\n                            cancelText=\"No\"\n                            disabled={item.is_deleted || isDeleting}\n                          >\n                            <button\n                              disabled={item.is_deleted || isDeleting}\n                              className={`w-8 h-8 rounded-lg flex items-center justify-center transition-colors border ${\n                                item.is_deleted || isDeleting\n                                  ? 'bg-[#F7F7F7] text-[#CCCCCC] cursor-not-allowed border-transparent'\n                                  : 'bg-[#FEE2E2] hover:bg-[#FECACA] text-[#EF4444] border-[#FEE2E2]'\n                              }`}\n                              title=\"Soft Delete\"\n                            >\n                              {isDeleting ? (\n                                <Loader2 className=\"w-4 h-4 animate-spin text-[#EF4444]\" />\n                              ) : (\n                                <Trash2 className=\"w-4 h-4\" />\n                              )}\n                            </button>\n                          </Popconfirm>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n\n              {/* Pagination */}\n              {sortedFeedbacks.length > pageSize && (\n                <div className=\"flex justify-end pt-4\">\n                  <PaginationBar\n                    currentPage={currentPage}\n                    totalItems={sortedFeedbacks.length}\n                    pageSize={pageSize}\n                    onPageChange={setCurrentPage}\n                    onPageSizeChange={setPageSize}\n                    itemLabel=\"feedback items\"\n                  />\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Detail Modal */}\n        <Modal\n          open={!!selected}\n          onCancel={() => setSelected(null)}\n          footer={null}\n          width={700}\n          centered\n          styles={{\n            body: { padding: '24px' }\n          }}\n          title={\n            selected && (\n              <div className=\"flex items-center gap-2 text-[18px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                {getFeedbackTypeConfig(selected.type).icon}\n                <span>Feedback Details</span>\n              </div>\n            )\n          }\n        >\n          {selected && (\n            <div className=\"pt-2\">\n              <div className=\"grid grid-cols-3 gap-8\">\n                <div className=\"col-span-2\">\n                  <h2 className=\"text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-3 leading-snug\">\n                    {selected.title}\n                  </h2>\n                  <p className=\"text-[15px] text-[#666666] font-['Manrope:Regular',sans-serif] whitespace-pre-wrap mb-6 leading-relaxed\">\n                    {selected.description}\n                  </p>\n\n                  <div className=\"border-t border-[#EEEEEE] pt-6\">\n                    <p className=\"text-[12px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider mb-3\">Reporter</p>\n                    <div className=\"flex items-center gap-3\">\n                      <UserAvatar name={selected.createdBy?.name} email={selected.createdBy?.email} />\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                          {selected.createdBy?.name || 'Anonymous User'}\n                        </span>\n                        <span className=\"text-[12px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                          {selected.createdBy?.email}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"border-l border-[#EEEEEE] pl-8 space-y-6\">\n                  <div>\n                    <p className=\"text-[12px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider mb-2\">Status</p>\n                    <div\n                      className=\"px-2.5 py-1 rounded-lg text-[12px] font-['Manrope:SemiBold',sans-serif] inline-flex items-center gap-1.5\"\n                      style={{ \n                        backgroundColor: getStatusConfig(selected.status).bgColor, \n                        color: getStatusConfig(selected.status).color \n                      }}\n                    >\n                      {getStatusConfig(selected.status).icon}\n                      {getStatusConfig(selected.status).label}\n                    </div>\n                  </div>\n\n                  <div>\n                    <p className=\"text-[12px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider mb-2\">Type</p>\n                    <div\n                      className=\"px-2.5 py-1 rounded-lg text-[12px] font-['Manrope:SemiBold',sans-serif] inline-flex items-center gap-1.5\"\n                      style={{ \n                        backgroundColor: getFeedbackTypeConfig(selected.type).bgColor, \n                        color: getFeedbackTypeConfig(selected.type).color \n                      }}\n                    >\n                      {getFeedbackTypeConfig(selected.type).icon}\n                      {getFeedbackTypeConfig(selected.type).label}\n                    </div>\n                  </div>\n\n                  <div>\n                    <p className=\"text-[12px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider mb-2\">Date Created</p>\n                    <p className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                      {formatDateTime(selected.created_at)}\n                    </p>\n                  </div>\n\n                  <div>\n                    <p className=\"text-[12px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider mb-2\">Popularity</p>\n                    <div className=\"flex items-center gap-2\">\n                      <ThumbsUp className=\"w-4 h-4 text-[#ff3b3b]\" />\n                      <p className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                        {selected.voteCount ?? 0} Upvotes\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </Modal>\n      </div>\n    </PageLayout>\n    </AlsonotifyLayoutWrapper>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/invoices/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/kanban/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/leaves/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/notes/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TodoWidget' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { AlsonotifyLayoutWrapper } from '../AlsonotifyLayoutWrapper';\nimport { ProgressWidget } from '../../components/dashboard/ProgressWidget';\nimport { MeetingsWidget } from '../../components/dashboard/MeetingsWidget';\nimport { TodoWidget } from '../../components/dashboard/TodoWidget';\nimport { LeavesWidget } from '../../components/dashboard/LeavesWidget';\nimport { NotesWidget } from '../../components/dashboard/NotesWidget';\nimport { ProductivityWidget } from '../../components/dashboard/ProductivityWidget';\n\n// ... (imports)\n\nexport default function DashboardPage() {\n  const router = useRouter();\n\n  return (\n    <AlsonotifyLayoutWrapper>\n      {/* Row 2 & 3: Widgets - Fill remaining space */}\n      <div className=\"flex-1 flex flex-col gap-5 overflow-y-auto min-h-0 pr-1\">\n        {/* Row 2: Task/Progress Widget & Meetings */}\n        <div className=\"grid grid-cols-3 gap-5 flex-1\">\n          <div className=\"col-span-2 h-full\">\n            <ProgressWidget onNavigate={(page: string) => {\n              // Handle filtered navigation with query params\n              if (page.startsWith('requirements')) {\n                // Extract query string if present (e.g., \"requirements?tab=active\")\n                const queryPart = page.includes('?') ? page.substring(page.indexOf('?')) : '';\n                router.push(`/dashboard/requirements${queryPart}`);\n              } else if (page.startsWith('tasks')) {\n                // Extract query string if present (e.g., \"tasks?tab=In_Progress\")\n                const queryPart = page.includes('?') ? page.substring(page.indexOf('?')) : '';\n                router.push(`/dashboard/tasks${queryPart}`);\n              }\n            }} />\n          </div>\n          <div className=\"col-span-1 h-full\">\n            <MeetingsWidget onNavigate={() => router.push('/dashboard/calendar')} />\n          </div>\n        </div>\n\n        {/* Row 3: Notes & Leaves */}\n        <div className=\"grid grid-cols-3 gap-5 flex-1\">\n          <div className=\"col-span-2 h-full\">\n            <NotesWidget />\n          </div>\n          <div className=\"col-span-1 h-full\">\n            <LeavesWidget onNavigate={() => router.push('/dashboard/leaves')} />\n          </div>\n        </div>\n      </div>\n\n      {/* Row 4: Command Centre - Fixed Height at Bottom */}\n      <div className=\"shrink-0\">\n        <ProductivityWidget />\n      </div>\n    </AlsonotifyLayoutWrapper>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/partners/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/profile/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/reports/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/requirements/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/tasks/[taskId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/tasks/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/todo/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/workload/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/workspace/[workspaceId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/workspace/[workspaceId]/requirements/[reqId]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/workspace/[workspaceId]/requirements/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/dashboard/workspace/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/forgot-password/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1155,1158],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1155,1158],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { App } from \"antd\";\nimport { Mail, ArrowRight, Loader2, ArrowLeft } from \"lucide-react\";\nimport { useForgotPassword } from \"@/hooks/useAuth\";\nimport Link from \"next/link\";\nimport { motion } from \"framer-motion\";\nimport AuthLayout from \"@/components/auth/AuthLayout\";\n\nexport default function ForgotPasswordPage() {\n    const { message } = App.useApp();\n    const forgotPasswordMutation = useForgotPassword();\n    const [email, setEmail] = useState(\"\");\n    const [isSubmitted, setIsSubmitted] = useState(false);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (!email) {\n            message.error(\"Please enter your email address\");\n            return;\n        }\n\n        forgotPasswordMutation.mutate(email, {\n            onSuccess: (data) => {\n                if (data.success) {\n                    setIsSubmitted(true);\n                    message.success(\"Reset link sent!\");\n                } else {\n                    message.error(data.message || \"Failed to send reset link\");\n                }\n            },\n            onError: (error: any) => {\n                const errorMessage = error?.response?.data?.message || \"Something went wrong. Please try again.\";\n                message.error(errorMessage);\n            },\n        });\n    };\n\n    const itemVariants = {\n        hidden: { opacity: 0, y: 20 },\n        visible: {\n            opacity: 1,\n            y: 0,\n            transition: { duration: 0.5, ease: [0.22, 1, 0.36, 1] as const }\n        }\n    };\n\n    return (\n        <AuthLayout>\n            <motion.div\n                initial=\"hidden\"\n                animate=\"visible\"\n                className=\"w-full max-w-[420px] space-y-8\"\n            >\n                {/* Header */}\n                <motion.div variants={itemVariants} className=\"space-y-2\">\n                    <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n                        {isSubmitted ? \"Check your inbox\" : \"Forgot Password?\"}\n                    </h2>\n                    <p className=\"text-[#666666]\">\n                        {isSubmitted\n                            ? `We've sent a password reset link to ${email}`\n                            : \"Enter your email address and we'll send you a link to reset your password.\"\n                        }\n                    </p>\n                </motion.div>\n\n                {!isSubmitted ? (\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        <motion.div variants={itemVariants} className=\"space-y-5\">\n                            <div className=\"space-y-2\">\n                                <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Email Address</label>\n                                <div className=\"relative\">\n                                    <input\n                                        type=\"email\"\n                                        placeholder=\"name@company.com\"\n                                        className=\"w-full h-12 pl-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                                        value={email}\n                                        onChange={(e) => setEmail(e.target.value)}\n                                        required\n                                    />\n                                    <Mail className=\"w-5 h-5 text-[#999999] absolute left-3.5 top-1/2 -translate-y-1/2\" />\n                                </div>\n                            </div>\n                        </motion.div>\n\n                        <motion.div variants={itemVariants} className=\"pt-2\">\n                            <button\n                                type=\"submit\"\n                                disabled={forgotPasswordMutation.isPending}\n                                className=\"w-full h-12 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                            >\n                                {forgotPasswordMutation.isPending ? (\n                                    <Loader2 className=\"w-5 h-5 animate-spin\" />\n                                ) : (\n                                    <>\n                                        Send Reset Link\n                                        <ArrowRight className=\"w-4 h-4\" />\n                                    </>\n                                )}\n                            </button>\n                        </motion.div>\n                    </form>\n                ) : (\n                    <motion.div variants={itemVariants} className=\"pt-2\">\n                        <Link href=\"/login\">\n                            <button\n                                className=\"w-full h-12 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 flex items-center justify-center gap-2\"\n                            >\n                                Back to Login\n                            </button>\n                        </Link>\n                    </motion.div>\n                )}\n\n                {!isSubmitted && (\n                    <motion.div variants={itemVariants} className=\"text-center\">\n                        <Link\n                            href=\"/login\"\n                            className=\"flex items-center justify-center gap-2 text-[14px] text-[#666666] font-semibold hover:text-[#111111] transition-colors\"\n                        >\n                            <ArrowLeft className=\"w-4 h-4\" />\n                            Back to Login\n                        </Link>\n                    </motion.div>\n                )}\n            </motion.div>\n        </AuthLayout>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/login/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1261,1264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1261,1264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, Suspense } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\nimport { App } from \"antd\";\nimport { Mail, Lock, Eye, EyeOff, ArrowRight, Loader2 } from \"lucide-react\";\nimport { useLogin } from \"@/hooks/useAuth\";\nimport Link from \"next/link\";\nimport { motion } from \"framer-motion\";\nimport AuthLayout from \"@/components/auth/AuthLayout\";\n\nfunction LoginForm() {\n  const { message } = App.useApp();\n  const searchParams = useSearchParams();\n  const loginMutation = useLogin();\n\n  const initialEmail = searchParams.get(\"email\") || \"\";\n  const redirect = searchParams.get(\"redirect\") || (searchParams.get(\"invite\") ? `/dashboard/partners?invite=${searchParams.get(\"invite\")}` : \"/dashboard\");\n\n  const [email, setEmail] = useState(initialEmail);\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!email || !password) {\n      message.error(\"Please fill in all fields\");\n      return;\n    }\n\n    loginMutation.mutate(\n      { email, password, redirect },\n      {\n        onSuccess: () => {\n          message.success(\"Login successful!\");\n        },\n        onError: (error: any) => {\n          const errorMessage = error?.response?.data?.message || \"Invalid credentials or server error.\";\n          message.error(errorMessage);\n        },\n      }\n    );\n  };\n\n  const itemVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: {\n      opacity: 1,\n      y: 0,\n      transition: { duration: 0.5, ease: [0.22, 1, 0.36, 1] as const }\n    }\n  };\n\n  return (\n    <AuthLayout>\n      <motion.div\n        initial=\"hidden\"\n        animate=\"visible\"\n        className=\"w-full max-w-[420px] space-y-8\"\n      >\n        {/* Header */}\n        <motion.div variants={itemVariants} className=\"space-y-2\">\n          <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n            Welcome Back\n          </h2>\n          <p className=\"text-[#666666]\">\n            Enter your details to access your workspace\n          </p>\n        </motion.div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <motion.div variants={itemVariants} className=\"space-y-5\">\n            <div className=\"space-y-2\">\n              <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Email Address</label>\n              <div className=\"relative\">\n                <input\n                  type=\"email\"\n                  placeholder=\"name@company.com\"\n                  className=\"w-full h-12 pl-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                />\n                <Mail className=\"w-5 h-5 text-[#999999] absolute left-3.5 top-1/2 -translate-y-1/2\" />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Password</label>\n                <Link href=\"/forgot-password\" className=\"text-[12px] font-semibold text-[#ff3b3b] hover:text-[#E63535]\">\n                  Forgot password?\n                </Link>\n              </div>\n              <div className=\"relative\">\n                <input\n                  type={showPassword ? \"text\" : \"password\"}\n                  placeholder=\"••••••••\"\n                  className=\"w-full h-12 pl-11 pr-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                />\n                <Lock className=\"w-5 h-5 text-[#999999] absolute left-3.5 top-1/2 -translate-y-1/2\" />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3.5 top-1/2 -translate-y-1/2 text-[#999999] hover:text-[#111111] p-1 transition-colors\"\n                >\n                  {showPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                </button>\n              </div>\n            </div>\n          </motion.div>\n\n          <motion.div variants={itemVariants} className=\"pt-2\">\n            <button\n              type=\"submit\"\n              disabled={loginMutation.isPending}\n              className=\"w-full h-12 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n            >\n              {loginMutation.isPending ? (\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\n              ) : (\n                <>\n                  Sign In\n                  <ArrowRight className=\"w-4 h-4\" />\n                </>\n              )}\n            </button>\n          </motion.div>\n        </form>\n\n        <motion.div variants={itemVariants} className=\"text-center\">\n          <p className=\"text-[14px] text-[#666666]\">\n            Don't have an account?{\" \"}\n            <Link\n              href=\"/register\"\n              className=\"text-[#111111] font-bold hover:text-[#ff3b3b] transition-colors\"\n            >\n              Sign Up\n            </Link>\n          </p>\n        </motion.div>\n      </motion.div>\n    </AuthLayout>\n  );\n}\n\nexport default function LoginPage() {\n  return (\n    <Suspense fallback={<div className=\"min-h-screen flex items-center justify-center\">Loading...</div>}>\n      <LoginForm />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/password-reset/[id]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1848,1851],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1848,1851],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport { App } from \"antd\";\nimport { Lock, Eye, EyeOff, CheckCircle2, ArrowRight, Loader2 } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { resetPassword } from \"@/services/auth\";\nimport AuthLayout from \"@/components/auth/AuthLayout\";\n\nexport default function PasswordResetPage() {\n  const router = useRouter();\n  const params = useParams();\n  const { message } = App.useApp();\n  const resetToken = params?.id as string;\n\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!password || !confirmPassword) {\n      message.error(\"Please fill in both password fields\");\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      message.error(\"Passwords do not match\");\n      return;\n    }\n\n    if (password.length < 8) {\n      message.error(\"Password must be at least 8 characters long\");\n      return;\n    }\n\n    if (!resetToken) {\n      message.error(\"Invalid or missing reset token\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const result = await resetPassword(resetToken, password);\n      if (result.success) {\n        setIsSubmitted(true);\n        message.success(\"Your password has been reset successfully!\");\n        setTimeout(() => {\n          router.push(\"/login\");\n        }, 3000);\n      } else {\n        message.error(result.message || \"Failed to reset password\");\n      }\n    } catch (error: any) {\n      const errorMessage =\n        error?.response?.data?.message || \"Failed to reset password. Please try again.\";\n      message.error(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const itemVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: {\n      opacity: 1,\n      y: 0,\n      transition: { duration: 0.5, ease: [0.22, 1, 0.36, 1] as const },\n    },\n  };\n\n  return (\n    <AuthLayout>\n      <motion.div\n        initial=\"hidden\"\n        animate=\"visible\"\n        className=\"w-full max-w-[420px] space-y-8\"\n      >\n        {isSubmitted ? (\n          <motion.div variants={itemVariants} className=\"text-center space-y-4\">\n            <CheckCircle2 className=\"w-16 h-16 text-[#28a745] mx-auto\" />\n            <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n              Password Reset!\n            </h2>\n            <p className=\"text-[#666666]\">\n              Your password has been successfully reset. You can now log in with your new password.\n            </p>\n            <motion.div variants={itemVariants} className=\"mt-8\">\n              <button\n                onClick={() => router.push(\"/login\")}\n                className=\"w-full h-12 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 flex items-center justify-center gap-2\"\n              >\n                Back to Login\n              </button>\n            </motion.div>\n          </motion.div>\n        ) : (\n          <>\n            {/* Header */}\n            <motion.div variants={itemVariants} className=\"space-y-2\">\n              <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n                Reset Password\n              </h2>\n              <p className=\"text-[#666666]\">\n                Enter your new password below.\n              </p>\n            </motion.div>\n\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              <motion.div variants={itemVariants} className=\"space-y-5\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                    New Password <span className=\"text-[#ff3b3b]\">*</span>\n                  </label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#999999]\" />\n                    <input\n                      type={showPassword ? \"text\" : \"password\"}\n                      placeholder=\"••••••••\"\n                      className=\"w-full h-12 pl-11 pr-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                      required\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowPassword(!showPassword)}\n                      className=\"absolute right-3.5 top-1/2 -translate-y-1/2 text-[#999999] hover:text-[#111111] p-1 transition-colors\"\n                    >\n                      {showPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                    </button>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">\n                    Confirm New Password <span className=\"text-[#ff3b3b]\">*</span>\n                  </label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#999999]\" />\n                    <input\n                      type={showConfirmPassword ? \"text\" : \"password\"}\n                      placeholder=\"••••••••\"\n                      className=\"w-full h-12 pl-11 pr-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                      value={confirmPassword}\n                      onChange={(e) => setConfirmPassword(e.target.value)}\n                      required\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                      className=\"absolute right-3.5 top-1/2 -translate-y-1/2 text-[#999999] hover:text-[#111111] p-1 transition-colors\"\n                    >\n                      {showConfirmPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                    </button>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Submit Button */}\n              <motion.div variants={itemVariants} className=\"mt-8\">\n                <button\n                  type=\"submit\"\n                  disabled={isLoading}\n                  className=\"h-12 px-8 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2 w-full\"\n                >\n                  {isLoading ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <>\n                      Reset Password\n                      <ArrowRight className=\"w-4 h-4\" />\n                    </>\n                  )}\n                </button>\n              </motion.div>\n            </form>\n          </>\n        )}\n      </motion.div>\n    </AuthLayout>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/app/register/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2351,2354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2351,2354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, Suspense } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { App } from \"antd\";\nimport { Lock, Eye, EyeOff, Mail, User, Building2, CheckCircle2, ArrowRight, Loader2 } from \"lucide-react\";\nimport { useRegister } from \"@/hooks/useAuth\";\nimport Link from \"next/link\";\nimport { motion } from \"framer-motion\";\nimport AuthLayout from \"@/components/auth/AuthLayout\";\n\nfunction RegisterForm() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const { message } = App.useApp();\n  const registerMutation = useRegister();\n\n  const inviteToken = searchParams.get(\"invite\") ?? null;\n  const inviteEmail = searchParams.get(\"email\") ?? null;\n  const inviteName = searchParams.get(\"name\") ?? null;\n\n  const [formData, setFormData] = useState(() => {\n    const nameParts = (inviteName || \"\").trim().split(/\\s+/).filter(Boolean);\n    return {\n      firstName: nameParts[0] || \"\",\n      lastName: nameParts.slice(1).join(\" \") || \"\",\n      email: inviteEmail || \"\",\n      password: \"\",\n      accountType: \"Individual\" as \"Individual\" | \"Organization\",\n    };\n  });\n\n  const [showPassword, setShowPassword] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!formData.firstName || !formData.lastName || !formData.email || !formData.password) {\n      message.error(\"Please fill in all fields\");\n      return;\n    }\n\n    if (formData.password.length < 8) {\n      message.error(\"Password must be at least 8 characters long\");\n      return;\n    }\n\n    registerMutation.mutate(\n      {\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        email: formData.email,\n        password: formData.password,\n        token: inviteToken,\n      },\n      {\n        onSuccess: (data) => {\n          if (data.success) {\n            if (inviteToken) {\n              message.success(\"Registration successful!\");\n              router.push(`/company-details?t=${data.result.token}&type=${formData.accountType.toLowerCase()}`);\n            } else {\n              message.success(\"Please check your email to verify your account\");\n              router.push(\"/login\");\n            }\n          } else {\n            message.error(data.message || \"Registration failed\");\n          }\n        },\n        onError: (error: any) => {\n          const errorMessage = error?.response?.data?.message || \"Something went wrong. Please try again.\";\n          message.error(errorMessage);\n        },\n      }\n    );\n  };\n\n  const itemVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: {\n      opacity: 1,\n      y: 0,\n      transition: { duration: 0.5, ease: [0.22, 1, 0.36, 1] as const }\n    }\n  };\n\n  return (\n    <AuthLayout>\n      <motion.div\n        initial=\"hidden\"\n        animate=\"visible\"\n        className=\"w-full max-w-[420px] space-y-8\"\n      >\n        <motion.div variants={itemVariants} className=\"space-y-2\">\n          <h2 className=\"text-3xl font-bold text-[#111111] tracking-tight\">\n            Create Account\n          </h2>\n          <p className=\"text-[#666666]\">\n            Get started with your 14-day free trial\n          </p>\n        </motion.div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Account Type Selector */}\n          <motion.div variants={itemVariants} className=\"space-y-3\">\n            <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Account Type</label>\n            <div className=\"grid grid-cols-2 gap-3\">\n              {(['Individual', 'Organization'] as const).map((type) => (\n                <button\n                  key={type}\n                  type=\"button\"\n                  onClick={() => setFormData({ ...formData, accountType: type })}\n                  className={`relative flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border-2 transition-all duration-200 ${formData.accountType === type\n                    ? 'border-[#ff3b3b] bg-[#FFF5F5]/50'\n                    : 'border-transparent bg-[#FAFAFA] hover:bg-[#F0F0F0]'\n                    }`}\n                >\n                  <div className={`p-2 rounded-full ${formData.accountType === type ? 'bg-[#ff3b3b] text-white' : 'bg-white text-[#999999]'}`}>\n                    {type === 'Individual' ? <User className=\"w-4 h-4\" /> : <Building2 className=\"w-4 h-4\" />}\n                  </div>\n                  <span className={`text-[13px] font-bold ${formData.accountType === type ? 'text-[#ff3b3b]' : 'text-[#666666]'}`}>{type}</span>\n                  {formData.accountType === type && (\n                    <div className=\"absolute top-3 right-3 text-[#ff3b3b]\">\n                      <CheckCircle2 className=\"w-4 h-4\" />\n                    </div>\n                  )}\n                </button>\n              ))}\n            </div>\n          </motion.div>\n\n          <motion.div variants={itemVariants} className=\"space-y-5\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">First Name</label>\n                <input\n                  type=\"text\"\n                  placeholder=\"John\"\n                  className=\"w-full h-12 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black px-4\"\n                  value={formData.firstName}\n                  onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Last Name</label>\n                <input\n                  type=\"text\"\n                  placeholder=\"Doe\"\n                  className=\"w-full h-12 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black px-4\"\n                  value={formData.lastName}\n                  onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n                  required\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Email Address</label>\n              <div className=\"relative\">\n                <input\n                  type=\"email\"\n                  placeholder=\"name@company.com\"\n                  className=\"w-full h-12 pl-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black disabled:opacity-60 disabled:cursor-not-allowed\"\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  disabled={!!inviteEmail}\n                  required\n                />\n                <Mail className=\"w-5 h-5 text-[#999999] absolute left-3.5 top-1/2 -translate-y-1/2\" />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-[11px] font-bold text-[#999999] uppercase tracking-widest\">Password</label>\n              <div className=\"relative\">\n                <input\n                  type={showPassword ? \"text\" : \"password\"}\n                  placeholder=\"••••••••\"\n                  className=\"w-full h-12 pl-11 pr-11 bg-[#FAFAFA] border border-transparent focus:bg-white focus:border-[#ff3b3b] focus:ring-4 focus:ring-[#ff3b3b]/10 rounded-xl transition-all font-medium outline-none text-black\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  required\n                />\n                <Lock className=\"w-5 h-5 text-[#999999] absolute left-3.5 top-1/2 -translate-y-1/2\" />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3.5 top-1/2 -translate-y-1/2 text-[#999999] hover:text-[#111111] p-1 transition-colors\"\n                >\n                  {showPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                </button>\n              </div>\n            </div>\n          </motion.div>\n\n          <motion.div variants={itemVariants} className=\"pt-2\">\n            <button\n              type=\"submit\"\n              disabled={registerMutation.isPending}\n              className=\"w-full h-12 bg-[#ff3b3b] hover:bg-[#E63535] text-white rounded-[16px] font-bold text-[15px] shadow-lg shadow-[#ff3b3b]/25 transition-all hover:shadow-[#ff3b3b]/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n            >\n              {registerMutation.isPending ? (\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\n              ) : (\n                <>\n                  Create Account\n                  <ArrowRight className=\"w-4 h-4\" />\n                </>\n              )}\n            </button>\n          </motion.div>\n        </form>\n\n        <motion.div variants={itemVariants} className=\"text-center\">\n          <p className=\"text-[14px] text-[#666666]\">\n            Already have an account?{\" \"}\n            <Link\n              href=\"/login\"\n              className=\"text-[#111111] font-bold hover:text-[#ff3b3b] transition-colors\"\n            >\n              Sign In\n            </Link>\n          </p>\n        </motion.div>\n      </motion.div>\n    </AuthLayout>\n  );\n}\n\nexport default function RegisterPage() {\n  return (\n    <Suspense fallback={<div className=\"min-h-screen flex items-center justify-center\">Loading...</div>}>\n      <RegisterForm />\n    </Suspense>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/AntDesignProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/BrowserPolyfills.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/auth/AuthLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { ReactNode } from \"react\";\nimport { motion } from \"framer-motion\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { ArrowLeft } from \"lucide-react\";\nimport BrandLogo from \"@/assets/images/logo-white.png\";\nimport { useRouter } from \"next/navigation\";\n\n// SVG Path for the Star\nconst STAR_PATH = \"M453.287 175.698L518.817 377.379H730.877L559.317 502.024L820.419 814.622L453.287 579.059L256.831 744.136L347.258 502.024L175.698 377.379H387.757L453.287 175.698Z\";\n\ninterface AuthLayoutProps {\n    children: ReactNode;\n}\n\nexport default function AuthLayout({ children }: AuthLayoutProps) {\n    const router = useRouter();\n\n    return (\n        <div className=\"min-h-screen w-full flex bg-white font-['Manrope',sans-serif] overflow-hidden\" data-auth-layout>\n            {/* LEFT SIDE - Brand & Visuals (50% Width) */}\n            <div className=\"hidden lg:flex flex-1 bg-[#111111] relative flex-col justify-between p-16 text-white isolate overflow-hidden\">\n\n                {/* Animated Background Stars */}\n                <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n                    {/* Star 1 - Top Right */}\n                    <motion.div\n                        animate={{\n                            opacity: [0.4, 0.7, 0.4],\n                            scale: [1, 1.15, 1],\n                            rotate: [0, 5, 0]\n                        }}\n                        transition={{ duration: 8, repeat: Infinity, ease: \"easeInOut\" }}\n                        className=\"absolute top-[-100px] right-[-100px] w-[700px] h-[700px] text-[#FF3B3B] opacity-40 blur-[90px]\"\n                    >\n                        <svg viewBox=\"0 0 996 990\" className=\"w-full h-full fill-current\">\n                            <path d={STAR_PATH} />\n                        </svg>\n                    </motion.div>\n\n                    {/* Star 2 - Bottom Left */}\n                    <motion.div\n                        animate={{\n                            opacity: [0.3, 0.6, 0.3],\n                            scale: [1, 1.2, 1],\n                            rotate: [0, -5, 0]\n                        }}\n                        transition={{ duration: 10, repeat: Infinity, ease: \"easeInOut\", delay: 1 }}\n                        className=\"absolute bottom-[-150px] left-[-150px] w-[600px] h-[600px] text-[#FF3B3B] opacity-30 blur-[80px]\"\n                    >\n                        <svg viewBox=\"0 0 996 990\" className=\"w-full h-full fill-current\">\n                            <path d={STAR_PATH} />\n                        </svg>\n                    </motion.div>\n                </div>\n\n                {/* Brand Header */}\n                <div className=\"relative z-10 flex items-center justify-between\">\n                    <div className=\"cursor-pointer\" onClick={() => router.push('/')}>\n                        <Image\n                            src={BrandLogo}\n                            alt=\"Alsonotify\"\n                            width={120}\n                            height={29}\n                            className=\"h-[32px] w-auto object-contain\"\n                            draggable={false}\n                            priority\n                        />\n                    </div>\n                </div>\n\n                {/* Main Text Content */}\n                <div className=\"relative z-10 max-w-xl space-y-8 my-auto\">\n                    <motion.h1\n                        initial={{ opacity: 0, y: 30 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ duration: 0.8, delay: 0.2 }}\n                        className=\"text-[56px] font-extrabold leading-[1.1] tracking-tight\"\n                    >\n                        Manage projects, clients, and tasks all in <span className=\"bg-clip-text text-transparent bg-gradient-to-r from-[#ffce64] via-[#ff5b52] to-[#ffffff]\">one place.</span>\n                    </motion.h1>\n                    <motion.p\n                        initial={{ opacity: 0 }}\n                        animate={{ opacity: 1 }}\n                        transition={{ duration: 0.8, delay: 0.4 }}\n                        className=\"text-[18px] text-[#999999] leading-relaxed max-w-md\"\n                    >\n                        Streamline your agency operations with the platform designed for modern teams. Track profitability, manage resources, and scale your business.\n                    </motion.p>\n                </div>\n\n                {/* Footer Links */}\n                <div className=\"relative z-10 flex items-center gap-8 text-xs font-medium text-[#666666] uppercase tracking-wider\">\n                    <span>© 2025 Alsonotify Inc.</span>\n                    <div className=\"flex gap-6\">\n                        <Link href=\"/privacy\" className=\"text-[#666666] hover:text-white transition-colors\">Privacy Policy</Link>\n                        <Link href=\"/terms\" className=\"text-[#666666] hover:text-white transition-colors\">Terms of Service</Link>\n                    </div>\n                </div>\n            </div>\n\n            {/* RIGHT SIDE - Form (50% Width) */}\n            <div className=\"flex-1 flex flex-col justify-center items-center p-8 lg:p-16 bg-white relative overflow-y-auto\">\n                {children}\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/ChecklistEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":21,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[928,931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[928,931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect, KeyboardEvent } from 'react';\nimport { Checkbox } from 'antd';\nimport { ChecklistItem, createEmptyChecklistItem } from '../../types/notes';\n\ninterface ChecklistEditorProps {\n  items: ChecklistItem[];\n  onChange: (items: ChecklistItem[]) => void;\n  placeholder?: string;\n  className?: string;\n}\n\nexport function ChecklistEditor({ items, onChange, placeholder = \"List\", className = \"\" }: ChecklistEditorProps) {\n  const [localItems, setLocalItems] = useState<ChecklistItem[]>(items.length > 0 ? items : [createEmptyChecklistItem(0)]);\n  const inputRefs = useRef<{ [key: string]: HTMLInputElement | null }>({});\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // Sync with external items - convert from backend format if needed\n  useEffect(() => {\n    if (items && items.length > 0) {\n      // Ensure all items are in ChecklistItem format\n      const convertedItems = items.map((item: any, index: number) => {\n        if (item.id && typeof item.isChecked === 'boolean' && item.order !== undefined) {\n          // Already in ChecklistItem format\n          return item;\n        } else {\n          // Convert from {text, checked} format\n          return {\n            id: item.id || `item-${Date.now()}-${index}`,\n            text: item.text || '',\n            isChecked: item.checked !== undefined ? item.checked : (item.isChecked || false),\n            order: item.order !== undefined ? item.order : index,\n            indentLevel: item.indentLevel || 0,\n            parentId: item.parentId || null,\n            createdAt: item.createdAt || new Date().toISOString(),\n            updatedAt: item.updatedAt || new Date().toISOString(),\n          };\n        }\n      });\n      setLocalItems(convertedItems);\n    } else if (localItems.length === 0) {\n      setLocalItems([createEmptyChecklistItem(0)]);\n    }\n  }, [items]);\n\n  // Notify parent of changes (debounced to avoid excessive updates)\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      onChange(localItems);\n    }, 100);\n    return () => clearTimeout(timeoutId);\n  }, [localItems, onChange]);\n\n  const updateItem = (id: string, updates: Partial<ChecklistItem>) => {\n    setLocalItems(prev => prev.map(item => \n      item.id === id ? { ...item, ...updates, updatedAt: new Date().toISOString() } : item\n    ));\n  };\n\n  const addItem = (afterIndex: number, text: string = '') => {\n    const newItem = createEmptyChecklistItem(afterIndex + 1, 0);\n    newItem.text = text;\n    \n    setLocalItems(prev => {\n      const newItems = [...prev];\n      // Update order of items after insertion point\n      newItems.forEach((item, idx) => {\n        if (idx > afterIndex) {\n          item.order = idx + 1;\n        }\n      });\n      newItems.splice(afterIndex + 1, 0, newItem);\n      return newItems;\n    });\n    \n    // Focus the new item\n    setTimeout(() => {\n      const input = inputRefs.current[newItem.id];\n      if (input) {\n        input.focus();\n        input.setSelectionRange(0, 0);\n      }\n    }, 0);\n  };\n\n  const removeItem = (index: number) => {\n    if (localItems.length === 1) {\n      // Keep at least one empty item\n      setLocalItems([createEmptyChecklistItem(0)]);\n      setTimeout(() => {\n        const input = inputRefs.current[localItems[0].id];\n        if (input) input.focus();\n      }, 0);\n      return;\n    }\n\n    setLocalItems(prev => {\n      const newItems = prev.filter((_, idx) => idx !== index);\n      // Reorder remaining items\n      newItems.forEach((item, idx) => {\n        item.order = idx;\n      });\n      return newItems;\n    });\n\n    // Focus previous item\n    if (index > 0) {\n      setTimeout(() => {\n        const prevItem = localItems[index - 1];\n        const input = inputRefs.current[prevItem.id];\n        if (input) {\n          input.focus();\n          input.setSelectionRange(input.value.length, input.value.length);\n        }\n      }, 0);\n    }\n  };\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLInputElement>, item: ChecklistItem, index: number) => {\n    const input = e.currentTarget;\n    const cursorPos = input.selectionStart || 0;\n    const textLength = input.value.length;\n\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      \n      if (cursorPos === 0 && input.value.trim() === '') {\n        // Enter on empty item: remove if not only item\n        if (localItems.length > 1) {\n          removeItem(index);\n        }\n        return;\n      }\n\n      if (cursorPos < textLength) {\n        // Split item at cursor\n        const beforeText = input.value.substring(0, cursorPos);\n        const afterText = input.value.substring(cursorPos);\n        \n        updateItem(item.id, { text: beforeText });\n        addItem(index, afterText);\n      } else {\n        // Enter at end: create new item\n        if (input.value.trim() !== '') {\n          addItem(index);\n        }\n      }\n    } else if (e.key === 'Backspace') {\n      if (cursorPos === 0 && input.value === '') {\n        e.preventDefault();\n        \n        if (item.indentLevel > 0) {\n          // Dedent instead of delete\n          updateItem(item.id, { indentLevel: Math.max(0, item.indentLevel - 1) });\n        } else if (localItems.length > 1) {\n          // Remove item\n          removeItem(index);\n        }\n      }\n    } else if (e.key === 'Tab') {\n      e.preventDefault();\n      \n      if (e.shiftKey) {\n        // Shift+Tab: dedent\n        if (item.indentLevel > 0) {\n          updateItem(item.id, { indentLevel: item.indentLevel - 1 });\n        }\n      } else {\n        // Tab: indent (only if previous item exists)\n        if (index > 0) {\n          const prevItem = localItems[index - 1];\n          // Can indent at most one level deeper than previous item\n          const maxIndent = prevItem.indentLevel + 1;\n          if (item.indentLevel < maxIndent) {\n            updateItem(item.id, { indentLevel: item.indentLevel + 1 });\n          }\n        }\n        // First item (index 0) cannot be indented\n      }\n    }\n  };\n\n  const handleToggleCheck = (item: ChecklistItem) => {\n    updateItem(item.id, { isChecked: !item.isChecked });\n  };\n\n  // Separate checked and unchecked items\n  const uncheckedItems = localItems.filter(item => !item.isChecked).sort((a, b) => a.order - b.order);\n  const checkedItems = localItems.filter(item => item.isChecked).sort((a, b) => a.order - b.order);\n\n  return (\n    <div \n      ref={containerRef} \n      className={`checklist-editor ${className}`} \n      style={{ \n        minHeight: '200px',\n        width: '100%',\n        boxSizing: 'border-box'\n      }}\n    >\n      {/* Unchecked Items */}\n      <div className=\"space-y-1\">\n        {uncheckedItems.map((item, displayIndex) => {\n          const actualIndex = localItems.findIndex(i => i.id === item.id);\n          return (\n            <div\n              key={item.id}\n              className=\"flex items-start gap-2\"\n              style={{ paddingLeft: `${item.indentLevel * 24}px` }}\n            >\n              <Checkbox\n                checked={item.isChecked}\n                onChange={() => handleToggleCheck(item)}\n                className=\"mt-1.5 flex-shrink-0\"\n              />\n              <input\n                ref={(el) => { inputRefs.current[item.id] = el; }}\n                type=\"text\"\n                value={item.text}\n                onChange={(e) => updateItem(item.id, { text: e.target.value })}\n                onKeyDown={(e) => handleKeyDown(e, item, actualIndex)}\n                placeholder={displayIndex === 0 && item.text === '' ? placeholder : ''}\n                className=\"flex-1 border-none outline-none bg-transparent font-['Manrope:Regular',sans-serif] text-[14px] text-[#111111] placeholder:text-[#999]\"\n                style={{ padding: '4px 0' }}\n              />\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Checked Items Section */}\n      {checkedItems.length > 0 && (\n        <div className=\"mt-4 pt-4 border-t border-[#EEEEEE]\">\n          <div className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999] mb-2 uppercase\">\n            Completed\n          </div>\n          <div className=\"space-y-1\">\n            {checkedItems.map((item) => {\n              const actualIndex = localItems.findIndex(i => i.id === item.id);\n              return (\n                <div\n                  key={item.id}\n                  className=\"flex items-start gap-2 opacity-60\"\n                  style={{ paddingLeft: `${item.indentLevel * 24}px` }}\n                >\n                  <Checkbox\n                    checked={item.isChecked}\n                    onChange={() => handleToggleCheck(item)}\n                    className=\"mt-1.5 flex-shrink-0\"\n                  />\n                  <input\n                    ref={(el) => { inputRefs.current[item.id] = el; }}\n                    type=\"text\"\n                    value={item.text}\n                    onChange={(e) => updateItem(item.id, { text: e.target.value })}\n                    onKeyDown={(e) => handleKeyDown(e, item, actualIndex)}\n                    className=\"flex-1 border-none outline-none bg-transparent font-['Manrope:Regular',sans-serif] text-[14px] text-[#666666] line-through\"\n                    style={{ padding: '4px 0' }}\n                  />\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/DateRangeSelector.tsx","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":82,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":82,"endColumn":58,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2912,3055],"text":"{ const yesterday = now.subtract(1, 'day');\n                newRange = [yesterday.startOf('day'), yesterday.endOf('day')];\n                break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":92,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":92,"endColumn":60,"suggestions":[{"messageId":"addBrackets","fix":{"range":[3356,3505],"text":"{ const lastMonth = now.subtract(1, 'month');\n                newRange = [lastMonth.startOf('month'), lastMonth.endOf('month')];\n                break; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React, { useState, useRef, useEffect } from 'react';\nimport { ChevronDown, ChevronLeft, ChevronRight, CheckSquare } from 'lucide-react';\nimport dayjs, { Dayjs } from 'dayjs';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport quarterOfYear from 'dayjs/plugin/quarterOfYear';\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore';\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter';\n\ndayjs.extend(isoWeek);\ndayjs.extend(quarterOfYear);\ndayjs.extend(isSameOrBefore);\ndayjs.extend(isSameOrAfter);\n\ninterface DateRangeSelectorProps {\n    value: [Dayjs | null, Dayjs | null] | null;\n    onChange: (range: [Dayjs | null, Dayjs | null] | null) => void;\n    defaultRangeType?: string;\n    className?: string;\n    availablePresets?: string[];\n}\n\nexport function DateRangeSelector({\n    value,\n    onChange,\n    defaultRangeType = 'this_month',\n    className = '',\n    availablePresets\n}: DateRangeSelectorProps) {\n    const [selectedRangeType, setSelectedRangeType] = useState<string>(defaultRangeType);\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n    const [calendarOpen, setCalendarOpen] = useState(false);\n\n    // Internal state for manual selection in calendar\n    const [startDate, setStartDate] = useState<Dayjs | null>(value?.[0] || null);\n    const [endDate, setEndDate] = useState<Dayjs | null>(value?.[1] || null);\n    const [currentMonth, setCurrentMonth] = useState<Dayjs>(dayjs());\n\n    const dropdownRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n\n    // Sync internal state with props when value changes externally (and not in custom mode)\n    useEffect(() => {\n        if (value && value[0]) {\n            // If we are not in custom mode, we might want to infer range type or just keep as is\n            // For now, just sync start/end dates for calendar\n            setStartDate(value[0]);\n            setEndDate(value[1]);\n            setCurrentMonth(value[0]);\n        }\n    }, [value]);\n\n    // Handle Range Type Selection\n    const handleRangeTypeChange = (type: string) => {\n        setSelectedRangeType(type);\n        setIsDropdownOpen(false);\n\n        if (type === 'custom') {\n            setCalendarOpen(true);\n            // Initialize calendar with current selection\n            if (value && value[0] && value[1]) {\n                setStartDate(value[0]);\n                setEndDate(value[1]);\n                setCurrentMonth(value[0]);\n            } else {\n                setStartDate(null);\n                setEndDate(null);\n                setCurrentMonth(dayjs());\n            }\n            return;\n        }\n\n        setCalendarOpen(false);\n        const now = dayjs();\n        let newRange: [Dayjs, Dayjs] | null = null;\n\n        switch (type) {\n            case 'today':\n                newRange = [now.startOf('day'), now.endOf('day')];\n                break;\n            case 'yesterday':\n                const yesterday = now.subtract(1, 'day');\n                newRange = [yesterday.startOf('day'), yesterday.endOf('day')];\n                break;\n            case 'this_week':\n                newRange = [now.startOf('isoWeek'), now.endOf('isoWeek')];\n                break;\n            case 'this_month':\n                newRange = [now.startOf('month'), now.endOf('month')];\n                break;\n            case 'last_month':\n                const lastMonth = now.subtract(1, 'month');\n                newRange = [lastMonth.startOf('month'), lastMonth.endOf('month')];\n                break;\n            case 'last_90_days':\n                newRange = [now.subtract(90, 'day').startOf('day'), now.endOf('day')];\n                break;\n            case 'this_year':\n                newRange = [now.startOf('year'), now.endOf('year')];\n                break;\n            case 'all_time':\n                newRange = null; // Represents All Time\n                break;\n            default:\n                newRange = null;\n        }\n\n        onChange(newRange);\n    };\n\n    // Get display label\n    const getRangeLabel = () => {\n        if (selectedRangeType === 'custom') {\n            if (value && value[0] && value[1]) {\n                return `${value[0].format('MMM D')} - ${value[1].format('MMM D')}`;\n            }\n            return 'Custom';\n        }\n        switch (selectedRangeType) {\n            case 'today': return 'Today';\n            case 'yesterday': return 'Yesterday';\n            case 'this_week': return 'This Week';\n            case 'this_month': return 'This Month';\n            case 'last_month': return 'Last Month';\n            case 'last_90_days': return 'Last 90 Days';\n            case 'this_year': return 'This Year';\n            case 'all_time': return 'All Time';\n            default: return 'Select Range';\n        }\n    };\n\n    // Check highlighting\n    const isDateInRange = (date: Dayjs) => {\n        if (!startDate || !endDate) return false;\n        const start = startDate.isBefore(endDate) ? startDate : endDate;\n        const end = startDate.isBefore(endDate) ? endDate : startDate;\n        return date.isAfter(start.startOf('day')) && date.isBefore(end.endOf('day'));\n    };\n\n    const isDateStartOrEnd = (date: Dayjs) => {\n        if (!startDate) return false;\n        if (!endDate) return date.isSame(startDate, 'day');\n        return date.isSame(startDate, 'day') || date.isSame(endDate, 'day');\n    };\n\n    const getCalendarDays = () => {\n        const start = currentMonth.startOf('month').startOf('week');\n        const end = currentMonth.endOf('month').endOf('week');\n        const days: Dayjs[] = [];\n        let current = start;\n        while (current.isSameOrBefore(end, 'day')) {\n            days.push(current);\n            current = current.add(1, 'day');\n        }\n        return days;\n    };\n\n    const handleDateClick = (date: Dayjs) => {\n        if (!startDate || (startDate && endDate)) {\n            setStartDate(date);\n            setEndDate(null);\n        } else if (startDate && !endDate) {\n            let finalStart = startDate;\n            let finalEnd = date;\n            if (date.isBefore(startDate)) {\n                finalStart = date;\n                finalEnd = startDate;\n            }\n            setStartDate(finalStart);\n            setEndDate(finalEnd);\n            onChange([finalStart, finalEnd]);\n            // Keep calendar open? Or close? Dashboard closes it.\n            setCalendarOpen(false);\n            setSelectedRangeType('custom');\n        }\n    };\n\n    // Close dropdown on click outside\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n                setIsDropdownOpen(false);\n            }\n            if (calendarRef.current && !calendarRef.current.contains(event.target as Node) && !dropdownRef.current?.contains(event.target as Node)) {\n                setCalendarOpen(false);\n            }\n        };\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n\n    return (\n        <div className={`relative ${className}`} ref={dropdownRef}>\n            <button\n                onClick={() => setIsDropdownOpen(!isDropdownOpen)}\n                className=\"flex items-center gap-2 px-3 py-1.5 bg-white border border-[#EEEEEE] rounded-lg hover:border-[#111111] hover:text-[#111111] transition-all duration-200 outline-none min-w-[120px] justify-between\"\n            >\n                <span className=\"font-['Manrope',sans-serif] font-semibold text-[13px] text-[#111111] truncate\">\n                    {getRangeLabel()}\n                </span>\n                <ChevronDown className=\"w-3.5 h-3.5 text-[#999999] shrink-0\" />\n            </button>\n\n            {isDropdownOpen && (\n                <div className=\"absolute top-full right-0 mt-2 bg-white border border-[#EEEEEE] rounded-[12px] shadow-lg z-50 w-full overflow-hidden\">\n                    {[\n                        { value: 'today', label: 'Today' },\n                        { value: 'yesterday', label: 'Yesterday' },\n                        { value: 'this_week', label: 'This Week' },\n                        { value: 'this_month', label: 'This Month' },\n                        { value: 'last_month', label: 'Last Month' },\n                        { value: 'last_90_days', label: 'Last 90 Days' },\n                        { value: 'this_year', label: 'This Year' },\n                        { value: 'all_time', label: 'All Time' },\n                        { value: 'custom', label: 'Custom' },\n                    ]\n                        .filter(option => !availablePresets || availablePresets.includes(option.value))\n                        .map((option) => (\n                            <button\n                                key={option.value}\n                                onClick={() => handleRangeTypeChange(option.value)}\n                                className=\"w-full text-left px-4 py-2.5 font-['Manrope',sans-serif] font-medium text-[13px] text-[#444444] hover:bg-[#F7F7F7] hover:text-[#111111] transition-colors flex items-center justify-between group\"\n                            >\n                                <span className={selectedRangeType === option.value ? 'text-[#ff3b3b] font-semibold' : ''}>{option.label}</span>\n                                {selectedRangeType === option.value && (\n                                    <CheckSquare className=\"w-4 h-4 text-[#ff3b3b] flex-shrink-0\" />\n                                )}\n                            </button>\n                        ))}\n                </div>\n            )}\n\n            {calendarOpen && (\n                <div className=\"absolute top-full right-0 mt-2 bg-white border border-[#EEEEEE] rounded-[16px] shadow-2xl z-50 w-[300px] p-4 animate-in fade-in zoom-in-95 duration-200\" ref={calendarRef}>\n                    <div className=\"flex items-center gap-2 mb-3\">\n                        <button\n                            onClick={() => {\n                                setCalendarOpen(false);\n                                setIsDropdownOpen(false);\n                            }}\n                            className=\"w-5 h-5 flex items-center justify-center hover:bg-[#F7F7F7] rounded transition-colors\"\n                        >\n                            <ChevronLeft className=\"w-3.5 h-3.5 text-[#666666]\" />\n                        </button>\n                        <h4 className=\"font-['Manrope',sans-serif] font-semibold text-[14px] text-[#111111]\">\n                            Select Range\n                        </h4>\n                    </div>\n\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <button\n                            onClick={() => setCurrentMonth(currentMonth.subtract(1, 'month'))}\n                            className=\"w-8 h-8 rounded-full hover:bg-[#F7F7F7] flex items-center justify-center transition-colors\"\n                        >\n                            <ChevronLeft className=\"w-4 h-4 text-[#111111]\" />\n                        </button>\n                        <h4 className=\"font-['Manrope',sans-serif] font-bold text-[15px] text-[#111111]\">\n                            {currentMonth.format('MMMM YYYY')}\n                        </h4>\n                        <button\n                            onClick={() => setCurrentMonth(currentMonth.add(1, 'month'))}\n                            className=\"w-8 h-8 rounded-full hover:bg-[#F7F7F7] flex items-center justify-center transition-colors\"\n                        >\n                            <ChevronRight className=\"w-4 h-4 text-[#111111]\" />\n                        </button>\n                    </div>\n\n                    <div className=\"grid grid-cols-7 gap-1 mb-2\">\n                        {['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].map((day) => (\n                            <div key={day} className=\"text-center text-[11px] font-['Manrope',sans-serif] font-bold text-[#999999] uppercase tracking-wider py-1\">\n                                {day}\n                            </div>\n                        ))}\n                    </div>\n\n                    <div className=\"grid grid-cols-7 gap-1\">\n                        {getCalendarDays().map((date, index) => {\n                            const isCurrentMonth = date.month() === currentMonth.month();\n                            const isInRange = isDateInRange(date);\n                            const isStartOrEnd = isDateStartOrEnd(date);\n                            const isToday = date.isSame(dayjs(), 'day');\n                            const isSelected = isStartOrEnd;\n\n                            return (\n                                <button\n                                    key={index}\n                                    onClick={() => handleDateClick(date)}\n                                    className={`\n                                        w-9 h-9 rounded-full text-[12px] font-['Inter',sans-serif] font-medium transition-all duration-200 relative\n                                        ${!isCurrentMonth ? 'invisible pointer-events-none' : 'text-[#111111]'}\n                                        ${isSelected\n                                            ? 'bg-[#111111] text-white shadow-lg'\n                                            : isInRange\n                                                ? 'bg-[#F7F7F7] text-[#111111] rounded-none'\n                                                : 'hover:bg-[#F7F7F7]'\n                                        }\n                                        ${isToday && !isSelected ? 'text-[#ff3b3b] font-bold' : ''}\n                                    `}\n                                >\n                                    {date.date()}\n                                </button>\n                            );\n                        })}\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/FeedbackWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2249,2252],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2249,2252],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState } from 'react';\nimport { Modal, Form, Input, Button, App } from 'antd';\nimport { Lightbulb, Bug, Sparkles, MessageCircle, X } from 'lucide-react';\nimport { useCreateFeedback } from '@/hooks/useFeedback';\nimport { FeedbackType } from '@/services/feedback';\n\nconst { TextArea } = Input;\n\ninterface FeedbackFormValues {\n  title: string;\n  description: string;\n}\n\nconst FEEDBACK_TYPE_OPTIONS: {\n  label: string;\n  description: string;\n  value: FeedbackType;\n  icon: React.ReactNode;\n  color: string;\n}[] = [\n  {\n    label: 'Feature Request',\n    description: 'Suggest a new feature or enhancement.',\n    value: FeedbackType.FEATURE,\n    icon: <Lightbulb className=\"w-5 h-5\" />,\n    color: '#F59E0B',\n  },\n  {\n    label: 'Bug Report',\n    description: 'Report something not working correctly.',\n    value: FeedbackType.BUG,\n    icon: <Bug className=\"w-5 h-5\" />,\n    color: '#EF4444',\n  },\n  {\n    label: 'Improvement',\n    description: 'Improve an existing feature or workflow.',\n    value: FeedbackType.IMPROVEMENT,\n    icon: <Sparkles className=\"w-5 h-5\" />,\n    color: '#10B981',\n  },\n  {\n    label: 'Other',\n    description: \"Anything else you'd like to share.\",\n    value: FeedbackType.OTHER,\n    icon: <MessageCircle className=\"w-5 h-5\" />,\n    color: '#6366F1',\n  },\n];\n\ninterface FeedbackWidgetProps {\n  open: boolean;\n  onClose: () => void;\n}\n\nexport function FeedbackWidget({ open, onClose }: FeedbackWidgetProps) {\n  const { message } = App.useApp();\n  const [selectedType, setSelectedType] = useState<FeedbackType>(FeedbackType.FEATURE);\n  const [form] = Form.useForm<FeedbackFormValues>();\n  const { mutateAsync, isPending } = useCreateFeedback();\n\n  const handleClose = () => {\n    form.resetFields();\n    setSelectedType(FeedbackType.FEATURE);\n    onClose();\n  };\n\n  const handleSubmit = async (values: FeedbackFormValues) => {\n    try {\n      const categoryLabel = FEEDBACK_TYPE_OPTIONS.find(opt => opt.value === selectedType)?.label || selectedType;\n      \n      await mutateAsync({\n        title: categoryLabel,\n        description: values.description.trim(),\n        type: selectedType,\n      });\n      message.success('Thank you for your feedback! 🙌');\n      handleClose();\n    } catch (err: any) {\n      const errorMessage = err?.response?.data?.message || err?.message || 'Failed to submit feedback';\n      message.error(errorMessage);\n    }\n  };\n\n  return (\n    <Modal\n      open={open}\n      onCancel={handleClose}\n      footer={null}\n      width={520}\n      centered\n      closable={false}\n      className=\"feedback-modal [&_.ant-modal-content]:!rounded-2xl [&_.ant-modal-content]:overflow-hidden\"\n      styles={{\n        body: { padding: 0 },\n      }}\n    >\n      <div className=\"bg-white\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-5 border-b border-[#EEEEEE]\">\n          <div>\n            <h2 className=\"text-[18px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-1\">\n              Give us feedback\n            </h2>\n            <p className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n              Tell us how we can make AlsoNotify better for you.\n            </p>\n          </div>\n          <button\n            onClick={handleClose}\n            className=\"w-8 h-8 rounded-full bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-colors\"\n          >\n            <X className=\"w-4 h-4 text-[#666666]\" />\n          </button>\n        </div>\n\n        {/* Body */}\n        <div className=\"px-6 py-5\">\n          <Form<FeedbackFormValues>\n            layout=\"vertical\"\n            form={form}\n            onFinish={handleSubmit}\n          >\n            {/* Category Selection */}\n            <div className=\"mb-5\">\n              <label className=\"block text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-3\">\n                Category\n              </label>\n              <div className=\"grid grid-cols-2 gap-3\">\n                {FEEDBACK_TYPE_OPTIONS.map((opt) => (\n                  <button\n                    key={opt.value}\n                    type=\"button\"\n                    onClick={() => setSelectedType(opt.value)}\n                    className={`\n                      p-3 rounded-xl border-2 text-left transition-all\n                      ${selectedType === opt.value\n                        ? 'border-[#ff3b3b] bg-[#FEF2F2]'\n                        : 'border-[#EEEEEE] bg-white hover:border-[#CCCCCC]'\n                      }\n                    `}\n                  >\n                    <div className=\"flex items-start gap-3\">\n                      <div\n                        className=\"w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0\"\n                        style={{ backgroundColor: `${opt.color}15`, color: opt.color }}\n                      >\n                        {opt.icon}\n                      </div>\n                      <div className=\"min-w-0\">\n                        <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-0.5\">\n                          {opt.label}\n                        </div>\n                        <div className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] leading-tight\">\n                          {opt.description}\n                        </div>\n                      </div>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Description */}\n            <Form.Item\n              name=\"description\"\n              label={\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  Details\n                </span>\n              }\n              rules={[{ required: true, message: 'Please describe your feedback' }]}\n            >\n              <TextArea\n                rows={6}\n                placeholder=\"Describe the bug or idea with as much detail as possible...\"\n                className=\"rounded-xl border-[#EEEEEE] font-['Manrope:Medium',sans-serif] py-3\"\n              />\n            </Form.Item>\n\n            {/* Actions */}\n            <div className=\"flex items-center justify-end gap-3 mt-6\">\n              <Button\n                type=\"text\"\n                onClick={handleClose}\n                className=\"h-11 px-6 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] rounded-xl transition-all\"\n              >\n                Cancel\n              </Button>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                loading={isPending}\n                className=\"h-11 px-6 text-[14px] font-['Manrope:SemiBold',sans-serif] bg-[#111111] hover:bg-[#333333] rounded-xl border-none\"\n              >\n                Submit Feedback\n              </Button>\n            </div>\n          </Form>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/InvitationPopup.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":4,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[607,610],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[607,610],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1338,1341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1338,1341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":73,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":96,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Modal, Button, App } from 'antd';\nimport { getReceivedInvites, acceptInviteById, declineInviteById } from '@/services/user';\nimport { Check, X, Building2, User } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\n\nexport function InvitationPopup() {\n    const { message } = App.useApp();\n    interface Invite {\n        id: number;\n        inviterName: string;\n        inviterCompany?: string;\n        inviterImage?: string;\n        type?: string;\n        created_at?: string;\n        status: string;\n        [key: string]: any;\n    }\n\n    const [isVisible, setIsVisible] = useState(false);\n    const [invites, setInvites] = useState<Invite[]>([]);\n    const [loading, setLoading] = useState(false);\n    const router = useRouter();\n\n    useEffect(() => {\n        const checkInvites = async () => {\n            try {\n                // Check if we've already shown the popup this session to avoid annoyance\n                const hasShown = sessionStorage.getItem('invitationPopupShown');\n                if (hasShown) return;\n\n                const res = await getReceivedInvites();\n                if (res.success && Array.isArray(res.result)) {\n                    // Filter only PENDING invites\n                    const pending = res.result.filter((i: any) => i.status !== 'REJECTED' && i.status !== 'ACCEPTED');\n\n                    if (pending.length > 0) {\n                        setInvites(pending as unknown as Invite[]);\n                        setIsVisible(true);\n                        sessionStorage.setItem('invitationPopupShown', 'true');\n                    }\n                }\n            } catch (error) {\n                console.error('Failed to check invites', error);\n            }\n        };\n\n        // Small delay to allow main data to load first\n        const timer = setTimeout(checkInvites, 2000);\n        return () => clearTimeout(timer);\n    }, []);\n\n    const handleAccept = async (id: number) => {\n        setLoading(true);\n        try {\n            const res = await acceptInviteById(id);\n            if (res.success) {\n                message.success('Invitation accepted!');\n                setInvites(prev => {\n                    const remaining = prev.filter(i => i.id !== id);\n                    if (remaining.length === 0) {\n                        setIsVisible(false);\n                    }\n                    return remaining;\n                });\n                // Refresh page or redirection might be needed if it affects current view\n                router.refresh();\n            } else {\n                message.error(res.message || 'Failed to accept invitation');\n            }\n        } catch (error) {\n            message.error('Failed to accept invitation');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleDecline = async (id: number) => {\n        setLoading(true);\n        try {\n            const res = await declineInviteById(id);\n            if (res.success) {\n                message.success('Invitation declined');\n                setInvites(prev => {\n                    const remaining = prev.filter(i => i.id !== id);\n                    if (remaining.length === 0) {\n                        setIsVisible(false);\n                    }\n                    return remaining;\n                });\n            } else {\n                message.error(res.message || 'Failed to decline invitation');\n            }\n        } catch (error) {\n            message.error('Failed to decline invitation');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setIsVisible(false);\n    };\n\n    if (!isVisible || invites.length === 0) return null;\n\n    return (\n        <Modal\n            open={isVisible}\n            onCancel={handleClose}\n            footer={null}\n            title={\n                <div className=\"flex items-center gap-2 text-xl font-bold font-['Manrope',sans-serif]\">\n                    <span className=\"w-2 h-2 rounded-full bg-[#ff3b3b]\"></span>\n                    Pending Invitations\n                </div>\n            }\n            width={500}\n            centered\n            className=\"invitation-popup\"\n        >\n            <div className=\"py-4 space-y-4\">\n                <p className=\"text-[#666666] text-[15px]\">\n                    You have {invites.length} pending invitation{invites.length > 1 ? 's' : ''} to join as a partner.\n                </p>\n\n                <div className=\"space-y-3 max-h-[300px] overflow-y-auto pr-2\">\n                    {invites.map((invite) => (\n                        <div key={invite.id} className=\"p-4 bg-[#FAFAFA] border border-[#EEEEEE] rounded-2xl flex items-center justify-between gap-4\">\n                            <div className=\"flex items-center gap-3 overflow-hidden\">\n                                <div className={`w-10 h-10 rounded-full flex items-center justify-center shrink-0 ${invite.type === 'ORGANIZATION' ? 'bg-[#FFF5F5] text-[#ff3b3b]' : 'bg-[#EFF6FF] text-[#2563EB]'}`}>\n                                    {invite.inviterImage ? (\n                                        <img src={invite.inviterImage} alt=\"\" className=\"w-full h-full rounded-full object-cover\" />\n                                    ) : (\n                                        invite.inviterCompany ? <Building2 className=\"w-5 h-5\" /> : <User className=\"w-5 h-5\" />\n                                    )}\n                                </div>\n                                <div className=\"flex flex-col min-w-0\">\n                                    <span className=\"font-bold text-[#111111] truncate\">{invite.inviterName}</span>\n                                    {invite.inviterCompany && (\n                                        <span className=\"text-[12px] text-[#666666] truncate\">{invite.inviterCompany}</span>\n                                    )}\n                                </div>\n                            </div>\n\n                            <div className=\"flex items-center gap-2 shrink-0\">\n                                <button\n                                    onClick={() => handleDecline(invite.id)}\n                                    disabled={loading}\n                                    className=\"w-9 h-9 flex items-center justify-center rounded-full hover:bg-[#FEE2E2] text-[#999999] hover:text-[#DC2626] transition-all\"\n                                    title=\"Decline\"\n                                >\n                                    <X className=\"w-4 h-4\" />\n                                </button>\n                                <button\n                                    onClick={() => handleAccept(invite.id)}\n                                    disabled={loading}\n                                    className=\"w-9 h-9 flex items-center justify-center rounded-full bg-[#111111] hover:bg-[#000000] text-white shadow-lg shadow-black/10 transition-all hover:scale-105 active:scale-95\"\n                                    title=\"Accept\"\n                                >\n                                    <Check className=\"w-4 h-4\" />\n                                </button>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n\n                <div className=\"pt-2 text-center\">\n                    <button onClick={handleClose} className=\"text-[#999999] text-[13px] hover:text-[#111111] transition-colors\">\n                        Remind me later\n                    </button>\n                </div>\n            </div>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/LinkWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/NoteComposerModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is assigned a value but never used.","line":33,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1745,1748],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1745,1748],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3671,3674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3671,3674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":171,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":171,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, KeyboardEvent } from 'react';\nimport { Modal, Input, Button, InputRef, App } from 'antd';\nimport { Bold, Italic, List, CheckSquare } from 'lucide-react';\nimport { RichTextEditor, formatText } from './RichTextEditor';\nimport { ChecklistEditor } from './ChecklistEditor';\nimport { NoteType, ChecklistItem, convertTextToChecklist, convertChecklistToText, isNoteEmpty, createEmptyChecklistItem } from '../../types/notes';\nimport { DEFAULT_NOTE_COLOR, NOTE_COLORS } from '../../utils/colorUtils';\n\ntype ComposerState = 'COLLAPSED' | 'EXPANDED_TEXT' | 'EXPANDED_CHECKLIST';\n\ninterface NoteComposerModalProps {\n  open: boolean;\n  onClose: () => void;\n  onSave: (note: {\n    title: string;\n    type: NoteType;\n    content?: string;\n    items?: ChecklistItem[];\n    color: string;\n  }) => Promise<void>;\n  initialNote?: {\n    id?: number;\n    title: string;\n    type: NoteType;\n    content?: string;\n    items?: ChecklistItem[];\n    color: string;\n  } | null;\n}\n\nexport function NoteComposerModal({ open, onClose, onSave, initialNote }: NoteComposerModalProps) {\n  const { message } = App.useApp();\n  const [state, setState] = useState<ComposerState>('COLLAPSED');\n  const [noteType, setNoteType] = useState<NoteType>(initialNote?.type || 'TEXT_NOTE');\n  const [title, setTitle] = useState(initialNote?.title || '');\n  const [content, setContent] = useState(initialNote?.content || '');\n  const [items, setItems] = useState<ChecklistItem[]>(\n    initialNote?.items && initialNote.items.length > 0\n      ? initialNote.items\n      : [createEmptyChecklistItem(0)]\n  );\n  const [color, setColor] = useState(() => {\n    const initial = initialNote?.color || DEFAULT_NOTE_COLOR;\n    return NOTE_COLORS.includes(initial as any) ? initial : NOTE_COLORS[0];\n  });\n  const [isSaving, setIsSaving] = useState(false);\n\n  const titleInputRef = useRef<InputRef>(null);\n  const hasChangesRef = useRef(false);\n\n  // Initialize from initialNote\n  useEffect(() => {\n    if (initialNote) {\n      setTitle(initialNote.title || '');\n      setNoteType(initialNote.type || 'TEXT_NOTE');\n      setContent(initialNote.content || '');\n\n      // Convert backend items format to ChecklistItem format\n      if (initialNote.items && initialNote.items.length > 0) {\n        const convertedItems: ChecklistItem[] = initialNote.items.map((item, index) => {\n          // Check if item is already in ChecklistItem format\n          if ('id' in item && 'isChecked' in item && typeof item.isChecked === 'boolean') {\n            return item as ChecklistItem;\n          }\n\n          // Convert from backend format {text, checked}\n          const backendItem = item as { text?: string; checked?: boolean; id?: string };\n          return {\n            id: backendItem.id || `item-${Date.now()}-${index}`,\n            text: backendItem.text || '',\n            isChecked: backendItem.checked || false,\n            order: 'order' in item && typeof item.order === 'number' ? item.order : index,\n            indentLevel: 'indentLevel' in item && typeof item.indentLevel === 'number' ? item.indentLevel : 0,\n            parentId: 'parentId' in item ? (item.parentId as string | null) : null,\n            createdAt: 'createdAt' in item && typeof item.createdAt === 'string' ? item.createdAt : new Date().toISOString(),\n            updatedAt: 'updatedAt' in item && typeof item.updatedAt === 'string' ? item.updatedAt : new Date().toISOString(),\n          };\n        });\n        setItems(convertedItems);\n      } else {\n        setItems([createEmptyChecklistItem(0)]);\n      }\n\n      const noteColor = initialNote.color || DEFAULT_NOTE_COLOR;\n      setColor(NOTE_COLORS.includes(noteColor as any) ? noteColor : NOTE_COLORS[0]);\n      setState(initialNote.type === 'CHECKLIST_NOTE' ? 'EXPANDED_CHECKLIST' : 'EXPANDED_TEXT');\n      hasChangesRef.current = false;\n    } else {\n      // New note\n      setTitle('');\n      setNoteType('TEXT_NOTE');\n      setContent('');\n      setItems([createEmptyChecklistItem(0)]);\n      setColor(DEFAULT_NOTE_COLOR);\n      setState('COLLAPSED');\n      hasChangesRef.current = false;\n    }\n  }, [initialNote, open]);\n\n  // Track changes\n  useEffect(() => {\n    if (open) {\n      hasChangesRef.current = true;\n    }\n  }, [title, content, items, color, noteType, open]);\n\n  const handleOpen = () => {\n    if (initialNote) {\n      setState(initialNote.type === 'CHECKLIST_NOTE' ? 'EXPANDED_CHECKLIST' : 'EXPANDED_TEXT');\n    } else {\n      setState('EXPANDED_TEXT');\n    }\n    setTimeout(() => {\n      if (titleInputRef.current) {\n        titleInputRef.current.focus();\n      }\n    }, 100);\n  };\n\n  const handleClose = async () => {\n    const isEmpty = isNoteEmpty({ title, content, items });\n\n    if (isEmpty) {\n      // Empty note: close without saving\n      onClose();\n      return;\n    }\n\n    // Non-empty: save and close\n    if (hasChangesRef.current) {\n      await handleSave();\n    } else {\n      onClose();\n    }\n  };\n\n  const handleSave = async () => {\n    if (!title.trim() && noteType === 'TEXT_NOTE' && !content.trim()) {\n      message.warning(\"Title is required\");\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      // Convert ChecklistItem[] to backend format\n      let backendItems: ChecklistItem[] | undefined = undefined;\n      if (noteType === 'CHECKLIST_NOTE' && items.length > 0) {\n        backendItems = items\n          .filter(item => item.text.trim() !== '')\n          .map(item => ({\n            id: item.id,\n            text: item.text,\n            isChecked: item.isChecked,\n            order: item.order,\n            indentLevel: item.indentLevel,\n            parentId: item.parentId || null,\n            createdAt: item.createdAt,\n            updatedAt: item.updatedAt,\n          }));\n      }\n\n      await onSave({\n        title: title.trim() || 'Untitled',\n        type: noteType,\n        content: noteType === 'TEXT_NOTE' ? content : undefined,\n        items: backendItems,\n        color,\n      });\n      hasChangesRef.current = false;\n      onClose();\n    } catch (error) {\n      message.error(\"Failed to save note\");\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleTypeToggle = () => {\n    if (noteType === 'TEXT_NOTE') {\n      // Convert to checklist\n      const newItems = convertTextToChecklist(content);\n      setItems(newItems);\n      setContent('');\n      setNoteType('CHECKLIST_NOTE');\n      setState('EXPANDED_CHECKLIST');\n    } else {\n      // Convert to text\n      const newContent = convertChecklistToText(items);\n      setContent(newContent);\n      setItems([createEmptyChecklistItem(0)]);\n      setNoteType('TEXT_NOTE');\n      setState('EXPANDED_TEXT');\n    }\n    hasChangesRef.current = true;\n  };\n\n  const handleKeyDown = (e: KeyboardEvent) => {\n    // Esc: save and close (or close if empty)\n    if (e.key === 'Escape' && !e.shiftKey && !e.ctrlKey && !e.metaKey) {\n      e.preventDefault();\n      handleClose();\n    }\n\n    // Ctrl/Cmd+Enter: save and close\n    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {\n      e.preventDefault();\n      handleSave();\n    }\n  };\n\n  const handleFormat = (type: string) => {\n    if (noteType === 'TEXT_NOTE') {\n      formatText(type);\n      setTimeout(() => {\n        const selection = window.getSelection();\n        if (selection && selection.rangeCount > 0) {\n          const range = selection.getRangeAt(0);\n          const container = range.commonAncestorContainer;\n          const editor = container.nodeType === Node.TEXT_NODE\n            ? container.parentElement?.closest('.rich-text-editor')\n            : container.nodeType === Node.ELEMENT_NODE\n              ? (container as Element).closest('.rich-text-editor')\n              : null;\n\n          if (editor) {\n            setContent(editor.innerHTML);\n          }\n        }\n      }, 0);\n    }\n  };\n\n  return (\n    <Modal\n      open={open}\n      onCancel={handleClose}\n      footer={null}\n      width={500}\n      centered\n      className=\"rounded-[16px] overflow-hidden\"\n      destroyOnHidden\n      styles={{\n        body: {\n          height: 'auto',\n          maxHeight: '85vh',\n          overflow: 'hidden',\n          display: 'flex',\n          flexDirection: 'column',\n          padding: '24px'\n        }\n      }}\n      afterOpenChange={(visible) => {\n        if (visible) {\n          handleOpen();\n        }\n      }}\n    >\n      <div onKeyDown={handleKeyDown} tabIndex={-1}>\n        <div className=\"border-b border-[#EEEEEE] mb-6 pb-4 flex-shrink-0\">\n          <h2 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">\n            {initialNote ? 'Edit Note' : 'Add Note'}\n          </h2>\n          <p className=\"font-['Manrope:Regular',sans-serif] text-[14px] text-[#666666] mt-1\">\n            Create a new sticky note for quick reminders and tasks.\n          </p>\n        </div>\n\n        <div className=\"flex-1 flex flex-col min-h-0 overflow-hidden\">\n          <div className=\"flex flex-col space-y-4 flex-shrink-0\">\n            {/* Title Input */}\n            <div className=\"flex-shrink-0\">\n              <span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666] mb-2 block\">Title</span>\n              <Input\n                ref={titleInputRef}\n                placeholder=\"Note title\"\n                className=\"rounded-lg font-['Manrope:Medium',sans-serif]\"\n                value={title}\n                onChange={(e) => {\n                  setTitle(e.target.value);\n                  hasChangesRef.current = true;\n                }}\n              />\n            </div>\n\n            {/* Type Toggle Button */}\n            <div className=\"flex items-center justify-between flex-shrink-0\">\n              <Button\n                type=\"text\"\n                onClick={handleTypeToggle}\n                className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666] hover:text-[#111111] p-0 h-auto\"\n              >\n                {noteType === 'TEXT_NOTE' ? (\n                  <>\n                    <CheckSquare className=\"size-4 inline mr-1\" />\n                    Show checkboxes\n                  </>\n                ) : (\n                  <>\n                    <List className=\"size-4 inline mr-1\" />\n                    Hide checkboxes\n                  </>\n                )}\n              </Button>\n\n              {/* Formatting Buttons (only for text notes) - Google Keep style: minimal formatting */}\n              {noteType === 'TEXT_NOTE' && (\n                <div className=\"flex gap-1\">\n                  <button type=\"button\" onClick={() => handleFormat('bold')} className=\"p-1 hover:bg-[#F7F7F7] rounded transition-colors\" title=\"Bold\" aria-label=\"Bold\">\n                    <Bold className=\"size-4 text-[#666666]\" />\n                  </button>\n                  <button type=\"button\" onClick={() => handleFormat('italic')} className=\"p-1 hover:bg-[#F7F7F7] rounded transition-colors\" title=\"Italic\" aria-label=\"Italic\">\n                    <Italic className=\"size-4 text-[#666666]\" />\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {/* Content Editor */}\n            <div\n              className=\"border border-[#d9d9d9] rounded-lg overflow-hidden flex flex-col flex-shrink-0\"\n              style={{\n                minHeight: '200px',\n                maxHeight: '400px'\n              }}\n            >\n              {noteType === 'TEXT_NOTE' ? (\n                <RichTextEditor\n                  value={content}\n                  onChange={(newContent) => {\n                    setContent(newContent);\n                    hasChangesRef.current = true;\n                  }}\n                  placeholder=\"Note content...\"\n                  style={{ minHeight: '200px', maxHeight: '400px', overflowY: 'auto' }}\n                />\n              ) : (\n                <div\n                  className=\"p-3\"\n                  style={{\n                    maxHeight: '400px',\n                    overflowY: 'auto',\n                    flex: 1,\n                    minHeight: 0\n                  }}\n                >\n                  <ChecklistEditor\n                    items={items}\n                    onChange={(newItems) => {\n                      setItems(newItems);\n                      hasChangesRef.current = true;\n                    }}\n                    placeholder=\"List\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Color Picker */}\n            <div className=\"flex-shrink-0\">\n              <span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666] mb-2 block\">Color</span>\n              <div className=\"flex gap-2\">\n                {NOTE_COLORS.map((c) => (\n                  <button\n                    key={c}\n                    className={`w-10 h-10 rounded-lg border-2 transition-colors ${color === c ? 'border-[#111111]' : 'border-transparent hover:border-[#ff3b3b]'}`}\n                    style={{ backgroundColor: c }}\n                    aria-label={`Select color ${c}`}\n                    aria-pressed={color === c}\n                    type=\"button\"\n                    onClick={() => {\n                      setColor(c);\n                      hasChangesRef.current = true;\n                    }}\n                  />\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* Action Buttons - Always visible at bottom */}\n          <div className=\"flex items-center justify-end gap-4 pt-4 mt-4 border-t border-[#EEEEEE] flex-shrink-0 bg-white\">\n            <Button\n              type=\"text\"\n              onClick={handleClose}\n              className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n            >\n              Cancel\n            </Button>\n            <Button\n              type=\"primary\"\n              onClick={handleSave}\n              loading={isSaving}\n              className=\"h-[44px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\"\n            >\n              {initialNote ? 'Update Note' : 'Add Note'}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/NoteViewModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Checkbox' is defined but never used.","line":3,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onEdit' is defined but never used.","line":21,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onArchive' is defined but never used.","line":21,"column":62,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":71},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onDelete' is defined but never used.","line":21,"column":73,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":81},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1407,1410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1407,1410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1795,1798],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1795,1798],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2101,2104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2101,2104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3208,3211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3208,3211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isChecklistNote' is assigned a value but never used.","line":195,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":195,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, KeyboardEvent } from 'react';\n\nimport { Modal, Button, Input, Checkbox, App } from 'antd';\nimport { Note, ChecklistItem } from '../../services/notes';\nimport { updateNote } from '../../services/notes';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { RichTextEditor, formatText } from './RichTextEditor';\nimport { ChecklistEditor } from './ChecklistEditor';\nimport { Bold, Italic, List, CheckSquare } from 'lucide-react';\nimport { NoteType, convertTextToChecklist, convertChecklistToText, createEmptyChecklistItem } from '../../types/notes';\n\ninterface NoteViewModalProps {\n  open: boolean;\n  note: Note | null;\n  onClose: () => void;\n  onEdit?: (note: Note) => void; // Optional - modal is now directly editable\n  onArchive?: (id: number) => void;\n  onDelete?: (id: number) => void;\n}\n\nexport function NoteViewModal({ open, note, onClose, onEdit, onArchive, onDelete }: NoteViewModalProps) {\n  const { message } = App.useApp();\n  const queryClient = useQueryClient();\n\n  // Editable state\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [items, setItems] = useState<ChecklistItem[]>([]);\n  const [noteType, setNoteType] = useState<NoteType>('TEXT_NOTE');\n  const [color, setColor] = useState('#ff3b3b');\n  const [hasChanges, setHasChanges] = useState(false);\n\n  const titleInputRef = useRef<any>(null);\n  const saveTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Initialize from note\n  useEffect(() => {\n    if (note) {\n      setTitle(note.title || '');\n      setContent(note.content || '');\n      // Normalize type: backend might return 'text'/'checklist', but we use 'TEXT_NOTE'/'CHECKLIST_NOTE'\n      const normalizedType = (note.type === 'TEXT_NOTE' || (note.type as any) === 'text') ? 'TEXT_NOTE' : 'CHECKLIST_NOTE';\n      setNoteType(normalizedType);\n      setColor(note.color || '#ff3b3b');\n\n      // Convert items to ChecklistItem format\n      if (note.items && Array.isArray(note.items) && note.items.length > 0) {\n        const convertedItems = note.items.map((item: any, index: number) => {\n          if (item.id && typeof item.isChecked === 'boolean') {\n            return item;\n          } else {\n            return {\n              id: item.id || `item-${Date.now()}-${index}`,\n              text: item.text || '',\n              isChecked: item.checked !== undefined ? item.checked : (item.isChecked || false),\n              order: item.order !== undefined ? item.order : index,\n              indentLevel: item.indentLevel || 0,\n              parentId: item.parentId || null,\n              createdAt: item.createdAt || new Date().toISOString(),\n              updatedAt: item.updatedAt || new Date().toISOString(),\n            };\n          }\n        });\n        setItems(convertedItems);\n      } else {\n        setItems([createEmptyChecklistItem(0)]);\n      }\n      setHasChanges(false);\n\n      // Focus title input when modal opens\n      setTimeout(() => {\n        if (titleInputRef.current) {\n          titleInputRef.current.focus();\n        }\n      }, 100);\n    }\n  }, [note, open]);\n\n  const updateMutation = useMutation({\n    mutationFn: (params: { id: number; data: any }) => updateNote(params.id, params.data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n      setHasChanges(false);\n    },\n    onError: () => message.error(\"Failed to update note\")\n  });\n\n  // Auto-save with debounce\n  const handleSave = async () => {\n    if (!note || !hasChanges) return;\n\n    // Convert ChecklistItem[] to backend format\n    let backendItems = undefined;\n    if (noteType === 'CHECKLIST_NOTE' && items.length > 0) {\n      backendItems = items\n        .filter(item => item.text.trim() !== '')\n        .map(item => ({\n          text: item.text,\n          checked: item.isChecked,\n          id: item.id,\n          order: item.order,\n          indentLevel: item.indentLevel,\n        }));\n    }\n\n    await updateMutation.mutateAsync({\n      id: note.id,\n      data: {\n        title: title.trim() || 'Untitled',\n        type: noteType === 'TEXT_NOTE' ? 'text' : 'checklist',\n        content: noteType === 'TEXT_NOTE' ? content : undefined,\n        items: backendItems,\n        color,\n      }\n    });\n  };\n\n  // Debounced auto-save\n  useEffect(() => {\n    if (hasChanges && note) {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n      }\n      saveTimeoutRef.current = setTimeout(() => {\n        handleSave();\n      }, 1000); // Auto-save after 1 second of no changes\n    }\n\n    return () => {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n      }\n    };\n  }, [title, content, items, color, noteType, hasChanges]);\n\n  const handleTypeToggle = () => {\n    if (noteType === 'TEXT_NOTE') {\n      // Convert to checklist\n      const newItems = convertTextToChecklist(content);\n      setItems(newItems);\n      setContent('');\n      setNoteType('CHECKLIST_NOTE');\n    } else {\n      // Convert to text\n      const newContent = convertChecklistToText(items);\n      setContent(newContent);\n      setItems([createEmptyChecklistItem(0)]);\n      setNoteType('TEXT_NOTE');\n    }\n    setHasChanges(true);\n  };\n\n  const handleFormat = (type: string) => {\n    if (noteType === 'TEXT_NOTE') {\n      formatText(type);\n      setTimeout(() => {\n        const selection = window.getSelection();\n        if (selection && selection.rangeCount > 0) {\n          const range = selection.getRangeAt(0);\n          const container = range.commonAncestorContainer;\n          const editor = container.nodeType === Node.TEXT_NODE\n            ? container.parentElement?.closest('.rich-text-editor')\n            : container.nodeType === Node.ELEMENT_NODE\n              ? (container as Element).closest('.rich-text-editor')\n              : null;\n\n          if (editor) {\n            setContent(editor.innerHTML);\n            setHasChanges(true);\n          }\n        }\n      }, 0);\n    }\n  };\n\n  const handleClose = async () => {\n    // Save any pending changes before closing\n    if (hasChanges && note) {\n      await handleSave();\n    }\n    onClose();\n  };\n\n  const handleKeyDown = (e: KeyboardEvent) => {\n    // Esc: close (after saving)\n    if (e.key === 'Escape' && !e.shiftKey && !e.ctrlKey && !e.metaKey) {\n      e.preventDefault();\n      handleClose();\n    }\n  };\n\n  if (!note) return null;\n\n  const isTextNote = noteType === 'TEXT_NOTE';\n  const isChecklistNote = noteType === 'CHECKLIST_NOTE';\n\n  return (\n    <Modal\n      open={open}\n      onCancel={handleClose}\n      footer={null}\n      width={500}\n      centered\n      className=\"rounded-[16px] overflow-hidden\"\n      destroyOnHidden\n      styles={{\n        body: {\n          height: 'auto',\n          maxHeight: '85vh',\n          overflow: 'hidden',\n          display: 'flex',\n          flexDirection: 'column',\n          padding: '24px'\n        }\n      }}\n    >\n      <div onKeyDown={handleKeyDown} tabIndex={-1}>\n        {/* Editable Title */}\n        <div className=\"mb-4 flex-shrink-0\">\n          <Input\n            ref={titleInputRef}\n            value={title}\n            onChange={(e) => {\n              setTitle(e.target.value);\n              setHasChanges(true);\n            }}\n            placeholder=\"Title\"\n            className=\"text-[20px] font-['Manrope:SemiBold',sans-serif] border-none p-0 shadow-none focus:shadow-none hover:border-none\"\n            style={{ fontSize: '20px', fontWeight: 600 }}\n          />\n        </div>\n\n        {/* Type Toggle and Formatting Buttons */}\n        <div className=\"flex items-center justify-between mb-3 flex-shrink-0\">\n          <Button\n            type=\"text\"\n            onClick={handleTypeToggle}\n            className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666] hover:text-[#111111] p-0 h-auto\"\n          >\n            {isTextNote ? (\n              <>\n                <CheckSquare className=\"size-4 inline mr-1\" />\n                Show checkboxes\n              </>\n            ) : (\n              <>\n                <List className=\"size-4 inline mr-1\" />\n                Hide checkboxes\n              </>\n            )}\n          </Button>\n\n          {/* Formatting Buttons (only for text notes) */}\n          {isTextNote && (\n            <div className=\"flex gap-1\">\n              <button onClick={() => handleFormat('bold')} className=\"p-1 hover:bg-[#F7F7F7] rounded transition-colors\" title=\"Bold\">\n                <Bold className=\"size-4 text-[#666666]\" />\n              </button>\n              <button onClick={() => handleFormat('italic')} className=\"p-1 hover:bg-[#F7F7F7] rounded transition-colors\" title=\"Italic\">\n                <Italic className=\"size-4 text-[#666666]\" />\n              </button>\n            </div>\n          )}\n        </div>\n\n        {/* Editable Content Area - Scrollable */}\n        <div className=\"flex-1 flex flex-col min-h-0 overflow-hidden\">\n          <div\n            className=\"flex-1 overflow-y-auto overflow-x-hidden\"\n            style={{ minHeight: 0 }}\n          >\n            {isTextNote ? (\n              <div\n                className=\"border border-[#d9d9d9] rounded-lg overflow-hidden flex flex-col\"\n                style={{\n                  minHeight: '200px',\n                  maxHeight: '550px'\n                }}\n              >\n                <RichTextEditor\n                  value={content}\n                  onChange={(newContent) => {\n                    setContent(newContent);\n                    setHasChanges(true);\n                  }}\n                  placeholder=\"Note content...\"\n                  style={{ height: '100%', maxHeight: '550px' }}\n                />\n              </div>\n            ) : (\n              <div\n                className=\"border border-[#d9d9d9] rounded-lg overflow-hidden flex flex-col\"\n                style={{\n                  minHeight: '200px',\n                  maxHeight: '550px',\n                  overflowY: 'auto'\n                }}\n              >\n                <div className=\"p-3\">\n                  <ChecklistEditor\n                    items={items}\n                    onChange={(newItems) => {\n                      setItems(newItems);\n                      setHasChanges(true);\n                    }}\n                    placeholder=\"List\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Color Picker */}\n          <div className=\"mt-4 flex-shrink-0\">\n            <div className=\"flex gap-2\">\n              {['#ff3b3b', '#3b8eff', '#9b59b6', '#FFA500', '#2ecc71', '#e74c3c'].map((c) => (\n                <button\n                  key={c}\n                  className={`w-10 h-10 rounded-lg border-2 transition-colors ${color === c ? 'border-[#111111]' : 'border-transparent hover:border-[#ff3b3b]'}`}\n                  style={{ backgroundColor: c }}\n                  onClick={() => {\n                    setColor(c);\n                    setHasChanges(true);\n                  }}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons - Always Visible */}\n        <div className=\"flex items-center justify-end gap-4 pt-4 mt-6 border-t border-[#EEEEEE] flex-shrink-0\">\n          <Button\n            type=\"text\"\n            onClick={handleClose}\n            className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n          >\n            Close\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/NotificationPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/ProfileCompletionBanner.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":32,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo, useEffect } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { X, ArrowRight } from 'lucide-react';\nimport { useUserDetails } from '@/hooks/useUser';\n\nexport function ProfileCompletionBanner() {\n  const [isVisible, setIsVisible] = useState(true);\n  const router = useRouter();\n  const pathname = usePathname();\n  const { data: userDetailsData } = useUserDetails();\n\n  // Check if banner was dismissed in localStorage (reset on each login session)\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const dismissed = localStorage.getItem('profileCompletionBannerDismissed');\n      setIsVisible(dismissed !== 'true');\n    }\n  }, []);\n\n  // Get user data from localStorage or backend\n  const user = useMemo(() => {\n    // First try localStorage (most up-to-date after login)\n    try {\n      if (typeof window !== 'undefined') {\n        const localUser = JSON.parse(localStorage.getItem('user') || '{}');\n        if (localUser && Object.keys(localUser).length > 0) {\n          return localUser;\n        }\n      }\n    } catch (error) {\n      // Ignore parse errors\n    }\n    // Fallback to API data\n    const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return apiUser;\n  }, [userDetailsData]);\n\n  // Calculate profile completion percentage (same logic as ProfilePage)\n  const profileCompletion = useMemo(() => {\n    const userProfile = user?.user_profile || {};\n    const fullName = user?.name || '';\n    const nameParts = fullName.split(' ');\n\n    const profile = {\n      firstName: userProfile?.first_name || nameParts[0] || '',\n      lastName: userProfile?.last_name || nameParts.slice(2).join(' ') || nameParts[1] || '',\n      designation: userProfile?.designation || user?.designation || '',\n      email: user?.email || '',\n      dob: userProfile?.date_of_birth\n        ? new Date(userProfile.date_of_birth).toISOString().split('T')[0]\n        : '',\n      gender: userProfile?.gender || '',\n      employeeId: user?.employee_id || userProfile?.employee_id || '',\n      country: userProfile?.country || '',\n      addressLine1: userProfile?.address?.split(',')[0] || userProfile?.address || '',\n      city: userProfile?.city || '',\n      state: userProfile?.state || '',\n      zipCode: userProfile?.zipcode || '',\n      emergencyContactName: userProfile?.emergency_contact_name || '',\n      emergencyContactNumber: userProfile?.emergency_contact_number || '',\n    };\n\n    const requiredFields = [\n      profile.firstName,\n      profile.lastName,\n      profile.designation,\n      profile.email,\n      profile.dob,\n      profile.gender,\n      profile.employeeId,\n      profile.country,\n      profile.addressLine1,\n      profile.city,\n      profile.state,\n      profile.zipCode,\n      profile.emergencyContactName,\n      profile.emergencyContactNumber,\n    ];\n\n    const filledFields = requiredFields.filter(\n      (field) => field && field.toString().trim() !== ''\n    ).length;\n\n    const totalFields = requiredFields.length;\n    return totalFields > 0 ? Math.round((filledFields / totalFields) * 100) : 0;\n  }, [user]);\n\n  // Don't show if dismissed, on profile page, or 100% complete\n  if (!isVisible || pathname === '/dashboard/profile' || profileCompletion >= 100) {\n    return null;\n  }\n\n  const handleDismiss = () => {\n    setIsVisible(false);\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('profileCompletionBannerDismissed', 'true');\n    }\n  };\n\n  const handleCompleteNow = () => {\n    router.push('/dashboard/profile');\n  };\n\n  // Calculate stroke-dasharray for the progress circle\n  // The circle path is approximately 100 units in length (2 * π * 15.9155 ≈ 100)\n  // For percentage P: we want to show P% of the circle\n  // strokeDasharray format is \"dash, gap\" - draw dash units, skip gap units\n  // For a circle of length ~100: to show 85%, use \"85, 15\" (draw 85, skip 15)\n  const circumference = 2 * Math.PI * 15.9155; // ≈ 100\n  const dashLength = (profileCompletion / 100) * circumference;\n  const gapLength = circumference - dashLength;\n  const strokeDasharray = `${dashLength}, ${gapLength}`;\n\n  return (\n    <div className=\"w-full bg-[#F0F7FF] border border-[#2F80ED]/20 py-3 px-6 flex items-center justify-between shrink-0 rounded-[16px]\">\n      <div className=\"flex items-center gap-4\">\n        <div className=\"relative w-9 h-9 shrink-0\">\n          <svg className=\"w-full h-full -rotate-90\" viewBox=\"0 0 36 36\">\n            {/* Background circle */}\n            <path\n              className=\"text-[#2F80ED]/20\"\n              d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"3\"\n            />\n            {/* Progress circle */}\n            <path\n              className=\"text-[#2F80ED]\"\n              d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"3\"\n              strokeDasharray={strokeDasharray}\n              strokeLinecap=\"round\"\n            />\n          </svg>\n          <span className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-[10px] font-bold text-[#2F80ED]\">\n            {profileCompletion}%\n          </span>\n        </div>\n        <div className=\"flex flex-col\">\n          <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n            Complete your profile\n          </span>\n          <span className=\"text-[12px] text-[#666666] font-['Inter:Medium',sans-serif]\">\n            Add your professional documents to verify your account\n          </span>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-3\">\n        <button\n          onClick={handleCompleteNow}\n          className=\"bg-[#2F80ED] hover:bg-[#2F80ED]/90 text-white text-[13px] h-8 px-4 font-['Manrope:SemiBold',sans-serif] rounded-full shadow-lg shadow-[#2F80ED]/20 flex items-center gap-2 group transition-all\"\n        >\n          Complete Now\n          <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n        </button>\n        <button\n          onClick={handleDismiss}\n          className=\"text-[#666666] hover:text-[#111111] transition-colors p-1 rounded-full hover:bg-[#2F80ED]/10\"\n        >\n          <X className=\"w-4 h-4\" />\n        </button>\n      </div>\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/RichTextEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":147,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":147,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6407,6410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6407,6410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":329,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":329,"endColumn":53,"suggestions":[{"messageId":"addBrackets","fix":{"range":[10565,11158],"text":"{ const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      const textNode = document.createTextNode(range.extractContents().textContent || '');\n      listItem.appendChild(textNode);\n      range.insertNode(listItem);\n      break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":334,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":334,"endColumn":55,"suggestions":[{"messageId":"addBrackets","fix":{"range":[10565,11158],"text":"{ const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      const textNode = document.createTextNode(range.extractContents().textContent || '');\n      listItem.appendChild(textNode);\n      range.insertNode(listItem);\n      break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":339,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":339,"endColumn":91,"suggestions":[{"messageId":"addBrackets","fix":{"range":[10565,11158],"text":"{ const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      const textNode = document.createTextNode(range.extractContents().textContent || '');\n      listItem.appendChild(textNode);\n      range.insertNode(listItem);\n      break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":356,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":356,"endColumn":51,"suggestions":[{"messageId":"addBrackets","fix":{"range":[11575,11914],"text":"{ const code = document.createElement('code');\n      code.style.backgroundColor = '#f5f5f5';\n      code.style.padding = '2px 4px';\n      code.style.borderRadius = '3px';\n      code.style.fontFamily = 'monospace';\n      code.style.fontSize = '0.9em';\n      code.appendChild(range.extractContents());\n      range.insertNode(code);\n      break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'editor' is defined but never used.","line":384,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":384,"endColumn":48},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":397,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":397,"endColumn":53,"suggestions":[{"messageId":"addBrackets","fix":{"range":[12902,13597],"text":"{ const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      listItem.appendChild(document.createTextNode(' '));\n      range.insertNode(listItem);\n      // Move cursor after the checkbox\n      range.setStartAfter(listItem);\n      range.collapse(true);\n      selection.removeAllRanges();\n      selection.addRange(range);\n      break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":402,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":402,"endColumn":55,"suggestions":[{"messageId":"addBrackets","fix":{"range":[12902,13597],"text":"{ const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      listItem.appendChild(document.createTextNode(' '));\n      range.insertNode(listItem);\n      // Move cursor after the checkbox\n      range.setStartAfter(listItem);\n      range.collapse(true);\n      selection.removeAllRanges();\n      selection.addRange(range);\n      break; }"},"desc":"Add {} brackets around the case block."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useRef, useEffect, useState } from 'react';\nimport { sanitizeRichTextForEditor } from '../../utils/sanitizeHtml';\n\ninterface RichTextEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport function RichTextEditor({ value, onChange, placeholder = \"Note content...\", className = \"\", style }: RichTextEditorProps) {\n  const editorRef = useRef<HTMLDivElement>(null);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isMounted, setIsMounted] = useState(false);\n\n  // Only run on client side\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  // Add CSS for placeholder and fix layout - only on client side\n  useEffect(() => {\n    if (typeof window !== 'undefined' && !document.head.querySelector('style[data-rich-text-editor]')) {\n      const style = document.createElement('style');\n      style.setAttribute('data-rich-text-editor', 'true');\n      style.textContent = `\n        .rich-text-editor {\n          box-sizing: border-box !important;\n          position: relative !important;\n          overflow-wrap: break-word !important;\n          word-wrap: break-word !important;\n          word-break: break-word !important;\n          overflow-x: hidden !important;\n          overflow-y: auto !important;\n          width: 100% !important;\n          display: block !important;\n        }\n        .rich-text-editor * {\n          box-sizing: border-box !important;\n          max-width: 100% !important;\n          word-wrap: break-word !important;\n          overflow-wrap: break-word !important;\n        }\n        .rich-text-editor:empty:before {\n          content: attr(data-placeholder);\n          color: #999;\n          pointer-events: none;\n          position: absolute;\n          top: 12px;\n          left: 12px;\n          right: 12px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .rich-text-editor:focus:empty:before {\n          color: #ccc;\n        }\n        .rich-text-editor:not(:empty):before {\n          display: none !important;\n        }\n        .rich-text-editor p {\n          margin: 0 0 8px 0 !important;\n          padding: 0 !important;\n        }\n        .rich-text-editor p:last-child {\n          margin-bottom: 0 !important;\n        }\n        .rich-text-editor ul,\n        .rich-text-editor ol {\n          margin: 0 0 8px 0 !important;\n          padding-left: 24px !important;\n          padding-right: 0 !important;\n        }\n        .rich-text-editor li {\n          margin: 4px 0 !important;\n          padding: 0 !important;\n          word-wrap: break-word !important;\n        }\n        .rich-text-editor h1,\n        .rich-text-editor h2,\n        .rich-text-editor h3,\n        .rich-text-editor h4,\n        .rich-text-editor h5,\n        .rich-text-editor h6 {\n          margin: 8px 0 !important;\n          padding: 0 !important;\n          font-weight: 600 !important;\n          word-wrap: break-word !important;\n        }\n        .rich-text-editor blockquote {\n          margin: 8px 0 !important;\n          padding: 0 0 0 12px !important;\n          word-wrap: break-word !important;\n        }\n        .rich-text-editor code {\n          display: inline-block !important;\n          max-width: 100% !important;\n          overflow-wrap: break-word !important;\n          word-wrap: break-word !important;\n          word-break: break-all !important;\n        }\n        .rich-text-editor pre {\n          margin: 8px 0 !important;\n          padding: 8px !important;\n          overflow-x: auto !important;\n          max-width: 100% !important;\n        }\n        .rich-text-editor img {\n          max-width: 100% !important;\n          height: auto !important;\n        }\n      `;\n      document.head.appendChild(style);\n    }\n  }, []);\n\n  // Update editor content when value prop changes\n  useEffect(() => {\n    if (editorRef.current && editorRef.current.innerHTML !== value) {\n      // Only update if content actually changed to avoid cursor jumping\n      const currentContent = editorRef.current.innerHTML;\n      if (currentContent !== (value || '')) {\n        // Sanitize incoming value before setting it in the editor\n        // We use the editor-specific sanitizer which might be more permissive if needed\n        editorRef.current.innerHTML = sanitizeRichTextForEditor(value || '');\n      }\n    }\n  }, [value]);\n\n  // Clean up content on mount to prevent any initial rendering issues\n  useEffect(() => {\n    if (editorRef.current && isMounted) {\n      // Ensure proper initial state\n      if (!editorRef.current.innerHTML && value) {\n        editorRef.current.innerHTML = value;\n      }\n      // Reset any unwanted styles that might cause overlap\n      const computedStyle = window.getComputedStyle(editorRef.current);\n      if (computedStyle.position === 'static') {\n        editorRef.current.style.position = 'relative';\n      }\n    }\n  }, [isMounted, value]);\n\n  const handleInput = (e: React.FormEvent<HTMLDivElement>) => {\n    if (editorRef.current) {\n        // Sanitize content before sending it up\n        // We generally trust the editor's output mainly for structure, but it's good practice \n        // to sanitize here too, or at least rely on the consumer to sanitize on render.\n        // The requirement is to sanitize \"Editor write path\". \n        // If we strictly sanitize on input (user typing), it might be aggressive.\n        // However, the prompt says \"sanitize output at the boundary\".\n        const cleanContent = sanitizeRichTextForEditor(editorRef.current.innerHTML);\n        onChange(cleanContent);\n    }\n  };\n\n  const handlePaste = (e: React.ClipboardEvent<HTMLDivElement>) => {\n    if (typeof document === 'undefined') return;\n    e.preventDefault();\n    const text = e.clipboardData.getData('text/plain');\n    // Clean the text and insert it\n    const cleanText = text.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n    document.execCommand('insertText', false, cleanText);\n  };\n\n  const applyFormat = (command: string, value?: string) => {\n    if (typeof document === 'undefined') return;\n    document.execCommand(command, false, value);\n    if (editorRef.current) {\n      editorRef.current.focus();\n      onChange(editorRef.current.innerHTML);\n    }\n  };\n\n  // Expose format function for parent component\n  useEffect(() => {\n    if (editorRef.current) {\n      (editorRef.current as any).applyFormat = applyFormat;\n    }\n  }, []);\n\n  // Don't render contentEditable during SSR\n  if (!isMounted) {\n    return (\n      <div\n        className={`rich-text-editor ${className}`}\n        style={{\n          minHeight: '200px',\n          maxHeight: '400px',\n          padding: '12px',\n          border: '1px solid #d9d9d9',\n          borderRadius: '8px',\n          fontFamily: \"'Manrope:Regular', sans-serif\",\n          fontSize: '14px',\n          lineHeight: '1.5',\n          color: '#999',\n          backgroundColor: '#fff',\n          boxSizing: 'border-box',\n          position: 'relative',\n          overflow: 'hidden',\n          wordWrap: 'break-word',\n          overflowWrap: 'break-word',\n          ...style\n        }}\n      >\n        {placeholder}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        width: '100%',\n        boxSizing: 'border-box',\n      }}\n    >\n      <div\n        ref={editorRef}\n        contentEditable\n        onInput={handleInput}\n        onPaste={handlePaste}\n        onFocus={() => setIsFocused(true)}\n        onBlur={() => setIsFocused(false)}\n        className={`rich-text-editor ${className} ${isFocused ? 'focused' : ''}`}\n        style={{\n          minHeight: '200px',\n          padding: '12px',\n          border: 'none',\n          borderRadius: '0',\n          outline: 'none',\n          fontFamily: \"'Manrope:Regular', sans-serif\",\n          fontSize: '14px',\n          lineHeight: '1.5',\n          color: '#111111',\n          backgroundColor: 'transparent',\n          boxSizing: 'border-box',\n          position: 'relative',\n          width: '100%',\n          overflowY: 'auto',\n          wordWrap: 'break-word',\n          overflowWrap: 'break-word',\n          whiteSpace: 'pre-wrap',\n          zIndex: 1,\n          ...(isFocused ? {\n            outline: 'none'\n          } : {}),\n          ...style\n        }}\n        data-placeholder={placeholder}\n        suppressContentEditableWarning\n      />\n    </div>\n  );\n}\n\n// Format button handler functions\nexport const formatText = (type: string) => {\n  // Only work in browser\n  if (typeof window === 'undefined' || typeof document === 'undefined') {\n    return;\n  }\n\n  const selection = window.getSelection();\n  if (!selection || selection.rangeCount === 0) {\n    // If no selection, focus the editor first\n    const editor = document.querySelector('.rich-text-editor') as HTMLElement;\n    if (editor) {\n      editor.focus();\n      // Try again after focusing\n      setTimeout(() => {\n        const newSelection = window.getSelection();\n        if (newSelection && newSelection.rangeCount > 0) {\n          applyFormatToSelection(type, newSelection);\n        } else {\n          // Insert formatting at cursor for block-level formats\n          if (['list', 'checklist', 'heading', 'quote'].includes(type)) {\n            insertBlockFormat(type, editor);\n          }\n        }\n      }, 10);\n    }\n    return;\n  }\n\n  applyFormatToSelection(type, selection);\n};\n\nconst applyFormatToSelection = (type: string, selection: Selection) => {\n  if (typeof document === 'undefined') return;\n\n  const range = selection.getRangeAt(0);\n\n  // For block formats, apply even if collapsed\n  if (['list', 'checklist', 'heading', 'quote'].includes(type)) {\n    if (range.collapsed) {\n      const editor = range.commonAncestorContainer.nodeType === Node.TEXT_NODE\n        ? range.commonAncestorContainer.parentElement?.closest('.rich-text-editor')\n        : (range.commonAncestorContainer as Element).closest('.rich-text-editor');\n      if (editor) {\n        insertBlockFormat(type, editor as HTMLElement);\n      }\n      return;\n    }\n  } else if (range.collapsed) {\n    // For inline formats, need selection\n    return;\n  }\n\n  switch (type) {\n    case 'bold':\n      document.execCommand('bold', false);\n      break;\n    case 'italic':\n      document.execCommand('italic', false);\n      break;\n    case 'strikethrough':\n      document.execCommand('strikethrough', false);\n      break;\n    case 'list':\n      document.execCommand('insertUnorderedList', false);\n      break;\n    case 'checklist':\n      // Create a custom checklist item\n      const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      const textNode = document.createTextNode(range.extractContents().textContent || '');\n      listItem.appendChild(textNode);\n      range.insertNode(listItem);\n      break;\n    case 'heading':\n      try {\n        document.execCommand('formatBlock', false, 'h3');\n      } catch {\n        const heading = document.createElement('h3');\n        heading.style.fontSize = '18px';\n        heading.style.fontWeight = '600';\n        heading.style.margin = '8px 0';\n        heading.appendChild(range.extractContents());\n        range.insertNode(heading);\n      }\n      break;\n    case 'code':\n      const code = document.createElement('code');\n      code.style.backgroundColor = '#f5f5f5';\n      code.style.padding = '2px 4px';\n      code.style.borderRadius = '3px';\n      code.style.fontFamily = 'monospace';\n      code.style.fontSize = '0.9em';\n      code.appendChild(range.extractContents());\n      range.insertNode(code);\n      break;\n    case 'quote':\n      try {\n        document.execCommand('formatBlock', false, 'blockquote');\n      } catch {\n        const blockquote = document.createElement('blockquote');\n        blockquote.style.borderLeft = '3px solid #ddd';\n        blockquote.style.paddingLeft = '12px';\n        blockquote.style.margin = '8px 0';\n        blockquote.style.color = '#666';\n        blockquote.appendChild(range.extractContents());\n        range.insertNode(blockquote);\n      }\n      break;\n  }\n\n  // Clear selection\n  selection.removeAllRanges();\n};\n\nconst insertBlockFormat = (type: string, editor: HTMLElement) => {\n  if (typeof window === 'undefined' || typeof document === 'undefined') return;\n\n  const selection = window.getSelection();\n  if (!selection) return;\n\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : document.createRange();\n\n  switch (type) {\n    case 'list':\n      document.execCommand('insertUnorderedList', false);\n      break;\n    case 'checklist':\n      const listItem = document.createElement('li');\n      listItem.style.listStyle = 'none';\n      listItem.style.position = 'relative';\n      listItem.style.paddingLeft = '24px';\n      listItem.style.margin = '4px 0';\n      const checkbox = document.createElement('span');\n      checkbox.textContent = '☐';\n      checkbox.style.position = 'absolute';\n      checkbox.style.left = '0';\n      listItem.appendChild(checkbox);\n      listItem.appendChild(document.createTextNode(' '));\n      range.insertNode(listItem);\n      // Move cursor after the checkbox\n      range.setStartAfter(listItem);\n      range.collapse(true);\n      selection.removeAllRanges();\n      selection.addRange(range);\n      break;\n    case 'heading':\n      try {\n        document.execCommand('formatBlock', false, 'h3');\n      } catch {\n        const heading = document.createElement('h3');\n        heading.style.fontSize = '18px';\n        heading.style.fontWeight = '600';\n        heading.style.margin = '8px 0';\n        heading.textContent = 'Heading';\n        range.insertNode(heading);\n        range.selectNodeContents(heading);\n        range.collapse(false);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n      break;\n    case 'quote':\n      try {\n        document.execCommand('formatBlock', false, 'blockquote');\n      } catch {\n        const blockquote = document.createElement('blockquote');\n        blockquote.style.borderLeft = '3px solid #ddd';\n        blockquote.style.paddingLeft = '12px';\n        blockquote.style.margin = '8px 0';\n        blockquote.style.color = '#666';\n        blockquote.textContent = 'Quote';\n        range.insertNode(blockquote);\n        range.selectNodeContents(blockquote);\n        range.collapse(false);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n      break;\n  }\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/Sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle24Filled' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Video24Filled' is defined but never used.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings24Filled' is defined but never used.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[692,695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[692,695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5331,5334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5331,5334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { usePathname } from 'next/navigation';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport BrandLogo from '@/assets/images/logo.png';\nimport {\n  Home24Filled,\n  People24Filled,\n  Handshake24Filled,\n  PeopleTeam24Filled,\n  Apps24Filled,\n  ClipboardTaskListLtr24Filled,\n  DocumentMultiple24Filled,\n  ChartMultiple24Filled,\n  Calendar24Filled,\n  WeatherRainShowersDay24Filled,\n  Receipt24Filled,\n  Sparkle24Filled,\n  Notepad24Filled,\n  Video24Filled,\n  Settings24Filled\n} from \"@fluentui/react-icons\";\nimport React from \"react\";\n\ntype UserRole = 'Admin' | 'Manager' | 'Leader' | 'Employee';\n\ninterface SidebarProps {\n  userRole: UserRole;\n  permissions?: any;\n}\n\ntype NavItemConfig = {\n  id: string;\n  path: string;\n  label: string;\n  icon: React.ReactNode;\n  allowedRoles: UserRole[];\n};\n\nimport { navPermissionMap } from '@/utils/navUtils';\n\nexport function Sidebar({ userRole, permissions }: SidebarProps) {\n  const pathname = usePathname();\n\n  const navItems: NavItemConfig[] = [\n    {\n      id: 'dashboard',\n      path: '/dashboard',\n      label: 'Dashboard',\n      icon: <Home24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'employees',\n      path: '/dashboard/employees',\n      label: 'Employees',\n      icon: <People24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'partners',\n      path: '/dashboard/partners',\n      label: 'Partners',\n      icon: <Handshake24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'workspace',\n      path: '/dashboard/workspace',\n      label: 'Workspace',\n      icon: <Apps24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'requirements',\n      path: '/dashboard/requirements',\n      label: 'Requirements',\n      icon: <PeopleTeam24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'tasks',\n      path: '/dashboard/tasks',\n      label: 'Tasks',\n      icon: <ClipboardTaskListLtr24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'reports',\n      path: '/dashboard/reports',\n      label: 'Reports',\n      icon: <DocumentMultiple24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'workload',\n      path: '/dashboard/workload',\n      label: 'Workload',\n      icon: <ChartMultiple24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'calendar',\n      path: '/dashboard/calendar',\n      label: 'Calendar',\n      icon: <Calendar24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'leaves',\n      path: '/dashboard/leaves',\n      label: 'Leaves',\n      icon: <WeatherRainShowersDay24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'invoices',\n      path: '/dashboard/invoices',\n      label: 'Invoices',\n      icon: <Receipt24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n    {\n      id: 'notes',\n      path: '/dashboard/notes',\n      label: 'Notes',\n      icon: <Notepad24Filled />,\n      allowedRoles: ['Admin', 'Manager', 'Leader', 'Employee']\n    },\n\n  ];\n\n  const filteredNavItems = navItems.filter(item => {\n    const permissionKey = navPermissionMap[item.id];\n    const hasPermission = permissions?.Navigation?.[permissionKey];\n\n    // If granular permission is explicitly defined, respect it\n    if (hasPermission !== undefined) {\n      return hasPermission;\n    }\n\n    // Otherwise fallback to role-based access\n    return item.allowedRoles.includes(userRole);\n  });\n\n  const isActive = (path: string) => {\n    if (path === '/dashboard') {\n      return pathname === '/dashboard' || pathname === '/';\n    }\n    // For nested routes, check if pathname starts with the path\n    return pathname.startsWith(path);\n  };\n\n  return (\n    <div className=\"bg-white rounded-[24px] p-6 w-full flex flex-col\" style={{ height: 'calc(100vh - 40px)' }}>\n      {/* Logo */}\n      <div className=\"flex items-center justify-center mb-6\">\n        <Image\n          src={BrandLogo}\n          alt=\"Alsonotify\"\n          width={120}\n          height={29}\n          className=\"h-[29px] w-auto object-contain\"\n          priority\n        />\n      </div>\n\n      {/* Divider */}\n      <div className=\"h-px bg-[#EEEEEE] mb-6\" />\n\n      {/* Navigation */}\n      <nav className=\"flex flex-col gap-2 flex-1 overflow-y-auto scrollbar-hide\">\n        {filteredNavItems.map((item) => (\n          <NavItem\n            key={item.id}\n            href={item.path}\n            icon={item.icon}\n            label={item.label}\n            active={isActive(item.path)}\n          />\n        ))}\n      </nav>\n\n\n      {/* Premium Card at bottom - Only show for Admin/Manager? Optional, keeping for all for now */}\n      <div className=\"mt-6\">\n        <PremiumCard />\n      </div>\n    </div>\n  );\n}\n\nfunction NavItem({ href, icon, label, active = false }: { href: string; icon: React.ReactNode; label: string; active?: boolean }) {\n  const iconColor = active ? '#ff3b3b' : '#434343';\n  const iconWithColor = React.isValidElement(icon)\n    ? React.cloneElement(icon as React.ReactElement<any>, { color: iconColor })\n    : icon;\n\n  return (\n    <Link\n      href={href}\n      className={`\n        relative w-full h-[40px] rounded-full transition-all group shrink-0\n        flex items-center gap-4 px-6\n        ${active\n          ? 'bg-[#FEF3F2] border-2 border-[#ff3b3b]'\n          : 'bg-white hover:bg-[#F7F7F7] border-2 border-transparent'\n        }\n        cursor-pointer outline-none focus:outline-none focus:ring-2 focus:ring-[#ff3b3b]/20\n        no-underline\n      `}\n    >\n      {/* Icon */}\n      <div className=\"flex-shrink-0\">\n        {iconWithColor}\n      </div>\n\n      {/* Label */}\n      <span className={`\n        font-['Manrope:SemiBold',sans-serif] text-[14px] leading-normal\n        ${active ? 'text-[#ff3b3b]' : 'text-[#434343]'}\n      `}>\n        {label}\n      </span>\n    </Link>\n  );\n}\n\nfunction PremiumCard() {\n  return (\n    <div className=\"w-full\">\n      <button className=\"w-full bg-[#ff3b3b] hover:bg-[#e63535] active:bg-[#cc2f2f] text-white font-['Manrope:Bold',sans-serif] text-[14px] px-4 py-3 rounded-full transition-all transform active:scale-[0.98] shadow-sm\">\n        Upgrade Now\n      </button>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/common/Topbar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used.","line":6,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Popover' is defined but never used.","line":7,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":7,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":72},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RequirementFormData' is defined but never used.","line":23,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'usePartners' is defined but never used.","line":30,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TextArea' is assigned a value but never used.","line":39,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Text' is assigned a value but never used.","line":40,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Option' is assigned a value but never used.","line":41,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setUserRole' is defined but never used.","line":59,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userDetailsError' is assigned a value but never used.","line":65,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingUserDetails' is assigned a value but never used.","line":65,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'employeesData' is assigned a value but never used.","line":75,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3971,3974],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3971,3974],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":116,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":116,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5283,5286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5283,5286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":159,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":159,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":178,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":178,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":183,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":183,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6539,6542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6539,6542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":218,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7201,7204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7201,7204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8120,8123],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8120,8123],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":251,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":251,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8425,8428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8425,8428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":514,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":514,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18130,18133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18130,18133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":519,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":519,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18322,18325],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18322,18325],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":528,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":528,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18732,18735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18732,18735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":550,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":550,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19368,19371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19368,19371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { AccessBadge } from '../ui/AccessBadge';\nimport Image from 'next/image';\nimport { Button, Dropdown, Modal, Input, Select, Popover, Avatar, Badge, Typography, App } from 'antd';\nimport type { MenuProps } from 'antd';\nimport {\n  Alert24Filled,\n  Add24Filled,\n  PeopleTeam24Filled,\n  Apps24Filled,\n  ClipboardTaskListLtr24Filled,\n  People24Filled,\n  Handshake24Filled,\n  Receipt24Filled,\n  Calendar24Filled,\n  Notepad24Filled\n} from '@fluentui/react-icons';\nimport { UserCog, Settings, LogOut, MessageCircle } from 'lucide-react';\nimport { TaskForm } from '../modals/TaskForm';\nimport { RequirementsForm, RequirementFormData } from '../modals/RequirementsForm';\nimport { WorkspaceForm } from '../modals/WorkspaceForm';\nimport { NotificationPanel } from './NotificationPanel';\nimport { FeedbackWidget } from './FeedbackWidget';\nimport { useUserDetails } from '@/hooks/useUser';\nimport { getRoleFromUser } from '@/utils/roleUtils';\nimport { useNotifications, useMarkAllNotificationsRead, useMarkNotificationRead } from '@/hooks/useNotification';\nimport { useWorkspaces, usePartners } from '@/hooks/useWorkspace';\nimport { useEmployees } from '@/hooks/useUser';\nimport { searchEmployees } from '@/services/user';\nimport { getRequirementsDropdownByWorkspaceId } from '@/services/workspace';\nimport { useCreateTask } from '@/hooks/useTask';\nimport { useCreateRequirement } from '@/hooks/useWorkspace';\nimport { useLogout } from '@/hooks/useAuth';\nimport { formatDistanceToNow } from 'date-fns';\n\nconst { TextArea } = Input;\nconst { Text } = Typography;\nconst { Option } = Select;\n\ntype UserRole = 'Admin' | 'Manager' | 'Leader' | 'Employee';\n\ninterface HeaderProps {\n  userRole?: UserRole;\n  roleColor?: string;\n  setUserRole?: (role: UserRole) => void;\n}\n\n// Helper function to get greeting based on local time\nconst getGreeting = (): string => {\n  const hour = new Date().getHours();\n  if (hour < 12) return 'Morning';\n  if (hour < 17) return 'Afternoon';\n  return 'Evening';\n};\n\nexport function Header({ userRole = 'Admin', roleColor, setUserRole }: HeaderProps) {\n  const router = useRouter();\n  const handleLogout = useLogout();\n  const { message } = App.useApp();\n\n  // Fetch user details\n  const { data: userDetailsData, error: userDetailsError, isLoading: isLoadingUserDetails } = useUserDetails();\n\n  // Fetch notifications\n  const { data: notificationsData, isLoading: isLoadingNotifications } = useNotifications();\n  const markAllReadMutation = useMarkAllNotificationsRead();\n  const markReadMutation = useMarkNotificationRead();\n\n  // Fetch data for dialogs\n  const { data: workspacesData } = useWorkspaces();\n\n  const { data: employeesData } = useEmployees();\n  const [usersDropdown, setUsersDropdown] = useState<Array<{ id: number; name: string }>>([]);\n  const [requirementsDropdown, setRequirementsDropdown] = useState<Array<{ id: number; name: string }>>([]);\n\n  // Dialogs state\n  const [showWorkspaceDialog, setShowWorkspaceDialog] = useState(false);\n  const [showTaskDialog, setShowTaskDialog] = useState(false);\n  const [showRequirementDialog, setShowRequirementDialog] = useState(false);\n  const [showFeedbackDialog, setShowFeedbackDialog] = useState(false);\n  const [notificationDrawerOpen, setNotificationDrawerOpen] = useState(false);\n\n  // Mutations\n  const createTaskMutation = useCreateTask();\n  const createRequirementMutation = useCreateRequirement();\n\n  // Form States\n\n\n  // Get greeting based on local time - client side only\n  const [greeting, setGreeting] = useState('');\n\n  useEffect(() => {\n    setGreeting(getGreeting());\n\n    // Periodically update greeting\n    const interval = setInterval(() => {\n      setGreeting(getGreeting());\n    }, 60000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  // Sync user from local storage on mount to avoid hydration mismatch\n  const [localUser, setLocalUser] = useState<any>(null);\n\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(\"user\");\n      if (stored) {\n        setLocalUser(JSON.parse(stored));\n      }\n    } catch (e) {\n      // Error reading user from localStorage\n    }\n  }, []);\n\n  const user = useMemo(() => {\n    if (localUser && localUser.name) return localUser;\n\n    // Fallback to API data\n    const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return apiUser;\n  }, [localUser, userDetailsData]);\n\n  // Extract first name from user data\n  const firstName = useMemo(() => {\n    const userProfile = user?.user_profile || userDetailsData?.result?.user?.user_profile;\n    if (userProfile?.first_name) {\n      return userProfile.first_name;\n    }\n    if (user?.first_name) {\n      return user.first_name;\n    }\n    if (user?.name) {\n      return user.name.split(' ')[0] || user.name;\n    }\n    return 'User';\n  }, [user, userDetailsData]);\n\n  // Determine role for UI - prefer prop if passed from authoritative Layout\n  const mappedRole = userRole;\n\n  // Fetch users and requirements for dropdowns\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await searchEmployees();\n        if (response.success) {\n          const transformed = (response.result || []).map((item: any) => ({\n            id: item.value || item.id,\n            name: item.label || item.name,\n          }));\n          setUsersDropdown(transformed);\n        }\n      } catch (error) {\n        message.error('Failed to fetch users');\n      }\n    };\n    fetchUsers();\n  }, [message]);\n\n  useEffect(() => {\n    const fetchRequirements = async () => {\n      try {\n        if (!workspacesData?.result?.workspaces) return;\n        const allRequirements: Array<{ id: number; name: string }> = [];\n\n        for (const workspace of workspacesData.result.workspaces) {\n          try {\n            const response = await getRequirementsDropdownByWorkspaceId(workspace.id);\n            if (response.success && response.result) {\n              allRequirements.push(...response.result);\n            }\n          } catch (error) {\n            // Failed to fetch requirements for workspace\n          }\n        }\n        setRequirementsDropdown(allRequirements);\n      } catch (error) {\n        message.error('Failed to fetch requirements');\n      }\n    };\n    fetchRequirements();\n  }, [workspacesData, message]);\n\n  // Transform notifications\n  const notifications = useMemo(() => {\n    if (!notificationsData?.result) return [];\n    return notificationsData.result.map((n: any) => ({\n      id: n.id,\n      title: n.title || n.message || 'Notification',\n      message: n.message || n.title || '',\n      time: n.created_at\n        ? formatDistanceToNow(new Date(n.created_at), { addSuffix: true })\n        : 'Just now',\n      unread: !n.is_read,\n      type: n.type || 'general',\n    }));\n  }, [notificationsData]);\n\n  const unreadCount = notifications.filter((n) => n.unread).length;\n\n  const handleMarkAsRead = (id: number) => {\n    markReadMutation.mutate(id);\n  };\n\n  const handleClearAllNotifications = () => {\n    markAllReadMutation.mutate();\n  };\n\n\n\n  // Handle requirement creation\n  const handleCreateRequirement = async (data: any) => {\n    if (!data.title) {\n      message.error(\"Requirement title is required\");\n      return;\n    }\n\n    if (!data.workspace_id) {\n      message.error(\"Please select a workspace\");\n      return;\n    }\n\n    createRequirementMutation.mutate(\n      {\n        workspace_id: Number(data.workspace_id),\n        project_id: Number(data.workspace_id), // Backward compatibility\n        name: data.title,\n        description: data.description || '',\n        start_date: new Date().toISOString(),\n        end_date: data.dueDate ? new Date(data.dueDate).toISOString() : undefined,\n        status: 'Assigned',\n        is_high_priority: data.priority === 'HIGH' || data.is_high_priority || false,\n        type: data.type,\n        contact_person: data.contactPerson,\n        contact_person_id: data.contact_person_id,\n        receiver_company_id: data.receiver_company_id,\n        budget: Number(data.budget) || 0,\n      } as any,\n      {\n        onSuccess: () => {\n          message.success(\"Requirement created successfully!\");\n          setShowRequirementDialog(false);\n          // Reset form handled by component unmount/remount usually, but here we might need to reset state if we kept it\n        },\n        onError: (error: any) => {\n          const errorMessage = error?.response?.data?.message || \"Failed to create requirement\";\n          message.error(errorMessage);\n        },\n      }\n    );\n  };\n\n  // Dropdown Items Configuration\n  const addMenuItems: MenuProps['items'] = [\n    {\n      key: 'create-new',\n      type: 'group',\n      label: <span className=\"text-[11px] text-[#999999] uppercase tracking-wider font-['Manrope:Medium',sans-serif]\">Create New</span>,\n      children: [\n        {\n          key: 'req',\n          label: 'Requirement',\n          icon: <PeopleTeam24Filled className=\"w-4 h-4\" />,\n          onClick: () => setShowRequirementDialog(true),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n        {\n          key: 'workspace',\n          label: 'Workspace',\n          icon: <Apps24Filled className=\"w-4 h-4\" />,\n          onClick: () => setShowWorkspaceDialog(true),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n        {\n          key: 'task',\n          label: 'Task',\n          icon: <ClipboardTaskListLtr24Filled className=\"w-4 h-4\" />,\n          onClick: () => setShowTaskDialog(true),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n      ],\n    },\n    { type: 'divider' },\n    {\n      key: 'people',\n      type: 'group',\n      label: <span className=\"text-[11px] text-[#999999] uppercase tracking-wider font-['Manrope:Medium',sans-serif]\">People</span>,\n      children: [\n        {\n          key: 'employee',\n          label: 'Employee',\n          icon: <People24Filled className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/employees'),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n        {\n          key: 'client',\n          label: 'Client',\n          icon: <Handshake24Filled className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/clients'),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n      ],\n    },\n    { type: 'divider' },\n    {\n      key: 'finance',\n      type: 'group',\n      label: <span className=\"text-[11px] text-[#999999] uppercase tracking-wider font-['Manrope:Medium',sans-serif]\">Finance</span>,\n      children: [\n        {\n          key: 'invoice',\n          label: 'Invoice',\n          icon: <Receipt24Filled className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/invoices'),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n      ],\n    },\n    { type: 'divider' },\n    {\n      key: 'quick',\n      type: 'group',\n      label: <span className=\"text-[11px] text-[#999999] uppercase tracking-wider font-['Manrope:Medium',sans-serif]\">Quick Actions</span>,\n      children: [\n        {\n          key: 'calendar',\n          label: 'Schedule Meeting',\n          icon: <Calendar24Filled className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/calendar'),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n        {\n          key: 'notes',\n          label: 'Add Note',\n          icon: <Notepad24Filled className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/todo'),\n          className: \"font-['Manrope:Medium',sans-serif]\"\n        },\n      ],\n    },\n  ];\n\n  const accountType = user?.company?.account_type || 'ORGANIZATION';\n  const isIndividual = accountType === 'INDIVIDUAL';\n\n  const isAdmin = useMemo(() => {\n    const userData = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return getRoleFromUser(userData) === 'Admin';\n  }, [userDetailsData]);\n\n  const profileMenuItems: MenuProps['items'] = [\n    {\n      key: 'account',\n      type: 'group',\n      label: (\n        <span className=\"text-[#111111] font-bold font-['Manrope:Bold',sans-serif] text-[14px]\">\n          {isIndividual ? 'Personal Account' : 'Organization Account'}\n        </span>\n      ),\n      children: [\n        {\n          key: 'settings',\n          label: 'Settings',\n          icon: <Settings className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/settings'),\n        },\n        {\n          key: 'profile',\n          label: 'Profile',\n          icon: <UserCog className=\"w-4 h-4\" />,\n          onClick: () => router.push('/dashboard/profile'),\n        },\n        ...(isAdmin ? [\n          {\n            key: 'feedbacks',\n            label: 'Feedbacks',\n            icon: <MessageCircle className=\"w-4 h-4\" />,\n            onClick: () => router.push('/dashboard/feedback'),\n          }\n        ] : []),\n      ],\n    },\n    { type: 'divider' },\n    {\n      key: 'logout',\n      label: <span className=\"text-[#ff3b3b]\">Log out</span>,\n      icon: <LogOut className=\"w-4 h-4 text-[#ff3b3b]\" />,\n      onClick: handleLogout,\n    },\n  ];\n\n\n  return (\n    <>\n      <div className=\"bg-white rounded-full p-4 w-full\">\n        <div className=\"flex flex-row items-center justify-between w-full\">\n          {/* Left: Greeting text */}\n          <div className=\"flex flex-col font-['Manrope:Regular',sans-serif] font-normal justify-center not-italic text-[#111111] text-nowrap\">\n            <div className=\"flex items-center gap-3\">\n              <p className=\"leading-[normal] text-[20px] whitespace-pre\">\n                <span className=\"font-['Manrope:Regular',sans-serif]\">{`👋 ${greeting}! `}</span>\n                <span className=\"font-['Manrope:Bold',sans-serif]\">{firstName}</span>\n              </p>\n              <AccessBadge role={mappedRole || userRole} color={roleColor} />\n            </div>\n          </div>\n\n          {/* Right: CTAs, icons & profile section */}\n          <div className=\"flex flex-row gap-6 items-center\">\n            {/* Add Button with Dropdown */}\n            <Dropdown menu={{ items: addMenuItems }} placement=\"bottomRight\" trigger={['click']}>\n              <Button\n                className=\"!w-10 !h-10 !min-w-[40px] rounded-full !bg-[#ff3b3b] hover:!bg-[#ff6b6b] flex items-center justify-center p-0 !border-none !shadow-none\"\n                type=\"primary\"\n                shape=\"circle\"\n                icon={<Add24Filled className=\"w-5 h-5 text-white\" />}\n              />\n            </Dropdown>\n\n            {/* Feedback Toggle */}\n            <button\n              onClick={() => setShowFeedbackDialog(true)}\n              className=\"w-10 h-10 rounded-full bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-colors cursor-pointer\"\n              title=\"Give Feedback\"\n            >\n              <svg \n                className=\"w-5 h-5 text-[#666666]\" \n                fill=\"none\" \n                viewBox=\"0 0 24 24\" \n                stroke=\"currentColor\" \n                strokeWidth={2}\n              >\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n              </svg>\n            </button>\n\n            {/* Notification icon */}\n            <>\n              <button\n                onClick={() => setNotificationDrawerOpen(true)}\n                className=\"relative hover:opacity-70 transition-opacity p-1 cursor-pointer\"\n              >\n                <Alert24Filled className=\"w-6 h-6 text-[#000000]\" strokeWidth={1.5} />\n                {/* Notification Badge */}\n                {unreadCount > 0 && (\n                  <span className=\"absolute top-0 right-0 w-4 h-4 bg-[#ff3b3b] rounded-full border border-white flex items-center justify-center\">\n                    <span className=\"text-[9px] font-['Inter:Bold',sans-serif] text-white\">{unreadCount}</span>\n                  </span>\n                )}\n              </button>\n              <NotificationPanel\n                open={notificationDrawerOpen}\n                onClose={() => setNotificationDrawerOpen(false)}\n                notifications={notifications}\n                isLoading={isLoadingNotifications}\n                onMarkAsRead={handleMarkAsRead}\n                onMarkAllRead={handleClearAllNotifications}\n              />\n            </>\n\n            {/* Profile photo & Role Switcher */}\n            <Dropdown menu={{ items: profileMenuItems }} placement=\"bottomRight\" trigger={['click']}>\n              <div className=\"relative shrink-0 size-[40px] rounded-full ring-2 ring-transparent hover:ring-[#ff3b3b]/20 transition-all cursor-pointer\">\n                <Avatar\n                  size={40}\n                  src={user?.user_profile?.profile_pic || user?.profile_pic || \"https://github.com/shadcn.png\"}\n                  // src={user?.user_profile?.profile_pic || user?.profile_pic || \"/documents/profile.png\"}\n                  alt={user?.name || 'User'}\n                />\n              </div>\n            </Dropdown>\n          </div>\n        </div>\n      </div>\n\n      {/* Workspace Modal */}\n      <WorkspaceForm\n        open={showWorkspaceDialog}\n        onCancel={() => setShowWorkspaceDialog(false)}\n        onSuccess={() => setShowWorkspaceDialog(false)}\n      />\n\n      {/* Task Modal */}\n      <Modal\n        open={showTaskDialog}\n        onCancel={() => setShowTaskDialog(false)}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        styles={{\n          body: {\n            padding: 0,\n          }\n        }}\n      >\n        <TaskForm\n          onSubmit={(data) => {\n            if (!data.start_date) {\n              message.error(\"Start Date is required\");\n              return;\n            }\n            const formattedData = {\n              ...data,\n              start_date: data.start_date,\n            };\n            createTaskMutation.mutate(formattedData as any, {\n              onSuccess: () => {\n                setShowTaskDialog(false);\n                message.success(\"Task created successfully\");\n              },\n              onError: (error: any) => {\n                const errorMessage = error?.response?.data?.message || error?.message || \"Failed to create task\";\n                message.error(errorMessage);\n              }\n            });\n          }}\n          onCancel={() => setShowTaskDialog(false)}\n          users={usersDropdown}\n          requirements={requirementsDropdown}\n          workspaces={workspacesData?.result?.workspaces?.map((p: any) => ({ id: p.id, name: p.name })) || []}\n        />\n      </Modal>\n\n      {/* Requirement Modal */}\n      <Modal\n        open={showRequirementDialog}\n        onCancel={() => setShowRequirementDialog(false)}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        styles={{\n          body: {\n            padding: 0,\n            height: '80vh',\n          }\n        }}\n      >\n        <RequirementsForm\n          onSubmit={handleCreateRequirement}\n          onCancel={() => setShowRequirementDialog(false)}\n          workspaces={workspacesData?.result?.workspaces?.map((w: any) => ({ id: w.id, name: w.name })) || []}\n          isLoading={createRequirementMutation.isPending}\n        />\n      </Modal>\n\n      {/* Feedback Modal */}\n      <FeedbackWidget\n        open={showFeedbackDialog}\n        onClose={() => setShowFeedbackDialog(false)}\n      />\n      <style jsx global>{`\n        /* Gray background for all Select dropdowns (default) */\n        .employee-form-select .ant-select-selector {\n          background-color: #F9FAFB !important;\n          border-color: #EEEEEE !important;\n        }\n        .employee-form-select .ant-select-selector:hover {\n          border-color: #EEEEEE !important;\n        }\n        .employee-form-select.ant-select-focused .ant-select-selector {\n          border-color: #EEEEEE !important;\n          box-shadow: none !important;\n        }\n        \n        /* White background for filled Select dropdowns */\n        .employee-form-select-filled .ant-select-selector {\n          background-color: white !important;\n        }\n        \n        /* Remove extra borders on Input focus */\n        .ant-input:focus {\n          border-color: #EEEEEE !important;\n          box-shadow: none !important;\n        }\n\n        /* Notification popover - remove default AntD background/shadow */\n        .notification-popover .ant-popover-inner {\n          background: transparent !important;\n          box-shadow: none !important;\n          padding: 0 !important;\n        }\n        .notification-popover .ant-popover-content {\n          padding: 0 !important;\n        }\n      `}</style>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/AIChatWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":166,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":166,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { MessageCircle, X, Send, Sparkles, Loader2 } from \"lucide-react\";\nimport { generateAgentResponse } from \"@/services/assistant\";\nimport { App } from \"antd\";\n\n// Note: Install react-markdown and remark-gfm if not already installed:\n// npm install react-markdown remark-gfm\n\n// Temporarily using a simple markdown renderer until packages are installed\n// Uncomment the ReactMarkdown import once packages are installed:\n// import ReactMarkdown, { Components } from \"react-markdown\";\n// import remarkGfm from \"remark-gfm\";\n\ntype ChatMessage = {\n  id: string;\n  type: \"user\" | \"assistant\";\n  content: string;\n  timestamp: Date;\n};\n\nconst SUGGESTED_PROMPTS = [\n  { label: \"Requirements\", prompt: \"Give me all the requirements for the project.\" },\n  { label: \"Tasks\", prompt: \"List down all my tasks for today.\" },\n  { label: \"Leaves\", prompt: \"Show the approved leave requests for this month.\" },\n];\n\nexport function AIChatWidget() {\n  const { message } = App.useApp();\n  const [isOpen, setIsOpen] = useState(false);\n  const [prompt, setPrompt] = useState(\"\");\n  const [messages, setMessages] = useState<ChatMessage[]>([\n    {\n      id: \"welcome-message\",\n      type: \"assistant\",\n      content: \"Hello! 👋 I am the Alsonotify Agent. I'm here to help you with your tasks, leaves, reports, and more. How can I assist you today?\",\n      timestamp: new Date(),\n    },\n  ]);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  const { mutateAsync, isPending } = useMutation({\n    mutationFn: (data: { prompt: string; history: { role: \"user\" | \"assistant\"; content: string }[] }) =>\n      generateAgentResponse(data.prompt, data.history),\n  });\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  // Markdown components (uncomment when ReactMarkdown is installed)\n  // const markdownComponents = useMemo<Components>(\n  //   () => ({\n  //     p: ({ children }) => (\n  //       <p className=\"mb-3 whitespace-pre-wrap text-xs leading-relaxed text-[#111111] last:mb-0\">{children}</p>\n  //     ),\n  //     strong: ({ children }) => (\n  //       <strong className=\"font-bold text-[#111111]\">{children}</strong>\n  //     ),\n  //     ul: ({ children }) => (\n  //       <ul className=\"mb-3 list-disc space-y-2 pl-4 text-xs leading-relaxed text-[#111111] last:mb-0\">\n  //         {children}\n  //       </ul>\n  //     ),\n  //     ol: ({ children }) => (\n  //       <ol className=\"mb-3 list-decimal space-y-2 pl-4 text-xs leading-relaxed text-[#111111] last:mb-0\">\n  //         {children}\n  //       </ol>\n  //     ),\n  //     li: ({ children }) => (\n  //       <li className=\"pl-1 whitespace-pre-wrap\">{children}</li>\n  //     ),\n  //     a: ({ href, children }) => (\n  //       <a\n  //         href={href ?? \"#\"}\n  //         target=\"_blank\"\n  //         rel=\"noreferrer\"\n  //         className=\"font-medium text-blue-600 underline hover:text-blue-800\"\n  //       >\n  //         {children}\n  //       </a>\n  //     ),\n  //     table: ({ children }) => (\n  //       <div className=\"my-3 w-full overflow-x-auto rounded-lg border border-slate-200\">\n  //         <table className=\"w-full min-w-full divide-y divide-slate-200 text-left text-xs\">\n  //           {children}\n  //         </table>\n  //       </div>\n  //     ),\n  //     thead: ({ children }) => (\n  //       <thead className=\"bg-slate-50 font-semibold text-[#111111]\">\n  //         {children}\n  //       </thead>\n  //     ),\n  //     tbody: ({ children }) => (\n  //       <tbody className=\"divide-y divide-slate-200 bg-white\">\n  //         {children}\n  //       </tbody>\n  //     ),\n  //     tr: ({ children }) => (\n  //       <tr className=\"hover:bg-slate-50/50 transition-colors\">\n  //         {children}\n  //       </tr>\n  //     ),\n  //     th: ({ children }) => (\n  //       <th className=\"px-3 py-2 font-semibold text-[#111111] whitespace-nowrap\">\n  //         {children}\n  //       </th>\n  //     ),\n  //     td: ({ children }) => (\n  //       <td className=\"px-3 py-2 text-[#666666] whitespace-normal\">\n  //         {children}\n  //       </td>\n  //     ),\n  //   }),\n  //   []\n  // );\n\n  const handleSubmit = async (incoming?: string) => {\n    const query = (incoming ?? prompt).trim();\n    if (!query || isPending) return;\n\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      type: \"user\",\n      content: query,\n      timestamp: new Date(),\n    };\n\n    setMessages((prev) => [...prev, userMessage]);\n    setPrompt(\"\");\n\n    // Prepare History (Last 6 valid messages) excluding the current one we just added\n    const history = messages\n      .filter((m) => m.type === \"user\" || m.type === \"assistant\")\n      .slice(-6)\n      .map((m) => ({\n        role: m.type,\n        content: m.content,\n      }));\n\n    try {\n      const result = await mutateAsync({ prompt: query, history });\n\n      if (result.error) {\n        const errorMessage: ChatMessage = {\n          id: (Date.now() + 1).toString(),\n          type: \"assistant\",\n          content: result.error,\n          timestamp: new Date(),\n        };\n        setMessages((prev) => [...prev, errorMessage]);\n        message.error(result.error);\n        return;\n      }\n\n      const assistantMessage: ChatMessage = {\n        id: (Date.now() + 1).toString(),\n        type: \"assistant\",\n        content: result.answer ?? \"I couldn't generate a response for that request.\",\n        timestamp: new Date(),\n      };\n      setMessages((prev) => [...prev, assistantMessage]);\n    } catch (error) {\n      const errorMessage: ChatMessage = {\n        id: (Date.now() + 1).toString(),\n        type: \"assistant\",\n        content: \"Unable to reach the assistant. Please try again.\",\n        timestamp: new Date(),\n      };\n      setMessages((prev) => [...prev, errorMessage]);\n      message.error(\"Unable to reach the assistant. Please try again.\");\n    }\n  };\n\n  const handlePromptSelect = (value: string) => {\n    if (isPending) return;\n    setPrompt(value);\n    textareaRef.current?.focus();\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (event.key === \"Enter\" && !event.shiftKey) {\n      event.preventDefault();\n      handleSubmit();\n    }\n  };\n\n  return (\n    <>\n      {/* Floating Chat Button */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className={`fixed bottom-6 right-6 z-50 transition-all duration-300 ${isOpen ? 'scale-0 opacity-0' : 'scale-100 opacity-100'\n          }`}\n      >\n        <div className=\"relative\">\n          {/* Pulsing ring animation */}\n          <div className=\"absolute inset-0 rounded-full bg-[#ff3b3b] animate-ping opacity-20\" />\n\n          {/* Main button */}\n          <div className=\"relative bg-gradient-to-br from-[#ff3b3b] via-[#ff5252] to-[#cc2f2f] rounded-full w-16 h-16 flex items-center justify-center shadow-lg hover:shadow-xl transition-all hover:scale-110 active:scale-95\">\n            <MessageCircle className=\"w-7 h-7 text-white\" strokeWidth={2} />\n\n            {/* AI indicator */}\n            <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-white rounded-full flex items-center justify-center shadow-md\">\n              <Sparkles className=\"w-3 h-3 text-[#ff3b3b] fill-[#ff3b3b]\" />\n            </div>\n          </div>\n        </div>\n      </button>\n\n      {/* Chat Panel */}\n      <div\n        className={`fixed bottom-6 right-6 z-50 transition-all duration-300 ${isOpen\n          ? 'scale-100 opacity-100 translate-y-0'\n          : 'scale-95 opacity-0 translate-y-4 pointer-events-none'\n          }`}\n      >\n        <div className=\"bg-white rounded-[24px] shadow-2xl w-[420px] h-[600px] flex flex-col overflow-hidden border border-[#EEEEEE]\">\n          {/* Header */}\n          <div className=\"bg-gradient-to-br from-[#ff3b3b] via-[#ff5252] to-[#cc2f2f] p-6 shadow-[4px_4px_7px_0px_inset_rgba(255,255,255,0.3)]\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center\">\n                  <Sparkles className=\"w-5 h-5 text-white fill-white\" />\n                </div>\n                <div>\n                  <h3 className=\"font-['Manrope:Bold',sans-serif] text-white text-[16px]\">\n                    AI Assistant\n                  </h3>\n                  <div className=\"flex items-center gap-1.5\">\n                    <div className=\"w-2 h-2 bg-[#4ade80] rounded-full animate-pulse\" />\n                    <p className=\"text-white/80 text-[12px] font-['Manrope:Regular',sans-serif]\">\n                      Online\n                    </p>\n                  </div>\n                </div>\n              </div>\n              <button\n                onClick={() => setIsOpen(false)}\n                className=\"w-8 h-8 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-full flex items-center justify-center transition-all\"\n              >\n                <X className=\"w-5 h-5 text-white\" />\n              </button>\n            </div>\n          </div>\n\n          {/* Messages Area */}\n          <div className=\"flex-1 overflow-y-auto p-6 bg-[#F7F7F7] space-y-4\">\n            <div className=\"flex flex-col gap-4\">\n              {messages.map((message) => (\n                <div\n                  key={message.id}\n                  className={`flex ${message.type === \"user\" ? \"justify-end\" : \"justify-start\"}`}\n                >\n                  <div\n                    className={`max-w-[80%] rounded-[16px] px-4 py-3 ${message.type === \"user\"\n                      ? \"bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] rounded-tr-[4px]\"\n                      : \"bg-white border border-[#EEEEEE] rounded-tl-[4px]\"\n                      }`}\n                  >\n                    {message.type === \"assistant\" ? (\n                      <div className=\"markdown-response whitespace-pre-wrap text-xs text-[#111111]\">\n                        {/* Uncomment when ReactMarkdown is installed:\n                        <ReactMarkdown\n                          components={markdownComponents}\n                          remarkPlugins={[remarkGfm]}\n                        >\n                          {message.content}\n                        </ReactMarkdown>\n                        */}\n                        {/* Temporary: Simple text rendering until ReactMarkdown is installed */}\n                        <div className=\"whitespace-pre-wrap text-[14px] font-['Manrope:Regular',sans-serif] leading-relaxed\">\n                          {message.content}\n                        </div>\n                      </div>\n                    ) : (\n                      <p className=\"text-white text-[14px] font-['Manrope:Regular',sans-serif] leading-relaxed\">\n                        {message.content}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              ))}\n\n              {isPending && (\n                <div className=\"flex justify-start\">\n                  <div className=\"rounded-[16px] bg-white border border-[#EEEEEE] px-4 py-3\">\n                    <div className=\"flex items-center gap-2 text-sm text-[#666666]\">\n                      <Loader2 className=\"h-4 w-4 animate-spin text-[#ff3b3b]\" />\n                      <span>Fetching fresh data...</span>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Suggested prompts */}\n          <div className=\"border-t border-[#EEEEEE] px-4 py-3 bg-white\">\n            <div className=\"flex flex-wrap gap-2\">\n              {SUGGESTED_PROMPTS.map((chip) => (\n                <button\n                  key={chip.label}\n                  className=\"rounded-full border border-[#EEEEEE] bg-white px-3 py-1.5 text-xs font-medium text-[#111111] transition hover:border-[#ff3b3b] hover:bg-[#ff3b3b] hover:text-white disabled:cursor-not-allowed disabled:opacity-50\"\n                  onClick={() => handlePromptSelect(chip.prompt)}\n                  disabled={isPending}\n                  aria-label={`Quick prompt for ${chip.label}`}\n                >\n                  {chip.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Input Area */}\n          <form\n            className=\"p-4 bg-white border-t border-[#EEEEEE]\"\n            onSubmit={(event) => {\n              event.preventDefault();\n              handleSubmit();\n            }}\n          >\n            <div className=\"flex items-end gap-2\">\n              <textarea\n                ref={textareaRef}\n                className=\"h-20 flex-1 resize-none rounded-[16px] border border-[#EEEEEE] bg-[#F7F7F7] px-4 py-3 text-sm text-[#111111] outline-none transition focus:border-[#ff3b3b] focus:ring-2 focus:ring-[#ff3b3b]/20\"\n                placeholder=\"Ask anything about your workspace data...\"\n                value={prompt}\n                onChange={(event) => setPrompt(event.target.value)}\n                onKeyDown={handleKeyDown}\n                disabled={isPending}\n              />\n              <button\n                type=\"submit\"\n                className=\"flex h-11 w-11 shrink-0 items-center justify-center rounded-[16px] bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] text-white transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60 shadow-md\"\n                disabled={isPending || !prompt.trim()}\n              >\n                {isPending ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <Send className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/InvoicesWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'date' is defined but never used.","line":37,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import svgPaths from \"../../constants/iconPaths\";\n\nexport function InvoicesWidget() {\n  const invoices = [\n    { id: \"#INV-1127\", client: \"TechStartup Inc.\", amount: \"$12,500\", status: \"Paid\", date: \"Nov 10\" },\n    { id: \"#INV-1128\", client: \"Creative Agency Co.\", amount: \"$8,200\", status: \"Pending\", date: \"Nov 15\" },\n    { id: \"#INV-1129\", client: \"Global Solutions Ltd.\", amount: \"$15,800\", status: \"Paid\", date: \"Nov 16\" },\n    { id: \"#INV-1130\", client: \"Digital Marketing Hub\", amount: \"$6,500\", status: \"Overdue\", date: \"Nov 5\" },\n  ];\n\n  return (\n    <div className=\"bg-white rounded-[24px] p-6 w-full h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Invoices</h3>\n        <button className=\"flex items-center gap-1 text-[#666666] text-[14px] font-['Manrope:SemiBold',sans-serif] hover:text-[#111111] transition-colors\">\n          <span>View All</span>\n          <svg className=\"size-[17px]\" fill=\"none\" viewBox=\"0 0 17 17\">\n            <path d={svgPaths.p3ac7a560} stroke=\"#666666\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n          </svg>\n        </button>\n      </div>\n\n      {/* Divider */}\n      <div className=\"h-px bg-[#EEEEEE] mb-3\" />\n\n      {/* Invoices List */}\n      <div className=\"flex flex-col gap-3 flex-1 overflow-y-auto\">\n        {invoices.map((invoice, index) => (\n          <InvoiceItem key={index} {...invoice} />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction InvoiceItem({ id, client, amount, status, date }: { id: string; client: string; amount: string; status: string; date: string }) {\n  const getStatusColor = () => {\n    switch (status) {\n      case 'Paid':\n        return 'bg-[#E8F5E9] text-[#2E7D32]';\n      case 'Pending':\n        return 'bg-[#FFF3E0] text-[#E65100]';\n      case 'Overdue':\n        return 'bg-[#FFEBEE] text-[#C62828]';\n      default:\n        return 'bg-[#F5F5F5] text-[#666666]';\n    }\n  };\n\n  return (\n    <div className=\"flex items-center gap-4 p-4 bg-[#F7F7F7] rounded-lg hover:bg-[#EEEEEE] transition-colors cursor-pointer\">\n      {/* Invoice Icon */}\n      <div className=\"flex-shrink-0 w-10 h-10 bg-white rounded-lg flex items-center justify-center\">\n        <svg className=\"size-5\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z\" stroke=\"#666666\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n          <path d=\"M14 2v6h6M16 13H8M16 17H8M10 9H8\" stroke=\"#666666\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n        </svg>\n      </div>\n\n      {/* Invoice Details */}\n      <div className=\"flex-1\">\n        <p className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-1\">{id}</p>\n        <p className=\"font-['Manrope:Regular',sans-serif] text-[12px] text-[#666666]\">{client}</p>\n      </div>\n\n      {/* Amount & Status */}\n      <div className=\"flex flex-col items-end gap-2\">\n        <p className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111]\">{amount}</p>\n        <span className={`text-[11px] font-['Manrope:Medium',sans-serif] px-2 py-1 rounded ${getStatusColor()}`}>\n          {status}\n        </span>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/LeavesWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TextArea' is assigned a value but never used.","line":12,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":128,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":128,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import svgPaths from \"../../constants/iconPaths\";\nimport { Plus } from 'lucide-react';\nimport { useState, useMemo } from 'react';\nimport { Modal, Input, Button, Select, Spin, Form, DatePicker } from 'antd';\nimport Image from \"next/image\";\nimport dayjs from \"dayjs\";\nimport type { Dayjs } from 'dayjs';\nimport { useCompanyLeaves, useApplyForLeave } from \"../../hooks/useLeave\";\nimport { LeaveType } from \"../../services/leave\";\n\nconst { Option } = Select;\nconst { TextArea } = Input;\n\n// Helper function to get initials from name\nconst getInitials = (name: string | null | undefined): string => {\n  if (!name) return \"?\";\n  const parts = name.trim().split(/\\s+/);\n  if (parts.length >= 2) {\n    return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();\n  }\n  return name.substring(0, 2).toUpperCase();\n};\n\n// Helper function to format date range\nconst formatDateRange = (startDate: string, endDate: string): string => {\n  const start = dayjs(startDate);\n  const end = dayjs(endDate);\n\n  if (start.isSame(end, \"day\")) {\n    return start.format(\"MMM D, YYYY\");\n  }\n\n  // Same month\n  if (start.month() === end.month() && start.year() === end.year()) {\n    return `${start.format(\"MMM D\")} - ${end.format(\"D, YYYY\")}`;\n  }\n\n  // Different months, same year\n  if (start.year() === end.year()) {\n    return `${start.format(\"MMM D\")} - ${end.format(\"MMM D, YYYY\")}`;\n  }\n\n  // Different years\n  return `${start.format(\"MMM D\")} - ${end.format(\"MMM D, YYYY\")}`;\n};\n\n// Helper function to format duration\nconst formatDuration = (days: number): string => {\n  if (days === 1) {\n    return \"1 Day\";\n  }\n  return `${days} Days`;\n};\n\ninterface ApplyLeaveFormValues {\n  start_date: Dayjs;\n  end_date: Dayjs;\n  day_type: string;\n  leave_type: string;\n  reason: string;\n}\n\nexport function LeavesWidget({ onNavigate }: { onNavigate?: (page: string) => void }) {\n  const [showDialog, setShowDialog] = useState(false);\n  const [form] = Form.useForm<ApplyLeaveFormValues>();\n  const { data, isLoading, error } = useCompanyLeaves();\n  const applyLeaveMutation = useApplyForLeave();\n\n  // Process and filter leaves\n  const processedLeaves = useMemo(() => {\n    if (!data?.result) return [];\n\n    const today = dayjs().startOf(\"day\");\n\n    // Filter to show only approved leaves that are upcoming or current\n    const filtered = data.result\n      .filter((leave: LeaveType) => {\n        const endDate = dayjs(leave.end_date).startOf(\"day\");\n        // Show only APPROVED leaves that haven't ended yet\n        const isApproved = leave.status.toUpperCase() === 'APPROVED';\n        return isApproved && (endDate.isAfter(today) || endDate.isSame(today, \"day\"));\n      })\n      .sort((a: LeaveType, b: LeaveType) => {\n        // Sort by start date, earliest first\n        return dayjs(a.start_date).valueOf() - dayjs(b.start_date).valueOf();\n      });\n\n    return filtered.map((leave: LeaveType) => {\n      // Calculate total duration: from start date (inclusive) to end date (inclusive)\n      const startDate = dayjs(leave.start_date).startOf(\"day\");\n      const endDate = dayjs(leave.end_date).startOf(\"day\");\n      \n      const totalDuration = Math.max(1, endDate.diff(startDate, \"day\") + 1);\n      \n      return {\n        id: leave.id,\n        name: leave.user?.name || \"Unknown Employee\",\n        dateRange: formatDateRange(leave.start_date, leave.end_date),\n        duration: formatDuration(totalDuration),\n        avatar: leave.user?.avatar || null,\n        initials: getInitials(leave.user?.name),\n      };\n    });\n  }, [data]);\n\n  // Get unique leave types for the form dropdown\n  const availableLeaveTypes = useMemo(() => {\n    if (!data?.result) return ['Sick Leave', 'Casual Leave', 'Vacation'];\n    const types = new Set(data.result.map((leave: LeaveType) => leave.leave_type));\n    return Array.from(types).filter(Boolean).length > 0\n      ? Array.from(types).filter(Boolean) as string[]\n      : ['Sick Leave', 'Casual Leave', 'Vacation'];\n  }, [data]);\n\n  const DAY_TYPES = ['Full Day', 'First Half', 'Second Half'];\n\n  const handleApplyLeave = async (values: ApplyLeaveFormValues) => {\n    try {\n      await applyLeaveMutation.mutateAsync({\n        start_date: values.start_date.format('YYYY-MM-DD'),\n        end_date: values.end_date.format('YYYY-MM-DD'),\n        day_type: values.day_type,\n        leave_type: values.leave_type,\n        reason: values.reason,\n      });\n      form.resetFields();\n      setShowDialog(false);\n    } catch (error) {\n      // Error handled by mutation\n    }\n  };\n\n  const handleCancel = () => {\n    form.resetFields();\n    setShowDialog(false);\n  };\n\n  return (\n    <>\n      <div className=\"bg-white rounded-[24px] p-5 w-full h-full flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-1.5\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Leaves</h3>\n            <button onClick={() => setShowDialog(true)} className=\"hover:scale-110 active:scale-95 transition-transform\">\n              <Plus className=\"size-5 text-[#FF4500]\" strokeWidth={2} />\n            </button>\n          </div>\n          <button className=\"flex items-center gap-1 text-[#666666] text-[14px] font-['Manrope:SemiBold',sans-serif] hover:text-[#111111] transition-colors\" onClick={() => onNavigate && onNavigate('leaves')}>\n            <span>View All</span>\n            <svg className=\"size-[17px]\" fill=\"none\" viewBox=\"0 0 17 17\">\n              <path d={svgPaths.p3ac7a560} stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* Leaves List */}\n        <div className=\"flex flex-col gap-2.5 flex-1 mt-2 overflow-y-auto scrollbar-hide\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <Spin size=\"small\" />\n            </div>\n          ) : error ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <p className=\"text-[14px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Unable to load leaves at the moment. Please try again later.\n              </p>\n            </div>\n          ) : processedLeaves.length === 0 ? (\n            <div className=\"bg-white rounded-[10px] border border-dashed border-[#CCCCCC] py-4 flex items-center justify-center\">\n              <p className=\"text-[14px] font-['Manrope:Regular',sans-serif] text-[#666666]\">No leaves to display at the moment</p>\n            </div>\n          ) : (\n            <>\n              {processedLeaves.map((leave) => (\n                <LeaveItem key={leave.id} {...leave} />\n              ))}\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Apply Leave Modal */}\n      <Modal\n        title=\"Apply Leave\"\n        open={showDialog}\n        onCancel={handleCancel}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        destroyOnHidden\n      >\n        <Form\n          form={form}\n          layout=\"vertical\"\n          onFinish={handleApplyLeave}\n          className=\"mt-6\"\n        >\n          <div className=\"grid grid-cols-2 gap-4\">\n            <Form.Item\n              name=\"start_date\"\n              label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Start Date</span>}\n              rules={[{ required: true, message: 'Please select start date' }]}\n            >\n              <DatePicker\n                className=\"w-full h-10 rounded-lg font-['Manrope:Medium',sans-serif]\"\n                placeholder=\"Select date\"\n                format=\"YYYY-MM-DD\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"end_date\"\n              label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">End Date</span>}\n              rules={[{ required: true, message: 'Please select end date' }]}\n            >\n              <DatePicker\n                className=\"w-full h-10 rounded-lg font-['Manrope:Medium',sans-serif]\"\n                placeholder=\"Select date\"\n                format=\"YYYY-MM-DD\"\n              />\n            </Form.Item>\n          </div>\n\n          <Form.Item\n            name=\"day_type\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Day Type</span>}\n            rules={[{ required: true, message: 'Please select day type' }]}\n          >\n            <Select\n              className=\"w-full h-10 rounded-lg font-['Manrope:Medium',sans-serif]\"\n              placeholder=\"Select day type\"\n            >\n              {DAY_TYPES.map((dayType) => (\n                <Option key={dayType} value={dayType}>\n                  {dayType}\n                </Option>\n              ))}\n            </Select>\n          </Form.Item>\n\n          <Form.Item\n            name=\"leave_type\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Leave Type</span>}\n            rules={[{ required: true, message: 'Please select leave type' }]}\n          >\n            <Select\n              className=\"w-full h-10 rounded-lg font-['Manrope:Medium',sans-serif]\"\n              placeholder=\"Select leave type\"\n            >\n              {availableLeaveTypes.map((leaveType) => (\n                <Option key={leaveType} value={leaveType}>\n                  {leaveType}\n                </Option>\n              ))}\n            </Select>\n          </Form.Item>\n\n          <Form.Item\n            name=\"reason\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Reason</span>}\n            rules={[{ required: true, message: 'Please enter reason' }]}\n          >\n            <Input\n              className=\"rounded-lg h-10 font-['Manrope:Medium',sans-serif]\"\n              placeholder=\"Type or select a reason\"\n            />\n          </Form.Item>\n\n          <div className=\"flex items-center justify-end gap-4 pt-4 mt-6 border-t border-[#EEEEEE]\">\n            <Button\n              type=\"text\"\n              onClick={handleCancel}\n              className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n            >\n              Cancel\n            </Button>\n            <Button\n              type=\"primary\"\n              htmlType=\"submit\"\n              loading={applyLeaveMutation.isPending}\n              className=\"h-[44px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\"\n            >\n              Save\n            </Button>\n          </div>\n        </Form>\n      </Modal>\n    </>\n  );\n}\n\nfunction LeaveItem({ name, dateRange, duration, avatar, initials }: { name: string; dateRange: string; duration: string; avatar: string | null; initials: string }) {\n  return (\n    <div className=\"group p-3 rounded-xl border border-[#EEEEEE] hover:border-[#ff3b3b]/20 transition-all duration-300 hover:shadow-lg cursor-pointer\">\n      <div className=\"flex items-center gap-2.5\">\n        {/* Avatar - Match meeting date badge size */}\n        <div className=\"flex-shrink-0\">\n          <div className=\"w-[48px] h-[48px] rounded-full overflow-hidden bg-[#F7F7F7] flex items-center justify-center\">\n            {avatar ? (\n              <Image src={avatar} alt={name} width={48} height={48} className=\"w-full h-full object-cover\" />\n            ) : (\n              <span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                {initials}\n              </span>\n            )}\n          </div>\n        </div>\n\n        {/* Leave Details + Duration */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center justify-between gap-2\">\n            {/* Name + Date stacked on the left */}\n            <div className=\"flex flex-col min-w-0\">\n              <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] line-clamp-1\">\n                {name}\n              </h4>\n              <span className=\"text-[#666666] text-[11px] font-['Manrope:Regular',sans-serif] mt-0.5\">\n                {dateRange}\n              </span>\n            </div>\n\n            {/* Duration Badge vertically centered on the right */}\n            <div className=\"flex-shrink-0 self-center\">\n              <span className=\"inline-block px-2.5 py-1 rounded-full bg-[#EEEEEE] text-[11px] font-['Manrope:Regular',sans-serif] text-[#333333]\">\n                {duration}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/MeetingsWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used.","line":4,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connecting' is assigned a value but never used.","line":28,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingTeamsStatus' is assigned a value but never used.","line":44,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":54,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connectToTeams' is assigned a value but never used.","line":57,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":64,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":173,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5843,5846],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5843,5846],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":227,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8303,8306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8303,8306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":270,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10596,10599],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10596,10599],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":535,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":535,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21761,21764],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21761,21764],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":553,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":553,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22382,22385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22382,22385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":565,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":565,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23015,23018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23015,23018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":614,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":614,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24680,24683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24680,24683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":693,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":693,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27673,27676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27673,27676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'duration' is defined but never used.","line":726,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":726,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'description' is defined but never used.","line":734,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":734,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stripHtml' is assigned a value but never used.","line":757,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":757,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'i' is defined but never used.","line":867,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":867,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import svgPaths from \"../../constants/iconPaths\";\nimport { Plus, Clock, Calendar as CalendarIcon, X, Video } from 'lucide-react';\nimport { useState, useMemo, useRef, useEffect, useCallback } from 'react';\nimport { Modal, Input, Button, Select, DatePicker, Spin, Tag, Popover, App } from 'antd';\nimport dayjs from 'dayjs';\nimport utc from 'dayjs/plugin/utc';\nimport timezone from 'dayjs/plugin/timezone';\nimport { useEmployees, useCurrentUserCompany } from '@/hooks/useUser';\nimport { useTeamsConnectionStatus, useCalendarEvents } from '../../hooks/useCalendar';\nimport { MicrosoftUserOAuth, GraphEvent, createCalendarEvent, CreateEventPayload } from '../../services/calendar';\nimport { useQueryClient } from '@tanstack/react-query';\n\ndayjs.extend(utc);\ndayjs.extend(timezone);\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\ninterface Attendee {\n  email: string;\n  name?: string;\n}\n\nexport function MeetingsWidget({ onNavigate }: { onNavigate?: (page: string) => void }) {\n  const { message } = App.useApp();\n  const queryClient = useQueryClient();\n  const [showDialog, setShowDialog] = useState(false);\n  const [connecting, setConnecting] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n\n  // Fetch employees for autocomplete (only when modal is open)\n  const { data: employeesData } = useEmployees(showDialog ? 'limit=100' : '');\n\n  const [formData, setFormData] = useState({\n    title: '',\n    startDateTime: null as dayjs.Dayjs | null,\n    duration: '',\n    customTime: '',\n    attendees: [] as Attendee[],\n    description: ''\n  });\n\n  // Fetch Teams connection status\n  const { data: teamsStatus, isLoading: isLoadingTeamsStatus, refetch: refetchTeamsStatus } = useTeamsConnectionStatus();\n  const isConnected = teamsStatus?.result?.connected ?? false;\n\n  // Get company timezone from backend, fallback to browser timezone\n  const { data: companyData } = useCurrentUserCompany();\n  const companyTimeZone = companyData?.result?.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone || \"UTC\";\n\n  // Fetch calendar events (meetings) from backend\n  const startISO = dayjs().startOf(\"day\").toISOString();\n  const endISO = dayjs().add(7, \"day\").endOf(\"day\").toISOString();\n  const { data: eventsData, isLoading, error, isError, refetch: refetchCalendarEvents } = useCalendarEvents(startISO, endISO);\n\n  // Connect to Teams\n  const connectToTeams = useCallback(async () => {\n    try {\n      setConnecting(true);\n      const response = await MicrosoftUserOAuth();\n      if (response?.result) {\n        window.location.href = response.result;\n      }\n    } catch (error) {\n      message.error(\"Failed to connect to Microsoft Teams\");\n    } finally {\n      setConnecting(false);\n    }\n  }, []);\n\n  // Check connection status on mount\n  useEffect(() => {\n    refetchTeamsStatus();\n  }, [refetchTeamsStatus]);\n\n  // Periodically refresh meetings to remove ended meetings in real-time\n  useEffect(() => {\n    if (!isConnected) return;\n\n    // Refresh every minute to check for ended meetings\n    const interval = setInterval(() => {\n      refetchCalendarEvents();\n    }, 60000); // 60 seconds\n\n    return () => clearInterval(interval);\n  }, [isConnected, refetchCalendarEvents]);\n\n  // Handle event form submission\n  const handleCreateEvent = useCallback(async () => {\n    // Validate required fields\n    if (!formData.title.trim()) {\n      message.error(\"Title is required\");\n      return;\n    }\n    if (!formData.startDateTime) {\n      message.error(\"Start Date & Time is required\");\n      return;\n    }\n    if (!formData.duration && !formData.customTime) {\n      message.error(\"Please select a duration or enter custom time\");\n      return;\n    }\n\n    try {\n      setSubmitting(true);\n\n      // Calculate end time\n      let endTime: dayjs.Dayjs;\n      if (formData.customTime) {\n        // Parse custom time (format: \"HH:mm\" or \"H:mm\")\n        const [hours, minutes] = formData.customTime.split(':').map(Number);\n        endTime = formData.startDateTime.hour(hours).minute(minutes || 0);\n      } else {\n        // Calculate from duration\n        const durationMap: Record<string, number> = {\n          '30 mins': 30,\n          '45 mins': 45,\n          '1 hour': 60,\n          '1.5 hours': 90,\n          '2 hours': 120,\n        };\n        const minutes = durationMap[formData.duration] || 60;\n        endTime = formData.startDateTime.add(minutes, 'minute');\n      }\n\n      // Format payload\n      const payload: CreateEventPayload = {\n        subject: formData.title.trim(),\n        start: {\n          dateTime: formData.startDateTime.toISOString(),\n          timeZone: companyTimeZone,\n        },\n        end: {\n          dateTime: endTime.toISOString(),\n          timeZone: companyTimeZone,\n        },\n        body: {\n          contentType: \"HTML\",\n          content: formData.description?.trim()\n            ? formData.description\n            : \"<p>Microsoft Teams meeting</p>\",\n        },\n        attendees: formData.attendees\n          .filter((attendee) => !!attendee.email)\n          .map((attendee) => ({\n            emailAddress: {\n              address: attendee.email,\n              name: attendee.name,\n            },\n            type: \"required\" as const,\n          })),\n        isOnlineMeeting: true,\n        onlineMeetingProvider: \"teamsForBusiness\",\n      };\n\n      await createCalendarEvent(payload);\n      message.success(\"Event created successfully!\");\n\n      // Reset form and close modal\n      setShowDialog(false);\n      setFormData({\n        title: '',\n        startDateTime: null,\n        duration: '',\n        customTime: '',\n        attendees: [],\n        description: ''\n      });\n\n      // Invalidate and refetch calendar events to show the new event\n      queryClient.invalidateQueries({ queryKey: [\"calendarEvents\"] });\n      await refetchCalendarEvents();\n    } catch (error: any) {\n      const errorMessage = error?.response?.data?.message || \"Failed to create event\";\n      message.error(errorMessage);\n    } finally {\n      setSubmitting(false);\n    }\n  }, [formData, companyTimeZone, refetchCalendarEvents, queryClient]);\n\n  // Transform and filter meetings\n  const processedMeetings = useMemo(() => {\n    if (!eventsData?.result) return [];\n\n    const now = dayjs().tz(companyTimeZone);\n\n    // Filter meetings that haven't ended yet (show until meeting end time)\n    // Parse event times properly - they come in ISO format and may be in UTC\n    const upcoming = (eventsData.result as GraphEvent[])\n      .filter((event: GraphEvent) => {\n        if (event.isCancelled) return false;\n\n        // Parse end time - event.end.dateTime is in ISO format\n        // Convert to company timezone for proper comparison\n        const endTime = dayjs.utc(event.end.dateTime).tz(companyTimeZone);\n\n        // Show meeting if current time is before the meeting end time\n        // This means meetings will be shown until they end (including in-progress meetings)\n        // Use 'minute' precision to avoid microsecond comparison issues\n        const shouldShow = now.isBefore(endTime, 'minute') || now.isSame(endTime, 'minute');\n\n        return shouldShow;\n      })\n      .sort((a: GraphEvent, b: GraphEvent) =>\n        dayjs.utc(a.start.dateTime).tz(companyTimeZone).valueOf() - dayjs.utc(b.start.dateTime).tz(companyTimeZone).valueOf()\n      )\n      .slice(0, 3) // Show only first 3 meetings (upcoming or in-progress)\n      .map((event: GraphEvent) => {\n        // Parse times with timezone awareness - convert to company timezone\n        const startTime = dayjs.utc(event.start.dateTime).tz(companyTimeZone);\n        const endTime = dayjs.utc(event.end.dateTime).tz(companyTimeZone);\n        const durationMinutes = endTime.diff(startTime, 'minute');\n\n        // Format duration\n        let duration = '';\n        if (durationMinutes < 60) {\n          duration = `${durationMinutes} mins`;\n        } else if (durationMinutes === 60) {\n          duration = '1 hour';\n        } else {\n          const hours = Math.floor(durationMinutes / 60);\n          const mins = durationMinutes % 60;\n          duration = mins > 0 ? `${hours}.${Math.round(mins / 60 * 10)} hours` : `${hours} hour${hours > 1 ? 's' : ''}`;\n        }\n\n        // Get attendees from event attendees\n        const attendees = (event.attendees || []).slice(0, 3).map((attendee: any) => ({\n          name: attendee?.emailAddress?.name || attendee?.emailAddress?.address?.split('@')[0] || 'Unknown',\n          avatar: '' // GraphEvent doesn't have avatar, use empty string\n        }));\n\n        // Determine status - use company timezone for now\n        const nowTz = dayjs().tz(companyTimeZone);\n        const isInProgress = nowTz.isAfter(startTime) && nowTz.isBefore(endTime);\n        const status = isInProgress ? 'in-progress' : 'upcoming';\n\n        // Get platform from onlineMeeting\n        // Priority: 1. onlineMeetingProvider, 2. Check joinUrl/onlineMeetingUrl for platform indicators\n        let platform = 'Teams'; // Default to Teams for Microsoft Graph API events\n        if (event.isOnlineMeeting) {\n          // Check onlineMeetingProvider first (most reliable)\n          if (event.onlineMeetingProvider === 'teamsForBusiness') {\n            platform = 'Teams';\n          } else {\n            // Check URLs for platform indicators\n            const joinUrl = event.onlineMeeting?.joinUrl || event.onlineMeetingUrl || '';\n            const urlLower = joinUrl.toLowerCase();\n\n            if (urlLower.includes('teams.microsoft.com') || urlLower.includes('teams.live.com') || urlLower.includes('/meetup-join/')) {\n              platform = 'Teams';\n            } else if (urlLower.includes('zoom.us') || urlLower.includes('zoom.com')) {\n              platform = 'Zoom';\n            } else if (urlLower.includes('meet.google.com') || urlLower.includes('google.com/meet')) {\n              platform = 'Meet';\n            } else if (event.onlineMeetingProvider) {\n              // If provider is set but not teamsForBusiness, default to Teams for Microsoft Graph\n              platform = 'Teams';\n            }\n            // If no indicators found and isOnlineMeeting is true, default to Teams (Microsoft Graph API)\n          }\n        }\n\n        // Get organizer\n        const organizer = event.organizer?.emailAddress?.name || event.organizer?.emailAddress?.address?.split('@')[0] || 'Unknown';\n\n        // Get join URL for the meeting\n        const joinUrl = event.onlineMeeting?.joinUrl || event.onlineMeetingUrl || event.webLink || null;\n\n        // Get full attendees list for details modal\n        const allAttendees = (event.attendees || []).map((attendee: any) => ({\n          name: attendee?.emailAddress?.name || attendee?.emailAddress?.address?.split('@')[0] || 'Unknown',\n          email: attendee?.emailAddress?.address || '',\n          avatar: ''\n        }));\n\n        return {\n          id: event.id,\n          title: event.subject || 'Untitled Meeting',\n          time: startTime.format('h:mm A'),\n          duration: duration,\n          date: {\n            month: startTime.format('MMM').toUpperCase(),\n            day: startTime.date()\n          },\n          attendees: attendees,\n          totalAttendees: event.attendees?.length || 0,\n          status: status,\n          platform: platform,\n          organizer: organizer,\n          joinUrl: joinUrl,\n          allAttendees: allAttendees,\n          description: event.body?.content || null,\n          startDateTime: startTime.toISOString(),\n          endDateTime: endTime.toISOString()\n        };\n      });\n\n    return upcoming;\n  }, [eventsData, companyTimeZone]);\n\n  return (\n    <>\n      <div className=\"bg-white rounded-[24px] p-5 w-full h-full flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-1.5\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Meetings</h3>\n            <button onClick={() => setShowDialog(true)} className=\"hover:scale-110 active:scale-95 transition-transform\">\n              <Plus className=\"size-5 text-[#ff3b3b]\" strokeWidth={2} />\n            </button>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button className=\"flex items-center gap-1 text-[#666666] text-[14px] font-['Manrope:SemiBold',sans-serif] hover:text-[#111111] transition-colors\" onClick={() => onNavigate && onNavigate('calendar')}>\n              <span>View All</span>\n              <svg className=\"size-[17px]\" fill=\"none\" viewBox=\"0 0 17 17\">\n                <path d={svgPaths.p3ac7a560} stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        {/* Meetings List */}\n        <div className=\"flex flex-col gap-2.5 flex-1 mt-2 overflow-hidden\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <Spin size=\"small\" />\n            </div>\n          ) : isError && !eventsData ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <p className=\"text-[14px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Unable to load meetings at the moment. Please connect to Teams.\n              </p>\n            </div>\n          ) : processedMeetings.length === 0 ? (\n            <div className=\"bg-white rounded-[10px] border border-dashed border-[#CCCCCC] py-4 flex items-center justify-center\">\n              <p className=\"text-[14px] font-['Manrope:Regular',sans-serif] text-[#888888]\">No upcoming meetings</p>\n            </div>\n          ) : (\n            <div className=\"flex flex-col gap-2.5\">\n              {processedMeetings.map((meeting) => (\n                <MeetingItem\n                  key={meeting.id}\n                  {...meeting}\n                  onJoin={(joinUrl) => {\n                    if (joinUrl) {\n                      window.open(joinUrl, '_blank');\n                    }\n                  }}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Create Event Modal */}\n      <Modal\n        title={null}\n        open={showDialog}\n        onCancel={() => {\n          setShowDialog(false);\n          setFormData({\n            title: '',\n            startDateTime: null,\n            duration: '',\n            customTime: '',\n            attendees: [],\n            description: ''\n          });\n        }}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        closeIcon={<X className=\"w-5 h-5 text-[#666666]\" />}\n        styles={{\n          body: { padding: 0 },\n        }}\n      >\n        <div className=\"flex flex-col h-full bg-white\">\n          {/* Fixed Header */}\n          <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-6\">\n            <div className=\"flex items-center gap-2 text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">\n              <div className=\"p-2 rounded-full bg-[#F7F7F7]\">\n                <CalendarIcon className=\"w-5 h-5 text-[#666666]\" />\n              </div>\n              Create Event\n            </div>\n            <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-11\">\n              Schedule a new meeting or event with your team.\n            </p>\n          </div>\n\n          {/* Scrollable Body */}\n          <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n            {/* Form Fields */}\n            <div className=\"space-y-5\">\n              {/* Title Field */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  <span className=\"text-[#ff3b3b]\">*</span> Title\n                </span>\n                <Input\n                  placeholder=\"Event title\"\n                  className={`h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.title ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                />\n              </div>\n\n              {/* Start Date & Time Field */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  <span className=\"text-[#ff3b3b]\">*</span> Start Date & Time\n                </span>\n                <DatePicker\n                  showTime\n                  format=\"YYYY-MM-DD HH:mm\"\n                  placeholder=\"Select start date & time\"\n                  className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.startDateTime ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                  value={formData.startDateTime}\n                  onChange={(date) => setFormData({ ...formData, startDateTime: date })}\n                  suffixIcon={<CalendarIcon className=\"w-4 h-4 text-[#666666]\" />}\n                />\n              </div>\n\n              {/* End Time Field */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  <span className=\"text-[#ff3b3b]\">*</span> End Time\n                </span>\n                <div className=\"flex items-center gap-3\">\n                  <Select\n                    placeholder=\"Select duration\"\n                    className={`flex-1 h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.duration ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                    value={formData.duration}\n                    onChange={(value) => setFormData({ ...formData, duration: value })}\n                  >\n                    <Option value=\"30 mins\">30 mins</Option>\n                    <Option value=\"45 mins\">45 mins</Option>\n                    <Option value=\"1 hour\">1 hour</Option>\n                    <Option value=\"1.5 hours\">1.5 hours</Option>\n                    <Option value=\"2 hours\">2 hours</Option>\n                  </Select>\n                  <Input\n                    placeholder=\"Custom time\"\n                    className={`flex-1 h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.customTime ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                    value={formData.customTime}\n                    onChange={(e) => setFormData({ ...formData, customTime: e.target.value })}\n                    suffix={<Clock className=\"w-4 h-4 text-[#666666]\" />}\n                  />\n                </div>\n              </div>\n\n              {/* Attendees Field */}\n              <AttendeesField\n                attendees={formData.attendees}\n                onAddAttendee={(attendee) => {\n                  if (!formData.attendees.some(a => a.email.toLowerCase() === attendee.email.toLowerCase())) {\n                    setFormData({\n                      ...formData,\n                      attendees: [...formData.attendees, attendee],\n                    });\n                  }\n                }}\n                onRemoveAttendee={(index) => {\n                  setFormData({\n                    ...formData,\n                    attendees: formData.attendees.filter((_, i) => i !== index),\n                  });\n                }}\n                employeesData={employeesData}\n              />\n\n              {/* Description Field */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  Description\n                </span>\n                <TextArea\n                  placeholder=\"Agenda, notes, etc.\"\n                  className={`min-h-[120px] rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] resize-none ${formData.description ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                  rows={4}\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                />\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex items-center justify-end gap-4 pt-6\">\n                <Button\n                  type=\"text\"\n                  onClick={() => {\n                    setShowDialog(false);\n                    setFormData({\n                      title: '',\n                      startDateTime: null,\n                      duration: '',\n                      customTime: '',\n                      attendees: [],\n                      description: ''\n                    });\n                  }}\n                  className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"primary\"\n                  onClick={handleCreateEvent}\n                  loading={submitting}\n                  className=\"h-[44px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\"\n                >\n                  Create\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </>\n  );\n}\n\n// Attendees Field Component with Autocomplete\nfunction AttendeesField({\n  attendees,\n  onAddAttendee,\n  onRemoveAttendee,\n  employeesData\n}: {\n  attendees: Attendee[];\n  onAddAttendee: (attendee: Attendee) => void;\n  onRemoveAttendee: (index: number) => void;\n  employeesData: any;\n}) {\n  const [inputValue, setInputValue] = useState('');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const suggestionsRef = useRef<HTMLDivElement>(null);\n\n  // Get employees list\n  const employees = useMemo(() => {\n    return employeesData?.result || [];\n  }, [employeesData]);\n\n  // Filter suggestions based on input\n  const suggestions = useMemo(() => {\n    if (!inputValue.trim()) return [];\n\n    const query = inputValue.toLowerCase();\n    const filtered = employees.filter((emp: any) => {\n      const email = (emp.email || '').toLowerCase();\n      const name = (emp.name || '').toLowerCase();\n      // Check if already selected\n      const isSelected = attendees.some(a => a.email.toLowerCase() === email);\n      return !isSelected && (email.includes(query) || name.includes(query));\n    });\n\n    // Also check if input is a valid email format and not already in attendees\n    const isEmailFormat = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(inputValue);\n    const isAlreadyAdded = attendees.some(a => a.email.toLowerCase() === inputValue.toLowerCase());\n\n    if (isEmailFormat && !isAlreadyAdded && !filtered.some((emp: any) => emp.email?.toLowerCase() === inputValue.toLowerCase())) {\n      // Add custom email as first suggestion\n      return [{ email: inputValue, name: inputValue }, ...filtered];\n    }\n\n    return filtered.slice(0, 5); // Limit to 5 suggestions\n  }, [inputValue, employees, attendees]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setInputValue(value);\n    setShowSuggestions(value.trim().length > 0);\n    setSelectedIndex(-1);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      if (selectedIndex >= 0 && selectedIndex < suggestions.length) {\n        // Select from suggestions\n        const selected = suggestions[selectedIndex];\n        onAddAttendee({\n          email: selected.email || inputValue,\n          name: selected.name\n        });\n      } else if (inputValue.trim() && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(inputValue.trim())) {\n        // Add custom email\n        onAddAttendee({\n          email: inputValue.trim(),\n          name: inputValue.trim()\n        });\n      }\n      setInputValue('');\n      setShowSuggestions(false);\n      setSelectedIndex(-1);\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault();\n      setSelectedIndex(prev =>\n        prev < suggestions.length - 1 ? prev + 1 : prev\n      );\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault();\n      setSelectedIndex(prev => prev > 0 ? prev - 1 : -1);\n    } else if (e.key === 'Escape') {\n      setShowSuggestions(false);\n      setSelectedIndex(-1);\n    }\n  };\n\n  const handleSelectSuggestion = (suggestion: any) => {\n    onAddAttendee({\n      email: suggestion.email || inputValue,\n      name: suggestion.name\n    });\n    setInputValue('');\n    setShowSuggestions(false);\n    setSelectedIndex(-1);\n    inputRef.current?.focus();\n  };\n\n  // Close suggestions when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        suggestionsRef.current &&\n        !suggestionsRef.current.contains(event.target as Node) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target as Node)\n      ) {\n        setShowSuggestions(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  return (\n    <div className=\"relative space-y-2\">\n      <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n        Attendees\n      </span>\n\n      {/* Attendee Chips (Gmail style) */}\n      {attendees.length > 0 && (\n        <div className=\"flex flex-wrap gap-2 mb-2 min-h-[32px] p-2 border border-[#EEEEEE] rounded-lg bg-[#F9FAFB]\">\n          {attendees.map((attendee, idx) => (\n            <span\n              key={idx}\n              className=\"inline-flex items-center gap-1.5 px-2.5 py-1 bg-white border border-[#EEEEEE] rounded-full text-[13px] text-[#111111] font-['Manrope:Medium',sans-serif] hover:border-[#ff3b3b]/30 transition-colors\"\n            >\n              <span>{attendee.name || attendee.email}</span>\n              <button\n                onClick={() => onRemoveAttendee(idx)}\n                className=\"ml-0.5 hover:bg-[#FEE2E2] rounded-full p-0.5 transition-colors\"\n                type=\"button\"\n              >\n                <X className=\"w-3.5 h-3.5 text-[#666666] hover:text-[#ff3b3b]\" />\n              </button>\n            </span>\n          ))}\n        </div>\n      )}\n\n      {/* Input Field */}\n      <div className=\"relative\">\n        <Input\n          placeholder=\"Type email address and press Enter\"\n          className={`h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${inputValue ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n          value={inputValue}\n          onChange={handleInputChange}\n          onKeyDown={handleKeyDown}\n          onFocus={() => {\n            if (inputValue.trim()) setShowSuggestions(true);\n          }}\n          suffix={\n            <svg className=\"w-4 h-4 text-[#666666]\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n            </svg>\n          }\n        />\n\n        {/* Suggestions Dropdown */}\n        {showSuggestions && suggestions.length > 0 && (\n          <div\n            ref={suggestionsRef}\n            className=\"absolute z-50 w-full mt-1 bg-white border border-[#EEEEEE] rounded-lg shadow-lg max-h-[200px] overflow-y-auto\"\n          >\n            {suggestions.map((suggestion: any, idx: number) => (\n              <div\n                key={idx}\n                onClick={() => handleSelectSuggestion(suggestion)}\n                className={`px-4 py-2.5 cursor-pointer transition-colors ${idx === selectedIndex\n                  ? 'bg-[#F7F7F7]'\n                  : 'hover:bg-[#FAFAFA]'\n                  }`}\n              >\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"flex-1\">\n                    <div className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                      {suggestion.name || suggestion.email}\n                    </div>\n                    {suggestion.name && suggestion.email && (\n                      <div className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                        {suggestion.email}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction MeetingItem({\n  title,\n  time,\n  duration,\n  date,\n  attendees,\n  totalAttendees,\n  platform,\n  organizer,\n  joinUrl,\n  allAttendees = [],\n  description,\n  startDateTime,\n  endDateTime,\n  onJoin\n}: {\n  title: string;\n  time: string;\n  duration: string;\n  date: { month: string; day: number };\n  attendees: { name: string; avatar: string | null }[];\n  totalAttendees: number;\n  platform: string;\n  organizer: string;\n  joinUrl?: string | null;\n  allAttendees?: Array<{ name: string; email: string; avatar: string }>;\n  description?: string | null;\n  startDateTime?: string;\n  endDateTime?: string;\n  onJoin?: (joinUrl: string) => void;\n}) {\n  const [showDetails, setShowDetails] = useState(false);\n\n  // Strip HTML tags from description\n  const stripHtml = (html: string | null): string => {\n    if (!html) return '';\n    if (typeof document === 'undefined') {\n      // SSR fallback - simple regex strip\n      return html.replace(/<[^>]*>/g, '').replace(/\\s+/g, ' ').trim();\n    }\n    const tmp = document.createElement('div');\n    tmp.innerHTML = html;\n    return tmp.textContent || tmp.innerText || '';\n  };\n\n  const handleJoinClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (joinUrl && onJoin) {\n      onJoin(joinUrl);\n    }\n  };\n\n  const handleCardClick = () => {\n    setShowDetails(true);\n  };\n  // Get initials from name\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map((n) => n[0])\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  // Truncate organizer name to 12 characters (to fit before attendees section)\n  const truncateOrganizer = (name: string, maxLength: number = 20) => {\n    if (name.length <= maxLength) return name;\n    return name.slice(0, maxLength) + '...';\n  };\n\n  // Truncate meeting title to 27 characters (to align with red line position)\n  const truncateTitle = (title: string, maxLength: number = 36) => {\n    if (title.length <= maxLength) return title;\n    return title.slice(0, maxLength) + '...';\n  };\n\n  // Platform colors\n  const getPlatformColor = (platform: string) => {\n    switch (platform.toLowerCase()) {\n      case 'teams':\n        return { bg: '#E3F2FD', text: '#1565C0' };\n      case 'zoom':\n        return { bg: '#E8F5E9', text: '#2E7D32' };\n      case 'meet':\n        return { bg: '#FFF3E0', text: '#E65100' };\n      default:\n        return { bg: '#F7F7F7', text: '#666666' };\n    }\n  };\n\n  const platformColor = getPlatformColor(platform);\n  const today = dayjs();\n  // Check if the meeting date matches today\n  const isToday = today.date() === date.day && today.format('MMM').toUpperCase() === date.month;\n  const isRedDate = isToday; // Red for today's date, grey for future\n\n  return (\n    <>\n      <Popover\n        open={showDetails}\n        onOpenChange={setShowDetails}\n        trigger=\"click\"\n        placement=\"right\"\n        overlayInnerStyle={{ padding: 0 }}\n        content={\n          <div className=\"w-[300px] bg-white rounded-[12px] shadow-lg border border-[#EEEEEE] overflow-hidden\">\n            {/* Header */}\n            <div className=\"px-4 py-3 bg-[#FAFAFA] border-b border-[#EEEEEE]\">\n              <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-1.5 line-clamp-2 leading-tight\">\n                {title}\n              </h4>\n              <div className=\"flex items-center gap-1.5 text-[#666666] text-[11px] font-['Manrope:Regular',sans-serif]\">\n                <Clock className=\"size-3\" strokeWidth={2} />\n                <span>{time}</span>\n                <span className=\"text-[#CCCCCC]\">•</span>\n                {/* <span>{duration}</span> */}\n              </div>\n            </div>\n\n            {/* Content - Compact & Clean */}\n            <div className=\"px-4 py-3 space-y-2.5 bg-white\">\n              {/* Host */}\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] uppercase tracking-wide min-w-[45px]\">Host</span>\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#111111]\">{organizer}</span>\n              </div>\n\n              {/* Date & Time */}\n              {startDateTime && endDateTime && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] uppercase tracking-wide min-w-[45px]\">When</span>\n                  <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#111111]\">\n                    {dayjs(startDateTime).format('MMM D, YYYY')} • {time} - {dayjs(endDateTime).format('h:mm A')}\n                  </span>\n                </div>\n              )}\n\n              {/* Attendees - Compact */}\n              {allAttendees && allAttendees.length > 0 && (\n                <div className=\"flex items-start gap-2\">\n                  <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] uppercase tracking-wide min-w-[45px] pt-0.5\">With</span>\n                  <div className=\"flex-1\">\n                    <div className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#111111] leading-relaxed\">\n                      {allAttendees.slice(0, 3).map((a, i) => a.name).join(', ')}\n                      {allAttendees.length > 3 && (\n                        <span className=\"text-[#999999]\"> +{allAttendees.length - 3} more</span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Join Button */}\n            {joinUrl && (\n              <div className=\"px-4 py-3 bg-[#FAFAFA] border-t border-[#EEEEEE]\">\n                <Button\n                  type=\"primary\"\n                  onClick={() => {\n                    if (joinUrl && onJoin) {\n                      onJoin(joinUrl);\n                    }\n                    setShowDetails(false);\n                  }}\n                  className=\"w-full h-9 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[13px] font-['Manrope:SemiBold',sans-serif] transition-all active:scale-95 border-none flex items-center justify-center gap-2 shadow-sm\"\n                  icon={<Video className=\"w-3.5 h-3.5\" />}\n                >\n                  Join {platform} Meeting\n                </Button>\n              </div>\n            )}\n          </div>\n        }\n      >\n        <div\n          className=\"group p-3 rounded-xl border border-[#EEEEEE] hover:border-[#ff3b3b]/20 transition-all duration-300 hover:shadow-lg cursor-pointer\"\n          onClick={handleCardClick}\n        >\n          <div className=\"flex items-start gap-2.5\">\n            {/* Date Badge - Rounded Square */}\n            <div className=\"flex-shrink-0\">\n              <div className={`w-[48px] h-[48px] rounded-[12px] flex flex-col items-center justify-center ${isRedDate\n                ? 'bg-[#ff3b3b]'\n                : 'bg-[#E5E5E5]'\n                }`}>\n                <span className={`text-[10px] font-['Manrope:Medium',sans-serif] uppercase leading-none mb-0.5 ${isRedDate ? 'text-white' : 'text-[#666666]'\n                  }`}>\n                  {date.month}\n                </span>\n                <span className={`text-[20px] font-['Manrope:Bold',sans-serif] leading-none ${isRedDate ? 'text-white' : 'text-[#111111]'\n                  }`}>\n                  {date.day}\n                </span>\n              </div>\n            </div>\n\n            {/* Meeting Info */}\n            <div className=\"flex-1 min-w-0\">\n              {/* Title & Platform Tag */}\n              <div className=\"flex items-start justify-between gap-2 mb-1\">\n                <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] line-clamp-1 flex-1\">\n                  {truncateTitle(title)}\n                </h4>\n                {joinUrl ? (\n                  <button\n                    onClick={handleJoinClick}\n                    className=\"px-1.5 py-0.5 rounded-full text-[9px] font-['Manrope:Medium',sans-serif] flex-shrink-0 flex items-center gap-0.5 hover:opacity-80 transition-opacity cursor-pointer\"\n                    style={{ backgroundColor: platformColor.bg, color: platformColor.text }}\n                    title={`Join ${platform} meeting`}\n                  >\n                    <svg className=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path d=\"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z\" />\n                    </svg>\n                    {platform}\n                  </button>\n                ) : (\n                  <span\n                    className=\"px-1.5 py-0.5 rounded-full text-[9px] font-['Manrope:Medium',sans-serif] flex-shrink-0 flex items-center gap-0.5\"\n                    style={{ backgroundColor: platformColor.bg, color: platformColor.text }}\n                  >\n                    <svg className=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path d=\"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z\" />\n                    </svg>\n                    {platform}\n                  </span>\n                )}\n              </div>\n\n              {/* Time, Duration, Host & Attendees - All in one line */}\n              <div className=\"flex items-center justify-between gap-2\">\n                <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-1 text-[#666666] text-[11px] font-['Manrope:Regular',sans-serif]\">\n                    <Clock className=\"size-3.5\" strokeWidth={2} />\n                    <span>{time}</span>\n                  </div>\n                  <div className=\"w-1 h-1 rounded-full bg-[#CCCCCC]\" />\n                  <span className=\"text-[#666666] text-[11px] font-['Manrope:Regular',sans-serif]\">Host: {truncateOrganizer(organizer)}</span>\n                </div>\n\n                {/* Attendees - Aligned to the right on same line */}\n                <div className=\"flex items-center -space-x-2 flex-shrink-0\">\n                  {attendees.slice(0, 3).map((attendee, index) => {\n                    const initials = getInitials(attendee.name);\n                    return (\n                      <div\n                        key={index}\n                        className=\"w-6 h-6 rounded-full border-2 border-white bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center shadow-sm relative z-[5] hover:z-10 transition-all\"\n                      >\n                        <span className=\"text-[9px] text-white font-['Manrope:Bold',sans-serif]\">{initials}</span>\n                      </div>\n                    );\n                  })}\n                  {totalAttendees > attendees.length && (\n                    <div className={`w-6 h-6 rounded-full border-2 border-white flex items-center justify-center shadow-sm relative z-[1] ${isRedDate ? 'bg-[#ff3b3b]' : 'bg-[#E5E5E5]'\n                      }`}>\n                      <span className={`text-[9px] font-['Manrope:SemiBold',sans-serif] ${isRedDate ? 'text-white' : 'text-[#666666]'\n                        }`}>\n                        +{totalAttendees - attendees.length}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Popover>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/NotesWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onNavigate' is defined but never used.","line":12,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2041,2044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2041,2044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":206,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":206,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9511,9514],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9511,9514],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":240,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":240,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9967,9970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9967,9970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":243,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10236,10239],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10236,10239],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":245,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10367,10370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10367,10370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { sanitizeRichText } from \"@/utils/sanitizeHtml\";\nimport { Plus, Archive, Trash2 } from 'lucide-react';\nimport { Checkbox, App } from 'antd';\nimport { getNotes, createNote, deleteNote, archiveNote, Note, NoteType, ChecklistItem } from \"@/services/notes\";\nimport Link from \"next/link\";\nimport svgPaths from \"../../constants/iconPaths\";\nimport { NoteComposerModal } from \"../common/NoteComposerModal\";\nimport { NoteViewModal } from \"../common/NoteViewModal\";\n\nexport function NotesWidget({ onNavigate }: { onNavigate?: (page: string) => void }) {\n    const queryClient = useQueryClient();\n    const { message: messageApi, modal } = App.useApp();\n    const [showDialog, setShowDialog] = useState(false);\n    const [viewingNote, setViewingNote] = useState<Note | null>(null);\n    const [showViewModal, setShowViewModal] = useState(false);\n\n    const { data, isLoading } = useQuery({\n        queryKey: ['notes', 'dashboard'],\n        queryFn: () => getNotes(0, 4, false), // Fetch 4 for the grid, exclude archived\n    });\n\n    const notesList: Note[] = data?.result && Array.isArray(data.result) ? data.result : [];\n\n    const createMutation = useMutation({\n        mutationFn: createNote,\n        onSuccess: () => {\n            messageApi.success(\"Note created\");\n            setShowDialog(false);\n            queryClient.invalidateQueries({ queryKey: ['notes'] });\n        },\n        onError: () => messageApi.error(\"Failed to create note\")\n    });\n\n    const handleSaveNote = async (noteData: {\n        title: string;\n        type: NoteType;\n        content?: string;\n        items?: ChecklistItem[];\n        color: string;\n    }) => {\n        await createMutation.mutateAsync({\n            title: noteData.title,\n            type: noteData.type, // NoteType is already 'TEXT_NOTE' | 'CHECKLIST_NOTE'\n            content: noteData.content,\n            items: noteData.items,\n            color: noteData.color,\n        } as any); // Type assertion needed as backend might expect different format\n    };\n\n    const deleteMutation = useMutation({\n        mutationFn: deleteNote,\n        onSuccess: () => {\n            messageApi.success(\"Note permanently deleted\");\n            setShowViewModal(false);\n            setViewingNote(null);\n            queryClient.invalidateQueries({ queryKey: ['notes'] });\n        },\n        onError: () => messageApi.error(\"Failed to delete note\")\n    });\n\n    const archiveMutation = useMutation({\n        mutationFn: archiveNote,\n        onSuccess: () => {\n            messageApi.success(\"Note archived\");\n            setShowViewModal(false);\n            setViewingNote(null);\n            queryClient.invalidateQueries({ queryKey: ['notes'] });\n        },\n        onError: () => messageApi.error(\"Failed to archive note\")\n    });\n\n    const handleArchive = (id: number) => {\n        archiveMutation.mutate(id);\n    };\n\n    const handleDelete = (id: number) => {\n        modal.confirm({\n            title: 'Delete Note',\n            content: 'Are you sure you want to permanently delete this note? This action cannot be undone.',\n            okText: 'Delete',\n            okType: 'danger',\n            cancelText: 'Cancel',\n            onOk: () => deleteMutation.mutate(id)\n        });\n    };\n\n\n    let notesContent;\n    if (isLoading) {\n        notesContent = (\n            <div className=\"col-span-4 flex items-center justify-center h-full\">\n                <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-[#ff3b3b]\"></div>\n            </div>\n        );\n    } else if (notesList.length === 0) {\n        notesContent = (\n            <div className=\"col-span-4 flex flex-col items-center justify-center h-full text-center text-[#999999] text-[13px]\">\n                <p>No notes yet</p>\n                <button\n                    onClick={() => setShowDialog(true)}\n                    className=\"text-[#ff3b3b] hover:underline mt-1\"\n                >\n                    Create one\n                </button>\n            </div>\n        );\n    } else {\n        notesContent = notesList.map((note: Note) => (\n            <NoteCard\n                key={note.id}\n                note={note}\n                onArchive={(id) => archiveMutation.mutate(id)}\n                onDelete={(id) => {\n                    modal.confirm({\n                        title: 'Delete Note',\n                        content: 'Are you sure you want to permanently delete this note? This action cannot be undone.',\n                        okText: 'Delete',\n                        okType: 'danger',\n                        cancelText: 'Cancel',\n                        onOk: () => deleteMutation.mutate(id)\n                    });\n                }}\n                onClick={(note) => {\n                    setViewingNote(note);\n                    setShowViewModal(true);\n                }}\n            />\n        ));\n    }\n\n    return (\n        <>\n            <div className=\"bg-white rounded-[24px] p-5 w-full h-full flex flex-col border border-[#EEEEEE]\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between mb-1.5 h-[32px]\">\n                    <div className=\"flex items-center gap-2\">\n                        <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Notes</h3>\n                        <button\n                            onClick={() => setShowDialog(true)}\n                            className=\"hover:scale-110 active:scale-95 transition-transform flex items-center justify-center p-0.5\"\n                        >\n                            <Plus className=\"size-5 text-[#ff3b3b]\" strokeWidth={2} />\n                        </button>\n                    </div>\n                    <Link\n                        href=\"/dashboard/notes\"\n                        className=\"flex items-center gap-1 text-[#666666] hover:text-[#ff3b3b] text-[14px] font-['Manrope:SemiBold',sans-serif] transition-colors no-underline [&>span]:text-current [&>svg]:text-current\"\n                        style={{ color: '#666666' }}\n                    >\n                        <span>View All</span>\n                        <svg className=\"size-[17px]\" fill=\"none\" viewBox=\"0 0 17 17\">\n                            <path d={svgPaths.p3ac7a560} stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n                        </svg>\n                    </Link>\n                </div>\n\n                {/* Notes Grid - 4 columns */}\n                <div className=\"grid grid-cols-4 gap-3 flex-1 mt-2 overflow-y-auto pr-1\">\n                    {notesContent}\n                </div>\n            </div>\n\n            {/* Note Composer Modal */}\n            <NoteComposerModal\n                open={showDialog}\n                onClose={() => setShowDialog(false)}\n                onSave={handleSaveNote}\n                initialNote={null}\n            />\n\n            {/* Note View Modal - Google Keep style editable */}\n            <NoteViewModal\n                open={showViewModal}\n                note={viewingNote}\n                onClose={() => {\n                    setShowViewModal(false);\n                    setViewingNote(null);\n                }}\n                onArchive={handleArchive}\n                onDelete={handleDelete}\n            />\n        </>\n    );\n}\n\nfunction NoteCard({ note, onArchive, onDelete, onClick }: {\n    note: Note;\n    onArchive: (id: number) => void;\n    onDelete: (id: number) => void;\n    onClick?: (note: Note) => void;\n}) {\n\n    const titleId = `note-title-${note.id}`;\n\n    const noteColor = note.color || '#ff3b3b';\n    const borderColorNormal = '#EEEEEE';\n    const borderColorHover = noteColor;\n\n    return (\n        <div className=\"relative group aspect-square\">\n            {/* Main Note Button */}\n            <button\n                aria-labelledby={titleId}\n                onClick={(e) => {\n                    // We don't need to check for action buttons here anymore as they are outside\n                    onClick?.(note);\n                }}\n                className=\"relative h-full w-full bg-white rounded-xl border transition-all duration-300 cursor-pointer p-4 flex flex-col hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-[#ff3b3b] focus:ring-opacity-50 text-left\"\n                style={{\n                    borderColor: borderColorNormal,\n                    borderWidth: '1px'\n                }}\n                onMouseEnter={(e) => {\n                    e.currentTarget.style.borderColor = borderColorHover;\n                }}\n                onMouseLeave={(e) => {\n                    e.currentTarget.style.borderColor = borderColorNormal;\n                }}\n            >\n                <div className=\"flex items-start justify-between mb-2 gap-2 flex-shrink-0 w-full pointer-events-none\">\n                    <h4 \n                        id={titleId}\n                        className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] flex-1 line-clamp-2\"\n                    >\n                        {note.title}\n                    </h4>\n                    {/* Spacer to preserve layout where action buttons used to be */}\n                    <div className=\"w-[56px] flex-shrink-0 h-6\"></div>\n                </div>\n\n                <div className=\"flex-1 overflow-hidden min-h-0 w-full pointer-events-none\">\n                    {(note.type === 'TEXT_NOTE' || (note.type as any) === 'text') && note.content && (\n                        <div\n                            className=\"font-['Inter:Regular',sans-serif] text-[12px] text-[#666666] line-clamp-4 leading-normal prose prose-sm max-w-none [&>p]:m-0 h-full\"\n                            dangerouslySetInnerHTML={{ __html: sanitizeRichText(note.content) }}\n                        />\n                    )}\n                    {(note.type === 'CHECKLIST_NOTE' || (note.type as any) === 'checklist') && note.items && Array.isArray(note.items) && note.items.length > 0 && (\n                        <div className=\"flex flex-col gap-1.5 h-full overflow-hidden\">\n                            {note.items\n                                .filter((item: any) => !item.isChecked && !item.checked)\n                                .slice(0, 3)\n                                .map((item: any, index: number) => (\n                                    <div key={item.id || index} className=\"flex items-start gap-2 flex-shrink-0\">\n                                        <Checkbox\n                                            checked={false}\n                                            disabled\n                                            className=\"mt-0.5 custom-checkbox-wrapper\"\n                                        />\n                                        <span className=\"font-['Inter:Regular',sans-serif] text-[12px] text-[#666666] line-clamp-1\">\n                                            {item.text || item}\n                                        </span>\n                                    </div>\n                                ))}\n                        </div>\n                    )}\n                </div>\n            </button>\n\n            {/* Action icons - Floating absolutely over the button in top right */}\n            <div className=\"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1 z-10\">\n                <button\n                    className=\"p-1.5 hover:bg-[#F7F7F7] rounded-md transition-colors bg-white/80 backdrop-blur-sm\"\n                    onClick={(e) => {\n                        e.stopPropagation();\n                        onArchive(note.id);\n                    }}\n                    title=\"Archive\"\n                >\n                    <Archive className=\"size-3.5 text-[#666666]\" strokeWidth={2} />\n                </button>\n                <button\n                    className=\"p-1.5 hover:bg-[#F7F7F7] rounded-md transition-colors bg-white/80 backdrop-blur-sm\"\n                    onClick={(e) => {\n                        e.stopPropagation();\n                        onDelete(note.id);\n                    }}\n                    title=\"Delete\"\n                >\n                    <Trash2 className=\"size-3.5 text-[#ff3b3b]\" strokeWidth={2} />\n                </button>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/ProductivityWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowCounterclockwise24Filled' is defined but never used.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock24Filled' is defined but never used.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flash24Filled' is defined but never used.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Document24Filled' is defined but never used.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTasks' is defined but never used.","line":23,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'contextStartTimer' is assigned a value but never used.","line":65,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":52},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'contextStopTimer' is assigned a value but never used.","line":65,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":81},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isFocused' is assigned a value but never used.","line":71,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isAnimating' is assigned a value but never used.","line":76,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sessionStartTime' is assigned a value but never used.","line":80,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":80,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6978,6981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6978,6981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7556,7559],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7556,7559],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":207,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":207,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8320,8323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8320,8323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":212,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":212,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8628,8631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8628,8631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9322,9325],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9322,9325],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":290,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":290,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'savedPausedTime' is assigned a value but never used.","line":311,"column":124,"nodeType":null,"messageId":"unusedVar","endLine":311,"endColumn":139},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'savedResumeTime' is assigned a value but never used.","line":311,"column":153,"nodeType":null,"messageId":"unusedVar","endLine":311,"endColumn":168},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":334,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":334,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":394,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":394,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":463,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":463,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":463,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":463,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17995,17998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17995,17998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":524,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":524,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":524,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":524,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20241,20244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20241,20244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":577,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":577,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":675,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":675,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":675,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":675,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25545,25548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25545,25548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":749,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":749,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":749,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":749,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28390,28393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28390,28393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":887,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":887,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":30,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from \"react\";\nimport { useTimer } from \"@/context/TimerContext\";\nimport {\n  Play24Filled,\n  Pause24Filled,\n  ArrowCounterclockwise24Filled,\n  Sparkle24Filled,\n  Send24Filled,\n  Clock24Filled,\n  Flash24Filled,\n  CheckmarkCircle24Filled,\n  Dismiss24Filled,\n  ChevronDown24Filled,\n  Mic24Filled,\n  Document24Filled,\n  Person24Filled\n} from \"@fluentui/react-icons\";\nimport ReactMarkdown, { Components } from \"react-markdown\";\nimport remarkGfm from \"remark-gfm\";\nimport { generateAgentResponse } from \"@/services/assistant\";\nimport { Tooltip, App } from \"antd\";\nimport { useUserDetails } from \"@/hooks/useUser\";\nimport { useTasks, useUpdateTaskStatus } from \"@/hooks/useTask\";\nimport { useWorkspaces } from \"@/hooks/useWorkspace\";\nimport { useMemo } from \"react\";\nimport { getAssignedTasks, startWorkLog, updateWorklog, getAssignedTaskDetail, type AssignedTaskDetailType } from \"@/services/task\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { WorklogModal } from \"../modals/WorklogModal\";\nimport { Modal } from \"antd\";\n\ninterface Message {\n  id: number;\n  type: 'user' | 'ai';\n  content: string;\n  timestamp: Date;\n  actions?: string[];\n  responseType?: string;\n}\n\n// Helper function to format seconds as HH:MM:SS\nfunction formatDuration(seconds: number): string {\n  const hrs = Math.floor(seconds / 3600);\n  const mins = Math.floor((seconds % 3600) / 60);\n  const secs = seconds % 60;\n  return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n}\n\n// Helper function to parse date string as UTC\n// Backend stores dates in UTC but may return without 'Z' suffix\n// JavaScript's new Date() interprets dates without 'Z' as local time, causing timezone offset issues\nfunction parseAsUTC(dateString: string): Date {\n  if (!dateString) return new Date();\n  // If already has timezone info (Z or +/-offset), parse directly\n  if (dateString.endsWith('Z') || /[+-]\\d{2}:\\d{2}$/.test(dateString)) {\n    return new Date(dateString);\n  }\n  // Otherwise, append 'Z' to treat as UTC\n  return new Date(dateString + 'Z');\n}\n\nexport function ProductivityWidget() {\n  const { message: antdMessage } = App.useApp();\n\n  // USE SHARED TIMER CONTEXT\n  const { timerState, startTimer: contextStartTimer, stopTimer: contextStopTimer, isLoading: timerLoading } = useTimer();\n\n  const [isRunning, setIsRunning] = useState(false);\n  const [time, setTime] = useState(0); // Current session elapsed seconds (for display)\n  const pausedElapsedRef = useRef<number>(0); // Elapsed time when paused (for resume calculation)\n  const [message, setMessage] = useState(\"\");\n  const [isFocused, setIsFocused] = useState(false);\n  const [conversations, setConversations] = useState<Message[]>([]);\n  const [showTaskSelector, setShowTaskSelector] = useState(false);\n  const [selectedTask, setSelectedTask] = useState(\"\");\n  const [showChatPopup, setShowChatPopup] = useState(false);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [showWorklogModal, setShowWorklogModal] = useState(false);\n  const [worklogAction, setWorklogAction] = useState<'stuck' | 'complete' | 'pause' | null>(null);\n  const [startTime, setStartTime] = useState<string>(\"\"); // ISO string of worklog start_datetime (for API calls)\n  const [sessionStartTime, setSessionStartTime] = useState<string>(\"\"); // ISO string when current timer session started (for display)\n  const [worklogId, setWorklogId] = useState<number | null>(null);\n  const [selectedTaskId, setSelectedTaskId] = useState<number | null>(null);\n  const [taskDetail, setTaskDetail] = useState<AssignedTaskDetailType | null>(null);\n  const taskButtonRef = useRef<HTMLButtonElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const conversationRef = useRef<HTMLDivElement>(null);\n\n  // SYNC LOCAL STATE WITH TIMER CONTEXT\n  // This keeps the dashboard in sync with task row timer actions\n  useEffect(() => {\n    if (!timerLoading) {\n      setIsRunning(timerState.isRunning);\n      setTime(timerState.elapsedSeconds);\n      setWorklogId(timerState.worklogId);\n      if (timerState.taskId) {\n        setSelectedTaskId(timerState.taskId);\n        setSelectedTask(timerState.taskName || \"\");\n      }\n      if (timerState.startTime) {\n        setStartTime(timerState.startTime.toISOString());\n      }\n    }\n  }, [timerState, timerLoading]);\n\n  const { mutateAsync, isPending } = useMutation({\n    mutationFn: (data: { prompt: string; history: { role: \"user\" | \"assistant\"; content: string }[] }) =>\n      generateAgentResponse(data.prompt, data.history),\n  });\n\n  // Timer effect using requestAnimationFrame (like old frontend) for smoother updates\n  useEffect(() => {\n    const taskStatus = (taskDetail?.status || '').toLowerCase();\n    const isTaskCompleted = taskStatus.includes('completed') || taskStatus === 'done';\n\n    if (isTaskCompleted) {\n      setIsRunning(false);\n      return;\n    }\n\n    let frame: number;\n    let lastSecond = -1;\n    const tick = () => {\n      if (isRunning && startTime) {\n        // CRITICAL FIX: Calculate elapsed from DB startTime (not sessionStartTime)\n        // This ensures timer shows REAL elapsed time across sessions, devices, and page refreshes\n        const elapsed = Math.floor((Date.now() - parseAsUTC(startTime).getTime()) / 1000);\n        // Only update state when the second changes\n        if (elapsed !== lastSecond) {\n          lastSecond = elapsed;\n          setTime(Math.max(0, elapsed));\n        }\n        frame = requestAnimationFrame(tick);\n      }\n    };\n\n    if (isRunning && startTime && !isTaskCompleted) {\n      // Start timer animation using DB startTime for real elapsed calculation\n      frame = requestAnimationFrame(tick);\n    } else if (!isRunning) {\n      // Timer is paused - keep displaying whatever time value is set (pausedElapsed)\n      // Don't reset to 0 here - that's handled by pause logic\n    }\n\n    return () => {\n      if (frame) cancelAnimationFrame(frame);\n    };\n  }, [isRunning, startTime, taskDetail]);\n\n  // Animate popup on open\n  useEffect(() => {\n    if (showChatPopup) {\n      // Small delay to trigger animation\n      setTimeout(() => setIsAnimating(true), 10);\n    } else {\n      setIsAnimating(false);\n    }\n  }, [showChatPopup]);\n\n  // Auto-scroll to bottom when new messages arrive\n  useEffect(() => {\n    if (conversationRef.current) {\n      conversationRef.current.scrollTop = conversationRef.current.scrollHeight;\n    }\n  }, [conversations]);\n\n  // Fetch user details to get current user ID\n  const { data: userDetailsData } = useUserDetails();\n  const user = useMemo(() => {\n    return userDetailsData?.result?.user || userDetailsData?.result || {};\n  }, [userDetailsData]);\n\n  // Fetch workspaces to map project names\n  const { data: workspacesData } = useWorkspaces();\n  const workspacesMap = useMemo(() => {\n    const map = new Map();\n    if (workspacesData?.result?.workspaces) {\n      workspacesData.result.workspaces.forEach((p: any) => map.set(p.id, p.name));\n    }\n    return map;\n  }, [workspacesData]);\n\n  // Fetch tasks assigned to current user using the dedicated endpoint\n  const { data: assignedTasksData, refetch: refetchAssignedTasks } = useQuery({\n    queryKey: ['assignedTasks'],\n    queryFn: () => getAssignedTasks(),\n    staleTime: 30 * 1000, // 30 seconds\n  });\n\n  // Filter tasks: show only \"Assigned\", \"In_Progress\", and \"Impediment\" (stuck) tasks\n  // Do NOT show \"Review\" or \"Completed\" tasks\n  const tasks = useMemo(() => {\n    return (assignedTasksData?.result || [])\n      .filter((t: any) => {\n        const status = (t.status || '').toLowerCase();\n        // Show Assigned, In_Progress, and Impediment (stuck) tasks\n        // Hide Review and Completed tasks\n        const isAssigned = status === 'assigned';\n        const isInProgress = status.includes('in_progress') || status.includes('in progress');\n        const isImpediment = status.includes('impediment') || status.includes('stuck');\n        const isReview = status.includes('review');\n        const isCompleted = status.includes('completed') || status === 'done';\n\n        // Filter out if no keys provided (security)\n        if (!user || !user.id) return false;\n\n        // Check if current user is a member and has provided an estimate\n        const myMember = t.task_members?.find((m: any) => String(m.user_id) === String(user.id));\n        const hasProvidedEstimate = myMember ? (myMember.estimated_time !== null && myMember.estimated_time > 0) : false;\n\n        return (isAssigned || isInProgress || isImpediment) && !isReview && !isCompleted && hasProvidedEstimate;\n      })\n      .map((t: any) => ({\n        id: t.id,\n        name: t.name || t.title || \"Untitled Task\",\n        project: t.project_id ? workspacesMap.get(t.project_id) || \"Unknown Project\" : \"No Project\",\n        status: t.status\n      }));\n  }, [assignedTasksData, workspacesMap, user]);\n\n  // Update Status Mutation\n  const updateStatusMutation = useUpdateTaskStatus();\n\n  // Start Worklog Mutation\n  const startWorklogMutation = useMutation({\n    mutationFn: ({ task_id, start_datetime }: { task_id: number; start_datetime: string }) =>\n      startWorkLog(task_id, start_datetime),\n  });\n\n  // Update Worklog Mutation\n  const updateWorklogMutation = useMutation({\n    mutationFn: ({ params, worklogId }: { params: any; worklogId: number }) =>\n      updateWorklog(params, worklogId),\n  });\n\n  // Fetch task detail when task is selected\n  const { data: taskDetailData, refetch: refetchTaskDetail } = useQuery({\n    queryKey: ['taskDetail', selectedTaskId],\n    queryFn: () => getAssignedTaskDetail(selectedTaskId!),\n    enabled: !!selectedTaskId,\n    staleTime: 10 * 1000, // 10 seconds\n  });\n\n  useEffect(() => {\n    if (taskDetailData?.result) {\n      setTaskDetail(taskDetailData.result);\n\n      // Check for active worklog in taskDetail first (from database - source of truth)\n      const activeWorklog = taskDetailData.result.task_worklog;\n\n      if (activeWorklog && !activeWorklog.end_datetime && activeWorklog.start_datetime) {\n        // RUNNING worklog exists in DB - timer should show real elapsed time\n        const utcStart = parseAsUTC(activeWorklog.start_datetime).toISOString();\n        setStartTime(utcStart); // For API calls & timer calculation\n        setWorklogId(activeWorklog.id || null);\n        setIsRunning(true);\n\n        // Calculate and set initial elapsed for immediate display\n        const initialElapsed = Math.floor((Date.now() - new Date(utcStart).getTime()) / 1000);\n        setTime(Math.max(0, initialElapsed));\n\n        // Save to localStorage for cross-tab sync\n        const task = tasks.find(t => t.id === selectedTaskId);\n        if (task) {\n          localStorage.setItem(\n            \"activeTimer\",\n            JSON.stringify({\n              taskId: selectedTaskId,\n              taskName: task.name,\n              startTime: activeWorklog.start_datetime,\n              worklogId: activeWorklog.id || null,\n              isRunning: true,\n            })\n          );\n        }\n      } else {\n        // No active worklog - check if we have paused state in localStorage\n        const saved = localStorage.getItem(\"activeTimer\");\n        if (saved) {\n          try {\n            const savedData = JSON.parse(saved);\n            if (savedData.taskId === selectedTaskId && savedData.isPaused && savedData.pausedElapsed > 0) {\n              // Task was paused - show paused elapsed time (not running)\n              setTime(savedData.pausedElapsed);\n              setIsRunning(false);\n              setWorklogId(null);\n              setStartTime(\"\");\n              pausedElapsedRef.current = savedData.pausedElapsed;\n              return;\n            }\n          } catch (error) {\n            // Error loading saved timer\n          }\n        }\n\n        // No active worklog and no paused state - clear timer completely\n        setIsRunning(false);\n        setStartTime(\"\");\n        setWorklogId(null);\n        setTime(0);\n        pausedElapsedRef.current = 0;\n      }\n    }\n  }, [taskDetailData, selectedTaskId, tasks]);\n\n  // Load saved timer state from localStorage on mount\n  useEffect(() => {\n    const saved = localStorage.getItem(\"activeTimer\");\n    if (saved) {\n      try {\n        const savedData = JSON.parse(saved);\n        const { taskId, taskName, startTime: savedStart, worklogId: savedWorklogId, isRunning: savedIsRunning, pausedTime: savedPausedTime, resumeTime: savedResumeTime } = savedData;\n        if (taskId && taskName) {\n          // Set selected task\n          setSelectedTask(taskName);\n          setSelectedTaskId(taskId);\n\n          // If was running, set startTime and worklogId so taskDetail fetch can restore\n          if (savedIsRunning && savedStart) {\n            setStartTime(savedStart);\n            if (savedWorklogId) {\n              setWorklogId(savedWorklogId);\n            }\n          } else {\n            // No paused state to restore - timer will start fresh\n            if (savedStart) {\n              setStartTime(savedStart);\n            }\n            if (savedWorklogId) {\n              setWorklogId(savedWorklogId);\n            }\n          }\n          // Fetch task detail to verify active worklog - this will properly restore the timer\n        }\n      } catch (error) {\n        localStorage.removeItem(\"activeTimer\");\n      }\n    }\n  }, []);\n\n  // Set initial selected task if available and none selected\n  // Removed auto-selection to show placeholder \"Select Task\" as requested\n  // useEffect(() => {\n  //   if (tasks.length > 0 && !selectedTask) {\n  //     setSelectedTask(tasks[0].name);\n  //   }\n  // }, [tasks]);\n\n  const formatTime = (seconds: number) => {\n    const hrs = Math.floor(seconds / 3600);\n    const mins = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n    return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handlePlayPause = () => {\n    if (!selectedTask) {\n      antdMessage.warning(\"Please select a task first\");\n      return;\n    }\n\n    const task = tasks.find(t => t.name === selectedTask);\n    if (!task) return;\n\n    // Allow starting timer for Assigned, In_Progress, and Impediment (stuck) tasks\n    const taskStatus = (task.status || '').toLowerCase();\n    const isAssigned = taskStatus === 'assigned';\n    const isInProgress = taskStatus.includes('in_progress') || taskStatus.includes('in progress');\n    const isImpediment = taskStatus.includes('impediment') || taskStatus.includes('stuck');\n\n    if (!isAssigned && !isInProgress && !isImpediment && !isRunning) {\n      antdMessage.warning(\"Cannot start timer for this task status\");\n      return;\n    }\n\n    const newIsRunning = !isRunning;\n\n    if (newIsRunning) {\n      // Start/Resume Timer (NO worklog modal)\n      if (worklogId && startTime) {\n        // Active worklog exists - timer should already be running\n        setIsRunning(true);\n        antdMessage.info(\"Timer is already running\");\n        return;\n      } else {\n        // Check if we have paused elapsed time to resume from\n        const savedTimer = localStorage.getItem(\"activeTimer\");\n        let previousElapsed = 0;\n        if (savedTimer) {\n          try {\n            const savedData = JSON.parse(savedTimer);\n            if (savedData.taskId === task.id && savedData.isPaused && savedData.pausedElapsed > 0) {\n              previousElapsed = savedData.pausedElapsed;\n            }\n          } catch (e) {\n            // Error reading paused time\n          }\n        }\n\n        // If resuming from pause, also check pausedElapsedRef\n        if (pausedElapsedRef.current > 0) {\n          previousElapsed = pausedElapsedRef.current;\n        }\n\n        // Calculate adjusted start time so timer continues from paused position\n        // If previousElapsed = 80 seconds, and we start now, \n        // start_datetime should be (now - 80 seconds) so elapsed shows 80+ seconds\n        const now = Date.now();\n        const adjustedStart = new Date(now - previousElapsed * 1000).toISOString();\n\n        setStartTime(adjustedStart); // For API/worklog & timer calculation\n        setTime(previousElapsed); // Immediately show elapsed time\n\n        startWorklogMutation.mutate(\n          { task_id: task.id, start_datetime: adjustedStart },\n          {\n            onSuccess: (data) => {\n              const newWorklogId = data.result?.id || null;\n              setWorklogId(newWorklogId);\n              setIsRunning(true);\n\n              // Clear paused state since we resumed\n              pausedElapsedRef.current = 0;\n\n              // Save to localStorage\n              localStorage.setItem(\n                \"activeTimer\",\n                JSON.stringify({\n                  taskId: task.id,\n                  taskName: selectedTask,\n                  startTime: adjustedStart,\n                  worklogId: newWorklogId,\n                  isRunning: true,\n                  isPaused: false,\n                  pausedElapsed: 0,\n                })\n              );\n\n              // Update selected task ID if not set\n              if (!selectedTaskId) {\n                setSelectedTaskId(task.id);\n              }\n\n              // Refetch task detail\n              refetchTaskDetail();\n\n              // Update task status to In_Progress if currently Assigned\n              if (taskStatus === 'assigned') {\n                updateStatusMutation.mutate(\n                  { id: task.id, status: 'In_Progress' },\n                  {\n                    onSuccess: () => {\n                      antdMessage.success(`Resumed working on: ${task.name}`);\n                    },\n                    onError: () => {\n                      antdMessage.error(\"Failed to update task status\");\n                    }\n                  }\n                );\n              } else {\n                antdMessage.success(previousElapsed > 0 ? `Resumed timer for: ${task.name}` : `Started working on: ${task.name}`);\n              }\n            },\n            onError: (error: any) => {\n              antdMessage.error(\"Failed to start timer\");\n            }\n          }\n        );\n      }\n    } else {\n      // Pause Timer -> Automatically save worklog with empty description (no modal)\n      // Get worklogId from state, localStorage, or taskDetail\n      const activeWorklogId = worklogId || (taskDetail?.task_worklog?.id ?? null);\n\n      if (!startTime || !activeWorklogId) {\n        antdMessage.warning(\"No active timer to pause\");\n        return;\n      }\n\n      // Ensure normalized UTC start time for accurate diff\n      const utcStart = parseAsUTC(startTime).toISOString();\n\n      // Calculate elapsed time and store for resume\n      const elapsed = Math.floor((Date.now() - new Date(utcStart).getTime()) / 1000);\n      pausedElapsedRef.current = elapsed;\n\n      // Automatically save worklog with empty description and current timestamp\n      const endDatetime = new Date().toISOString();\n      const payload = {\n        task_id: task.id,\n        start_datetime: utcStart,\n        end_datetime: endDatetime,\n        description: '', // Empty description as per user requirement\n      };\n\n      setIsRunning(false);\n      // Keep time displayed at paused value (don't reset to 0)\n      setTime(elapsed);\n\n      updateWorklogMutation.mutate(\n        { params: payload, worklogId: activeWorklogId },\n        {\n          onSuccess: () => {\n            // Clear worklogId and startTime since worklog is now closed\n            setWorklogId(null);\n            setStartTime(\"\");\n\n            // CRITICAL: Save pausedElapsed to localStorage for cross-session persistence\n            const task = tasks.find(t => t.id === selectedTaskId);\n            localStorage.setItem(\n              \"activeTimer\",\n              JSON.stringify({\n                taskId: selectedTaskId,\n                taskName: task?.name || selectedTask,\n                worklogId: null,\n                startTime: \"\",\n                isRunning: false,\n                isPaused: true,\n                pausedElapsed: elapsed, // This is the key for resume functionality\n              })\n            );\n\n            antdMessage.info(`Paused timer at ${formatDuration(elapsed)} for: ${task?.name || selectedTask}`);\n          },\n          onError: (error: any) => {\n            antdMessage.error(\"Failed to save worklog on pause\");\n            // Revert isRunning state on error (timer will recalculate time from startTime)\n            setIsRunning(true);\n          }\n        }\n      );\n    }\n  };\n\n  const handleStuck = () => {\n    if (!selectedTask) {\n      antdMessage.warning(\"Please select a task first\");\n      return;\n    }\n\n    // Stop timer and open worklog modal (matching old frontend)\n    setIsRunning(false);\n    setWorklogAction('stuck');\n    setShowWorklogModal(true);\n  };\n\n  const handleComplete = () => {\n    if (!selectedTask) {\n      antdMessage.warning(\"Please select a task first\");\n      return;\n    }\n\n    // Stop timer and open worklog modal (matching old frontend)\n    setIsRunning(false);\n    setWorklogAction('complete');\n    setShowWorklogModal(true);\n  };\n\n  const handleWorklogSubmit = async (description: string) => {\n    if (!selectedTask || !worklogAction || !selectedTaskId) return;\n\n    const task = tasks.find(t => t.name === selectedTask);\n    if (!task) return;\n\n    // Match old frontend: get startTime from localStorage (savedIso)\n    const saved = localStorage.getItem(\"activeTimer\");\n    if (!saved) {\n      antdMessage.error(\"No active worklog found\");\n      return;\n    }\n\n    let savedIso: string;\n    let savedWorklogId: number | null = null;\n    try {\n      const savedData = JSON.parse(saved);\n      savedIso = savedData.startTime;\n      savedWorklogId = savedData.worklogId || null;\n    } catch (error) {\n      antdMessage.error(\"Error reading saved timer data\");\n      return;\n    }\n\n    if (!savedIso) {\n      antdMessage.error(\"No start time found for worklog\");\n      return;\n    }\n\n    // Match old frontend: use current time for end_datetime\n    const endDatetime = new Date().toISOString();\n\n    // Use worklogId from state or localStorage (matching old frontend)\n    const activeWorklogId = worklogId || savedWorklogId || taskDetail?.task_worklog?.id;\n\n    if (activeWorklogId) {\n      const payload = {\n        task_id: task.id,\n        start_datetime: savedIso,\n        end_datetime: endDatetime,\n        description,\n      };\n\n      updateWorklogMutation.mutate(\n        { params: payload, worklogId: activeWorklogId },\n        {\n          onSuccess: () => {\n            antdMessage.success(\"Worklog added successfully\");\n\n            // Match old frontend: after worklog saved, handle action\n            if (worklogAction === 'complete') {\n              // Update status to Review (matching old frontend)\n              updateStatusMutation.mutate(\n                { id: task.id, status: 'Review' },\n                {\n                  onSuccess: () => {\n                    setIsRunning(false);\n                    setStartTime(\"\");\n                    setSessionStartTime(\"\");\n                    setTime(0);\n                    pausedElapsedRef.current = 0;\n                    setWorklogId(null);\n                    localStorage.removeItem(\"activeTimer\");\n                    setSelectedTask(\"\");\n                    setSelectedTaskId(null);\n                    setTaskDetail(null);\n                    refetchTaskDetail();\n                    setShowWorklogModal(false);\n                    setWorklogAction(null);\n                    antdMessage.success(`Marked \"${task.name}\" as completed`);\n                  },\n                  onError: () => {\n                    antdMessage.error(\"Failed to update task status\");\n                  }\n                }\n              );\n            } else if (worklogAction === 'stuck') {\n              // Update status to Impediment (matching old frontend)\n              updateStatusMutation.mutate(\n                { id: task.id, status: 'Impediment' },\n                {\n                  onSuccess: () => {\n                    setIsRunning(false);\n                    setStartTime(\"\");\n                    setSessionStartTime(\"\");\n                    setTime(0);\n                    pausedElapsedRef.current = 0;\n                    setWorklogId(null);\n                    localStorage.removeItem(\"activeTimer\");\n                    refetchTaskDetail();\n                    setShowWorklogModal(false);\n                    setWorklogAction(null);\n                    antdMessage.success(`Marked \"${task.name}\" as stuck`);\n\n                    // Add AI message for stuck\n                    const stuckMessage: Message = {\n                      id: Date.now(),\n                      type: 'ai',\n                      content: `I've marked \"${task.name}\" as stuck. What specific challenge are you facing? I can help you brainstorm or find resources.`,\n                      timestamp: new Date(),\n                      responseType: 'info'\n                    };\n                    setConversations(prev => [...prev, stuckMessage]);\n                    setShowChatPopup(true);\n                  },\n                  onError: () => {\n                    antdMessage.error(\"Failed to update task status\");\n                  }\n                }\n              );\n            } else {\n              // Pause action: just close modal and keep timer state\n              setShowWorklogModal(false);\n              setWorklogAction(null);\n              // Don't resume timer - user can click play to resume\n            }\n          },\n          onError: (error: any) => {\n            antdMessage.error(\"Failed to save worklog\");\n          }\n        }\n      );\n    } else if (taskDetail?.task_worklog && !taskDetail.task_worklog.end_datetime && taskDetail.task_worklog.id) {\n      // Fallback: Use worklog from taskDetail if not in localStorage\n      // Match old frontend: use current time for end_datetime\n      const endDatetime = new Date().toISOString();\n\n      const payload = {\n        task_id: task.id,\n        start_datetime: taskDetail.task_worklog.start_datetime,\n        end_datetime: endDatetime,\n        description,\n      };\n\n      updateWorklogMutation.mutate(\n        { params: payload, worklogId: taskDetail.task_worklog.id },\n        {\n          onSuccess: () => {\n            antdMessage.success(\"Worklog added successfully\");\n\n            // Match old frontend: after worklog saved, handle action\n            if (worklogAction === 'complete') {\n              updateStatusMutation.mutate(\n                { id: task.id, status: 'Review' },\n                {\n                  onSuccess: () => {\n                    setIsRunning(false);\n                    setStartTime(\"\");\n                    setTime(0);\n                    pausedElapsedRef.current = 0;\n                    setWorklogId(null);\n                    localStorage.removeItem(\"activeTimer\");\n                    setSelectedTask(\"\");\n                    setSelectedTaskId(null);\n                    setTaskDetail(null);\n                    refetchTaskDetail();\n                    setShowWorklogModal(false);\n                    setWorklogAction(null);\n                    antdMessage.success(`Marked \"${task.name}\" as completed`);\n                  },\n                  onError: () => {\n                    antdMessage.error(\"Failed to update task status\");\n                  }\n                }\n              );\n            } else if (worklogAction === 'stuck') {\n              updateStatusMutation.mutate(\n                { id: task.id, status: 'Impediment' },\n                {\n                  onSuccess: () => {\n                    setIsRunning(false);\n                    setStartTime(\"\");\n                    setTime(0);\n                    pausedElapsedRef.current = 0;\n                    setWorklogId(null);\n                    localStorage.removeItem(\"activeTimer\");\n                    refetchTaskDetail();\n                    setShowWorklogModal(false);\n                    setWorklogAction(null);\n                    antdMessage.success(`Marked \"${task.name}\" as stuck`);\n                  },\n                  onError: () => {\n                    antdMessage.error(\"Failed to update task status\");\n                  }\n                }\n              );\n            } else {\n              setShowWorklogModal(false);\n              setWorklogAction(null);\n            }\n          },\n          onError: (error: any) => {\n            antdMessage.error(\"Failed to save worklog\");\n          }\n        }\n      );\n    } else {\n      // No active worklog, just update status\n      // Match old frontend: stuck -> \"Impediment\", complete -> \"Review\"\n      const newStatus = worklogAction === 'stuck' ? 'Impediment' : 'Review';\n      updateStatusMutation.mutate(\n        { id: task.id, status: newStatus },\n        {\n          onSuccess: () => {\n            antdMessage.success(\n              worklogAction === 'stuck'\n                ? `Marked \"${task.name}\" as stuck`\n                : `Marked \"${task.name}\" as completed`\n            );\n\n            // Clear timer state\n            setIsRunning(false);\n            setTime(0);\n            pausedElapsedRef.current = 0;\n            setStartTime(\"\");\n            setSessionStartTime(\"\");\n            setWorklogId(null);\n            localStorage.removeItem(\"activeTimer\");\n\n            if (worklogAction === 'complete') {\n              setSelectedTask(\"\");\n              setSelectedTaskId(null);\n              setTaskDetail(null);\n            }\n\n            // Refetch task detail\n            if (selectedTaskId) {\n              refetchTaskDetail();\n            }\n\n            setShowWorklogModal(false);\n            setWorklogAction(null);\n          },\n          onError: () => {\n            antdMessage.error(\"Failed to update task status\");\n          }\n        }\n      );\n    }\n  };\n\n  const handleSend = async () => {\n    if (!message.trim() || isPending) return;\n\n    const query = message.trim();\n\n    // Add user message to conversation\n    const userMessage: Message = {\n      id: Date.now(),\n      type: 'user',\n      content: query,\n      timestamp: new Date()\n    };\n\n    setConversations(prev => [...prev, userMessage]);\n    setMessage(\"\");\n    setIsFocused(false);\n\n    // Handle timer commands locally (these are UI actions, not AI queries)\n    const queryLower = query.toLowerCase();\n    if (queryLower.includes(\"start timer\") || queryLower.includes(\"start tracking\")) {\n      setIsRunning(true);\n      const timerMessage: Message = {\n        id: Date.now() + 1,\n        type: 'ai',\n        content: `Timer started for ${selectedTask}`,\n        timestamp: new Date(),\n        responseType: \"timer_action\"\n      };\n      setConversations(prev => [...prev, timerMessage]);\n      return;\n    }\n    if (queryLower.includes(\"stop timer\") || queryLower.includes(\"pause timer\")) {\n      setIsRunning(false);\n      const timerMessage: Message = {\n        id: Date.now() + 1,\n        type: 'ai',\n        content: `Timer paused at ${formatTime(time)} for ${selectedTask}`,\n        timestamp: new Date(),\n        responseType: \"info\"\n      };\n      setConversations(prev => [...prev, timerMessage]);\n      return;\n    }\n    if (queryLower.includes(\"reset timer\")) {\n      setIsRunning(false);\n      setTime(0);\n      const timerMessage: Message = {\n        id: Date.now() + 1,\n        type: 'ai',\n        content: \"Timer has been reset\",\n        timestamp: new Date(),\n        responseType: \"info\"\n      };\n      setConversations(prev => [...prev, timerMessage]);\n      return;\n    }\n\n    // Prepare History (Last 6 valid messages) excluding the current one we just added\n    const history = conversations\n      .filter((m) => m.type === \"user\" || m.type === \"ai\")\n      .slice(-6)\n      .map((m) => ({\n        role: (m.type === \"user\" ? \"user\" : \"assistant\") as \"user\" | \"assistant\",\n        content: m.content,\n      }));\n\n    try {\n      const result = await mutateAsync({ prompt: query, history });\n\n      if (result.error) {\n        const errorMessage: Message = {\n          id: Date.now() + 1,\n          type: 'ai',\n          content: result.error,\n          timestamp: new Date()\n        };\n        setConversations(prev => [...prev, errorMessage]);\n        antdMessage.error(result.error);\n        return;\n      }\n\n      const assistantMessage: Message = {\n        id: Date.now() + 1,\n        type: 'ai',\n        content: result.answer ?? \"I couldn't generate a response for that request.\",\n        timestamp: new Date()\n      };\n      setConversations(prev => [...prev, assistantMessage]);\n    } catch (error) {\n      const errorMessage: Message = {\n        id: Date.now() + 1,\n        type: 'ai',\n        content: \"Unable to reach the assistant. Please try again.\",\n        timestamp: new Date()\n      };\n      setConversations(prev => [...prev, errorMessage]);\n      antdMessage.error(\"Unable to reach the assistant. Please try again.\");\n    }\n  };\n\n  const handleTaskSelect = (taskName: string) => {\n    const task = tasks.find(t => t.name === taskName);\n    if (task) {\n      // Reset timer display immediately when selecting a new task\n      // The taskDetail useEffect will restore timer state if there's an active worklog\n      setTime(0);\n      setIsRunning(false);\n      setSelectedTask(taskName);\n      setSelectedTaskId(task.id);\n      setShowTaskSelector(false);\n\n      // Task detail will be fetched automatically via the useQuery hook when selectedTaskId changes\n      // This will properly restore the timer state if the task has an active worklog\n    }\n  };\n\n  // Refetch assigned tasks when dropdown is opened\n  useEffect(() => {\n    if (showTaskSelector) {\n      refetchAssignedTasks();\n    }\n  }, [showTaskSelector, refetchAssignedTasks]);\n\n  // Periodic refresh of task detail while timer is running\n  useEffect(() => {\n    if (isRunning && selectedTaskId) {\n      const interval = setInterval(() => {\n        refetchTaskDetail();\n      }, 30000); // Refresh every 30 seconds to update worked_time\n\n      return () => clearInterval(interval);\n    }\n  }, [isRunning, selectedTaskId, refetchTaskDetail]);\n\n\n  const markdownComponents = useMemo<Components>(\n    () => ({\n      p: ({ children }) => (\n        <p className=\"mb-2 last:mb-0 text-[14px] font-['Manrope:Medium',sans-serif] leading-relaxed\">{children}</p>\n      ),\n      ul: ({ children }) => (\n        <ul className=\"mb-2 pl-4 list-disc space-y-1 text-[14px] font-['Manrope:Medium',sans-serif]\">{children}</ul>\n      ),\n      ol: ({ children }) => (\n        <ol className=\"mb-2 pl-4 list-decimal space-y-1 text-[14px] font-['Manrope:Medium',sans-serif]\">{children}</ol>\n      ),\n      li: ({ children }) => (\n        <li className=\"pl-1\">{children}</li>\n      ),\n      strong: ({ children }) => (\n        <strong className=\"font-semibold text-[#111111]\">{children}</strong>\n      ),\n      a: ({ href, children }) => (\n        <a href={href} className=\"text-[#ff3b3b] underline hover:text-[#cc2f2f]\" target=\"_blank\" rel=\"noopener noreferrer\">{children}</a>\n      ),\n      table: ({ children }) => (\n        <div className=\"my-2 overflow-x-auto rounded-lg border border-[#EEEEEE]\">\n          <table className=\"w-full text-[13px] text-left\">{children}</table>\n        </div>\n      ),\n      thead: ({ children }) => <thead className=\"bg-[#F7F7F7] font-semibold text-[#111111]\">{children}</thead>,\n      tbody: ({ children }) => <tbody className=\"divide-y divide-[#EEEEEE]\">{children}</tbody>,\n      tr: ({ children }) => <tr className=\"hover:bg-[#F7F7F7]/50\">{children}</tr>,\n      th: ({ children }) => <th className=\"px-3 py-2 whitespace-nowrap\">{children}</th>,\n      td: ({ children }) => <td className=\"px-3 py-2\">{children}</td>,\n    }),\n    []\n  );\n\n  return (\n    <div className=\"flex flex-col gap-3 w-full relative pr-1\">\n\n\n      {/* Expandable Command Center - White Rectangle Expands Upward */}\n      <div\n        className={`bg-white w-full border border-[#EEEEEE] relative transition-all duration-500 ease-out ${showChatPopup ? 'overflow-hidden' : 'overflow-visible'}`}\n        style={{\n          height: showChatPopup ? 'calc(100vh - 140px)' : '88px',\n          borderRadius: showChatPopup ? '24px' : '9999px',\n          position: showChatPopup ? 'absolute' : 'relative',\n          bottom: showChatPopup ? '0' : 'auto',\n          left: showChatPopup ? '0' : 'auto',\n          right: showChatPopup ? '0' : 'auto',\n          zIndex: showChatPopup || showTaskSelector ? 50 : 20\n        }}\n      >\n        {/* Close Button - Top Left Corner (only visible when expanded) */}\n        {showChatPopup && (\n          <button\n            onClick={() => setShowChatPopup(false)}\n            className=\"absolute top-4 left-4 z-10 w-9 h-9 rounded-full bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-all active:scale-90\"\n          >\n            <Dismiss24Filled className=\"w-5 h-5 text-[#666666]\" />\n          </button>\n        )}\n\n        {/* Chat Messages Area - Only visible when expanded */}\n        {showChatPopup && (\n          <div\n            ref={conversationRef}\n            className=\"absolute top-0 left-0 right-0 overflow-y-auto px-6 pt-6\"\n            style={{ height: 'calc(100% - 100px)' }}\n          >\n            <div className=\"space-y-4 flex flex-col justify-end min-h-full\">\n              {conversations.length === 0 ? (\n                <div className=\"flex flex-col items-center justify-center flex-1 gap-4\">\n                  <div className=\"w-16 h-16 bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] rounded-full flex items-center justify-center shadow-lg\">\n                    <Sparkle24Filled className=\"w-8 h-8 text-white fill-white\" />\n                  </div>\n                  <div className=\"text-center\">\n                    <h4 className=\"font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">How can I help you?</h4>\n                    <p className=\"text-[14px] text-[#999999] font-['Manrope:Regular',sans-serif] max-w-md\">\n                      Ask me about tasks, time tracking, team status, meetings, or workspace updates\n                    </p>\n                  </div>\n                  <div className=\"flex gap-2 mt-4 flex-wrap justify-center\">\n                    <button\n                      onClick={() => { setMessage(\"Give me all the requirements for the project.\"); inputRef.current?.focus(); }}\n                      className=\"px-4 py-2 bg-[#F7F7F7] hover:bg-gradient-to-br hover:from-[#ff3b3b] hover:to-[#cc2f2f] hover:text-white text-[#666666] rounded-full text-[13px] font-['Manrope:SemiBold',sans-serif] transition-all\"\n                    >\n                      Requirements\n                    </button>\n                    <button\n                      onClick={() => { setMessage(\"List down all my tasks for today.\"); inputRef.current?.focus(); }}\n                      className=\"px-4 py-2 bg-[#F7F7F7] hover:bg-gradient-to-br hover:from-[#ff3b3b] hover:to-[#cc2f2f] hover:text-white text-[#666666] rounded-full text-[13px] font-['Manrope:SemiBold',sans-serif] transition-all\"\n                    >\n                      Tasks\n                    </button>\n                    <button\n                      onClick={() => { setMessage(\"Show the approved leave requests for this month.\"); inputRef.current?.focus(); }}\n                      className=\"px-4 py-2 bg-[#F7F7F7] hover:bg-gradient-to-br hover:from-[#ff3b3b] hover:to-[#cc2f2f] hover:text-white text-[#666666] rounded-full text-[13px] font-['Manrope:SemiBold',sans-serif] transition-all\"\n                    >\n                      Leaves\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                conversations.map((msg) => (\n                  <div\n                    key={msg.id}\n                    className={`flex gap-3 ${msg.type === 'user' ? 'flex-row-reverse' : 'flex-row'}`}\n                  >\n                    {/* Avatar */}\n                    <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${msg.type === 'ai'\n                      ? 'bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] shadow-[2px_2px_4px_0px_inset_rgba(255,255,255,0.3)]'\n                      : 'bg-[#F7F7F7]'\n                      }`}>\n                      {msg.type === 'ai' ? (\n                        <Sparkle24Filled className=\"w-4 h-4 text-white fill-white\" />\n                      ) : (\n                        <Person24Filled className=\"w-4 h-4 text-[#666666]\" />\n                      )}\n                    </div>\n\n                    {/* Message Content */}\n                    <div className={`flex flex-col gap-2 max-w-[70%] ${msg.type === 'user' ? 'items-end' : 'items-start'}`}>\n                      <div className={`rounded-[20px] px-5 py-3 ${msg.type === 'user'\n                        ? 'bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] text-white shadow-sm'\n                        : 'bg-[#F7F7F7] text-[#111111]'\n                        }`}>\n                        <p className=\"text-[14px] font-['Manrope:Medium',sans-serif]\">\n                          {msg.type === 'ai' ? (\n                            <ReactMarkdown\n                              components={markdownComponents}\n                              remarkPlugins={[remarkGfm]}\n                            >\n                              {msg.content}\n                            </ReactMarkdown>\n                          ) : (\n                            msg.content\n                          )}\n                        </p>\n                      </div>\n\n\n                      {/* Status Badges */}\n                      {msg.type === 'ai' && msg.responseType === 'timer_action' && (\n                        <div className=\"flex items-center gap-2 px-3 py-1.5 bg-[#F0FDF4] rounded-full\">\n                          <CheckmarkCircle24Filled className=\"w-3 h-3 text-[#16a34a]\" />\n                          <span className=\"text-[11px] text-[#16a34a] font-['Manrope:SemiBold',sans-serif]\">Started</span>\n                        </div>\n                      )}\n                      {msg.type === 'ai' && msg.responseType === 'info' && (\n                        <div className=\"flex items-center gap-2 px-3 py-1.5 bg-[#F0F9FF] rounded-full\">\n                          <CheckmarkCircle24Filled className=\"w-3 h-3 text-[#0284c7]\" />\n                          <span className=\"text-[11px] text-[#0284c7] font-['Manrope:SemiBold',sans-serif]\">Done</span>\n                        </div>\n                      )}\n\n                      <span className=\"text-[10px] text-[#999999] font-['Manrope:Regular',sans-serif] px-2\">\n                        {msg.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                      </span>\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Fixed Input & Timer Controls at Bottom */}\n        <div className={`absolute bottom-0 left-0 right-0 p-4 flex ${showChatPopup ? 'h-auto items-end' : 'h-full items-center'}`}>\n          {/* Grid Layout: 3 columns matching dashboard layout with same gap-5 */}\n          <div className={`grid grid-cols-3 gap-5 w-full ${showChatPopup ? 'items-end' : 'items-center h-full'}`}>\n            {/* Left Section: Input Box (col-span-2 - aligned with Notes and Progress) */}\n            <div className={`col-span-2 flex items-center ${showChatPopup ? 'h-auto' : 'h-full'}`}>\n              <div className=\"flex items-center gap-3 px-6 py-2.5 bg-[#F7F7F7] rounded-full border border-[#EEEEEE] hover:bg-[#EEEEEE] hover:border-[#D3D2D2] transition-all w-full\">\n                <button className=\"text-[#666666] hover:text-[#ff3b3b] flex items-center justify-center transition-all active:scale-90 flex-shrink-0\">\n                  <Mic24Filled className=\"w-[18px] h-[18px]\" />\n                </button>\n                <input\n                  ref={inputRef}\n                  type=\"text\"\n                  value={message}\n                  onChange={(e) => setMessage(e.target.value)}\n                  onFocus={() => setShowChatPopup(true)}\n                  onKeyDown={(e) => e.key === 'Enter' && handleSend()}\n                  placeholder=\"Ask anything or give command...\"\n                  className=\"flex-1 bg-transparent text-[14px] font-['Manrope:Regular',sans-serif] text-[#111111] placeholder:text-[#999999] focus:outline-none min-w-0\"\n                />\n                <button\n                  onClick={handleSend}\n                  disabled={isPending || !message.trim()}\n                  className=\"text-[#ff3b3b] hover:text-[#cc2f2f] flex items-center justify-center transition-all active:scale-90 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0\"\n                >\n                  {isPending ? (\n                    <div className=\"w-[18px] h-[18px] border-2 border-[#ff3b3b] border-t-transparent rounded-full animate-spin\" />\n                  ) : (\n                    <Send24Filled className=\"w-[18px] h-[18px]\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Right Section: Timer & Controls (col-span-1 - aligned with Meetings and Leaves left start) */}\n            <div className={`col-span-1 flex items-center gap-3 justify-between overflow-hidden ${showChatPopup ? 'h-auto' : 'h-full'}`}>\n              {/* Left: Vertical Separator and Timer Section */}\n              <div className={`flex items-center gap-3 flex-1 min-w-0 ${showChatPopup ? 'h-auto' : 'h-full'}`}>\n                {/* Vertical Separator - Small line at the start */}\n                <div className=\"h-8 w-px bg-[#EEEEEE] flex-shrink-0\" />\n\n                {/* Timer and Task Selector Layout - Vertically Centered */}\n                <div className=\"flex flex-col gap-1.5 flex-1 min-w-0 justify-center\">\n                  {/* Top Row: Timer and Task Selector */}\n                  <div className=\"flex items-center gap-2.5\">\n                    {/* Timer Display */}\n                    <div className=\"flex items-center gap-1.5 flex-shrink-0\">\n                      <div className=\"text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111] leading-none tracking-tight\">\n                        {isRunning && startTime ? formatTime(time) : \"00:00:00\"}\n                      </div>\n                      {isRunning && (\n                        <div className=\"w-2 h-2 rounded-full bg-[#ff3b3b] animate-pulse flex-shrink-0\" />\n                      )}\n                    </div>\n\n                    {/* Task Selector Dropdown - Enhanced visibility */}\n                    <button\n                      ref={taskButtonRef}\n                      onClick={() => setShowTaskSelector(!showTaskSelector)}\n                      className={`flex items-center gap-1.5 group rounded-md px-2.5 py-0.5 transition-all text-left flex-1 min-w-0 h-fit ${selectedTask\n                        ? 'bg-[#FFF5F5] border border-[#ff3b3b]/30 hover:bg-[#FFEBEB] hover:border-[#ff3b3b]/50'\n                        : 'hover:bg-[#F7F7F7] border-0'\n                        }`}\n                    >\n                      <p className={`text-[12px] font-['Manrope:SemiBold',sans-serif] transition-colors truncate ${selectedTask\n                        ? 'text-[#ff3b3b]'\n                        : 'text-[#666666] group-hover:text-[#111111]'\n                        }`}>\n                        {selectedTask || \"Select Task\"}\n                      </p>\n                      <ChevronDown24Filled className={`w-3 h-3 transition-colors flex-shrink-0 ${selectedTask\n                        ? 'text-[#ff3b3b]'\n                        : 'text-[#666666] group-hover:text-[#111111]'\n                        }`} />\n                    </button>\n                  </div>\n\n                  {/* Bottom Row: Estimated Time and Progress Bar - Below timer */}\n                  {selectedTask && taskDetail && taskDetail.estimated_time > 0 && (() => {\n                    // Calculate real-time progress including current timer\n                    const estimatedSeconds = taskDetail.estimated_time * 3600;\n                    const workedSeconds = taskDetail.worked_time || 0;\n                    const currentTimerSeconds = time;\n                    const totalWorkedSeconds = workedSeconds + currentTimerSeconds;\n\n                    const progress = (totalWorkedSeconds / estimatedSeconds) * 100;\n                    const isOverEstimate = totalWorkedSeconds > estimatedSeconds;\n                    const displayProgress = isOverEstimate ? 100 : Math.min(progress, 100);\n\n                    // Get task status for color coding\n                    const task = tasks.find(t => t.name === selectedTask);\n                    const taskStatus = task?.status || taskDetail.status || '';\n                    const statusLower = taskStatus.toLowerCase();\n\n                    // Color logic matching TaskRow component exactly\n                    const progressBarColor = isOverEstimate\n                      ? 'bg-[#dc2626]'  // Red for overtime\n                      : statusLower.includes('completed')\n                        ? 'bg-[#16a34a]'  // Green for completed\n                        : statusLower.includes('delayed') || statusLower.includes('impediment') || statusLower.includes('stuck')\n                          ? 'bg-[#dc2626]'  // Red for delayed/impediment/stuck\n                          : statusLower.includes('review')\n                            ? 'bg-[#fbbf24]'  // Yellow/Orange for review\n                            : 'bg-[#0284c7]';  // Blue for Assigned/In_Progress\n\n                    return (\n                      <div className=\"flex flex-col gap-0.5\">\n                        {/* Estimated Time */}\n                        <div className=\"text-[10px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                          Estimated: <span className=\"font-['Manrope:SemiBold',sans-serif] text-[#111111]\">{Math.round(taskDetail.estimated_time * 60)}m</span>\n                        </div>\n\n                        {/* Progress Bar with real-time animation - matching TaskRow style */}\n                        <div className=\"h-1.5 bg-[#F7F7F7] rounded-full overflow-hidden w-full\">\n                          <div\n                            className={`h-full rounded-full transition-all duration-300 ${progressBarColor}`}\n                            style={{\n                              width: `${displayProgress}%`\n                            }}\n                          />\n                        </div>\n                      </div>\n                    );\n                  })()}\n                </div>\n              </div>\n\n              {/* Right: Control Buttons - Pushed to far right */}\n              <div className=\"flex items-center gap-2 flex-shrink-0\" onClick={(e) => e.stopPropagation()}>\n                {/* Play/Pause Button */}\n                <Tooltip title={isRunning ? \"Pause\" : \"Play\"}>\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handlePlayPause();\n                    }}\n                    className=\"w-10 h-10 bg-[#EAEAEA] hover:bg-[#DDDDDD] text-[#666666] rounded-full flex items-center justify-center transition-all active:scale-90 cursor-pointer\"\n                    type=\"button\"\n                  >\n                    {isRunning ? (\n                      <Pause24Filled className=\"w-5 h-5\" fill=\"currentColor\" />\n                    ) : (\n                      <Play24Filled className=\"w-5 h-5 ml-0.5\" fill=\"currentColor\" />\n                    )}\n                  </button>\n                </Tooltip>\n\n                {/* Stuck Button (Palm/Hand) */}\n                <Tooltip title=\"I'm stuck\">\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleStuck();\n                    }}\n                    className=\"w-10 h-10 bg-[#EAEAEA] hover:bg-[#DDDDDD] rounded-full flex items-center justify-center transition-all active:scale-90 cursor-pointer\"\n                    type=\"button\"\n                  >\n                    <span className=\"text-[18px]\">✋</span>\n                  </button>\n                </Tooltip>\n\n                {/* Completed Button */}\n                <Tooltip title=\"Mark as Complete\">\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleComplete();\n                    }}\n                    className=\"w-10 h-10 bg-[#EAEAEA] hover:bg-[#DDDDDD] text-[#666666] rounded-full flex items-center justify-center transition-all active:scale-90 cursor-pointer\"\n                    type=\"button\"\n                  >\n                    <CheckmarkCircle24Filled className=\"w-5 h-5 text-[#666666]\" />\n                  </button>\n                </Tooltip>\n              </div>\n            </div>\n          </div>\n\n          {/* Task Selector Dropdown */}\n          {showTaskSelector && (\n            <div className=\"absolute bottom-full right-0 mb-2 bg-white rounded-[20px] shadow-lg border border-[#EEEEEE] p-3 animate-in slide-in-from-bottom-1 duration-200 z-10 w-[320px]\">\n              <div className=\"flex items-center gap-2 mb-2 px-2\">\n                <span className=\"text-[10px] text-[#999999] font-['Manrope:SemiBold',sans-serif] uppercase tracking-wide\">\n                  Select Task\n                </span>\n                <div className=\"flex-1 h-px bg-[#EEEEEE]\" />\n              </div>\n              <div className=\"space-y-1 max-h-[240px] overflow-y-auto\">\n                {tasks.map((task) => (\n                  <button\n                    key={task.id}\n                    onClick={() => handleTaskSelect(task.name)}\n                    className={`w-full flex items-center justify-between px-3 py-2 rounded-[12px] text-left transition-all ${selectedTask === task.name\n                      ? 'bg-gradient-to-br from-[#ff3b3b] to-[#cc2f2f] text-white shadow-sm'\n                      : 'hover:bg-[#F7F7F7] text-[#111111]'\n                      }`}\n                  >\n                    <div className=\"flex-1\">\n                      <p className={`text-[13px] font-['Manrope:SemiBold',sans-serif] ${selectedTask === task.name ? 'text-white' : 'text-[#111111]'\n                        }`}>\n                        {task.name}\n                      </p>\n                      <p className={`text-[10px] font-['Manrope:Regular',sans-serif] mt-0.5 ${selectedTask === task.name ? 'text-white/80' : 'text-[#999999]'\n                        }`}>\n                        {task.project}\n                      </p>\n                    </div>\n                    {selectedTask === task.name && (\n                      <CheckmarkCircle24Filled className=\"w-4 h-4 text-white flex-shrink-0 ml-2\" />\n                    )}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Worklog Modal */}\n      <Modal\n        open={showWorklogModal}\n        onCancel={() => {\n          setShowWorklogModal(false);\n          setWorklogAction(null);\n          // Resume timer if we have an active worklog (was running before)\n          if (startTime && worklogId && !taskDetail?.task_worklog?.end_datetime) {\n            setIsRunning(true);\n            // Timer will calculate from startTime using requestAnimationFrame\n          }\n        }}\n        footer={null}\n        width={600}\n        styles={{\n          body: { padding: 0 },\n        }}\n        className=\"worklog-modal\"\n      >\n        <WorklogModal\n          onSubmit={handleWorklogSubmit}\n          onCancel={() => {\n            setShowWorklogModal(false);\n            setWorklogAction(null);\n            // Resume timer if we have an active worklog (was running before)\n            if (startTime && worklogId && !taskDetail?.task_worklog?.end_datetime) {\n              setIsRunning(true);\n              // Reset paused elapsed ref\n              pausedElapsedRef.current = 0;\n              // Timer will calculate from startTime using requestAnimationFrame\n            }\n          }}\n          actionType={worklogAction === 'pause' ? 'complete' : (worklogAction || 'complete')}\n        />\n      </Modal>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/ProgressWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tooltip' is defined but never used.","line":3,"column":59,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":66},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfigProvider' is defined but never used.","line":6,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RangePicker' is assigned a value but never used.","line":21,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":20},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":78,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":78,"endColumn":52,"suggestions":[{"messageId":"addBrackets","fix":{"range":[3000,3133],"text":"{ const lastMonth = now.subtract(1, 'month');\n        newRange = [lastMonth.startOf('month'), lastMonth.endOf('month')];\n        break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":85,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":85,"endColumn":50,"suggestions":[{"messageId":"addBrackets","fix":{"range":[3266,3393],"text":"{ const lastYear = now.subtract(1, 'year');\n        newRange = [lastYear.startOf('year'), lastYear.endOf('year')];\n        break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7772,7775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7772,7775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":252,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8659,8662],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8659,8662],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":268,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9220,9223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9220,9223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9805,9808],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9805,9808],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport { ArrowRight, ChevronDown, ChevronLeft, ChevronRight, CheckSquare } from 'lucide-react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Label, Tooltip } from 'recharts';\nimport { useMemo, useState, useRef, useEffect } from 'react';\nimport { useQueries } from '@tanstack/react-query';\nimport { DatePicker, ConfigProvider } from 'antd';\nimport dayjs, { Dayjs } from 'dayjs';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport quarterOfYear from 'dayjs/plugin/quarterOfYear';\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore';\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter';\n\ndayjs.extend(isoWeek);\ndayjs.extend(quarterOfYear);\ndayjs.extend(isSameOrBefore);\ndayjs.extend(isSameOrAfter);\nimport { useTasks } from '@/hooks/useTask';\nimport { useWorkspaces } from '@/hooks/useWorkspace';\nimport { getRequirementsByWorkspaceId } from '@/services/workspace';\n\nconst { RangePicker } = DatePicker;\n\nexport function ProgressWidget({ onNavigate }: { onNavigate?: (page: string) => void }) {\n  const [selectedRangeType, setSelectedRangeType] = useState<string>('this_month');\n  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(() => {\n    const now = dayjs();\n    return [now.startOf('month'), now.endOf('month')];\n  });\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n  const [calendarOpen, setCalendarOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Dayjs | null>(null);\n  const [endDate, setEndDate] = useState<Dayjs | null>(null);\n  const [currentMonth, setCurrentMonth] = useState<Dayjs>(dayjs());\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const calendarRef = useRef<HTMLDivElement>(null);\n\n  // Construct query string for tasks based on date range\n  const taskQueryString = useMemo(() => {\n    let query = \"limit=1000&skip=0\";\n    if (dateRange && dateRange[0] && dateRange[1]) {\n      query += `&start_date[start]=${dateRange[0].startOf('day').toISOString()}&start_date[end]=${dateRange[1].endOf('day').toISOString()}`;\n    }\n    return query;\n  }, [dateRange]);\n\n  // Handle Dropdown Selection\n  const handleRangeTypeChange = (value: string) => {\n    setSelectedRangeType(value);\n    setIsDropdownOpen(false);\n\n    if (value === 'custom') {\n      setCalendarOpen(true);\n      // If we already have a custom range, use it; otherwise reset\n      if (dateRange && dateRange[0] && dateRange[1]) {\n        setStartDate(dateRange[0]);\n        setEndDate(dateRange[1]);\n        setCurrentMonth(dateRange[0]);\n      } else {\n        setStartDate(null);\n        setEndDate(null);\n        setCurrentMonth(dayjs());\n      }\n      return;\n    }\n\n    setCalendarOpen(false);\n    const now = dayjs();\n    let newRange: [Dayjs, Dayjs] | null = null;\n\n    switch (value) {\n      case 'this_week':\n        newRange = [now.startOf('isoWeek'), now.endOf('isoWeek')];\n        break;\n      case 'this_month':\n        newRange = [now.startOf('month'), now.endOf('month')];\n        break;\n      case 'last_month':\n        const lastMonth = now.subtract(1, 'month');\n        newRange = [lastMonth.startOf('month'), lastMonth.endOf('month')];\n        break;\n      case 'this_year':\n        newRange = [now.startOf('year'), now.endOf('year')];\n        break;\n      case 'last_year':\n        const lastYear = now.subtract(1, 'year');\n        newRange = [lastYear.startOf('year'), lastYear.endOf('year')];\n        break;\n      default:\n        newRange = null;\n    }\n\n    if (newRange) {\n      setDateRange(newRange);\n    }\n  };\n\n  // Get display label for selected range\n  const getRangeLabel = () => {\n    if (selectedRangeType === 'custom') {\n      return getCustomRangeLabel();\n    }\n    switch (selectedRangeType) {\n      case 'this_week':\n        return 'This week';\n      case 'this_month':\n        return 'This month';\n      case 'last_month':\n        return 'Last Month';\n      case 'this_year':\n        return 'This Year';\n      case 'last_year':\n        return 'Last Year';\n      default:\n        return 'This week';\n    }\n  };\n\n  // Check if date is in selected range (for highlighting)\n  const isDateInRange = (date: Dayjs) => {\n    if (!startDate || !endDate) {\n      // If only start date is selected, don't highlight range yet\n      return false;\n    }\n    const start = startDate.isBefore(endDate) ? startDate : endDate;\n    const end = startDate.isBefore(endDate) ? endDate : startDate;\n    return date.isAfter(start.startOf('day')) && date.isBefore(end.endOf('day'));\n  };\n\n  // Check if date is start or end of range\n  const isDateStartOrEnd = (date: Dayjs) => {\n    if (!startDate || !endDate) {\n      // If only start date is selected, highlight it\n      if (startDate) {\n        return date.isSame(startDate, 'day');\n      }\n      return false;\n    }\n    return date.isSame(startDate, 'day') || date.isSame(endDate, 'day');\n  };\n\n  // Get calendar days for current month\n  const getCalendarDays = () => {\n    const start = currentMonth.startOf('month').startOf('week');\n    const end = currentMonth.endOf('month').endOf('week');\n    const days: Dayjs[] = [];\n    let current = start;\n    while (current.isSameOrBefore(end, 'day')) {\n      days.push(current);\n      current = current.add(1, 'day');\n    }\n    return days;\n  };\n\n  // Close dropdown and calendar when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsDropdownOpen(false);\n      }\n      // Close calendar when clicking outside - revert to previous selection\n      if (calendarRef.current && !calendarRef.current.contains(event.target as Node) && calendarOpen) {\n        // Revert startDate and endDate to current dateRange values\n        if (dateRange && dateRange[0] && dateRange[1]) {\n          setStartDate(dateRange[0]);\n          setEndDate(dateRange[1]);\n        } else {\n          setStartDate(null);\n          setEndDate(null);\n        }\n        setCalendarOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [calendarOpen, dateRange]);\n\n  // Handle Manual Date Selection (custom calendar)\n  const handleDateClick = (date: Dayjs) => {\n    if (!startDate || (startDate && endDate)) {\n      // First click or reset: set start date\n      setStartDate(date);\n      setEndDate(null);\n    } else if (startDate && !endDate) {\n      // Second click: set end date\n      let finalStart = startDate;\n      let finalEnd = date;\n\n      if (date.isBefore(startDate)) {\n        // If clicked date is before start, swap them\n        finalStart = date;\n        finalEnd = startDate;\n      }\n\n      // Set the range and close calendar\n      setStartDate(finalStart);\n      setEndDate(finalEnd);\n      setDateRange([finalStart, finalEnd]);\n      setSelectedRangeType('custom');\n      setCalendarOpen(false);\n    }\n  };\n\n  // Get display label for custom range\n  const getCustomRangeLabel = () => {\n    if (dateRange && dateRange[0] && dateRange[1]) {\n      return `${dateRange[0].format('MMM D')} - ${dateRange[1].format('MMM D')}`;\n    }\n    return 'Custom';\n  };\n\n  // Fetch all tasks\n  const { data: tasksData, isLoading: isLoadingTasks } = useTasks(taskQueryString);\n\n  // Fetch all workspaces to get requirements\n  const { data: workspacesData, isLoading: isLoadingWorkspaces } = useWorkspaces(\"\");\n\n  // Calculate task statistics\n  const taskData = useMemo(() => {\n    if (!tasksData?.result || isLoadingTasks) {\n      return { completed: 0, total: 0, percentage: 0, inProgress: 0, delayed: 0 };\n    }\n\n    const tasks = tasksData.result;\n    let completed = 0;\n    let inProgress = 0;\n    let delayed = 0;\n\n    tasks.forEach((task: any) => {\n      const status = task.status?.toLowerCase() || '';\n      // Task statuses: Assigned, In_Progress, Completed, Delayed, Impediment, Review, Stuck, New Task\n      if (status.includes('completed') || status === 'done') {\n        completed++;\n      } else if (status.includes('delayed') || status.includes('stuck') || status.includes('impediment') || status.includes('blocked')) {\n        delayed++;\n      } else {\n        // Default everything else (In Progress, Assigned, New Task, etc.) to In Progress\n        inProgress++;\n      }\n    });\n\n    const total = tasks.length;\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n\n    return { completed, total, percentage, inProgress, delayed };\n  }, [tasksData, isLoadingTasks]);\n\n  // Get all workspace IDs\n  const workspaceIds = useMemo(() => {\n    return workspacesData?.result?.workspaces?.map((w: any) => w.id) || [];\n  }, [workspacesData]);\n\n  // Fetch requirements for all workspaces in parallel\n  const requirementQueries = useQueries({\n    queries: workspaceIds.map((id: number) => ({\n      queryKey: ['requirements', id],\n      queryFn: () => getRequirementsByWorkspaceId(id),\n      enabled: !!id && workspaceIds.length > 0 && !isLoadingWorkspaces,\n    })),\n  });\n\n  const isLoadingRequirements = requirementQueries.some(q => q.isLoading);\n\n  // Combine all requirements from all workspaces\n  const allRequirements = useMemo(() => {\n    const combined: any[] = [];\n    requirementQueries.forEach((query) => {\n      if (query.data?.result && Array.isArray(query.data.result)) {\n        combined.push(...query.data.result);\n      }\n    });\n    return combined;\n  }, [requirementQueries]);\n\n  // Calculate requirements statistics\n  const requirementsData = useMemo(() => {\n    if (isLoadingRequirements || isLoadingWorkspaces) {\n      return { completed: 0, total: 0, percentage: 0, inProgress: 0, delayed: 0 };\n    }\n\n    let completed = 0;\n    let inProgress = 0;\n    let delayed = 0;\n    let total = 0;\n\n    allRequirements.forEach((req: any) => {\n      // Filter by date if range is selected\n      if (dateRange && dateRange[0] && dateRange[1]) {\n        // Use start_date for filtering requirements\n        const reqDate = req.start_date ? dayjs(req.start_date) : null;\n        if (!reqDate || reqDate.isBefore(dateRange[0].startOf('day')) || reqDate.isAfter(dateRange[1].endOf('day'))) {\n          return;\n        }\n      }\n\n      // Count this requirement in the total\n      total++;\n\n      const status = req.status?.toLowerCase() || '';\n      // Requirement statuses: Assigned, In_Progress, On_Hold, Submitted, Completed, Waiting, Rejected, Review, Revision, Impediment, Stuck\n      if (status.includes('completed')) {\n        completed++;\n      } else if (status.includes('stuck') || status.includes('impediment')) {\n        delayed++;\n      } else {\n        // Default everything else (In Progress, Assigned, etc.) to In Progress\n        inProgress++;\n      }\n    });\n\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n\n    return { completed, total, percentage, inProgress, delayed };\n  }, [allRequirements, isLoadingRequirements, isLoadingWorkspaces, dateRange]);\n\n  const isLoading = isLoadingTasks || isLoadingWorkspaces || isLoadingRequirements;\n\n  return (\n    <div className=\"bg-white rounded-[24px] p-5 w-full h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-1.5\">\n        <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Progress</h3>\n        <div className=\"relative\" ref={dropdownRef}>\n          {/* Custom Dropdown Button */}\n          <button\n            onClick={() => setIsDropdownOpen(!isDropdownOpen)}\n            className=\"flex items-center gap-2 px-4 py-2 bg-white border border-[#E5E5E5] rounded-full hover:border-[#CCCCCC] transition-colors\"\n          >\n            <span className=\"font-['Manrope:Regular',sans-serif] text-[14px] text-[#111111]\">\n              {getRangeLabel()}\n            </span>\n            <ChevronDown className=\"w-4 h-4 text-[#111111]\" />\n          </button>\n\n          {/* Dropdown Menu */}\n          {isDropdownOpen && (\n            <div className=\"absolute top-full right-0 mt-2 bg-white border border-[#EEEEEE] rounded-[12px] shadow-lg z-50 min-w-[160px] overflow-hidden\">\n              {[\n                { value: 'this_week', label: 'This week' },\n                { value: 'this_month', label: 'This month' },\n                { value: 'last_month', label: 'Last Month' },\n                { value: 'this_year', label: 'This Year' },\n                { value: 'last_year', label: 'Last Year' },\n                { value: 'custom', label: 'Custom' },\n              ].map((option) => (\n                <button\n                  key={option.value}\n                  onClick={() => handleRangeTypeChange(option.value)}\n                  className=\"w-full text-left px-3 py-2.5 font-['Manrope:Regular',sans-serif] text-[14px] text-[#111111] hover:bg-[#F7F7F7] transition-colors flex items-center justify-between\"\n                >\n                  <span>{option.label}</span>\n                  {selectedRangeType === option.value && (\n                    <CheckSquare className=\"w-4 h-4 text-[#ff3b3b] flex-shrink-0\" />\n                  )}\n                </button>\n              ))}\n            </div>\n          )}\n\n          {/* Custom Calendar Popup - Single Calendar */}\n          {calendarOpen && (\n            <div className=\"absolute top-full right-0 mt-2 bg-white border border-[#EEEEEE] rounded-[12px] shadow-lg z-50 w-[280px] p-3\" ref={calendarRef}>\n              {/* Select Range Header */}\n              <div className=\"flex items-center gap-2 mb-3\">\n                <button\n                  onClick={() => {\n                    setCalendarOpen(false);\n                    setIsDropdownOpen(false);\n                  }}\n                  className=\"w-5 h-5 flex items-center justify-center hover:bg-[#F7F7F7] rounded transition-colors\"\n                >\n                  <ChevronLeft className=\"w-3.5 h-3.5 text-[#666666]\" />\n                </button>\n                <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111]\">\n                  Select Range\n                </h4>\n              </div>\n\n              {/* Month Navigation */}\n              <div className=\"flex items-center justify-between mb-3\">\n                <button\n                  onClick={() => setCurrentMonth(currentMonth.subtract(1, 'month'))}\n                  className=\"w-7 h-7 rounded-lg bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-colors\"\n                >\n                  <ChevronLeft className=\"w-3.5 h-3.5 text-[#111111]\" />\n                </button>\n                <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111]\">\n                  {currentMonth.format('MMMM YYYY')}\n                </h4>\n                <button\n                  onClick={() => setCurrentMonth(currentMonth.add(1, 'month'))}\n                  className=\"w-7 h-7 rounded-lg bg-[#F7F7F7] hover:bg-[#EEEEEE] flex items-center justify-center transition-colors\"\n                >\n                  <ChevronRight className=\"w-3.5 h-3.5 text-[#111111]\" />\n                </button>\n              </div>\n\n              {/* Day Headers */}\n              <div className=\"grid grid-cols-7 gap-0.5 mb-1.5\">\n                {['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].map((day) => (\n                  <div key={day} className=\"text-center text-[11px] font-['Manrope:Regular',sans-serif] text-[#999999] py-0.5\">\n                    {day}\n                  </div>\n                ))}\n              </div>\n\n              {/* Calendar Grid */}\n              <div className=\"grid grid-cols-7 gap-0.5\">\n                {getCalendarDays().map((date, index) => {\n                  const isCurrentMonth = date.month() === currentMonth.month();\n                  const isInRange = isDateInRange(date);\n                  const isStartOrEnd = isDateStartOrEnd(date);\n\n                  return (\n                    <button\n                      key={index}\n                      onClick={() => handleDateClick(date)}\n                      className={`\n                        w-8 h-8 rounded-lg text-[12px] font-['Manrope:Regular',sans-serif] transition-colors\n                        ${!isCurrentMonth ? 'text-[#CCCCCC]' : 'text-[#111111]'}\n                        ${isStartOrEnd\n                          ? 'bg-[#111111] text-white'\n                          : isInRange\n                            ? 'bg-[#F7F7F7]'\n                            : 'hover:bg-[#F7F7F7]'\n                        }\n                      `}\n                    >\n                      {date.date()}\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Sub-cards Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1 mt-2\">\n        <ProgressCard\n          title=\"Requirements\"\n          data={requirementsData}\n          isLoading={isLoading}\n          dateRangeLabel={getRangeLabel()}\n          onClick={() => onNavigate && onNavigate('requirements')}\n          onStatusClick={(status: string) => {\n            if (onNavigate) {\n              // Map status to requirements page tab\n              let tab = 'active'; // Default to active tab\n              if (status === 'Completed') {\n                tab = 'completed';\n              } else if (status === 'In Progress') {\n                tab = 'active';\n              } else if (status === 'Delayed') {\n                tab = 'active'; // Delayed is part of active tab\n              }\n              onNavigate(`requirements?tab=${tab}`);\n            }\n          }}\n        />\n\n        <ProgressCard\n          title=\"Tasks\"\n          data={taskData}\n          isLoading={isLoading}\n          dateRangeLabel={getRangeLabel()}\n          onClick={() => onNavigate && onNavigate('tasks')}\n          onStatusClick={(status: string) => {\n            if (onNavigate) {\n              // Map status to tasks page tab\n              let tab = 'all';\n              if (status === 'In Progress') {\n                tab = 'In_Progress';\n              } else if (status === 'Completed') {\n                tab = 'Completed';\n              } else if (status === 'Delayed') {\n                tab = 'Delayed';\n              }\n              onNavigate(`tasks?tab=${tab}`);\n            }\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\ninterface ProgressCardProps {\n  title: string;\n  data: {\n    completed: number;\n    total: number;\n    percentage: number;\n    inProgress: number;\n    delayed: number;\n  };\n  isLoading?: boolean;\n  dateRangeLabel?: string;\n  onClick?: () => void;\n  onStatusClick?: (status: string) => void;\n}\n\nfunction ProgressCard({ title, data, isLoading = false, dateRangeLabel = 'this period', onClick, onStatusClick }: ProgressCardProps) {\n  const chartData = [\n    { name: 'Completed', value: data.completed, color: '#0F9D58' },   // Green - matches reference\n    { name: 'In Progress', value: data.inProgress, color: '#2F80ED' }, // Blue - matches reference\n    { name: 'Delayed', value: data.delayed, color: '#ff3b3b' },      // Red - matches reference\n  ];\n\n  // Filter out zero values for the chart only\n  const activeData = chartData.filter(d => d.value > 0);\n\n  // Data to render: if total is 0, use a placeholder ring\n  const renderData = data.total === 0\n    ? [{ name: 'Empty', value: 1, color: '#f3f4f6' }]\n    : activeData;\n\n  if (isLoading) {\n    return (\n      <div className=\"group relative flex flex-col bg-white rounded-[20px] border border-gray-100 p-5 h-full overflow-hidden\">\n        <div className=\"flex items-center justify-between mb-4 z-10 shrink-0\">\n          <h4 className=\"font-['Manrope',sans-serif] font-semibold text-[16px] text-[#111111]\">{title}</h4>\n        </div>\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-[13px] text-[#666666] font-['Manrope',sans-serif]\">Loading...</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"group relative flex flex-col bg-white rounded-[20px] border border-gray-100 p-4 hover:shadow-lg hover:border-[#ff3b3b]/10 transition-all duration-300 cursor-pointer h-full\"\n      onClick={onClick}\n    >\n      {/* Card Header */}\n      <div className=\"flex items-center justify-between mb-3 z-10 shrink-0\">\n        <h4 className=\"font-['Manrope',sans-serif] font-semibold text-[16px] text-[#111111]\">{title}</h4>\n        <div className=\"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center group-hover:bg-[#ff3b3b] transition-colors duration-300\">\n          <ArrowRight className=\"w-4 h-4 text-gray-400 group-hover:text-white transition-colors duration-300\" />\n        </div>\n      </div>\n\n      {/* Content Container - Side by Side Layout */}\n      <div className=\"flex-1 flex items-center gap-5 min-h-[140px] px-2\">\n        {/* Chart Section */}\n        <div className=\"relative w-[130px] h-[130px] shrink-0\">\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\n            <PieChart margin={{ top: 0, right: 0, bottom: 0, left: 0 }}>\n              <Pie\n                data={renderData}\n                cx=\"50%\"\n                cy=\"50%\"\n                innerRadius={45}\n                outerRadius={60}\n                paddingAngle={data.total === 0 ? 0 : 4}\n                cornerRadius={data.total === 0 ? 0 : 4}\n                dataKey=\"value\"\n                stroke=\"#ffffff\"\n                strokeWidth={2}\n                isAnimationActive={false}\n              >\n                {renderData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={entry.color} />\n                ))}\n                <Label\n                  content={({ viewBox }) => {\n                    if (viewBox && \"cx\" in viewBox && \"cy\" in viewBox) {\n                      // If total is 0, show a message instead of \"0 Total\"\n                      if (data.total === 0) {\n                        const itemType = title.toLowerCase();\n                        // Create a more readable message based on date range\n                        let periodText = (dateRangeLabel || 'this period').toLowerCase();\n                        // Handle custom date ranges (format: \"MMM D - MMM D\")\n                        if (periodText.includes(' - ')) {\n                          periodText = 'this period';\n                        }\n                        return (\n                          <text\n                            x={viewBox.cx}\n                            y={viewBox.cy}\n                            textAnchor=\"middle\"\n                            dominantBaseline=\"middle\"\n                          >\n                            <tspan\n                              x={viewBox.cx}\n                              y={(viewBox.cy || 0) - 8}\n                              className=\"fill-[#666666] text-[10px] font-medium font-['Manrope',sans-serif]\"\n                            >\n                              No {itemType}\n                            </tspan>\n                            <tspan\n                              x={viewBox.cx}\n                              y={(viewBox.cy || 0) + 8}\n                              className=\"fill-[#666666] text-[10px] font-medium font-['Manrope',sans-serif]\"\n                            >\n                              {periodText}\n                            </tspan>\n                          </text>\n                        );\n                      }\n\n                      // Otherwise show the total number\n                      return (\n                        <text\n                          x={viewBox.cx}\n                          y={viewBox.cy}\n                          textAnchor=\"middle\"\n                          dominantBaseline=\"middle\"\n                        >\n                          <tspan\n                            x={viewBox.cx}\n                            y={viewBox.cy}\n                            className=\"fill-[#111111] text-3xl font-extrabold font-['Manrope',sans-serif] tracking-tight\"\n                          >\n                            {data.total || 0}\n                          </tspan>\n                          <tspan\n                            x={viewBox.cx}\n                            y={(viewBox.cy || 0) + 20}\n                            className=\"fill-[#999999] text-[11px] font-semibold font-['Manrope',sans-serif] uppercase tracking-wider\"\n                          >\n                            Total\n                          </tspan>\n                        </text>\n                      );\n                    }\n                    return null;\n                  }}\n                />\n              </Pie>\n            </PieChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Legend / Stats Section */}\n        <div className=\"flex-1 flex flex-col justify-center\">\n          {chartData.map((item) => (\n            <div\n              key={item.name}\n              onClick={(e) => {\n                e.stopPropagation();\n                if (onStatusClick) {\n                  onStatusClick(item.name);\n                }\n              }}\n              className={`flex items-center justify-between w-full py-2 border-b border-gray-50 last:border-0 group/item transition-colors rounded-lg px-2 -mx-2 ${onStatusClick\n                  ? 'hover:bg-gray-50/50 cursor-pointer'\n                  : 'cursor-default'\n                } ${item.value === 0 ? 'opacity-60' : ''}`}\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-2 h-2 rounded-full shrink-0 ring-2 ring-white shadow-sm\" style={{ backgroundColor: item.color }} />\n                <span className={`text-[13px] font-medium font-['Manrope',sans-serif] whitespace-nowrap group-hover/item:text-[#111111] transition-colors ${item.value > 0 ? 'text-[#111111]' : 'text-[#666666]'\n                  }`}>\n                  {item.name === 'In Progress' ? 'In Progress' : item.name}\n                </span>\n              </div>\n              <span className={`text-[16px] font-bold font-['Manrope',sans-serif] ${item.value > 0 ? 'text-[#111111]' : 'text-[#666666]'\n                }`}>\n                {item.value || 0}\n              </span>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/TimerWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/dashboard/TodoWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/CalendarEventPopup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/CalendarPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":3,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":59},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Spin' is defined but never used.","line":8,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Avatar' is defined but never used.","line":8,"column":77,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tooltip' is defined but never used.","line":8,"column":85,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":92},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":49,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4344,4347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4344,4347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4363,4366],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4363,4366],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":114,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":114,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":175,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":175,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7493,7496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7493,7496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":199,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":199,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8665,8668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8665,8668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":255,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10599,10602],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10599,10602],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":277,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11487,11490],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11487,11490],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":373,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":373,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15021,15024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15021,15024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":396,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":396,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15773,15776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15773,15776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":668,"column":216,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":668,"endColumn":219,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33601,33604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33601,33604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":674,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":674,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33854,33857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33854,33857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":711,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":711,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35650,35653],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35650,35653],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useMemo, useEffect, useCallback, useRef } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { ChevronLeft, ChevronRight, Calendar as CalendarIcon, Clock, MapPin, Video, X } from 'lucide-react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { Popover, Spin, Tag, Button, Modal, Input, Select, DatePicker, App, Avatar, Tooltip, Segmented, Radio } from 'antd';\nimport dayjs from 'dayjs';\nimport utc from 'dayjs/plugin/utc';\nimport timezone from 'dayjs/plugin/timezone';\nimport weekOfYear from 'dayjs/plugin/weekOfYear';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\n\ndayjs.extend(utc);\ndayjs.extend(timezone);\ndayjs.extend(timezone);\ndayjs.extend(weekOfYear);\ndayjs.extend(customParseFormat);\n\nimport { useTasks } from '@/hooks/useTask';\nimport { useMeetings } from '@/hooks/useMeeting';\nimport { useLeaves, useApplyForLeave, useCompanyLeaves } from '@/hooks/useLeave';\nimport { useTeamsConnectionStatus, useCalendarEvents } from '@/hooks/useCalendar';\nimport { usePublicHolidays } from '@/hooks/useHoliday';\nimport { MicrosoftUserOAuth, createCalendarEvent, CreateEventPayload, GraphEvent } from '@/services/calendar';\nimport { useEmployees, useCurrentUserCompany, useUserDetails } from '@/hooks/useUser';\n// import { TaskType } from '@/services/task'; // Removed to avoid confusion\nimport { MeetingType } from '@/services/meeting';\nimport { LeaveType } from '@/services/leave';\nimport { Holiday, Task } from '@/types/domain';\n\nimport { MonthView } from './MonthView';\nimport { WeekView } from './WeekView';\nimport { DayView } from './DayView';\nimport { CalendarEventPopup } from './CalendarEventPopup';\nimport { CalendarEvent } from './types';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\ninterface Attendee {\n  email: string;\n  name?: string;\n}\n\nexport function CalendarPage() {\n  const { message } = App.useApp();\n  const router = useRouter();\n  \n  const [activeView, setActiveView] = useTabSync<'month' | 'week' | 'day'>({\n    defaultTab: 'month',\n    validTabs: ['month', 'week', 'day']\n  });\n\n  const [currentDate, setCurrentDate] = useState(dayjs());\n  const [selectedDate, setSelectedDate] = useState<string | null>(dayjs().format('YYYY-MM-DD'));\n  const [connecting, setConnecting] = useState(false);\n  const [showEventDialog, setShowEventDialog] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const [eventType, setEventType] = useState<'event' | 'leave'>('event');\n\n  // Fetch employees for autocomplete\n  const { data: employeesData } = useEmployees(showEventDialog ? 'limit=100' : '');\n\n  // Get company timezone\n  const { data: companyData } = useCurrentUserCompany();\n  const companyTimeZone = companyData?.result?.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone || \"UTC\";\n\n  // Fetch calendar events\n  const startISO = currentDate.startOf('month').subtract(7, 'day').toISOString();\n  const endISO = currentDate.endOf('month').add(7, 'day').toISOString();\n  \n  const { data: calendarEventsData, refetch: refetchCalendarEvents } = useCalendarEvents(startISO, endISO);\n\n  const [formData, setFormData] = useState({\n    title: '',\n    startDateTime: null as dayjs.Dayjs | null,\n    endDateTime: null as dayjs.Dayjs | null,\n    duration: '',\n    customTime: '',\n    attendees: [] as Attendee[],\n    description: '',\n    leaveType: undefined as string | undefined,\n    dayType: 'Full Day'\n  });\n\n  const { data: tasks, isLoading: isLoadingTasks } = useTasks();\n  const { data: meetings, isLoading: isLoadingMeetings } = useMeetings();\n  const { data: leaves, isLoading: isLoadingLeaves } = useLeaves();\n  const { data: holidays, isLoading: isLoadingHolidays } = usePublicHolidays();\n  const { data: teamsStatus, isLoading: isLoadingTeamsStatus, refetch: refetchTeamsStatus } = useTeamsConnectionStatus();\n  const { data: leavesData } = useCompanyLeaves();\n  const applyLeaveMutation = useApplyForLeave();\n\n  const isLoading = isLoadingTasks || isLoadingMeetings || isLoadingLeaves || isLoadingHolidays;\n  const isConnected = teamsStatus?.result?.connected ?? false;\n\n  const availableLeaveTypes = useMemo((): string[] => {\n    if (!leavesData?.result) return ['Sick Leave', 'Casual Leave', 'Vacation'];\n    const types = new Set((leavesData.result as any[]).map((leave: any) => leave.leave_type)); // leavesData type might be generic, casting to any[] for map if needed or strictly typing if possible. Assuming leavesData result is generic array.\n    return Array.from(types).filter(Boolean).length > 0\n      ? Array.from(types).filter((t): t is string => Boolean(t))\n      : ['Sick Leave', 'Casual Leave', 'Vacation'];\n  }, [leavesData]);\n\n  const connectToTeams = useCallback(async () => {\n    try {\n      setConnecting(true);\n      const response = await MicrosoftUserOAuth();\n      if (response?.result) {\n        window.location.href = response.result;\n      }\n    } catch (error) {\n      message.error(\"Failed to connect to Microsoft Teams\");\n    } finally {\n      setConnecting(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    refetchTeamsStatus();\n  }, [refetchTeamsStatus]);\n\n  const handleCancel = () => {\n      setShowEventDialog(false);\n      setFormData({ \n          title: '', \n          startDateTime: null, \n          endDateTime: null,\n          duration: '', \n          customTime: '', \n          attendees: [], \n          description: '',\n          leaveType: undefined,\n          dayType: 'Full Day'\n      });\n      setEventType('event');\n  };\n\n  const handleCreate = useCallback(async () => {\n    if (eventType === 'event') {\n        if (!formData.title.trim()) { message.error(\"Title is required\"); return; }\n        if (!formData.startDateTime) { message.error(\"Start Date & Time is required\"); return; }\n        if (!formData.duration && !formData.customTime) { message.error(\"Please select a duration or enter custom time\"); return; }\n        \n        try {\n            setSubmitting(true);\n            let endTime: dayjs.Dayjs;\n            if (formData.customTime) {\n              const [hours, minutes] = formData.customTime.split(':').map(Number);\n              endTime = formData.startDateTime.hour(hours).minute(minutes || 0);\n            } else {\n              const durationMap: Record<string, number> = {\n                '30 mins': 30, '45 mins': 45, '1 hour': 60, '1.5 hours': 90, '2 hours': 120,\n              };\n              const minutes = durationMap[formData.duration] || 60;\n              endTime = formData.startDateTime.add(minutes, 'minute');\n            }\n\n            const payload: CreateEventPayload = {\n              subject: formData.title.trim(),\n              start: { dateTime: formData.startDateTime.toISOString(), timeZone: companyTimeZone },\n              end: { dateTime: endTime.toISOString(), timeZone: companyTimeZone },\n              body: { contentType: \"HTML\", content: formData.description?.trim() ? formData.description : \"<p>Microsoft Teams meeting</p>\" },\n              attendees: formData.attendees.filter((a) => !!a.email).map((a) => ({ emailAddress: { address: a.email, name: a.name }, type: \"required\" as const })),\n              isOnlineMeeting: true,\n              onlineMeetingProvider: \"teamsForBusiness\",\n            };\n\n            await createCalendarEvent(payload);\n            message.success(\"Event created successfully!\");\n            handleCancel();\n            await refetchCalendarEvents();\n        } catch (error: any) {\n            const errorMessage = error?.response?.data?.message || \"Failed to create event\";\n            message.error(errorMessage);\n        } finally {\n            setSubmitting(false);\n        }\n    } else {\n        if (!formData.leaveType) { message.error(\"Leave Type is required\"); return; }\n        if (!formData.startDateTime) { message.error(\"Start Date is required\"); return; }\n        // For leaves, endDateTime defaults to startDateTime if missing usually, but let's enforce it\n        if (!formData.endDateTime) { message.error(\"End Date is required\"); return; }\n        if (!formData.description) { message.error(\"Reason is required\"); return; }\n\n        try {\n            setSubmitting(true);\n            await applyLeaveMutation.mutateAsync({\n                start_date: formData.startDateTime.format('YYYY-MM-DD'),\n                end_date: formData.endDateTime.format('YYYY-MM-DD'),\n                day_type: formData.dayType,\n                leave_type: formData.leaveType,\n                reason: formData.description\n            });\n            message.success(\"Leave applied successfully!\");\n            handleCancel();\n        } catch (error: any) {\n             // Error already handled generally\n        } finally {\n            setSubmitting(false);\n        }\n    }\n  }, [formData, eventType, companyTimeZone, refetchCalendarEvents, applyLeaveMutation]);\n\n\n  const handleTimeSlotClick = useCallback((dateTime: dayjs.Dayjs) => {\n    console.log('handleTimeSlotClick triggered:', dateTime.format('YYYY-MM-DD HH:mm'));\n    setFormData(prev => ({ \n        ...prev, \n        startDateTime: dateTime, \n        endDateTime: dateTime, \n        duration: '1 hour' \n    }));\n    setEventType('event');\n    setShowEventDialog(true);\n  }, []);\n\n  const events = useMemo(() => {\n    const allEvents: CalendarEvent[] = [];\n    const calendarEvents = calendarEventsData?.result;\n\n    if (tasks?.result) {\n      tasks.result.forEach((task: Task) => {\n        if (task.dueDate) {\n            allEvents.push({\n                id: `task-${task.id}`,\n                title: task.title || task.name || 'Untitled',\n                date: dayjs(task.dueDate).format('YYYY-MM-DD'),\n                time: 'Deadline',\n                type: 'deadline',\n                description: task.description,\n                status: task.status,\n                color: '#ff3b3b',\n                raw: task\n            });\n        }\n      });\n    }\n\n    if (calendarEvents) {\n      (calendarEvents as GraphEvent[]).forEach((event: GraphEvent) => {\n        if (event.isCancelled) return;\n        const startTime = dayjs.utc(event.start.dateTime).tz(companyTimeZone);\n        allEvents.push({\n          id: `calendar-event-${event.id}`,\n          title: event.subject || 'Untitled Meeting',\n          date: startTime.format('YYYY-MM-DD'),\n          time: startTime.format('h:mm A'),\n          type: 'meeting',\n          location: event.isOnlineMeeting ? 'Microsoft Teams' : undefined,\n          description: event.body?.content || '',\n          status: 'scheduled',\n          participants: event.attendees?.map((a: any) => ({\n            name: a.emailAddress?.name || a.emailAddress?.address?.split('@')[0] || 'Unknown',\n            avatar: undefined\n          })),\n          color: '#3B82F6',\n          startDateTime: startTime, // Pass the timezone-converted Dayjs object\n          raw: event\n        });\n      });\n    }\n\n    if (meetings?.result && (!calendarEvents || calendarEvents.length === 0)) {\n      meetings.result.forEach((meeting: MeetingType) => {\n        allEvents.push({\n          id: `meeting-${meeting.id}`,\n          title: meeting.title,\n          date: dayjs(meeting.start_time).format('YYYY-MM-DD'),\n          time: dayjs(meeting.start_time).format('h:mm A'),\n          type: 'meeting',\n          location: meeting.platform || meeting.meeting_link,\n          description: meeting.description,\n          status: meeting.status,\n          participants: meeting.participants?.map((p: any) => ({ name: p.name || 'Unknown', avatar: p.avatar })), // meeting participants typed as unknown[] in service. keeping any cast or refining if possible. defining strictly:\n          // We can try to cast p as {name: string, avatar: string} if we trust backend\n          color: '#3B82F6',\n          raw: meeting\n        });\n      });\n    }\n\n    if (leaves?.result) {\n      leaves.result.forEach((leave: LeaveType) => {\n        const start = dayjs(leave.start_date);\n        const end = dayjs(leave.end_date);\n        const diff = end.diff(start, 'day');\n        for (let i = 0; i <= diff; i++) {\n          const date = start.add(i, 'day').format('YYYY-MM-DD');\n          allEvents.push({\n            id: `leave-${leave.id}-${i}`,\n            title: `${leave.user?.name || 'Employee'} - ${leave.leave_type} Leave`,\n            date: date,\n            time: 'All Day',\n            type: 'leave',\n            description: leave.reason,\n            status: leave.status,\n            color: '#f59e0b',\n            raw: leave\n          });\n        }\n      });\n    }\n\n    if (holidays?.result) {\n      holidays.result.forEach((holiday: Holiday) => {\n        if (holiday.is_deleted) return;\n        allEvents.push({\n          id: `holiday-${holiday.id}`,\n          title: holiday.name,\n          date: dayjs(holiday.date).format('YYYY-MM-DD'),\n          time: 'All Day',\n          type: 'holiday',\n          description: `Public Holiday: ${holiday.name}`,\n          status: 'holiday',\n          color: '#8b5cf6',\n          raw: holiday\n        });\n      });\n    }\n\n    return allEvents;\n  }, [tasks, meetings, leaves, calendarEventsData, holidays, companyTimeZone]);\n\n  const handlePrev = () => {\n      if (activeView === 'month') setCurrentDate(currentDate.subtract(1, 'month'));\n      else if (activeView === 'week') setCurrentDate(currentDate.subtract(1, 'week'));\n      else setCurrentDate(currentDate.subtract(1, 'day'));\n  };\n\n  const handleNext = () => {\n      if (activeView === 'month') setCurrentDate(currentDate.add(1, 'month'));\n      else if (activeView === 'week') setCurrentDate(currentDate.add(1, 'week'));\n      else setCurrentDate(currentDate.add(1, 'day'));\n  };\n\n  const handleToday = () => {\n    setCurrentDate(dayjs());\n    setSelectedDate(dayjs().format('YYYY-MM-DD'));\n  };\n\n  const dateLabel = useMemo(() => {\n      if (activeView === 'month') return currentDate.format('MMMM YYYY');\n      if (activeView === 'week') {\n          const start = currentDate.startOf('week');\n          const end = currentDate.endOf('week');\n          if (start.month() === end.month()) {\n              return `${start.format('MMM D')} - ${end.format('D, YYYY')}`;\n          } else {\n              if (start.year() === end.year()) {\n                  return `${start.format('MMM D')} - ${end.format('MMM D, YYYY')}`;\n              }\n              return `${start.format('MMM D, YYYY')} - ${end.format('MMM D, YYYY')}`;\n          }\n      }\n      return currentDate.format('MMMM D, YYYY');\n  }, [currentDate, activeView]);\n\n  // Fetch current user details for leave filtering\n  const { data: userDetails } = useUserDetails();\n  const currentUserId = userDetails?.result?.id;\n\n  const todayEvents = events.filter(e => e.date === dayjs().format('YYYY-MM-DD'));\n  const upcomingEvents = useMemo(() => {\n    return events\n      .filter(e => {\n        const isFuture = dayjs(e.date).isAfter(dayjs(), 'day');\n        if (!isFuture) return false;\n\n        if (e.type === 'meeting') return true;\n        if (e.type === 'leave') return (e.raw as any).user_id === currentUserId;\n        if (e.type === 'holiday') {\n          const eventDate = dayjs(e.date);\n          const now = dayjs();\n          return eventDate.month() === now.month() && eventDate.year() === now.year();\n        }\n        \n        // Exclude others (tasks/deadlines) based on request \"only show...\"\n        return false;\n      })\n      .sort((a, b) => dayjs(a.date).valueOf() - dayjs(b.date).valueOf())\n      .slice(0, 10);\n  }, [events, currentUserId]);\n\n  return (\n    <PageLayout\n      title=\"Calendar\"\n      tabs={[\n        { id: 'month', label: 'Month' },\n        { id: 'week', label: 'Week' },\n        { id: 'day', label: 'Day' }\n      ]}\n      activeTab={activeView}\n      onTabChange={(tabId) => setActiveView(tabId as any)}\n      titleAction={{ onClick: () => { setShowEventDialog(true); setEventType('event'); } }}\n      action={\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <button \n              onClick={handleToday} \n              className=\"h-9 px-4 rounded-[8px] border border-[#EEEEEE] flex items-center justify-center hover:bg-[#F7F7F7] transition-colors font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] focus:ring-2 focus:ring-[#111111] focus:outline-none\"\n            >\n              Today\n            </button>\n            <button onClick={handlePrev} className=\"w-9 h-9 rounded-[8px] border border-[#EEEEEE] flex items-center justify-center hover:bg-[#F7F7F7] transition-colors focus:ring-2 focus:ring-[#111111] focus:outline-none\">\n              <ChevronLeft className=\"w-4 h-4 text-[#666666]\" />\n            </button>\n            <div className=\"px-4 py-2 bg-[#F7F7F7] rounded-[8px] border border-[#EEEEEE]\" role=\"status\">\n              <span className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111]\">\n                {dateLabel}\n              </span>\n            </div>\n            <button onClick={handleNext} className=\"w-9 h-9 rounded-[8px] border border-[#EEEEEE] flex items-center justify-center hover:bg-[#F7F7F7] transition-colors focus:ring-2 focus:ring-[#111111] focus:outline-none\">\n              <ChevronRight className=\"w-4 h-4 text-[#666666]\" />\n            </button>\n          </div>\n          {!isLoadingTeamsStatus && (\n            <>\n              {isConnected ? (\n                <Tag color=\"green\" className=\"m-0 font-['Manrope:SemiBold',sans-serif] text-[12px]\">Connected to Teams</Tag>\n              ) : (\n                <Button type=\"primary\" icon={<Video className=\"w-4 h-4\" />} loading={connecting} onClick={connectToTeams} className=\"h-9 px-4 text-[13px] font-['Manrope:SemiBold',sans-serif] bg-[#111111] hover:bg-[#000000]/90 border-none\">Connect to Teams</Button>\n              )}\n            </>\n          )}\n        </div>\n      }\n    >\n      <div className=\"flex flex-col h-full\"> \n        <div className=\"flex-1 grid grid-cols-[1fr_280px] gap-6 overflow-hidden min-h-0\">\n          \n          <div className=\"overflow-hidden h-full flex flex-col\">\n              {activeView === 'month' && (\n                  <MonthView\n                      currentDate={currentDate}\n                      events={events}\n                      isLoading={isLoading}\n                      selectedDate={selectedDate}\n                      onSelectDate={setSelectedDate}\n                  />\n              )}\n              {activeView === 'week' && (\n                  <WeekView \n                      currentDate={currentDate}\n                      events={events}\n                      isLoading={isLoading}\n                      onTimeSlotClick={handleTimeSlotClick}\n                  />\n              )}\n              {activeView === 'day' && (\n                  <DayView\n                      currentDate={currentDate}\n                      events={events}\n                      isLoading={isLoading}\n                      onTimeSlotClick={handleTimeSlotClick}\n                  />\n              )}\n\n          </div>\n\n          <div className=\"flex flex-col gap-4 overflow-y-auto scrollbar-hide\">\n            {/* Today's Events */}\n            <div className=\"bg-[#F7F7F7] rounded-[16px] p-5\">\n              <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-4\">\n                Today&apos;s Events\n              </h4>\n              <div className=\"space-y-3\">\n                {todayEvents.length > 0 ? (\n                  todayEvents.map((event) => (\n                    <Popover key={event.id} content={<CalendarEventPopup event={event} />} title=\"\" trigger=\"click\" placement=\"left\">\n                      <div className=\"bg-white rounded-[12px] p-4 border border-[#EEEEEE] cursor-pointer hover:shadow-md transition-shadow\">\n                        <div className=\"flex items-start gap-3\">\n                          <div className=\"w-1 h-full rounded-full mt-1\" style={{ backgroundColor: event.color }} />\n                          <div className=\"flex-1\">\n                            <div className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] mb-1\">{event.title}</div>\n                            <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] mb-2\">\n                              <Clock className=\"w-3 h-3\" />\n                              {event.time}\n                            </div>\n                            {event.location && (\n                              <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                                <MapPin className=\"w-3 h-3\" />\n                                {event.location}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </Popover>\n                  ))\n                ) : (\n                  <div className=\"text-center py-6 text-[13px] font-['Manrope:Regular',sans-serif] text-[#999999]\">\n                    No events today\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Upcoming Events */}\n            <div className=\"bg-[#F7F7F7] rounded-[16px] p-5 min-h-[300px]\">\n              <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-4\">Upcoming</h4>\n              <div className=\"space-y-3\">\n                {upcomingEvents.length > 0 ? (upcomingEvents.map((event) => (\n                   <Popover key={event.id} content={<CalendarEventPopup event={event} />} title=\"\" trigger=\"click\" placement=\"left\">\n                    <div key={event.id} className=\"bg-white rounded-[12px] p-4 border border-[#EEEEEE] cursor-pointer hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-start gap-3\">\n                        <div className=\"w-1 h-full rounded-full mt-1\" style={{ backgroundColor: event.color }} />\n                        <div className=\"flex-1\">\n                          <div className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] mb-1\">{event.title}</div>\n                          <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                            <CalendarIcon className=\"w-3 h-3\" />\n                            {event.endDate ? (\n                              dayjs(event.date).month() === dayjs(event.endDate).month() ?\n                                `${dayjs(event.date).format('MMM D')} - ${dayjs(event.endDate).format('D')}` :\n                                `${dayjs(event.date).format('MMM D')} - ${dayjs(event.endDate).format('MMM D')}`\n                            ) : (\n                              dayjs(event.date).format('MMM D')\n                            )} • {event.time}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </Popover>\n                ))) : (\n                  <div className=\"text-center py-6 text-[13px] font-['Manrope:Regular',sans-serif] text-[#999999]\">No upcoming events</div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        title={null}\n        open={showEventDialog}\n        onCancel={handleCancel}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        closeIcon={<X className=\"w-5 h-5 text-[#666666]\" />}\n        styles={{ body: { padding: 0 } }}\n      >\n        <div className=\"flex flex-col h-full bg-white\">\n          <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n                 <div className=\"flex items-center gap-2 text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                    <div className=\"p-2 rounded-full bg-[#F7F7F7]\">\n                        <CalendarIcon className=\"w-5 h-5 text-[#666666]\" />\n                    </div>\n                    {eventType === 'event' ? 'Create Event' : 'Apply Leave'}\n                </div>\n                <Segmented\n                    options={[\n                        { label: 'Event', value: 'event' },\n                        { label: 'Leave', value: 'leave' }\n                    ]}\n                    value={eventType}\n                    onChange={(val) => setEventType(val as 'event' | 'leave')}\n                    className=\"bg-[#F7F7F7] p-1 rounded-lg\"\n                />\n            </div>\n            <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-11\">\n                {eventType === 'event' \n                    ? 'Schedule a new meeting or event with your team.' \n                    : 'Apply for leave request to your manager.'}\n            </p>\n          </div>\n          \n          <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n            <div className=\"space-y-5\">\n              \n              {eventType === 'event' ? (\n                  <>\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Title</span>\n                        <Input placeholder=\"Event title\" className={`h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.title ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.title} onChange={(e) => setFormData({ ...formData, title: e.target.value })} />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Start Date & Time</span>\n                        <DatePicker showTime format=\"YYYY-MM-DD HH:mm\" placeholder=\"Select start date & time\" className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.startDateTime ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.startDateTime} onChange={(date) => setFormData({ ...formData, startDateTime: date })} suffixIcon={<CalendarIcon className=\"w-4 h-4 text-[#666666]\" />} />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> End Time</span>\n                        <div className=\"flex items-center gap-3\">\n                          <Select placeholder=\"Select duration\" className={`flex-1 h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.duration ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.duration} onChange={(value) => setFormData({ ...formData, duration: value })}>\n                            <Option value=\"30 mins\">30 mins</Option>\n                            <Option value=\"45 mins\">45 mins</Option>\n                            <Option value=\"1 hour\">1 hour</Option>\n                            <Option value=\"1.5 hours\">1.5 hours</Option>\n                            <Option value=\"2 hours\">2 hours</Option>\n                          </Select>\n                          <Input placeholder=\"Custom time\" className={`flex-1 h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.customTime ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.customTime} onChange={(e) => setFormData({ ...formData, customTime: e.target.value })} suffix={<Clock className=\"w-4 h-4 text-[#666666]\" />} />\n                        </div>\n                      </div>\n                      <AttendeesField attendees={formData.attendees} onAddAttendee={(attendee) => { if (!formData.attendees.some(a => a.email.toLowerCase() === attendee.email.toLowerCase())) { setFormData({ ...formData, attendees: [...formData.attendees, attendee] }); } }} onRemoveAttendee={(index) => { setFormData({ ...formData, attendees: formData.attendees.filter((_, i) => i !== index) }); }} employeesData={employeesData} />\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Description</span>\n                        <TextArea placeholder=\"Agenda, notes, etc.\" className={`min-h-[120px] rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] resize-none ${formData.description ? 'bg-white' : 'bg-[#F9FAFB]'}`} rows={4} value={formData.description} onChange={(e) => setFormData({ ...formData, description: e.target.value })} />\n                      </div>\n                  </>\n              ) : (\n                  <>\n                      {/* Leave Type */}\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Leave Type</span>\n                        <Select \n                            placeholder=\"Select leave type\" \n                            className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.leaveType ? 'bg-white' : 'bg-[#F9FAFB]'}`} \n                            value={formData.leaveType} \n                            onChange={(value) => setFormData({ ...formData, leaveType: value })}\n                        >\n                             {availableLeaveTypes.map(t => <Option key={t} value={t}>{t}</Option>)}\n                        </Select>\n                      </div>\n\n                      {/* Dates */}\n                      <div className=\"grid grid-cols-2 gap-4\">\n                          <div className=\"space-y-2\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Start Date</span>\n                            <DatePicker format=\"YYYY-MM-DD\" placeholder=\"Start Date\" className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.startDateTime ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.startDateTime} onChange={(date) => setFormData({ ...formData, startDateTime: date })} suffixIcon={<CalendarIcon className=\"w-4 h-4 text-[#666666]\" />} />\n                          </div>\n                          <div className=\"space-y-2\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> End Date</span>\n                            <DatePicker format=\"YYYY-MM-DD\" placeholder=\"End Date\" className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${formData.endDateTime ? 'bg-white' : 'bg-[#F9FAFB]'}`} value={formData.endDateTime} onChange={(date) => setFormData({ ...formData, endDateTime: date })} suffixIcon={<CalendarIcon className=\"w-4 h-4 text-[#666666]\" />} />\n                          </div>\n                      </div>\n\n                      {/* Day Type */}\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Day Type</span>\n                        <Radio.Group \n                            value={formData.dayType} \n                            onChange={(e) => setFormData({ ...formData, dayType: e.target.value })}\n                            className=\"flex gap-4\"\n                        >\n                            <Radio value=\"Full Day\">Full Day</Radio>\n                            <Radio value=\"First Half\">First Half</Radio>\n                            <Radio value=\"Second Half\">Second Half</Radio>\n                        </Radio.Group>\n                      </div>\n\n                      {/* Reason */}\n                      <div className=\"space-y-2\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\"><span className=\"text-[#ff3b3b]\">*</span> Reason</span>\n                        <TextArea placeholder=\"Reason for leave\" className={`min-h-[120px] rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] resize-none ${formData.description ? 'bg-white' : 'bg-[#F9FAFB]'}`} rows={4} value={formData.description} onChange={(e) => setFormData({ ...formData, description: e.target.value })} />\n                      </div>\n                  </>\n              )}\n\n              <div className=\"flex items-center justify-end gap-4 pt-6\">\n                <Button type=\"text\" onClick={handleCancel} className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\">Cancel</Button>\n                <Button type=\"primary\" onClick={handleCreate} loading={submitting} className=\"h-[44px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\">\n                    {eventType === 'event' ? 'Create Event' : 'Apply Leave'}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </PageLayout>\n  );\n}\n\n// Reuse AttendeesField as is or keep it here if not moved\nfunction AttendeesField({ attendees, onAddAttendee, onRemoveAttendee, employeesData }: { attendees: Attendee[]; onAddAttendee: (attendee: Attendee) => void; onRemoveAttendee: (index: number) => void; employeesData: any; }) {\n  const [searchValue, setSearchValue] = useState('');\n  \n  // Filter employees based on search\n  const filteredEmployees = useMemo(() => {\n    if (!searchValue || !employeesData?.result) return [];\n    return employeesData.result.filter((emp: any) => \n      emp.name.toLowerCase().includes(searchValue.toLowerCase()) || \n      emp.email.toLowerCase().includes(searchValue.toLowerCase())\n    ).slice(0, 5);\n  }, [searchValue, employeesData]);\n\n  return (\n    <div className=\"space-y-2\">\n      <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Attendees</span>\n      <div className=\"flex flex-wrap gap-2 mb-2\">\n        {attendees.map((attendee, index) => (\n          <div key={index} className=\"flex items-center gap-1 bg-[#F7F7F7] px-2 py-1 rounded-md border border-[#EEEEEE]\">\n            <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">{attendee.name || attendee.email}</span>\n            <button onClick={() => onRemoveAttendee(index)} className=\"text-[#666666] hover:text-[#FF3B3B]\">\n              <X className=\"w-3 h-3\" />\n            </button>\n          </div>\n        ))}\n      </div>\n      <div className=\"relative\">\n        <Input \n          placeholder=\"Add attendees by email\" \n          className=\"h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] bg-[#F9FAFB]\" \n          value={searchValue}\n          onChange={(e) => setSearchValue(e.target.value)}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' && searchValue) {\n              e.preventDefault();\n              if (searchValue.includes('@')) {\n                  onAddAttendee({ email: searchValue, name: searchValue.split('@')[0] });\n                  setSearchValue('');\n              }\n            }\n          }}\n        />\n        {searchValue && filteredEmployees.length > 0 && (\n          <div className=\"absolute top-full left-0 w-full bg-white border border-[#EEEEEE] rounded-lg shadow-lg mt-1 z-50\">\n            {filteredEmployees.map((emp: any) => (\n              <div \n                key={emp.id} \n                className=\"px-4 py-2 hover:bg-[#F7F7F7] cursor-pointer flex items-center gap-2\"\n                onClick={() => {\n                  onAddAttendee({ email: emp.email, name: emp.name });\n                  setSearchValue('');\n                }}\n              >\n                <div className=\"w-6 h-6 rounded-full bg-[#111111] text-white flex items-center justify-center text-[10px]\">\n                  {emp.name.charAt(0)}\n                </div>\n                <div>\n                  <div className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">{emp.name}</div>\n                  <div className=\"text-[11px] text-[#666666]\">{emp.email}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/CalendarPageNew.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":3,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCurrentMonth' is assigned a value but never used.","line":73,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedDate' is assigned a value but never used.","line":74,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2134,2137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2134,2137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2172,2175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2172,2175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3689,3692],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3689,3692],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from 'react';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { ChevronLeft, ChevronRight, Plus, Calendar as CalendarIcon, Clock, MapPin, Loader2 } from 'lucide-react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { usePublicHolidays } from '@/hooks/useHoliday';\nimport dayjs from 'dayjs';\n\ninterface CalendarEvent {\n  id: string;\n  title: string;\n  date: string;\n  time: string;\n  type: 'meeting' | 'deadline' | 'event' | 'leave' | 'holiday';\n  participants?: string[];\n  location?: string;\n  color: string;\n}\n\nconst eventsData: CalendarEvent[] = [\n  {\n    id: '1',\n    title: 'Client Review - Triem Security',\n    date: '2025-11-20',\n    time: '10:00 AM',\n    type: 'meeting',\n    participants: ['Satyam Yadav', 'Appurva Panchakshai'],\n    location: 'Zoom',\n    color: '#3B82F6'\n  },\n  {\n    id: '2',\n    title: 'Cleanstart Podcast Deadline',\n    date: '2025-11-22',\n    time: '5:00 PM',\n    type: 'deadline',\n    color: '#ff3b3b'\n  },\n  {\n    id: '3',\n    title: 'Team Standup',\n    date: '2025-11-21',\n    time: '9:30 AM',\n    type: 'meeting',\n    participants: ['All Team'],\n    location: 'Conference Room',\n    color: '#16a34a'\n  },\n  {\n    id: '4',\n    title: 'Design Sprint Review',\n    date: '2025-11-25',\n    time: '2:00 PM',\n    type: 'event',\n    participants: ['Design Team'],\n    color: '#8b5cf6'\n  },\n  {\n    id: '5',\n    title: 'Yusuf Shaikh - Sick Leave',\n    date: '2025-11-26',\n    time: 'All Day',\n    type: 'leave',\n    color: '#f59e0b'\n  }\n];\n\nexport function CalendarPage() {\n  const [activeView, setActiveView] = useTabSync<'month' | 'week' | 'day' | 'agenda'>({\n    defaultTab: 'month',\n    validTabs: ['month', 'week', 'day', 'agenda']\n  });\n\n  const [currentMonth, setCurrentMonth] = useState('November 2025');\n  const [selectedDate, setSelectedDate] = useState<string | null>(null);\n\n  // Fetch Holidays\n  const { data: holidaysData, isLoading: isLoadingHolidays } = usePublicHolidays();\n\n  // Merge events with holidays\n  const allEvents = useMemo(() => {\n    const holidays: CalendarEvent[] = (holidaysData?.result || [])\n      .filter((h: any) => !h.is_deleted)\n      .map((h: any) => ({\n        id: `holiday-${h.id}`,\n        title: h.name,\n        date: dayjs(h.date).format('YYYY-MM-DD'),\n        time: 'All Day',\n        type: 'holiday',\n        color: '#8B5CF6' // Purple for holidays\n      }));\n    \n    return [...eventsData, ...holidays];\n  }, [holidaysData]);\n\n  // Generate calendar days for November 2025\n  const daysInMonth = 30;\n  const startDay = 5;\n  const calendarDays = [];\n\n  for (let i = startDay - 1; i >= 0; i--) {\n    calendarDays.push({ day: 31 - i, isCurrentMonth: false, date: `2025-10-${31 - i}` });\n  }\n\n  for (let i = 1; i <= daysInMonth; i++) {\n    calendarDays.push({ day: i, isCurrentMonth: true, date: `2025-11-${i.toString().padStart(2, '0')}` });\n  }\n\n  const remainingDays = 42 - calendarDays.length;\n  for (let i = 1; i <= remainingDays; i++) {\n    calendarDays.push({ day: i, isCurrentMonth: false, date: `2025-12-${i}` });\n  }\n\n  const getEventsForDate = (date: string) => {\n    return allEvents.filter(event => event.date === date);\n  };\n\n  const todayEvents = allEvents.filter(e => e.date === '2025-11-20' && e.type !== 'holiday');\n  const upcomingEvents = allEvents.filter(e => e.date > '2025-11-20' && e.type !== 'holiday').slice(0, 3);\n\n  return (\n    <PageLayout\n      title=\"Calendar\"\n      tabs={[\n        { id: 'month', label: 'Month' },\n        { id: 'week', label: 'Week' },\n        { id: 'day', label: 'Day' },\n        { id: 'agenda', label: 'Agenda' }\n      ]}\n      activeTab={activeView}\n      onTabChange={(tabId) => setActiveView(tabId as any)}\n      titleAction={{\n        onClick: () => { }\n      }}\n    >\n      {/* Month Navigation */}\n      <div className=\"flex items-center justify-center gap-3 mb-6\">\n        <button className=\"w-9 h-9 rounded-[8px] border border-[#EEEEEE] flex items-center justify-center hover:bg-[#F7F7F7] transition-colors\">\n          <ChevronLeft className=\"w-4 h-4 text-[#666666]\" />\n        </button>\n        <div className=\"px-4 py-2 bg-[#F7F7F7] rounded-[8px] border border-[#EEEEEE]\">\n          <span className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111]\">\n            {currentMonth}\n          </span>\n        </div>\n        <button className=\"w-9 h-9 rounded-[8px] border border-[#EEEEEE] flex items-center justify-center hover:bg-[#F7F7F7] transition-colors\">\n          <ChevronRight className=\"w-4 h-4 text-[#666666]\" />\n        </button>\n        <button className=\"px-4 py-2 text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666] hover:text-[#111111] transition-colors\">\n          Today\n        </button>\n      </div>\n\n      <div className=\"flex-1 grid grid-cols-[1fr_320px] gap-6 overflow-hidden\">\n        {/* Calendar Grid */}\n        <div className=\"overflow-y-auto scrollbar-hide\">\n          <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-4\">\n            {/* Day Headers */}\n            <div className=\"grid grid-cols-7 gap-2 mb-2\">\n              {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n                <div key={day} className=\"text-center py-2\">\n                  <span className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\">\n                    {day}\n                  </span>\n                </div>\n              ))}\n            </div>\n\n            {/* Calendar Days */}\n            <div className=\"grid grid-cols-7 gap-2\">\n              {calendarDays.map((dayObj, index) => {\n                const events = getEventsForDate(dayObj.date);\n                const isToday = dayObj.date === '2025-11-20';\n\n                return (\n                  <div\n                    key={index}\n                    className={`min-h-[90px] p-2 rounded-[8px] border transition-all cursor-pointer ${dayObj.isCurrentMonth\n                      ? 'bg-white border-[#EEEEEE] hover:border-[#ff3b3b] hover:bg-[#FFF5F5]'\n                      : 'bg-[#F7F7F7] border-transparent'\n                      } ${isToday ? 'border-[#ff3b3b] bg-[#FFF5F5]' : ''}`}\n                    onClick={() => setSelectedDate(dayObj.date)}\n                  >\n                    <div className={`font-['Manrope:SemiBold',sans-serif] text-[13px] mb-1 ${dayObj.isCurrentMonth ? 'text-[#111111]' : 'text-[#999999]'\n                      } ${isToday ? 'text-[#ff3b3b]' : ''}`}>\n                      {dayObj.day}\n                    </div>\n                    <div className=\"space-y-1\">\n                      {events.slice(0, 2).map((event) => (\n                        <div\n                          key={event.id}\n                          className=\"px-2 py-1 rounded-[4px] text-[10px] font-['Manrope:Medium',sans-serif] text-white truncate\"\n                          style={{ backgroundColor: event.color }}\n                        >\n                          {event.title}\n                        </div>\n                      ))}\n                      {events.length > 2 && (\n                        <div className=\"text-[10px] font-['Manrope:Medium',sans-serif] text-[#666666] px-2\">\n                          +{events.length - 2} more\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n\n        {/* Sidebar */}\n        <div className=\"flex flex-col gap-4 overflow-y-auto scrollbar-hide\">\n          {/* Today's Events */}\n          <div className=\"bg-[#F7F7F7] rounded-[16px] p-5 flex-shrink-0\">\n            <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-4\">\n              Today&apos;s Events\n            </h4>\n            <div className=\"space-y-3\">\n              {isLoadingHolidays ? (\n                 <div className=\"text-center py-2\"><Loader2 className=\"w-4 h-4 animate-spin mx-auto text-[#999999]\" /></div>\n              ) : todayEvents.length > 0 ? (\n                todayEvents.map((event) => (\n                  <div key={event.id} className=\"bg-white rounded-[12px] p-4 border border-[#EEEEEE]\">\n                    <div className=\"flex items-start gap-3\">\n                      <div\n                        className=\"w-1 h-full rounded-full mt-1\"\n                        style={{ backgroundColor: event.color }}\n                      />\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] mb-1 break-words\">\n                          {event.title}\n                        </div>\n                        <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] mb-2\">\n                          <Clock className=\"w-3 h-3\" />\n                          {event.time}\n                        </div>\n                        {event.location && (\n                          <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                            <MapPin className=\"w-3 h-3\" />\n                            {event.location}\n                          </div>\n                        )}\n                        {event.type === 'holiday' && (\n                          <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                             Public Holiday\n                          </div>\n                        )}\n                        {event.type === 'holiday' && (\n                          <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                             Public Holiday\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <div className=\"text-center py-6 text-[13px] font-['Manrope:Regular',sans-serif] text-[#999999]\">\n                  No events today\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Upcoming Events */}\n          <div className=\"bg-[#F7F7F7] rounded-[16px] p-5 flex-shrink-0\">\n            <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-4\">\n              Upcoming\n            </h4>\n            <div className=\"space-y-3\">\n              {upcomingEvents.map((event) => (\n                <div key={event.id} className=\"bg-white rounded-[12px] p-4 border border-[#EEEEEE]\">\n                  <div className=\"flex items-start gap-3\">\n                    <div\n                      className=\"w-1 h-full rounded-full mt-1\"\n                      style={{ backgroundColor: event.color }}\n                    />\n                    <div className=\"flex-1 min-w-0 w-full max-w-full\">\n                      <div className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#111111] mb-1 break-words\">\n                        {event.title}\n                      </div>\n                      <div className=\"flex items-center gap-1 text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                        <CalendarIcon className=\"w-3 h-3\" />\n                        {new Date(event.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} • {event.time}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Event Types Legend */}\n          <div className=\"bg-[#F7F7F7] rounded-[16px] p-5\">\n            <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-4\">\n              Event Types\n            </h4>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#3B82F6]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Meetings</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#ff3b3b]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Deadlines</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#8b5cf6]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Events</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#f59e0b]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Leaves</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#8B5CF6]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Holidays</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full bg-[#8B5CF6]\" />\n                <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">Holidays</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </PageLayout>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/DayView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useMemo, useEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport { Popover, Spin } from 'antd';\nimport { CalendarEventPopup } from './CalendarEventPopup';\nimport { CalendarEvent } from './types';\n\ninterface DayViewProps {\n    currentDate: dayjs.Dayjs;\n    events: CalendarEvent[];\n    isLoading?: boolean;\n    onTimeSlotClick?: (date: dayjs.Dayjs) => void;\n}\n\nexport function DayView({ currentDate, events, isLoading, onTimeSlotClick }: DayViewProps) {\n    const scrollContainerRef = useRef<HTMLDivElement>(null);\n\n    // Scroll to 8 AM on mount\n    useEffect(() => {\n        if (scrollContainerRef.current) {\n            const eightAM = 8 * 60; // 8 hours * 60 minutes\n            scrollContainerRef.current.scrollTop = eightAM;\n        }\n    }, []);\n\n    // Use 24 hours\n    const hours = Array.from({ length: 24 }).map((_, i) => i);\n\n    const getEventsForDay = (date: dayjs.Dayjs) => {\n        return events.filter(e => dayjs(e.date).isSame(date, 'day'));\n    };\n    \n    // Helper to get minutes from start of day\n    const getMinutesFromStart = (event: CalendarEvent) => {\n        if (event.time === 'All Day' || event.type === 'holiday' || event.type === 'leave') {\n             return -1; \n        }\n        \n        // Use the pre-calculated timezone-aware startDateTime if available\n        if (event.startDateTime) {\n            return event.startDateTime.hour() * 60 + event.startDateTime.minute();\n        }\n\n        if (event.time && event.date) {\n             const dateTimeStr = `${event.date} ${event.time}`;\n             const parsed = dayjs(dateTimeStr, 'YYYY-MM-DD h:mm A');\n             if (parsed.isValid()) {\n                return parsed.hour() * 60 + parsed.minute();\n             }\n        }\n\n        return 9 * 60; // Default if parsing fails\n    };\n\n    const processEvents = (dayEvents: CalendarEvent[]) => {\n        const allDayEvents: CalendarEvent[] = [];\n        const timeEvents: CalendarEvent[] = [];\n\n        dayEvents.forEach(e => {\n            if (e.time === 'All Day' || e.type === 'holiday' || e.type === 'leave') {\n                allDayEvents.push(e);\n            } else {\n                timeEvents.push(e);\n            }\n        });\n\n        return { allDayEvents, timeEvents };\n    };\n\n    const { allDayEvents, timeEvents } = useMemo(() => {\n        return processEvents(getEventsForDay(currentDate));\n    }, [currentDate, events]);\n\n    const isToday = currentDate.isSame(dayjs(), 'day');\n\n    if (isLoading) {\n        return (\n            <div className=\"flex items-center justify-center h-full\">\n                <Spin size=\"large\" />\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"flex flex-col h-full bg-white border border-[#EEEEEE] rounded-[16px] overflow-hidden\">\n             \n             {/* Scrollable Grid containing Header (sticky) and Body */}\n             {/* Scrollable Grid containing Header (sticky) and Body */}\n             <div ref={scrollContainerRef} className=\"flex-1 overflow-y-auto relative bg-white scrollbar-hide\">\n                \n                {/* Header (Moved inside) */}\n                <div className=\"flex border-b border-[#EEEEEE] sticky top-0 bg-white z-40\">\n                    <div className=\"w-16 flex-shrink-0 border-r border-[#EEEEEE] bg-white\"></div>\n                    <div className=\"flex-1 px-4 py-2 bg-white flex justify-center border-l-0\">\n                         <div className=\"text-center\">\n                            <div className={`text-[11px] font-['Manrope:SemiBold',sans-serif] mb-0.5 ${isToday ? 'text-[#ff3b3b]' : 'text-[#666666]'}`}>\n                                {currentDate.format('dddd').toUpperCase()}\n                            </div>\n                            <div className={`flex items-center justify-center`}>\n                                <div className={`text-[20px] leading-none font-['Manrope:Bold',sans-serif] w-8 h-8 flex items-center justify-center rounded-full ${isToday ? 'bg-[#ff3b3b] text-white' : 'text-[#111111]'}`}>\n                                    {currentDate.format('D')}\n                                </div>\n                            </div>\n                         </div>\n                    </div>\n                </div>\n\n                {/* All Day Section (Moved inside, stays at top under header?) \n                   Wait, all day usually scrolls WITH content in Google Calendar? \n                   Actually Google Calendar All Day section is sticky or separate. \n                   If I put it here, it will scroll up. \n                   If user wants alignment, All Day should also share width context.\n                   Let's keep it here, but maybe not sticky? \n                   If it scrolls away, that's fine for now, or I can make it sticky top-[headerHeight].\n                   For now, let's just let it scroll.\n                */}\n                {allDayEvents.length > 0 && (\n                     <div className=\"border-b border-[#EEEEEE] flex\">\n                         <div className=\"w-16 flex-shrink-0 border-r border-[#EEEEEE] bg-white flex items-center justify-center\">\n                             <span className=\"text-[10px] text-[#666666] font-['Manrope:Medium',sans-serif]\">All day</span>\n                         </div>\n                         <div className=\"flex-1 p-2 space-y-1\">\n                             {allDayEvents.map(event => (\n                                 <Popover key={event.id} content={<CalendarEventPopup event={event} />} trigger=\"click\">\n                                     <div \n                                        className=\"px-3 py-1.5 rounded-[6px] text-white text-[13px] font-['Manrope:Medium',sans-serif] cursor-pointer inline-block mr-2 mb-1\"\n                                        style={{ backgroundColor: event.color }}\n                                     >\n                                        {event.title}\n                                     </div>\n                                 </Popover>\n                             ))}\n                         </div>\n                     </div>\n                 )}\n\n                <div className=\"flex relative min-h-[1440px] z-0\"> {/* 24 hours * 60px */}\n                    \n                    {/* Time Scale */}\n                    <div className=\"w-16 flex-shrink-0 border-r border-[#EEEEEE] bg-white sticky left-0 z-30 select-none\">\n                        {hours.map(hour => (\n                            <div key={hour} className=\"h-[60px] relative text-right pr-2\">\n                                <span className=\"text-[11px] text-[#666666] font-['Manrope:Medium',sans-serif] -top-2 relative block transform -translate-y-1/2\">\n                                    {hour === 0 ? '' : dayjs().hour(hour).format('h A')}\n                                </span>\n                            </div>\n                        ))}\n\n                        {/* Current Time Indicator on Left Axis */}\n                        <div \n                            className=\"absolute right-0 w-full h-[2px] z-30 pointer-events-none flex items-center justify-end pr-1\"\n                            style={{ top: dayjs().hour() * 60 + dayjs().minute() }}\n                        >\n                             <div className=\"text-[10px] font-['Manrope:Bold',sans-serif] text-white bg-[#ff3b3b] px-1.5 py-0.5 rounded-[4px] relative -top-[1px]\">\n                                {dayjs().format('h:mm')}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Day Column */}\n                    <div \n                        className=\"flex-1 min-h-[1440px] relative group hover:bg-gray-50 transition-colors z-[1]\"\n                    >\n                         {/* Grid Lines */}\n                         {hours.map(h => (\n                             <div key={h} className=\"absolute w-full border-b border-[#EEEEEE] h-[60px] pointer-events-none\" style={{ top: h * 60 }}></div>\n                         ))}\n\n                         {/* Click Overlay - FINAL FIX */}\n                         <div \n                            className=\"absolute inset-0 z-[10] cursor-pointer\"\n                            style={{ height: '1440px' }} // Force height match\n                            onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                const rect = e.currentTarget.getBoundingClientRect();\n                                const relativeY = e.clientY - rect.top;\n                                const safeY = Math.max(0, relativeY);\n                                \n                                const minutes = safeY; \n                                const roundedMinutes = Math.round(minutes / 15) * 15;\n                                const dayStart = dayjs(currentDate).startOf('day');\n                                const eventTime = dayStart.add(roundedMinutes, 'minute');\n                                \n                                onTimeSlotClick?.(eventTime);\n                            }}\n                         />\n\n                         {/* Time Events */}\n                         {timeEvents.map(event => {\n                             const startMinutes = getMinutesFromStart(event);\n                             const duration = 60; // Mock duration\n                             \n                             return (\n                                <Popover key={event.id} content={<CalendarEventPopup event={event} />} trigger=\"click\">\n                                 <div\n                                     className=\"absolute w-[95%] left-[2.5%] rounded-[4px] px-4 py-3 cursor-pointer border-l-[3px] hover:shadow-md transition-shadow overflow-hidden z-10\"\n                                     style={{\n                                         top: `${startMinutes}px`,\n                                         height: `${duration}px`,\n                                         backgroundColor: event.color + '20', // transparent bg\n                                         borderLeftColor: event.color\n                                     }}\n                                      onClick={(e) => e.stopPropagation()}\n                                 >\n                                     <div className=\"flex items-start justify-between\">\n                                         <div>\n                                             <div className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                                 {event.title}\n                                             </div>\n                                             <div className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#666666] mt-1\">\n                                                 {event.time} {event.location ? ` | ${event.location}` : ''}\n                                             </div>\n                                         </div>\n                                     </div>\n                                     {event.description && (\n                                         <div className=\"mt-2 text-[12px] text-[#666666] line-clamp-2\">\n                                             {event.description}\n                                         </div>\n                                     )}\n                                 </div>\n                                </Popover>\n                             );\n                         })}\n                         \n                         {/* Current Time Indicator for Today */}\n                         {isToday && (\n                             <div \n                                className=\"absolute w-full h-[2px] bg-[#ff3b3b] z-30 pointer-events-none flex items-center\"\n                                style={{ top: dayjs().hour() * 60 + dayjs().minute() }}\n                             >\n                                <div className=\"w-2.5 h-2.5 rounded-full bg-[#ff3b3b] -ml-[5px] ring-2 ring-white\"></div>\n                             </div>\n                         )}\n                    </div>\n                </div>\n             </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/MonthView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'endOfMonth' is assigned a value but never used.","line":18,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo } from 'react';\nimport dayjs from 'dayjs';\nimport { Popover, Spin } from 'antd';\nimport { CalendarEventPopup } from './CalendarEventPopup';\nimport { CalendarEvent } from './types';\n\ninterface MonthViewProps {\n    readonly currentDate: dayjs.Dayjs;\n    readonly events: CalendarEvent[];\n    readonly isLoading?: boolean;\n    readonly selectedDate: string | null;\n    readonly onSelectDate: (date: string) => void;\n}\n\nexport function MonthView({ currentDate, events, isLoading, selectedDate, onSelectDate }: MonthViewProps) {\n    const calendarDays = useMemo(() => {\n        const startOfMonth = currentDate.startOf('month');\n        const endOfMonth = currentDate.endOf('month');\n        const startDayOfWeek = startOfMonth.day(); // 0 (Sun) to 6 (Sat)\n        const daysInMonth = currentDate.daysInMonth();\n\n        const days = [];\n\n        // Previous month filler\n        const prevMonth = currentDate.subtract(1, 'month');\n        const daysInPrevMonth = prevMonth.daysInMonth();\n        for (let i = startDayOfWeek - 1; i >= 0; i--) {\n            const d = prevMonth.date(daysInPrevMonth - i);\n            days.push({\n                day: d.date(),\n                isCurrentMonth: false,\n                date: d.format('YYYY-MM-DD')\n            });\n        }\n\n        // Current month\n        for (let i = 1; i <= daysInMonth; i++) {\n            const d = currentDate.date(i);\n            days.push({\n                day: i,\n                isCurrentMonth: true,\n                date: d.format('YYYY-MM-DD')\n            });\n        }\n\n        // Next month filler - only fill to complete current row, not entire rows\n        const totalDays = days.length;\n        const remainingSlotsInLastRow = totalDays % 7;\n        if (remainingSlotsInLastRow > 0) {\n            // Only fill the remaining slots in the current row\n            const nextMonth = currentDate.add(1, 'month');\n            for (let i = 1; i <= (7 - remainingSlotsInLastRow); i++) {\n                const d = nextMonth.date(i);\n                days.push({\n                    day: i,\n                    isCurrentMonth: false,\n                    date: d.format('YYYY-MM-DD')\n                });\n            }\n        }\n\n        // Remove last row if it contains only next month days\n        if (days.length >= 7) {\n            const lastRow = days.slice(-7);\n            const allNextMonth = lastRow.every(day => !day.isCurrentMonth);\n            if (allNextMonth) {\n                return days.slice(0, -7);\n            }\n        }\n\n        return days;\n    }, [currentDate]);\n\n    const weeks = useMemo(() => {\n        const result = [];\n        for (let i = 0; i < calendarDays.length; i += 7) {\n            result.push(calendarDays.slice(i, i + 7));\n        }\n        return result;\n    }, [calendarDays]);\n\n    const getEventsForDate = (date: string) => {\n        return events.filter(event => event.date === date);\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"flex items-center justify-center h-full\">\n                <Spin size=\"large\" />\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-4 h-full flex flex-col overflow-auto scrollbar-hide\">\n            {/* Day Headers - using Table */}\n            <table className=\"w-full h-full table-fixed border-separate border-spacing-2\" role=\"grid\" aria-label=\"Calendar Month View\">\n                <thead>\n                    <tr>\n                        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n                            <th key={day} className=\"text-center py-2\">\n                                <span className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\">\n                                    {day}\n                                </span>\n                            </th>\n                        ))}\n                    </tr>\n                </thead>\n                <tbody>\n                    {weeks.map((week, weekIndex) => (\n                        <tr key={week[0].date} style={{ height: `${100 / weeks.length}%` }}>\n                            {week.map((dayObj, dayIndex) => {\n                                const index = weekIndex * 7 + dayIndex;\n                                const dayEvents = getEventsForDate(dayObj.date);\n                                const isToday = dayObj.date === dayjs().format('YYYY-MM-DD');\n                                const isSelected = selectedDate === dayObj.date;\n                                const dateDesc = dayjs(dayObj.date).format('dddd, MMMM D, YYYY');\n                                const label = isToday ? `Today, ${dateDesc}` : dateDesc;\n\n                                return (\n                                    <td\n                                        key={index}\n                                        aria-label={label}\n                                        aria-selected={isSelected}\n                                        tabIndex={0}\n                                        className={`p-2 rounded-[8px] border transition-all cursor-pointer align-top focus:ring-2 focus:ring-[#111111] focus:outline-none overflow-hidden ${dayObj.isCurrentMonth\n                                            ? 'bg-white border-[#EEEEEE] hover:border-[#ff3b3b] hover:bg-[#FFF5F5]'\n                                            : 'bg-[#F7F7F7] border-transparent'\n                                            } ${isToday ? 'border-[#ff3b3b] bg-[#FFF5F5]' : ''} ${isSelected && !isToday ? 'border-gray-400' : ''}`}\n                                        onClick={() => onSelectDate(dayObj.date)}\n                                        onKeyDown={(e) => {\n                                            if (e.key === 'Enter' || e.key === ' ') {\n                                                e.preventDefault();\n                                                onSelectDate(dayObj.date);\n                                            }\n                                            // Navigation logic update\n                                            const table = e.currentTarget.closest('table');\n                                            if (!table) return;\n                                            const cells = Array.from(table.querySelectorAll('tbody td')) as HTMLElement[];\n                                            const currentIndex = cells.indexOf(e.currentTarget);\n\n                                            let nextIndex = -1;\n                                            if (e.key === 'ArrowRight') nextIndex = currentIndex + 1;\n                                            if (e.key === 'ArrowLeft') nextIndex = currentIndex - 1;\n                                            if (e.key === 'ArrowDown') nextIndex = currentIndex + 7;\n                                            if (e.key === 'ArrowUp') nextIndex = currentIndex - 7;\n\n                                            if (nextIndex >= 0 && nextIndex < cells.length) {\n                                                e.preventDefault();\n                                                cells[nextIndex].focus();\n                                            }\n                                        }}\n                                    >\n                                        <div className=\"flex flex-col h-full\">\n                                            <div className={`font-['Manrope:SemiBold',sans-serif] text-[13px] mb-1 flex justify-between items-center ${dayObj.isCurrentMonth ? 'text-[#111111]' : 'text-[#999999]'\n                                                } ${isToday ? 'text-[#ff3b3b]' : ''}`}>\n                                                <span aria-hidden=\"true\">{dayObj.day}</span>\n                                                {isToday && <span className=\"text-[10px] bg-[#ff3b3b] text-white px-1.5 rounded\" aria-hidden=\"true\">Today</span>}\n                                            </div>\n                                            <div className=\"space-y-1 flex-1\">\n                                                {dayEvents.slice(0, 3).map((event) => (\n                                                    <Popover key={event.id} content={<CalendarEventPopup event={event} />} trigger=\"click\">\n                                                        <button\n                                                            type=\"button\"\n                                                            aria-label={`Event: ${event.title}`}\n                                                            className=\"px-2 py-1 rounded-[4px] text-[10px] font-['Manrope:Medium',sans-serif] text-white truncate cursor-pointer hover:opacity-80 transition-opacity focus:ring-1 focus:ring-white focus:outline-none w-full text-left border-none\"\n                                                            style={{ backgroundColor: event.color }}\n                                                            onClick={(e) => e.stopPropagation()}\n                                                            onKeyDown={(e) => {\n                                                                if (e.key === 'Enter' || e.key === ' ') {\n                                                                    e.stopPropagation();\n                                                                }\n                                                            }}\n                                                        >\n                                                            {event.title}\n                                                        </button>\n                                                    </Popover>\n                                                ))}\n                                                {dayEvents.length > 3 && (\n                                                    <div className=\"text-[10px] font-['Manrope:Medium',sans-serif] text-[#666666] px-2\">\n                                                        +{dayEvents.length - 3} more\n                                                    </div>\n                                                )}\n                                            </div>\n                                        </div>\n                                    </td>\n                                );\n                            })}\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/WeekView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getEventStyle' is assigned a value but never used.","line":43,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useMemo, useEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport { Popover, Spin } from 'antd';\nimport { CalendarEventPopup } from './CalendarEventPopup';\nimport { CalendarEvent } from './types';\n\ninterface WeekViewProps {\n    currentDate: dayjs.Dayjs;\n    events: CalendarEvent[];\n    isLoading?: boolean;\n    onTimeSlotClick?: (date: dayjs.Dayjs) => void;\n}\n\nexport function WeekView({ currentDate, events, isLoading, onTimeSlotClick }: WeekViewProps) {\n    const scrollContainerRef = useRef<HTMLDivElement>(null);\n\n    // Scroll to 8 AM on mount\n    useEffect(() => {\n        if (scrollContainerRef.current) {\n            const eightAM = 8 * 60; // 8 hours * 60 minutes\n            scrollContainerRef.current.scrollTop = eightAM;\n        }\n    }, []);\n\n    const weekDays = useMemo(() => {\n        const startOfWeek = currentDate.startOf('week'); // Sunday\n        return Array.from({ length: 7 }).map((_, i) => {\n            const date = startOfWeek.add(i, 'day');\n            return {\n                date: date,\n                label: date.format('ddd'),\n                day: date.format('D'),\n                isToday: date.isSame(dayjs(), 'day')\n            };\n        });\n    }, [currentDate]);\n\n    // Use 24 hours\n    const hours = Array.from({ length: 24 }).map((_, i) => i);\n\n    const getEventStyle = (event: CalendarEvent) => {\n        let startTime = dayjs(event.date); // Default to start of day\n        if (event.time && event.time !== 'All Day') {\n             // Try to parse standard formats\n             const parsed = dayjs(`${event.date} ${event.time}`);\n             if (parsed.isValid()) {\n                startTime = parsed;\n             }\n        }\n        \n        const startHour = startTime.hour();\n        const startMinute = startTime.minute();\n        \n        // Calculate duration\n        let durationMinutes = 60; // Default 1 hour\n        if (event.endDate) {\n           durationMinutes = dayjs(event.endDate).diff(startTime, 'minute');\n        }\n\n        const top = (startHour * 60) + startMinute;\n        const height = Math.max(durationMinutes, 30); // Min height 30 mins\n\n        return {\n            top: `${top}px`,\n            height: `${height}px`,\n            backgroundColor: event.color\n        };\n    };\n\n\n\n    const getEventsForDay = (date: dayjs.Dayjs) => {\n        return events.filter(e => dayjs(e.date).isSame(date, 'day'));\n    };\n\n    // Need a function to parse the time string from the event object properly as it seems loosely typed in existing code ('10:00 AM', 'All Day', 'Deadline')\n    // Existing code constructs 'time' string for display. We need valid datetime for positioning.\n    // The `raw` field might have the ISO strings.\n    \n    // Helper to get minutes from start of day\n    const getMinutesFromStart = (event: CalendarEvent) => {\n        if (event.time === 'All Day' || event.type === 'holiday' || event.type === 'leave') {\n             return -1; // All day events handled separately\n        }\n        \n        // Use the pre-calculated timezone-aware startDateTime if available\n        if (event.startDateTime) {\n            return event.startDateTime.hour() * 60 + event.startDateTime.minute();\n        }\n\n        // Check if event.time is a valid time string (e.g. \"10:00 AM\")\n        if (event.time && event.date) {\n             // Construct a parseable string\n             const dateTimeStr = `${event.date} ${event.time}`;\n             const parsed = dayjs(dateTimeStr, 'YYYY-MM-DD h:mm A');\n             if (parsed.isValid()) {\n                return parsed.hour() * 60 + parsed.minute();\n             }\n        }\n\n        // Fallback\n        return 9 * 60; // Default to 9 AM if parsing fails\n    };\n\n    // Group events into \"All Day\" and \"Time\" events\n    const processEvents = (dayEvents: CalendarEvent[]) => {\n        const allDayEvents: CalendarEvent[] = [];\n        const timeEvents: CalendarEvent[] = [];\n\n        dayEvents.forEach(e => {\n            if (e.time === 'All Day' || e.type === 'holiday' || e.type === 'leave') {\n                allDayEvents.push(e);\n            } else {\n                timeEvents.push(e);\n            }\n        });\n\n        return { allDayEvents, timeEvents };\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"flex items-center justify-center h-full\">\n                <Spin size=\"large\" />\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"flex flex-col h-full bg-white border border-[#EEEEEE] rounded-[16px] overflow-hidden\">\n             {/* Scrollable Grid containing Header (sticky) and Body */}\n             {/* Scrollable Grid containing Header (sticky) and Body */}\n             <div ref={scrollContainerRef} className=\"flex-1 overflow-y-auto relative bg-white scrollbar-hide\">\n                \n                {/* Header (Moved inside to share scrollbar width context) */}\n                <div className=\"flex border-b border-[#EEEEEE] sticky top-0 bg-white z-40\">\n                    <div className=\"w-16 flex-shrink-0 border-r border-[#EEEEEE] bg-white\"></div>\n                    <div className=\"flex-1 grid grid-cols-7\">\n                        {weekDays.map((d, i) => (\n                            <div key={i} className={`py-2 text-center border-r border-[#EEEEEE] last:border-r-0 ${d.isToday ? 'bg-[#ff3b3b]/5' : ''}`}>\n                                <div className={`text-[11px] font-['Manrope:SemiBold',sans-serif] mb-0.5 ${d.isToday ? 'text-[#ff3b3b]' : 'text-[#666666]'}`}>\n                                    {d.label.toUpperCase()}\n                                </div>\n                                <div className={`flex items-center justify-center`}>\n                                    <div className={`text-[20px] leading-none font-['Manrope:Bold',sans-serif] w-8 h-8 flex items-center justify-center rounded-full ${d.isToday ? 'bg-[#ff3b3b] text-white' : 'text-[#111111]'}`}>\n                                        {d.day}\n                                    </div>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n\n                <div className=\"flex relative min-h-[1440px] z-0\"> {/* 24 hours * 60px */}\n                    \n                    {/* Time Scale */}\n                    <div className=\"w-16 flex-shrink-0 border-r border-[#EEEEEE] bg-white sticky left-0 z-30 select-none\">\n                        {hours.map(hour => (\n                            <div key={hour} className=\"h-[60px] relative text-right pr-2\">\n                                <span className=\"text-[11px] text-[#666666] font-['Manrope:Medium',sans-serif] -top-2 relative block transform -translate-y-1/2\">\n                                    {hour === 0 ? '' : dayjs().hour(hour).format('h A')}\n                                </span>\n                            </div>\n                        ))}\n\n                        {/* Current Time Indicator on Left Axis */}\n                        <div \n                            className=\"absolute right-0 w-full h-[2px] z-30 pointer-events-none flex items-center justify-end pr-1\"\n                            style={{ top: dayjs().hour() * 60 + dayjs().minute() }}\n                        >\n                             <div className=\"text-[10px] font-['Manrope:Bold',sans-serif] text-white bg-[#ff3b3b] px-1.5 py-0.5 rounded-[4px] relative -top-[1px]\">\n                                {dayjs().format('h:mm')}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Days Columns */}\n                    <div className=\"flex-1 grid grid-cols-7 h-full\">\n                         {weekDays.map((dayObj, dayIndex) => {\n                             const { allDayEvents, timeEvents } = processEvents(getEventsForDay(dayObj.date));\n\n                             return (\n                                 <div \n                                    key={dayIndex} \n                                    className={`relative border-r border-[#E0E0E0] last:border-r-0 min-h-[1440px] ${dayObj.isToday ? 'bg-[#F7F7F7]' : ''} group z-[1]`}\n                                 >\n                                     {/* Grid Lines */}\n                                     {hours.map(h => (\n                                         <div key={h} className=\"absolute w-full border-b border-[#EEEEEE] h-[60px] pointer-events-none\" style={{ top: h * 60 }}></div>\n                                     ))}\n\n                                     {/* Click Overlay - FINAL FIX */}\n                                     <div \n                                        className=\"absolute inset-0 z-[10] cursor-pointer\"\n                                        style={{ height: '1440px' }} // Force height match\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            e.stopPropagation();\n                                            const rect = e.currentTarget.getBoundingClientRect();\n                                            const relativeY = e.clientY - rect.top;\n                                            const safeY = Math.max(0, relativeY);\n                                            \n                                            const minutes = safeY; \n                                            const roundedMinutes = Math.round(minutes / 15) * 15;\n                                            \n                                            const dayStart = dayjs(dayObj.date).startOf('day');\n                                            const eventTime = dayStart.add(roundedMinutes, 'minute');\n                                            \n                                            onTimeSlotClick?.(eventTime);\n                                        }}\n                                     />\n\n                                     {/* All Day Events Stacked at top */}\n                                     {allDayEvents.map((ep, idx) => (\n                                         <Popover key={ep.id} content={<CalendarEventPopup event={ep} />} trigger=\"click\">\n                                             <div \n                                                className=\"absolute w-[95%] left-[2.5%] text-[10px] px-2 py-1 rounded-[4px] text-white truncate cursor-pointer z-20 hover:opacity-90\"\n                                                style={{ \n                                                    top: `${idx * 22 + 2}px`, \n                                                    height: '20px',\n                                                    backgroundColor: ep.color \n                                                }}\n                                                onClick={(e) => e.stopPropagation()}\n                                             >\n                                                {ep.title}\n                                             </div>\n                                         </Popover>\n                                     ))}\n\n                                     {/* Time Events */}\n                                     {timeEvents.map(event => {\n                                         const startMinutes = getMinutesFromStart(event);\n                                         const duration = 60; \n                                         \n                                         return (\n                                            <Popover key={event.id} content={<CalendarEventPopup event={event} />} trigger=\"click\">\n                                             <div\n                                                 className=\"absolute w-[95%] left-[2.5%] rounded-[4px] px-2 py-1 cursor-pointer border-l-[3px] hover:shadow-md transition-shadow overflow-hidden z-10\"\n                                                 style={{\n                                                     top: `${startMinutes}px`,\n                                                     height: `${duration}px`,\n                                                     backgroundColor: event.color + '20', // transparent bg\n                                                     borderLeftColor: event.color\n                                                 }}\n                                                 onClick={(e) => e.stopPropagation()}\n                                             >\n                                                 <div className=\"text-[11px] font-['Manrope:SemiBold',sans-serif] text-[#111111] leading-tight truncate\">\n                                                     {event.title}\n                                                 </div>\n                                                 <div className=\"text-[10px] font-['Manrope:Medium',sans-serif] text-[#666666] leading-tight truncate mt-0.5\">\n                                                     {event.time}\n                                                 </div>\n                                             </div>\n                                            </Popover>\n                                         );\n                                     })}\n                                     \n                                     {/* Current Time Line in the grid (Line only) */}\n                                     {dayObj.isToday && (\n                                         <div \n                                            className=\"absolute w-full h-[2px] bg-[#ff3b3b] z-30 pointer-events-none flex items-center\"\n                                            style={{ top: dayjs().hour() * 60 + dayjs().minute() }}\n                                         >\n                                            <div className=\"w-2.5 h-2.5 rounded-full bg-[#ff3b3b] -ml-[5px] ring-2 ring-white\"></div>\n                                         </div>\n                                     )}\n                                 </div>\n                             );\n                         })}\n                    </div>\n                </div>\n             </div>\n        </div>\n    );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/calendar/types.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[669,672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[669,672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { MeetingType } from '@/services/meeting';\nimport { LeaveType } from '@/services/leave';\nimport { GraphEvent } from '@/services/calendar';\nimport { TaskType } from '@/services/task';\nimport { Holiday } from '@/types/domain';\n\nexport interface CalendarEvent {\n    id: string;\n    title: string;\n    date: string;\n    time: string;\n    type: 'meeting' | 'deadline' | 'event' | 'leave' | 'holiday';\n    participants?: { name: string; avatar?: string }[];\n    location?: string;\n    description?: string;\n    status?: string;\n    color: string;\n    raw?: MeetingType | LeaveType | GraphEvent | TaskType | Holiday | unknown;\n    endDate?: string;\n    startDateTime?: any; // dayjs.Dayjs - keep as is or import dayjs\n}\n\nexport type ViewType = 'month' | 'week' | 'day';\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/employees/EmployeeDetailsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[786,789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[786,789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2028,2031],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2028,2031],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3805,3808],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3805,3808],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":117,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5146,5149],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5146,5149],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5456,5459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5456,5459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6348,6351],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6348,6351],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6435,6438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6435,6438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6482,6485],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6482,6485],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6515,6518],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6515,6518],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":184,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6637,6640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6637,6640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7136,7139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7136,7139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":194,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":194,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7188,7191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7188,7191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":195,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7250,7253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7250,7253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":196,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":196,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7346,7349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7346,7349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7413,7416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7413,7416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7534,7537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7534,7537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7571,7574],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7571,7574],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7643,7646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7643,7646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7701,7704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7701,7704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":201,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7753,7756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7753,7756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7804,7807],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7804,7807],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7863,7866],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7863,7866],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7931,7934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7931,7934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":415,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":415,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16950,16953],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16950,16953],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":415,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":415,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16995,16998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16995,16998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { useEmployee, useUpdateEmployee, useCompanyDepartments } from '@/hooks/useUser';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { AccessBadge } from '../../ui/AccessBadge';\nimport { Button, Tag, Divider, Modal, App } from 'antd';\nimport { Mail, Phone, Calendar, Briefcase, DollarSign, ArrowLeft, Edit, FileText } from 'lucide-react';\nimport { EmployeeForm, EmployeeFormData } from '../../modals/EmployeesForm';\nimport { DocumentCard } from '@/components/ui/DocumentCard';\nimport { DocumentPreviewModal } from '@/components/ui/DocumentPreviewModal';\nimport { UserDocument } from '@/types/genericTypes';\n\n\n\nfunction calculateWorkingHours(workingHours: any): number {\n  if (!workingHours || !workingHours.start_time || !workingHours.end_time) return 0;\n\n  // Simple calculation assuming same day\n  // Format is usually \"HH:mm\" or \"h:mm a\"\n  // For now returning standard 8 if both exist as placeholder improvement, \n  // or implementing basic parsing if format is standard.\n  return 8; // keeping it simple as per original logic, but abstracted\n}\n\nexport function EmployeeDetailsPage() {\n  const params = useParams();\n  const employeeId = params.employeeId as string;\n  const router = useRouter();\n  const { message } = App.useApp();\n  const { data: employeeData, isLoading } = useEmployee(parseInt(employeeId || '0'));\n  const { data: departmentsData } = useCompanyDepartments();\n  const updateEmployeeMutation = useUpdateEmployee();\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [selectedDocument, setSelectedDocument] = useState<UserDocument | null>(null);\n  const [isPreviewModalOpen, setIsPreviewModalOpen] = useState(false);\n\n  const backendEmp = employeeData?.result;\n\n  // Mock documents data - TODO: Replace with actual API call when available\n  const documents = useMemo(() => {\n    // Check if employee data has documents\n    const employeeDocs = (backendEmp as any)?.documents || [];\n    if (Array.isArray(employeeDocs) && employeeDocs.length > 0) {\n      return employeeDocs;\n    }\n    // Mock documents from docs folder - all 4 types\n    const mockDocuments: UserDocument[] = [\n      {\n        id: '1',\n        documentTypeId: '1',\n        documentTypeName: 'Resume',\n        fileName: 'Resume_Updated.pdf',\n        fileSize: 2400000, // 2.4 MB\n        fileUrl: '/documents/Jayendra_Jadhav_Resume.pdf',\n        uploadedDate: '2024-10-24T00:00:00Z',\n        fileType: 'pdf',\n        isRequired: true,\n      },\n      {\n        id: '2',\n        documentTypeId: '2',\n        documentTypeName: 'ID Proof',\n        fileName: 'Identity_Proof.webp',\n        fileSize: 1000000, // 1 MB\n        fileUrl: '/documents/profile.jpeg',\n        uploadedDate: '2024-01-15T00:00:00Z',\n        fileType: 'image',\n        isRequired: true,\n      },\n      {\n        id: '3',\n        documentTypeId: '3',\n        documentTypeName: 'Contract',\n        fileName: 'Employment_Contract.docx',\n        fileSize: 206000, // 206 KB\n        fileUrl: '/documents/AI Agent Documentation.docx',\n        uploadedDate: '2024-01-20T00:00:00Z',\n        fileType: 'docx',\n        isRequired: true,\n      },\n      {\n        id: '4',\n        documentTypeId: '4',\n        documentTypeName: 'Supporting Docs',\n        fileName: 'ollama_data.csv',\n        fileSize: 50000, // 50 KB\n        fileUrl: '/documents/ollama_filtered_json_support.csv',\n        uploadedDate: '2024-12-17T00:00:00Z',\n        fileType: 'csv',\n        isRequired: false,\n      },\n    ];\n    return mockDocuments;\n  }, [backendEmp]);\n\n  const handleUpdateEmployee = (data: EmployeeFormData) => {\n    // Find department ID from name\n    const selectedDepartment = departmentsData?.result?.find(\n      (dept: any) => dept.name === data.department\n    );\n    const departmentId = selectedDepartment?.id || null;\n\n    // Parse hourly rate\n    const hourlyRate = parseFloat(data.hourlyRate.replace(/[^0-9.]/g, '')) || 0;\n\n    // Parse date of joining\n    let dateOfJoining = new Date().toISOString();\n    if (data.dateOfJoining) {\n      try {\n        const date = new Date(data.dateOfJoining);\n        if (!isNaN(date.getTime())) {\n          dateOfJoining = date.toISOString();\n        }\n      } catch (e) {\n        // Invalid date format\n      }\n    }\n\n    updateEmployeeMutation.mutate(\n      {\n        id: parseInt(employeeId),\n        name: `${data.firstName} ${data.lastName}`.trim(),\n        first_name: data.firstName,\n        last_name: data.lastName,\n        email: data.email,\n        mobile_number: data.phone, // Map frontend phone to backend mobile_number\n        designation: data.role,\n        department_id: departmentId,\n        role_id: data.role_id, // Keep existing role_id if valid\n        experience: parseInt(data.experience) || 0,\n        skills: data.skillsets.split(',').map((s: string) => s.trim()).filter((s: string) => s.length > 0),\n        date_of_joining: dateOfJoining,\n        salary_yearly: parseFloat(data.salary) || 0,\n        hourly_rates: hourlyRate,\n        no_of_leaves: parseFloat(data.leaves) || 0,\n      } as any,\n      {\n        onSuccess: () => {\n          message.success(\"Employee updated successfully!\");\n          setIsDialogOpen(false);\n          // Invalidate queries to refresh the data\n          // The useUpdateEmployee hook should handle this, but we'll ensure it's done\n        },\n        onError: (error: any) => {\n          const errorMessage = error?.response?.data?.message || \"Failed to update employee\";\n          message.error(errorMessage);\n        },\n      }\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full\">\n        <p className=\"text-[#999999]\">Loading employee...</p>\n      </div>\n    );\n  }\n\n  if (!backendEmp) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full\">\n        <h2 className=\"text-xl font-semibold mb-2\">Employee not found</h2>\n        <Button onClick={() => router.push('/dashboard/employees')}>Back to Employees</Button>\n      </div>\n    );\n  }\n\n  // Transform backend data to UI format\n  // Check multiple possible paths for mobile_number (userProfile table or nested user_profile)\n  // Also default to 'N/A' if nothing found\n  const mobileNumber =\n    (backendEmp as any).user_profile?.mobile_number ||\n    backendEmp.mobile_number ||\n    (backendEmp as any).user_profile?.phone ||\n    (backendEmp as any).phone ||\n    (backendEmp as any).user_employee?.user?.mobile_number || // Attempt deep search\n    'N/A';\n\n  const employee = {\n    id: (backendEmp as any).user_id || backendEmp.id,\n    name: backendEmp.name || '',\n    role: backendEmp.designation || 'Unassigned',\n    email: backendEmp.email || '',\n    phone: mobileNumber,\n    hourlyRate: backendEmp.hourly_rates ? `$${backendEmp.hourly_rates}/Hr` : 'N/A',\n    dateOfJoining: backendEmp.date_of_joining\n      ? new Date(backendEmp.date_of_joining || '').toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric', timeZone: 'UTC' })\n      : 'N/A',\n    experience: (backendEmp as any).experience || 0,\n    skillsets: (backendEmp as any).skills?.join(', ') || 'None',\n    status: (backendEmp as any).user_employee?.is_active !== false ? 'active' : 'inactive',\n    department: (backendEmp as any).department?.name || 'Unassigned',\n    access: ((backendEmp as any).user_employee?.role?.name || 'Employee') as 'Admin' | 'Manager' | 'Leader' | 'Employee',\n    salary: (backendEmp as any).salary_yearly || (backendEmp as any).salary || 0,\n    currency: 'USD',\n    workingHours: (backendEmp as any).working_hours ? calculateWorkingHours((backendEmp as any).working_hours) : 0,\n    leaves: (backendEmp as any).no_of_leaves || 0,\n    roleId: (backendEmp as any).user_employee?.role_id,\n    roleColor: (backendEmp as any).user_employee?.role?.color,\n    employmentType: (backendEmp as any).employment_type || 'Full-time',\n  };\n\n  const handleDocumentPreview = (document: UserDocument) => {\n    setSelectedDocument(document);\n    setIsPreviewModalOpen(true);\n  };\n\n  const handleDocumentDownload = (document: UserDocument) => {\n    if (document.fileUrl) {\n      window.open(document.fileUrl, '_blank');\n    } else {\n      message.warning('Document URL not available');\n    }\n  };\n\n  const handleDocumentUpload = (documentTypeId: string) => {\n    message.info(`Upload functionality for document type ${documentTypeId} - To be implemented`);\n    // TODO: Implement upload functionality\n  };\n\n  return (\n    <PageLayout\n      title=\"Employee Details\"\n      titleAction={{\n        label: \"Back\",\n        icon: <ArrowLeft className=\"w-5 h-5\" />,\n        onClick: () => router.push('/dashboard/employees'),\n        variant: \"outline\"\n      }}\n      action={\n        <Button\n          type=\"primary\"\n          onClick={() => setIsDialogOpen(true)}\n          className=\"flex items-center gap-2 bg-[#111111] text-white hover:bg-[#000000] border-0 h-10 px-5 rounded-full font-['Manrope:SemiBold',sans-serif]\"\n        >\n          <Edit className=\"w-4 h-4\" />\n          Edit Profile\n        </Button>\n      }\n    >\n      <div className=\"bg-white rounded-[24px] border border-[#EEEEEE] p-8 max-w-4xl mx-auto mt-6\">\n        <div className=\"flex items-start justify-between mb-8\">\n          <div>\n            <h1 className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">{employee.name}</h1>\n            <div className=\"flex items-center gap-2 text-[#666666]\">\n              <Briefcase className=\"w-4 h-4\" />\n              <span className=\"text-sm font-['Manrope:Medium',sans-serif]\">{employee.role} • {employee.department}</span>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <AccessBadge role={employee.access} color={employee.roleColor} />\n            <Tag className={`flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-medium border ${employee.status === 'active'\n              ? 'bg-green-50 text-green-700 border-green-200'\n              : 'bg-red-50 text-red-700 border-red-200'\n              }`}>\n              {employee.status === 'active' ? 'Active' : 'Inactive'}\n            </Tag>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n          {/* Contact Info */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-sm font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Contact Information</h3>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-[#F7F7F7] flex items-center justify-center\">\n                  <Mail className=\"w-5 h-5 text-[#666666]\" />\n                </div>\n                <div>\n                  <p className=\"text-xs text-[#999999] m-0\">Email Address</p>\n                  <p className=\"text-sm font-medium text-[#111111] m-0\">{employee.email}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-[#F7F7F7] flex items-center justify-center\">\n                  <Phone className=\"w-5 h-5 text-[#666666]\" />\n                </div>\n                <div>\n                  <p className=\"text-xs text-[#999999] m-0\">Phone Number</p>\n                  <p className=\"text-sm font-medium text-[#111111] m-0\">{employee.phone}</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Employment Details */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-sm font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Employment Details</h3>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-[#F7F7F7] flex items-center justify-center\">\n                  <Calendar className=\"w-5 h-5 text-[#666666]\" />\n                </div>\n                <div>\n                  <p className=\"text-xs text-[#999999] m-0\">Date of Joining</p>\n                  <p className=\"text-sm font-medium text-[#111111] m-0\">{employee.dateOfJoining}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-[#F7F7F7] flex items-center justify-center\">\n                  <DollarSign className=\"w-5 h-5 text-[#666666]\" />\n                </div>\n                <div className=\"flex flex-col\">\n                  <p className=\"text-xs text-[#999999] m-0\">Hourly Rate</p>\n                  {/* Ensure minimum height to match other items even if N/A */}\n                  <div className=\"min-h-[20px] flex items-center\">\n                    <p className=\"text-sm font-medium text-[#111111] m-0\">{employee.hourlyRate}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <Divider className=\"my-8\" />\n\n        {/* Skills & Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <div className=\"p-4 bg-[#F7F7F7] rounded-xl\">\n            <p className=\"text-xs text-[#999999] mb-1\">Experience</p>\n            <p className=\"text-xl font-bold text-[#111111]\">{employee.experience} Years</p>\n          </div>\n          <div className=\"p-4 bg-[#F7F7F7] rounded-xl\">\n            <p className=\"text-xs text-[#999999] mb-1\">Working Hours</p>\n            <p className=\"text-xl font-bold text-[#111111]\">{employee.workingHours === 0 ? 'N/A' : `${employee.workingHours}h / week`}</p>\n          </div>\n          <div className=\"p-4 bg-[#F7F7F7] rounded-xl\">\n            <p className=\"text-xs text-[#999999] mb-1\">Leaves Balance</p>\n            <p className=\"text-xl font-bold text-[#111111]\">{employee.leaves} Days</p>\n          </div>\n        </div>\n\n        <div className=\"mt-8\">\n          <h3 className=\"text-sm font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide mb-4\">Skillsets</h3>\n          <div className=\"flex flex-wrap gap-2\">\n            {employee.skillsets.split(',').map((skill: string, index: number) => (\n              <Tag key={index} className=\"bg-[#F7F7F7] text-[#111111] hover:bg-[#EEEEEE] border-0 rounded-full px-3 py-1\">\n                {skill.trim()}\n              </Tag>\n            ))}\n          </div>\n        </div>\n\n        <Divider className=\"my-8\" />\n\n        {/* Documents Section */}\n        <div>\n          <h3 className=\"text-sm font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide mb-4\">Attached Documents</h3>\n          {documents && documents.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {documents.map((doc: UserDocument) => (\n                <DocumentCard\n                  key={doc.id}\n                  document={doc}\n                  onPreview={handleDocumentPreview}\n                  onDownload={handleDocumentDownload}\n                  showUpload={!doc.fileUrl}\n                  onUpload={handleDocumentUpload}\n                />\n              ))}\n            </div>\n          ) : (\n            <div className=\"border border-[#EEEEEE] border-dashed rounded-lg p-8 bg-[#FAFAFA] text-center\">\n              <FileText className=\"w-12 h-12 text-[#CCCCCC] mx-auto mb-3\" />\n              <p className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666] mb-1\">\n                No documents uploaded\n              </p>\n              <p className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                Documents will appear here once uploaded\n              </p>\n            </div>\n          )}\n        </div>\n\n      </div>\n\n      {/* Document Preview Modal */}\n      <DocumentPreviewModal\n        open={isPreviewModalOpen}\n        onClose={() => {\n          setIsPreviewModalOpen(false);\n          setSelectedDocument(null);\n        }}\n        document={selectedDocument}\n      />\n\n      <Modal\n        open={isDialogOpen}\n        onCancel={() => setIsDialogOpen(false)}\n        footer={null}\n        width={700}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n      >\n        <div className=\"p-0\">\n          <div className=\"border-b border-[#EEEEEE] mb-6 pb-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"flex items-center gap-2 text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                {/* User icon could be added here similar to EmployeesPage */}\n                Edit Employee Details\n              </div>\n            </div>\n            <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif]\">\n              Update employee profile, access, and HR details.\n            </p>\n          </div>\n\n          <EmployeeForm\n            departments={departmentsData?.result?.filter((dept: any) => dept.is_active !== false).map((dept: any) => dept.name) || []}\n            initialData={{\n              firstName: employee.name.split(\" \")[0] || \"\",\n              lastName: employee.name.split(\" \").slice(1).join(\" \") || \"\",\n              role: employee.role,\n              email: employee.email,\n              phone: employee.phone,\n              department: employee.department,\n              hourlyRate: employee.hourlyRate,\n              dateOfJoining: backendEmp?.date_of_joining ? new Date(backendEmp.date_of_joining).toISOString().split('T')[0] : '',\n              experience: employee.experience.toString(),\n              skillsets: employee.skillsets,\n              access: employee.access,\n              salary: employee.salary.toString(),\n              currency: employee.currency,\n              workingHours: employee.workingHours.toString(),\n              leaves: employee.leaves.toString(),\n              role_id: employee.roleId,\n              employmentType: (() => {\n                const type = employee.employmentType;\n                if (type === 'In-house') return 'Full-time';\n                if (type === 'Freelancer' || type === 'Agency') return 'Contract';\n                if (type === 'Full-time' || type === 'Contract' || type === 'Part-time') return type;\n                return 'Full-time' as 'Full-time' | 'Contract' | 'Part-time';\n              })()\n            }}\n            onSubmit={handleUpdateEmployee}\n            onCancel={() => setIsDialogOpen(false)}\n            isEditing={true}\n          />\n        </div>\n      </Modal>\n    </PageLayout>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/employees/EmployeesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":2,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":2,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":59},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Dropdown' is defined but never used.","line":4,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSearchParams' is defined but never used.","line":20,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":28,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'companyData' is assigned a value but never used.","line":56,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3666,3669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3666,3669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7649,7652],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7649,7652],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":107,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":110,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7694,7697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7694,7697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":238,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9830,9833],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9830,9833],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":255,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10308,10311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10308,10311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":274,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":274,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":315,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12549,12552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12549,12552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":323,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":323,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12825,12828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12825,12828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":362,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":362,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14224,14227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14224,14227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":398,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":398,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":420,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":420,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16137,16140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16137,16140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":462,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":462,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":473,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":473,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":479,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":479,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18576,18579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18576,18579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":480,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":480,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18625,18628],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18625,18628],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":486,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":486,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18869,18872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18869,18872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":513,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":513,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20130,20133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20130,20133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":513,"column":111,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":513,"endColumn":114,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20149,20152],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20149,20152],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":548,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":548,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":561,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":561,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22133,22136],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22133,22136],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":572,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":572,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22445,22448],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22445,22448],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":584,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":584,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22970,22973],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22970,22973],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":614,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":614,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":625,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":625,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":631,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":631,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24873,24876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24873,24876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":632,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24916,24919],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24916,24919],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":632,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24961,24964],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24961,24964],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":632,"column":138,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":141,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25027,25030],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25027,25030],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":633,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":633,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25089,25092],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25089,25092],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":648,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":648,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25787,25790],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25787,25790],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":649,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":649,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25858,25861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25858,25861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":665,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":665,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26490,26493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26490,26493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":666,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":666,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26555,26558],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26555,26558],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":666,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":666,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26593,26596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26593,26596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":668,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":668,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26686,26689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26686,26689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":668,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":668,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26724,26727],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26724,26727],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":669,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":669,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26781,26784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26781,26784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":670,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":670,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26849,26852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26849,26852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":670,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":670,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26880,26883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26880,26883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":672,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":672,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26976,26979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26976,26979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":674,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":674,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27071,27074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27071,27074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":675,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":675,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27123,27126],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27123,27126],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":676,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":676,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27173,27176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27173,27176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":677,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":677,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27226,27229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27226,27229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":678,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":678,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27281,27284],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27281,27284],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":679,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":679,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27338,27341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27338,27341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":680,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":680,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27399,27402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27399,27402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":686,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":686,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27762,27765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27762,27765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":686,"column":111,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":686,"endColumn":114,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27781,27784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27781,27784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":717,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":717,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":782,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":782,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":815,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":815,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32509,32512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32509,32512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":827,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":827,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33068,33071],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33068,33071],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":856,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":856,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1116,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1116,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46131,46134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46131,46134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1116,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1116,"endColumn":111,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46176,46179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46176,46179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":1141,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":1141,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1170,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1170,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[48577,48580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[48577,48580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":64,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { PageLayout } from '../../layout/PageLayout';\nimport { useState, useMemo, useRef, useEffect, useCallback } from 'react';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { Checkbox, Tooltip, Dropdown, App, Modal } from \"antd\";\nimport { ShieldCheck, Briefcase, Download, Trash2, User as UserIcon, Users } from 'lucide-react';\nimport { EmployeeForm, EmployeeFormData } from '../../modals/EmployeesForm';\nimport { EmployeeDetailsModal } from '../../modals/EmployeeDetailsModal';\nimport { EmployeeRow } from './rows/EmployeeRow';\nimport { PaginationBar } from '../../ui/PaginationBar';\nimport {\n  useEmployees,\n  useCreateEmployee,\n  useUpdateEmployee,\n  useUpdateEmployeeStatus,\n  useCompanyDepartments,\n  useUserDetails,\n  useRoles,\n  useCurrentUserCompany,\n} from '../../../hooks/useUser';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { Employee } from '@/types/domain';\nimport { UserDto } from '@/types/dto/user.dto';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { getRoleFromUser } from '@/utils/roleUtils';\n\nexport function EmployeesPage() {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n  const { modal, message } = App.useApp();\n  // searchParams/router now handled by useTabSync, keeping searchParams if needed for other hooks or manual check\n  // actually useTabSync handles activeTab sync, but queryParams depends on activeTab, which is fine.\n\n  const [activeTab, setActiveTab] = useTabSync<'active' | 'inactive'>({\n    defaultTab: 'active',\n    validTabs: ['active', 'inactive']\n  });\n\n  // Sync activeTab with URL - handled by useTabSync\n  // useEffect(() => { ... }) removed\n\n  // Build query parameters based on active tab\n  const queryParams = useMemo(() => {\n    const params = new URLSearchParams();\n    if (activeTab === 'inactive') {\n      params.append('is_active', 'false');\n    } else {\n      params.append('is_active', 'true');\n    }\n    return params.toString();\n  }, [activeTab]);\n\n  const { data: employeesData, isLoading } = useEmployees(queryParams);\n  const { data: departmentsData } = useCompanyDepartments();\n  const { data: currentUserData } = useUserDetails();\n  const { data: companyData } = useCurrentUserCompany();\n  const { data: rolesData } = useRoles();\n  const createEmployeeMutation = useCreateEmployee();\n  const updateEmployeeMutation = useUpdateEmployee();\n  const updateEmployeeStatusMutation = useUpdateEmployeeStatus();\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    role: 'All',\n    department: 'All',\n    access: 'All',\n    employmentType: 'All'\n  });\n  const [selectedEmployees, setSelectedEmployees] = useState<number[]>([]);\n  const [showAccessDropdown, setShowAccessDropdown] = useState(false);\n  const [showDepartmentDropdown, setShowDepartmentDropdown] = useState(false);\n  const accessDropdownRef = useRef<HTMLDivElement>(null);\n  const departmentDropdownRef = useRef<HTMLDivElement>(null);\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n\n\n\n  // Modal State\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingEmployee, setEditingEmployee] = useState<Employee | null>(null);\n  const [isDetailsModalOpen, setIsDetailsModalOpen] = useState(false);\n  const [selectedEmployeeForDetails, setSelectedEmployeeForDetails] = useState<Employee | null>(null);\n\n\n  // Transform backend data to UI format\n  const employees = useMemo(() => {\n    if (!employeesData?.result) return [];\n    return employeesData.result.map((emp: any) => ({\n      id: emp.user_id || emp.id,\n      name: emp.name || '',\n      role: emp.designation || 'Unassigned',\n      email: emp.email || '',\n      phone: emp.mobile_number || emp.phone || emp.user_profile?.mobile_number || emp.user_profile?.phone || emp.user?.mobile_number || '',\n      hourlyRate: emp.hourly_rates ? `${emp.hourly_rates}/Hr` : 'N/A',\n      dateOfJoining: emp.date_of_joining ? new Date(emp.date_of_joining).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric', timeZone: 'UTC' }) : 'N/A',\n      experience: emp.experience || 0,\n      skillsets: emp.skills?.join(', ') || 'None',\n\n      status: (emp.user_employee?.is_active !== false ? 'active' : 'inactive') as 'active' | 'inactive',\n      department: emp.department?.name || 'Unassigned',\n      access: getRoleFromUser(emp.user_employee),\n      roleId: emp.user_employee?.role_id,\n      manager_id: emp.manager_id, // Added manager_id\n      managerName: emp.manager?.name || 'Unassigned', // Added managerName\n      roleColor: emp.user_employee?.role?.color,\n      salary: emp.salary_yearly || emp.salary || 0,\n      currency: 'USD',\n      workingHours: emp.working_hours?.start_time && emp.working_hours?.end_time ? 8 : 0,\n      rawWorkingHours: emp.working_hours,\n      leaves: emp.no_of_leaves || 0,\n      // Map employment type - convert old values to new format\n      employmentType: (() => {\n        // If backend provides employment type, use it; otherwise default\n        const type = emp.employment_type || emp.employmentType;\n        if (type === 'In-house') return 'Full-time';\n        if (type === 'Freelancer' || type === 'Agency') return 'Contract';\n        if (type === 'Full-time' || type === 'Contract' || type === 'Part-time') return type;\n        return 'Full-time';\n      })(),\n    }));\n  }, [employeesData]);\n\n  const filteredEmployees = useMemo(() => {\n    return employees.filter(emp => {\n      const matchesTab = emp.status === activeTab;\n      const matchesSearch = searchQuery === '' ||\n        emp.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        emp.role.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        emp.skillsets.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesRole = filters.role === 'All' || emp.role === filters.role;\n      const matchesDept = filters.department === 'All' || emp.department === filters.department;\n\n      // Handle \"Employee\" display mapping for \"Member\" role\n      const matchesAccess = filters.access === 'All' ||\n        (filters.access === 'Employee'\n          ? (emp.access === 'Employee')\n          : emp.access === filters.access);\n\n      const matchesType = filters.employmentType === 'All' ||\n        (filters.employmentType === 'Full-time' && (emp.employmentType === 'Full-time' || emp.employmentType === 'In-house')) ||\n        (filters.employmentType === 'Contract' && (emp.employmentType === 'Contract' || emp.employmentType === 'Freelancer' || emp.employmentType === 'Agency')) ||\n        (filters.employmentType === 'Part-time' && emp.employmentType === 'Part-time') ||\n        (filters.employmentType !== 'All' && emp.employmentType === filters.employmentType);\n\n      return matchesTab && matchesSearch && matchesRole && matchesDept && matchesAccess && matchesType;\n    });\n  }, [employees, activeTab, searchQuery, filters]);\n\n  // Pagination\n  const paginatedEmployees = useMemo(() => {\n    const startIndex = (currentPage - 1) * pageSize;\n    return filteredEmployees.slice(startIndex, startIndex + pageSize);\n  }, [filteredEmployees, currentPage, pageSize]);\n\n  // Get unique roles and departments\n  const uniqueRoles = useMemo(() => ['All', ...Array.from(new Set(employees.map(emp => emp.role)))], [employees]);\n\n  // Get departments from backend if available, otherwise from employees\n  const uniqueDepts = useMemo(() => {\n    if (departmentsData?.result && departmentsData.result.length > 0) {\n      return ['All', ...departmentsData.result.filter((dept: any) => dept.is_active !== false).map((dept: any) => dept.name)];\n    }\n    return ['All', ...Array.from(new Set(employees.map(emp => emp.department)))];\n  }, [departmentsData, employees]);\n\n  // Defined access levels\n  const accessOptions = ['All', 'Admin', 'Manager', 'Leader', 'Employee'];\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'role',\n      label: 'Designation',\n      options: uniqueRoles,\n      placeholder: 'Designation',\n      defaultValue: 'All'\n    },\n    {\n      id: 'department',\n      label: 'Department',\n      options: uniqueDepts,\n      placeholder: 'Department',\n      defaultValue: 'All'\n    },\n    {\n      id: 'employmentType',\n      label: 'Employment Type',\n      options: ['All', 'Full-time', 'Contract', 'Part-time'],\n      placeholder: 'Employment Type',\n      defaultValue: 'All'\n    },\n    {\n      id: 'access',\n      label: 'Access Level',\n      options: accessOptions,\n      placeholder: 'Access Level',\n      defaultValue: 'All'\n    }\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n    setCurrentPage(1);\n  };\n\n  const clearFilters = () => {\n    setFilters({ role: 'All', department: 'All', access: 'All', employmentType: 'All' });\n    setSearchQuery('');\n    setCurrentPage(1);\n  };\n\n  const handleOpenDialog = (employee?: Employee) => {\n    setEditingEmployee(employee || null);\n    setIsDialogOpen(true);\n  };\n\n  const handleViewDetails = (employee: Employee) => {\n    setSelectedEmployeeForDetails(employee);\n    setIsDetailsModalOpen(true);\n  };\n\n  const handleDeactivateEmployee = async (employeeId: number, isCurrentlyActive: boolean) => {\n    if (employeeId === currentUserId && isCurrentlyActive) {\n      message.error(\"You cannot deactivate your own account.\");\n      return;\n    }\n    updateEmployeeStatusMutation.mutate(\n      {\n        user_id: employeeId,\n        is_active: !isCurrentlyActive,\n      },\n      {\n        onSuccess: () => {\n          message.success(`Employee ${isCurrentlyActive ? 'deactivated' : 'activated'} successfully!`);\n        },\n        onError: (error: Error) => {\n          const errorMessage = (error as any)?.response?.data?.message || \"Failed to update employee status\";\n          message.error(errorMessage);\n        },\n      }\n    );\n  };\n\n  const handleSaveEmployee = async (data: EmployeeFormData) => {\n    if (!data.firstName) {\n      message.error(\"First name is required\");\n      return;\n    }\n\n    const fullName = `${data.firstName} ${data.lastName}`.trim();\n\n    // Find department ID from name\n    const selectedDepartment = departmentsData?.result?.find(\n      (dept: any) => dept.name === data.department\n    );\n    const departmentId = selectedDepartment?.id || null;\n\n    // Map access level to role_id\n    const roleName = data.access || 'Employee';\n    const roleId = rolesData?.result?.find((r: { name: string; id: number }) => r.name === roleName)?.id;\n\n    // Parse hourly rate (remove $ if present)\n    const hourlyRate = parseFloat(data.hourlyRate.replace(/[^0-9.]/g, '')) || 0;\n\n    // Parse date of joining\n    let dateOfJoining = new Date().toISOString();\n    if (data.dateOfJoining) {\n      try {\n        const date = new Date(data.dateOfJoining);\n        if (!isNaN(date.getTime())) {\n          dateOfJoining = date.toISOString();\n        }\n      } catch (e) {\n        // Invalid date format\n      }\n    }\n\n    // Construct working hours object\n    const workingHours = {\n      start_time: data.workingHoursStart || \"09:00 AM\",\n      end_time: data.workingHoursEnd || \"05:00 PM\"\n    };\n\n    // Construct full mobile number with country code\n    const countryCode = data.countryCode || \"+91\";\n    // Ensure phone number doesn't already have the code if user typed it\n    let phoneNumber = data.phone;\n    if (phoneNumber.startsWith(countryCode)) {\n      phoneNumber = phoneNumber.replace(countryCode, \"\").trim();\n    }\n    const fullMobileNumber = `${countryCode} ${phoneNumber}`.trim();\n\n    if (editingEmployee) {\n      updateEmployeeMutation.mutate(\n        {\n          id: editingEmployee.id,\n          name: fullName,\n          first_name: data.firstName,\n          last_name: data.lastName,\n          email: data.email,\n          mobile_number: fullMobileNumber,\n          designation: data.role,\n          department_id: departmentId,\n          role_id: roleId, // Send resolved role ID\n          experience: parseInt(data.experience) || 0,\n          skills: data.skillsets.split(',').map((s: string) => s.trim()).filter((s: string) => s.length > 0),\n          date_of_joining: dateOfJoining,\n          salary_yearly: parseFloat(data.salary) || 0,\n          hourly_rates: hourlyRate,\n          no_of_leaves: parseFloat(data.leaves) || 0,\n          working_hours: workingHours,\n          employment_type: data.employmentType,\n          manager_id: data.manager_id,\n        } as unknown as any,\n        {\n          onSuccess: () => {\n            message.success(\"Employee updated successfully!\");\n            setIsDialogOpen(false);\n            setEditingEmployee(null);\n          },\n          onError: (error: Error) => {\n            const errorMessage = (error as any)?.response?.data?.message || \"Failed to update employee\";\n            message.error(errorMessage);\n          },\n        }\n      );\n    } else {\n      // Validate role is present\n      if (!roleName || !roleId) {\n        message.error(\"Please select a valid access level\");\n        return;\n      }\n\n      createEmployeeMutation.mutate(\n        {\n          name: fullName,\n          first_name: data.firstName,\n          last_name: data.lastName,\n          email: data.email,\n          mobile_number: fullMobileNumber,\n          designation: data.role,\n          department_id: departmentId,\n          role_id: roleId, // Send resolved role ID\n          experience: parseInt(data.experience) || 0,\n          skills: data.skillsets.split(',').map((s: string) => s.trim()).filter((s: string) => s.length > 0),\n          date_of_joining: dateOfJoining,\n\n          salary_yearly: parseFloat(data.salary) || 0,\n          hourly_rates: hourlyRate,\n          no_of_leaves: parseFloat(data.leaves) || 0,\n          working_hours: workingHours,\n          employment_type: data.employmentType,\n          manager_id: data.manager_id,\n        } as unknown as Partial<UserDto>,\n        {\n          onSuccess: () => {\n            message.success(\"Employee created successfully!\");\n            setIsDialogOpen(false);\n          },\n          onError: (error: Error) => {\n            const errorMessage = (error as any)?.response?.data?.message || \"Failed to create employee\";\n            message.error(errorMessage);\n          },\n        }\n      );\n    }\n  };\n\n  const toggleSelectAll = () => {\n    const currentIds = paginatedEmployees.map(e => e.id);\n    const allCurrentSelected = currentIds.every(id => selectedEmployees.includes(id));\n\n    if (allCurrentSelected) {\n      setSelectedEmployees(selectedEmployees.filter(id => !currentIds.includes(id)));\n    } else {\n      setSelectedEmployees([...new Set([...selectedEmployees, ...currentIds])]);\n    }\n  };\n\n  const toggleSelect = (id: number) => {\n    if (selectedEmployees.includes(id)) {\n      setSelectedEmployees(selectedEmployees.filter(empId => empId !== id));\n    } else {\n      setSelectedEmployees([...selectedEmployees, id]);\n    }\n  };\n\n  // Get current user ID to prevent self-deactivation\n  const currentUserId = useMemo(() => {\n    try {\n      if (typeof window !== 'undefined') {\n        const localUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n        if (localUser?.id || localUser?.user_id) {\n          return localUser.id || localUser.user_id;\n        }\n      }\n    } catch (error) {\n      // Error reading user from localStorage\n    }\n    return currentUserData?.result?.user?.id || currentUserData?.result?.user?.user_id || null;\n  }, [currentUserData]);\n\n  // Bulk update access level\n  const handleBulkUpdateAccess = async (access: string) => { // access is role name\n    if (selectedEmployees.length === 0) {\n      message.warning('Please select at least one employee');\n      return;\n    }\n\n    // Find role ID from name\n    const selectedRole = rolesData?.result?.find((r: { name: string; id: number }) => r.name === access);\n    if (!selectedRole) {\n      message.error(`Role \"${access}\" not found`);\n      return;\n    }\n    const roleId = selectedRole.id;\n\n    // Prepare all update payloads first\n    const updatePromises: Promise<any>[] = [];\n    const failedEmployees: { id: number; name: string; reason: string }[] = [];\n\n    for (const empId of selectedEmployees) {\n      // Get employee data to include required fields\n      const employee = employees.find(e => e.id === empId);\n      if (!employee) {\n        failedEmployees.push({ id: empId, name: 'Unknown', reason: 'Employee not found in list' });\n        continue;\n      }\n\n      // Get raw backend employee data to preserve all fields\n      const rawEmployee = employeesData?.result?.find((emp: Employee) => {\n        const empBackendId = emp.user_id || emp.id;\n        return empBackendId === empId || empBackendId === parseInt(String(empId));\n      });\n      if (!rawEmployee) {\n        failedEmployees.push({ id: empId, name: employee.name, reason: 'Raw employee data not found' });\n        continue;\n      }\n\n      // Parse hourly rate from display format (e.g., \"200/Hr\" -> 200)\n      const hourlyRate = employee.hourlyRate && employee.hourlyRate !== 'N/A'\n        ? parseFloat(employee.hourlyRate.replace(/[^0-9.]/g, ''))\n        : (rawEmployee.hourly_rates || null);\n\n      // Parse date of joining - try multiple formats\n      let dateOfJoining = null;\n      if (employee.dateOfJoining && employee.dateOfJoining !== 'N/A') {\n        try {\n          // Parse from format \"DD-MMM-YYYY\" (e.g., \"17-Dec-2007\")\n          const dateParts = employee.dateOfJoining.split('-');\n          if (dateParts.length === 3) {\n            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n            const monthIndex = monthNames.indexOf(dateParts[1]);\n            if (monthIndex !== -1) {\n              const date = new Date(parseInt(dateParts[2]), monthIndex, parseInt(dateParts[0]));\n              if (!isNaN(date.getTime())) {\n                dateOfJoining = date.toISOString();\n              }\n            }\n          }\n        } catch (e) {\n          // Error parsing date\n        }\n      }\n      // Fallback to raw employee date\n      if (!dateOfJoining && rawEmployee.date_of_joining) {\n        try {\n          const date = new Date(rawEmployee.date_of_joining || '');\n          if (!isNaN(date.getTime())) {\n            dateOfJoining = date.toISOString();\n          }\n        } catch (e) {\n          // Error parsing raw date\n        }\n      }\n\n      // Ensure working_hours is an object (not null) - backend requires object type\n      let workingHours: any = undefined;\n      const re = rawEmployee as any;\n      if (re.working_hours && typeof re.working_hours === 'object' && !Array.isArray(re.working_hours)) {\n        workingHours = re.working_hours;\n      }\n\n      // Build update payload with all preserved fields\n      const updatePayload: any = {\n        id: empId,\n        name: employee.name, // Required\n        email: employee.email, // Required\n        role_id: roleId, // Send resolved role ID\n        // Preserve all existing fields to prevent them from being set to null\n        designation: re.designation || null,\n        mobile_number: re.mobile_number || re.phone || null,\n        hourly_rates: hourlyRate,\n        salary_yearly: re.salary_yearly || re.salary || null,\n        experience: re.experience || 0,\n        skills: Array.isArray(re.skills) ? re.skills : [],\n        date_of_joining: dateOfJoining,\n        no_of_leaves: re.no_of_leaves || null,\n        // Preserve address fields\n        address: re.address || null,\n        city: re.city || null,\n        state: re.state || null,\n        zipcode: re.zipcode || null,\n        country: re.country || null,\n        late_time: re.late_time || null,\n        profile_pic: re.profile_pic || null,\n        // Only include working_hours if it's a valid object, otherwise omit it (don't send null)\n        ...(workingHours !== undefined ? { working_hours: workingHours } : {}),\n      };\n\n      // Create promise for this update using mutateAsync\n      const updatePromise = updateEmployeeMutation.mutateAsync(updatePayload as unknown as any).catch((error: any) => {\n        const errorMsg = error?.response?.data?.message || 'Update failed';\n        failedEmployees.push({ id: empId, name: employee.name, reason: errorMsg });\n        throw error; // Re-throw to mark as failed in Promise.allSettled\n      });\n\n      updatePromises.push(updatePromise);\n    }\n\n    // Execute all updates and wait for completion\n    try {\n      const results = await Promise.allSettled(updatePromises);\n\n      // Count successful updates\n      const successfulUpdates = results.filter(r => r.status === 'fulfilled').length;\n      const totalFailed = failedEmployees.length;\n      const totalSelected = selectedEmployees.length;\n\n      if (totalFailed === 0 && successfulUpdates === totalSelected) {\n        message.success(`Updated access level to ${access} for ${totalSelected} employee(s)`);\n        setSelectedEmployees([]);\n        setShowAccessDropdown(false);\n        // Query invalidation is handled in the hook's onSuccess, but we can force refetch\n        queryClient.invalidateQueries({ queryKey: [\"employees\"] });\n        // Also invalidate user details if current user's role was updated\n        if (currentUserId && selectedEmployees.includes(currentUserId)) {\n          queryClient.invalidateQueries({ queryKey: [\"user\", \"details\"] });\n        }\n      } else if (successfulUpdates > 0) {\n        message.warning(`Updated ${successfulUpdates} employee(s), ${totalFailed} failed`);\n        // Failed employees logged\n      } else {\n        message.error(`Failed to update all ${totalSelected} employee(s)`);\n        // Failed employees logged\n      }\n    } catch (error) {\n      message.error('An error occurred during bulk update');\n    }\n  };\n\n  // Bulk update department\n  const handleBulkUpdateDepartment = async (departmentName: string) => {\n    if (selectedEmployees.length === 0) {\n      message.warning('Please select at least one employee');\n      return;\n    }\n\n    const selectedDepartment = departmentsData?.result?.find(\n      (dept: any) => dept.name === departmentName\n    );\n\n    if (!selectedDepartment || !selectedDepartment.id) {\n      message.error(`Department \"${departmentName}\" not found`);\n      return;\n    }\n\n    const departmentId = selectedDepartment.id;\n\n    // Prepare all update payloads first\n    const updatePromises: Promise<any>[] = [];\n    const failedEmployees: { id: number; name: string; reason: string }[] = [];\n\n    for (const empId of selectedEmployees) {\n      // Get employee data to include required fields\n      const employee = employees.find(e => e.id === empId);\n      if (!employee) {\n        failedEmployees.push({ id: empId, name: 'Unknown', reason: 'Employee not found in list' });\n        continue;\n      }\n\n      // Get raw backend employee data to preserve all fields\n      const rawEmployee = employeesData?.result?.find((emp: any) => {\n        const empBackendId = emp.user_id || emp.id;\n        return empBackendId === empId || empBackendId === parseInt(String(empId));\n      });\n      if (!rawEmployee) {\n        failedEmployees.push({ id: empId, name: employee.name, reason: 'Raw employee data not found' });\n        continue;\n      }\n\n      // Parse hourly rate from display format (e.g., \"200/Hr\" -> 200)\n      const hourlyRate = employee.hourlyRate && employee.hourlyRate !== 'N/A'\n        ? parseFloat(employee.hourlyRate.replace(/[^0-9.]/g, ''))\n        : (rawEmployee.hourly_rates || null);\n\n      // Parse date of joining - try multiple formats\n      let dateOfJoining = null;\n      if (employee.dateOfJoining && employee.dateOfJoining !== 'N/A') {\n        try {\n          // Parse from format \"DD-MMM-YYYY\" (e.g., \"17-Dec-2007\")\n          const dateParts = employee.dateOfJoining.split('-');\n          if (dateParts.length === 3) {\n            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n            const monthIndex = monthNames.indexOf(dateParts[1]);\n            if (monthIndex !== -1) {\n              const date = new Date(parseInt(dateParts[2]), monthIndex, parseInt(dateParts[0]));\n              if (!isNaN(date.getTime())) {\n                dateOfJoining = date.toISOString();\n              }\n            }\n          }\n        } catch (e) {\n          // Error parsing date\n        }\n      }\n      // Fallback to raw employee date\n      if (!dateOfJoining && rawEmployee.date_of_joining) {\n        try {\n          const date = new Date(rawEmployee.date_of_joining);\n          if (!isNaN(date.getTime())) {\n            dateOfJoining = date.toISOString();\n          }\n        } catch (e) {\n          // Error parsing raw date\n        }\n      }\n\n      // Ensure working_hours is an object (not null) - backend requires object type\n      let workingHours: any = undefined;\n      if ((rawEmployee as any).working_hours && typeof (rawEmployee as any).working_hours === 'object' && !Array.isArray((rawEmployee as any).working_hours)) {\n        workingHours = (rawEmployee as any).working_hours;\n      }\n\n      // Resolve current role ID\n      let currentRoleId = employee.roleId;\n      if (!currentRoleId && employee.access) {\n        const foundRole = rolesData?.result?.find((r: { name: string; id: number }) => r.name === employee.access);\n        if (foundRole) currentRoleId = foundRole.id;\n      }\n\n      // Fallback to null if not found (though update might require it if we don't partial update carefully, \n      // but payload includes all strict fields). \n      // Actually backend updateUserService updates everything passed. If we pass null, it might error.\n      // But typically we should keep existing if we can.\n\n      if (!currentRoleId && (rawEmployee as any).user_employee?.role_id) {\n        currentRoleId = (rawEmployee as any).user_employee.role_id;\n      }\n\n      if (!currentRoleId) {\n        failedEmployees.push({ id: empId, name: employee.name, reason: 'Unable to determine current role' });\n        continue;\n      }\n\n      // Build update payload with all preserved fields\n      const updatePayload = {\n        id: empId,\n        name: employee.name, // Required\n        email: employee.email, // Required\n        role_id: currentRoleId, // Preserve current role ID\n        department_id: departmentId, // The field we're updating\n        // Preserve all existing fields to prevent them from being set to null\n        designation: (rawEmployee as any).designation || null,\n        mobile_number: (rawEmployee as any).mobile_number || (rawEmployee as any).phone || null,\n        hourly_rates: hourlyRate,\n        salary_yearly: (rawEmployee as any).salary_yearly || (rawEmployee as any).salary || null,\n        experience: (rawEmployee as any).experience || 0,\n        skills: Array.isArray((rawEmployee as any).skills) ? (rawEmployee as any).skills : [],\n        date_of_joining: dateOfJoining,\n        no_of_leaves: (rawEmployee as any).no_of_leaves || null,\n        // Preserve address fields\n        address: (rawEmployee as any).address || null,\n        city: (rawEmployee as any).city || null,\n        state: (rawEmployee as any).state || null,\n        zipcode: (rawEmployee as any).zipcode || null,\n        country: (rawEmployee as any).country || null,\n        late_time: (rawEmployee as any).late_time || null,\n        profile_pic: (rawEmployee as any).profile_pic || null,\n        // Only include working_hours if it's a valid object, otherwise omit it (don't send null)\n        ...(workingHours !== undefined ? { working_hours: workingHours } : {}),\n      };\n\n      // Create promise for this update using mutateAsync\n      const updatePromise = updateEmployeeMutation.mutateAsync(updatePayload as unknown as any).catch((error: any) => {\n        const errorMsg = error?.response?.data?.message || 'Update failed';\n        failedEmployees.push({ id: empId, name: employee.name, reason: errorMsg });\n        throw error; // Re-throw to mark as failed in Promise.allSettled\n      });\n\n      updatePromises.push(updatePromise);\n    }\n\n    // Execute all updates and wait for completion\n    try {\n      const results = await Promise.allSettled(updatePromises);\n\n      // Count successful updates\n      const successfulUpdates = results.filter(r => r.status === 'fulfilled').length;\n      const totalFailed = failedEmployees.length;\n      const totalSelected = selectedEmployees.length;\n\n      if (totalFailed === 0 && successfulUpdates === totalSelected) {\n        message.success(`Updated department to ${departmentName} for ${totalSelected} employee(s)`);\n        setSelectedEmployees([]);\n        setShowDepartmentDropdown(false);\n        // Query invalidation is handled in the hook's onSuccess, but we can force refetch\n        queryClient.invalidateQueries({ queryKey: [\"employees\"] });\n      } else if (successfulUpdates > 0) {\n        message.warning(`Updated ${successfulUpdates} employee(s), ${totalFailed} failed`);\n        // Failed employees logged\n      } else {\n        message.error(`Failed to update all ${totalSelected} employee(s)`);\n        // Failed employees logged\n      }\n    } catch (error) {\n      message.error('An error occurred during bulk update');\n    }\n  };\n\n  // Export to CSV\n  const handleExportToCSV = () => {\n    if (selectedEmployees.length === 0) {\n      message.warning('Please select at least one employee');\n      return;\n    }\n\n    // Get selected employees data - use employees array which contains all employees\n    const selectedEmployeesData = employees.filter(emp => selectedEmployees.includes(emp.id));\n\n    if (selectedEmployeesData.length === 0) {\n      message.error('No employee data found for selected employees');\n      return;\n    }\n\n    // CSV Headers\n    const headers = ['Name', 'Email', 'Role', 'Department', 'Access Level', 'Employment Type', 'Hourly Rate', 'Date of Joining', 'Status'];\n\n    // CSV Rows - escape special characters properly\n    const rows = selectedEmployeesData.map(emp => [\n      emp.name || '',\n      emp.email || '',\n      emp.role || '',\n      emp.department || '',\n      emp.access || '',\n      emp.employmentType || 'N/A',\n      emp.hourlyRate || 'N/A',\n      emp.dateOfJoining || 'N/A',\n      emp.status || ''\n    ]);\n\n    // Convert to CSV format with proper escaping\n    const escapeCSV = (cell: unknown): string => {\n      const str = String(cell || '');\n      // Escape quotes by doubling them, and wrap in quotes if contains comma, quote, or newline\n      if (str.includes(',') || str.includes('\"') || str.includes('\\n') || str.includes('\\r')) {\n        return `\"${str.replace(/\"/g, '\"\"')}\"`;\n      }\n      return str;\n    };\n\n    const csvContent = [\n      headers.join(','),\n      ...rows.map(row => row.map(escapeCSV).join(','))\n    ].join('\\n');\n\n    // Create blob and download\n    try {\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `employees_export_${new Date().toISOString().split('T')[0]}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url); // Clean up the URL\n\n      message.success(`Exported ${selectedEmployeesData.length} employee(s) to CSV`);\n    } catch (error) {\n      message.error('Failed to export employees to CSV');\n    }\n  };\n\n  // Bulk delete/deactivate\n  const handleBulkDelete = () => {\n    if (selectedEmployees.length === 0) {\n      message.warning('Please select at least one employee');\n      return;\n    }\n\n    // Filter out current user from selection\n    const employeesToDeactivate = selectedEmployees.filter(empId => empId !== currentUserId);\n\n    if (employeesToDeactivate.length !== selectedEmployees.length) {\n      message.warning('You cannot deactivate yourself. Removed from selection.');\n    }\n\n    if (employeesToDeactivate.length === 0) {\n      message.warning('No employees to deactivate');\n      setSelectedEmployees([]);\n      return;\n    }\n\n    modal.confirm({\n      title: 'Deactivate Employees',\n      content: `Are you sure you want to deactivate ${employeesToDeactivate.length} employee(s)?`,\n      okText: 'Yes, Deactivate',\n      okType: 'danger',\n      cancelText: 'Cancel',\n      onOk: async () => {\n        // Prepare all deactivation promises\n        const deactivatePromises: Promise<any>[] = [];\n        const failedEmployees: { id: number; name: string; reason: string }[] = [];\n\n        for (const empId of employeesToDeactivate) {\n          // Get employee name for error reporting\n          const employee = employees.find(e => e.id === empId);\n          const employeeName = employee?.name || 'Unknown';\n\n          // Create promise for this deactivation using mutateAsync\n          const deactivatePromise = updateEmployeeStatusMutation.mutateAsync({\n            user_id: empId,\n            is_active: false,\n          }).catch((error: any) => {\n            const errorMsg = error?.response?.data?.message || 'Deactivation failed';\n            failedEmployees.push({ id: empId, name: employeeName, reason: errorMsg });\n            throw error; // Re-throw to mark as failed in Promise.allSettled\n          });\n\n          deactivatePromises.push(deactivatePromise);\n        }\n\n        // Execute all deactivations and wait for completion\n        try {\n          const results = await Promise.allSettled(deactivatePromises);\n\n          // Count successful deactivations\n          const successfulDeactivations = results.filter(r => r.status === 'fulfilled').length;\n          const totalFailed = failedEmployees.length;\n          const totalToDeactivate = employeesToDeactivate.length;\n\n          if (totalFailed === 0 && successfulDeactivations === totalToDeactivate) {\n            message.success(`Deactivated ${totalToDeactivate} employee(s)`);\n            setSelectedEmployees([]);\n            // Query invalidation is handled in the hook's onSuccess\n          } else if (successfulDeactivations > 0) {\n            message.warning(`Deactivated ${successfulDeactivations} employee(s), ${totalFailed} failed`);\n            // Failed employees logged\n          } else {\n            message.error(`Failed to deactivate all ${totalToDeactivate} employee(s)`);\n            // Failed employees logged\n          }\n        } catch (error) {\n          message.error('An error occurred during bulk deactivation');\n        }\n      },\n    });\n  };\n\n  return (\n    <PageLayout\n      title=\"Employees\"\n      tabs={[\n        { id: 'active', label: 'Active' },\n        { id: 'inactive', label: 'Deactivated' }\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => {\n        const id = tabId as 'active' | 'inactive';\n        setActiveTab(id);\n        setCurrentPage(1);\n        setSelectedEmployees([]);\n      }}\n      titleAction={{\n        onClick: () => handleOpenDialog(),\n        label: \"Add Employee\"\n      }}\n    >\n      <div className=\"flex flex-col h-full relative\">\n        {/* Filters Bar */}\n        <div className=\"mb-6\">\n          <FilterBar\n            filters={filterOptions}\n            selectedFilters={filters}\n            onFilterChange={handleFilterChange}\n            onClearFilters={clearFilters}\n            searchPlaceholder=\"Search by name, role, or skill\"\n            searchValue={searchQuery}\n            onSearchChange={setSearchQuery}\n          />\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto pb-24\">\n          {/* Table Header */}\n          <div className=\"sticky top-0 z-20 bg-white grid grid-cols-[40px_2fr_1.8fr_1.2fr_1fr_1fr_1.2fr_40px] gap-4 px-4 py-3 mb-2 items-center\">\n            <div className=\"flex justify-center\">\n              <Checkbox\n                checked={paginatedEmployees.length > 0 &&\n                  paginatedEmployees.every(emp => selectedEmployees.includes(emp.id))}\n                onChange={toggleSelectAll}\n                className=\"red-checkbox\"\n              />\n            </div>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Name</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Email Address</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Access Level</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Type</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Hourly Rate</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\">Date of Joining</p>\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#6B7280] uppercase tracking-wider\"></p>\n          </div>\n\n          <div className=\"space-y-2\">\n            {paginatedEmployees.map((employee) => (\n              <EmployeeRow\n                key={employee.id}\n                employee={employee}\n                selected={selectedEmployees.includes(employee.id)}\n                onSelect={() => toggleSelect(employee.id)}\n                onEdit={() => handleOpenDialog(employee)}\n                onDeactivate={() => handleDeactivateEmployee(employee.id, employee.status === 'active')}\n                onViewDetails={() => handleViewDetails(employee)}\n                currentUserId={currentUserId}\n              />\n            ))}\n          </div>\n\n          {isLoading && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">Loading employees...</p>\n            </div>\n          )}\n\n          {!isLoading && filteredEmployees.length === 0 && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                No employees found\n              </p>\n            </div>\n          )}\n        </div>\n\n        <div className=\"bg-white\">\n          <PaginationBar\n            currentPage={currentPage}\n            totalItems={filteredEmployees.length}\n            pageSize={pageSize}\n            onPageChange={setCurrentPage}\n            onPageSizeChange={(size) => {\n              setPageSize(size);\n              setCurrentPage(1);\n            }}\n            itemLabel=\"employees\"\n          />\n        </div>\n\n        {/* Bulk Action Bar */}\n        {selectedEmployees.length > 0 && (\n          <div className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-[#111111] text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-4 z-20 animate-in slide-in-from-bottom-4 duration-200\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"bg-[#ff3b3b] text-white text-[12px] font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center\">\n                {selectedEmployees.length}\n              </div>\n              <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif]\">Selected</span>\n            </div>\n\n            <div className=\"h-6 w-px bg-white/20\" />\n\n            <div className=\"flex items-center gap-0\">\n              {/* Update Access Level Button with Dropdown */}\n              <div className=\"relative\" ref={accessDropdownRef}>\n                <Tooltip\n                  title=\"Update Access Level\"\n                  placement=\"top\"\n                  styles={{ root: { marginBottom: '8px' } }}\n                >\n                  <button\n                    onClick={() => setShowAccessDropdown(!showAccessDropdown)}\n                    className=\"p-2 hover:bg-white/10 rounded-full transition-colors\"\n                  >\n                    <ShieldCheck className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n                {showAccessDropdown && (\n                  <div className=\"absolute bottom-full left-0 mb-6 z-30\">\n                    {/* Arrow pointing down to the button */}\n                    <div className=\"absolute -bottom-2 left-4 w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-l-transparent border-r-transparent border-t-white\"></div>\n                    <div className=\"absolute -bottom-2.5 left-4 w-0 h-0 border-l-[7px] border-r-[7px] border-t-[7px] border-l-transparent border-r-transparent border-t-[#EEEEEE]\"></div>\n                    {/* Dropdown content */}\n                    <div className=\"bg-white rounded-lg shadow-lg border border-[#EEEEEE] overflow-hidden min-w-[200px]\">\n                      {[\n                        { value: 'Admin', icon: ShieldCheck, color: '#ff3b3b', bgColor: '#FFF5F5' },\n                        { value: 'Manager', icon: Briefcase, color: '#2E90FA', bgColor: '#EFF8FF' },\n                        { value: 'Leader', icon: Users, color: '#7F56D9', bgColor: '#F9F5FF' },\n                        { value: 'Employee', icon: UserIcon, color: '#12B76A', bgColor: '#ECFDF3' },\n                      ].map((access) => {\n                        const IconComponent = access.icon;\n                        return (\n                          <button\n                            key={access.value}\n                            onClick={() => handleBulkUpdateAccess(access.value as 'Admin' | 'Manager' | 'Leader' | 'Employee')}\n                            className=\"w-full flex items-center gap-3 px-4 py-3 hover:bg-[#F7F7F7] transition-colors text-left\"\n                          >\n                            <div className=\"p-2 rounded-full\" style={{ backgroundColor: access.bgColor }}>\n                              <IconComponent className=\"w-4 h-4\" style={{ color: access.color }} />\n                            </div>\n                            <span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                              {access.value}\n                            </span>\n                          </button>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Change Department Button with Dropdown */}\n              <div className=\"relative\" ref={departmentDropdownRef}>\n                <Tooltip\n                  title=\"Change Department\"\n                  placement=\"top\"\n                  styles={{ root: { marginBottom: '8px' } }}\n                >\n                  <button\n                    onClick={() => setShowDepartmentDropdown(!showDepartmentDropdown)}\n                    className=\"p-2 hover:bg-white/10 rounded-full transition-colors\"\n                  >\n                    <Briefcase className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n                {showDepartmentDropdown && (\n                  <div className=\"absolute bottom-full left-0 mb-6 z-30\">\n                    {/* Arrow pointing down to the button */}\n                    <div className=\"absolute -bottom-2 left-4 w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-l-transparent border-r-transparent border-t-white\"></div>\n                    <div className=\"absolute -bottom-2.5 left-4 w-0 h-0 border-l-[7px] border-r-[7px] border-t-[7px] border-l-transparent border-r-transparent border-t-[#EEEEEE]\"></div>\n                    {/* Dropdown content */}\n                    <div className=\"bg-white rounded-lg shadow-lg border border-[#EEEEEE] overflow-hidden min-w-[200px] max-h-[300px] overflow-y-auto\">\n                      {uniqueDepts.filter(dept => dept !== 'All').map((dept) => (\n                        <button\n                          key={dept}\n                          onClick={() => handleBulkUpdateDepartment(dept)}\n                          className=\"w-full flex items-center gap-3 px-4 py-3 hover:bg-[#F7F7F7] transition-colors text-left\"\n                        >\n                          <span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                            {dept}\n                          </span>\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Export Data Button */}\n              <Tooltip\n                title=\"Export Data\"\n                placement=\"top\"\n                styles={{ root: { marginBottom: '8px' } }}\n              >\n                <button\n                  onClick={handleExportToCSV}\n                  className=\"p-2 hover:bg-white/10 rounded-full transition-colors\"\n                >\n                  <Download className=\"w-4 h-4\" />\n                </button>\n              </Tooltip>\n\n              {/* Delete Button */}\n              <Tooltip\n                title=\"Delete\"\n                placement=\"top\"\n                styles={{ root: { marginBottom: '8px' } }}\n              >\n                <button\n                  onClick={handleBulkDelete}\n                  className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#ff3b3b]\"\n                >\n                  <Trash2 className=\"w-4 h-4\" />\n                </button>\n              </Tooltip>\n            </div>\n\n            <div className=\"h-6 w-px bg-white/20\" />\n\n            <button\n              onClick={() => setSelectedEmployees([])}\n              className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-white hover:text-white/80 transition-colors\"\n            >\n              Cancel\n            </button>\n          </div>\n        )}\n      </div>\n\n      <Modal\n        open={isDialogOpen}\n        onCancel={() => setIsDialogOpen(false)}\n        footer={null}\n        width={700}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        styles={{\n          body: {\n            padding: 0,\n            height: 'calc(100vh - 100px)', // Fixed height to force header/footer positioning\n            display: 'flex',\n            flexDirection: 'column',\n          },\n        }}\n      >\n        <EmployeeForm\n          departments={departmentsData?.result?.filter((dept: any) => dept.is_active !== false).map((dept: any) => dept.name) || []}\n          initialData={editingEmployee ? {\n            name: editingEmployee.name,\n            role: editingEmployee.role,\n            email: editingEmployee.email,\n            phone: editingEmployee.phone,\n            department: editingEmployee.department,\n            hourlyRate: editingEmployee.hourlyRate,\n            dateOfJoining: editingEmployee.dateOfJoining && editingEmployee.dateOfJoining !== 'N/A'\n              ? (() => {\n                try {\n                  // Parse date string like \"01 Jan 2024\"\n                  const dateParts = editingEmployee.dateOfJoining.split(' ');\n                  if (dateParts.length === 3) {\n                    const day = dateParts[0].padStart(2, '0');\n                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n                    const month = String(monthNames.indexOf(dateParts[1]) + 1).padStart(2, '0');\n                    const year = dateParts[2];\n                    return `${year}-${month}-${day}`;\n                  }\n                  // Try parsing as ISO string\n                  const date = new Date(editingEmployee.dateOfJoining);\n                  if (!isNaN(date.getTime())) {\n                    return date.toISOString().split('T')[0];\n                  }\n                } catch (e) {\n                  // Error parsing date\n                }\n                return '';\n              })()\n              : '',\n            experience: editingEmployee.experience.toString(),\n            skillsets: editingEmployee.skillsets,\n            access: editingEmployee.access,\n            salary: editingEmployee.salary.toString(),\n            currency: editingEmployee.currency,\n            workingHours: editingEmployee.rawWorkingHours,\n            leaves: editingEmployee.leaves.toString(),\n            role_id: editingEmployee.roleId,\n            employmentType: editingEmployee.employmentType\n          } : null}\n          onSubmit={handleSaveEmployee}\n          onCancel={() => setIsDialogOpen(false)}\n          isEditing={!!editingEmployee}\n        />\n      </Modal>\n\n      {/* Employee Details Modal */}\n      <EmployeeDetailsModal\n        open={isDetailsModalOpen}\n        onClose={() => {\n          setIsDetailsModalOpen(false);\n          setSelectedEmployeeForDetails(null);\n        }}\n        employee={selectedEmployeeForDetails as any}\n        onEdit={() => {\n          setIsDetailsModalOpen(false);\n          setSelectedEmployeeForDetails(null);\n          handleOpenDialog(selectedEmployeeForDetails || undefined);\n        }}\n      />\n    </PageLayout>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/employees/rows/EmployeeRow.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDays' is defined but never used.","line":3,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport { Badge, Dropdown, MenuProps, Checkbox } from \"antd\";\nimport { Briefcase, CalendarDays, Edit, MoreVertical, Trash2 } from \"lucide-react\";\nimport { AccessBadge } from '../../../ui/AccessBadge';\nimport { Employee } from \"@/types/genericTypes\";\n\ninterface EmployeeRowProps {\n  employee: Employee;\n  selected: boolean;\n  onSelect: () => void;\n  onEdit: () => void;\n  onDeactivate?: () => void;\n  onViewDetails?: () => void;\n  currentUserId?: number | null;\n}\n\nexport function EmployeeRow({\n  employee,\n  selected,\n  onSelect,\n  onEdit,\n  onDeactivate,\n  onViewDetails,\n  currentUserId\n}: EmployeeRowProps) {\n\n  const items: MenuProps['items'] = [\n    {\n      key: 'edit',\n      label: 'Edit Details',\n      icon: <Edit className=\"w-3.5 h-3.5\" />,\n      onClick: onEdit,\n      className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n    },\n    ...(onDeactivate ? [{\n      key: 'deactivate',\n      label: employee.status === 'active' ? 'Deactivate' : 'Activate',\n      icon: <Trash2 className=\"w-3.5 h-3.5\" />,\n      onClick: onDeactivate,\n      danger: true,\n      className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n    }] : []),\n    ...(onDeactivate && employee.id === currentUserId && employee.status === 'active' ? [{\n      key: 'deactivate-self',\n      label: 'Deactivate',\n      icon: <Trash2 className=\"w-3.5 h-3.5\" />,\n      disabled: true,\n      danger: true,\n      title: \"You cannot deactivate your own account\",\n      className: \"text-[13px] font-['Manrope:Medium',sans-serif] opacity-50\"\n    }] : [])\n  ].filter(item => {\n    // If it's the current user and we are showing 'deactivate', we want to show the disabled one instead\n    if (employee.id === currentUserId && employee.status === 'active') {\n      return item.key !== 'deactivate';\n    }\n    return true;\n  });\n\n  return (\n    <div\n      onClick={() => onViewDetails?.()}\n      className={`\n        group bg-white border rounded-[16px] px-4 py-3 transition-all duration-300 cursor-pointer relative z-10\n        ${selected\n          ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n          : 'border-[#EEEEEE] hover:border-[#ff3b3b]/20 hover:shadow-lg'\n        }\n      `}\n    >\n      <div className=\"grid grid-cols-[40px_2fr_1.8fr_1.2fr_1fr_1fr_1.2fr_40px] gap-4 items-center\">\n        {/* Checkbox */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            checked={selected}\n            onChange={(e) => {\n              e.stopPropagation();\n              onSelect();\n            }}\n            className=\"red-checkbox\"\n          />\n        </div>\n\n        {/* Employee Info - Name, Role & Dept */}\n        <div>\n          <div className=\"flex items-center gap-2\">\n            <span className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111] group-hover:text-[#ff3b3b] transition-colors\">\n              {employee.name}\n            </span>\n          </div>\n          <div className=\"flex items-center gap-1.5\">\n            <span className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n              {employee.role}\n            </span>\n            <span className=\"text-[#DDDDDD] text-[11px]\">|</span>\n            <span className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n              {employee.department}\n            </span>\n          </div>\n        </div>\n\n        {/* Email */}\n        <div>\n          <span className=\"text-[13px] text-[#111111] font-['Manrope:Regular',sans-serif]\">\n            {employee.email}\n          </span>\n        </div>\n\n        {/* Access */}\n        <div className=\"flex flex-col items-start\">\n          <AccessBadge role={employee.access} color={employee.roleColor} />\n        </div>\n\n        {/* Employment Type */}\n        <div>\n          <span className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#111111]\">\n            {employee.employmentType || 'Unknown'}\n          </span>\n        </div>\n\n        {/* Hourly Rate */}\n        <div>\n          <span className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#111111]\">\n            {employee.hourlyRate}\n          </span>\n        </div>\n\n        {/* Joining Date */}\n        <div>\n          <span className=\"text-[13px] text-[#111111] font-['Manrope:Regular',sans-serif]\">\n            {employee.dateOfJoining}\n          </span>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end\" onClick={(e) => e.stopPropagation()}>\n          <Dropdown menu={{ items }} trigger={['click']} placement=\"bottomRight\">\n            <button className=\"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] transition-colors opacity-0 group-hover:opacity-100\">\n              <MoreVertical className=\"w-4 h-4 text-[#999999]\" />\n            </button>\n          </Dropdown>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/invoices/InvoicesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5105,5108],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5105,5108],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { Download, Send, Eye, MoreVertical, Calendar, DollarSign } from 'lucide-react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\n\ninterface Invoice {\n  id: string;\n  invoiceNumber: string;\n  client: string;\n  workspace: string;\n  amount: number;\n  issueDate: string;\n  dueDate: string;\n  status: 'paid' | 'pending' | 'overdue' | 'draft';\n}\n\nconst invoicesData: Invoice[] = [\n  {\n    id: '1',\n    invoiceNumber: 'INV-2025-001',\n    client: 'Triem Security',\n    workspace: 'Cleanstart - UI',\n    amount: 15000,\n    issueDate: '2025-11-01',\n    dueDate: '2025-11-15',\n    status: 'paid'\n  },\n  {\n    id: '2',\n    invoiceNumber: 'INV-2025-002',\n    client: 'Eventus Security',\n    workspace: 'Eventus - Documentation',\n    amount: 8500,\n    issueDate: '2025-11-05',\n    dueDate: '2025-11-20',\n    status: 'pending'\n  },\n  {\n    id: '3',\n    invoiceNumber: 'INV-2025-003',\n    client: 'TechCorp Inc.',\n    workspace: 'Website Redesign',\n    amount: 25000,\n    issueDate: '2025-11-10',\n    dueDate: '2025-11-25',\n    status: 'pending'\n  },\n  {\n    id: '4',\n    invoiceNumber: 'INV-2025-004',\n    client: 'Triem Security',\n    workspace: 'Mobile App Development',\n    amount: 18000,\n    issueDate: '2025-10-20',\n    dueDate: '2025-11-05',\n    status: 'paid'\n  },\n  {\n    id: '5',\n    invoiceNumber: 'INV-2025-005',\n    client: 'Eventus Security',\n    workspace: 'Branding Package',\n    amount: 12000,\n    issueDate: '2025-10-01',\n    dueDate: '2025-10-15',\n    status: 'overdue'\n  },\n  {\n    id: '6',\n    invoiceNumber: 'DRAFT-001',\n    client: 'New Client',\n    workspace: 'Consultation Project',\n    amount: 5000,\n    issueDate: '',\n    dueDate: '',\n    status: 'draft'\n  }\n];\n\nexport function InvoicesPage() {\n  /* Manual router/params removed */\n  const [activeTab, setActiveTab] = useTabSync<'all' | 'paid' | 'pending' | 'overdue' | 'draft'>({\n    defaultTab: 'all',\n    validTabs: ['all', 'paid', 'pending', 'overdue', 'draft']\n  });\n\n  // Sync activeTab with URL - handled by useTabSync\n  /* useEffect(() => { ... }) removed */\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    client: 'All',\n    dateRange: 'All Time'\n  });\n\n  const filteredInvoices = invoicesData.filter(invoice => {\n    const matchesTab = activeTab === 'all' || invoice.status === activeTab;\n    const matchesSearch = searchQuery === '' ||\n      invoice.invoiceNumber.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      invoice.client.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      invoice.workspace.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesClient = filters.client === 'All' || invoice.client === filters.client;\n    return matchesTab && matchesSearch && matchesClient;\n  });\n\n  // Get unique clients for filter\n  const clients = ['All', ...Array.from(new Set(invoicesData.map(i => i.client)))];\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'client',\n      label: 'Client',\n      options: clients,\n      placeholder: 'Client',\n      defaultValue: 'All'\n    },\n    {\n      id: 'dateRange',\n      label: 'Date Range',\n      options: ['All Time', 'This Month', 'Last Month', 'Last 3 Months', 'This Year'],\n      placeholder: 'Date Range',\n      defaultValue: 'All Time'\n    }\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n  };\n\n  const clearFilters = () => {\n    setFilters({ client: 'All', dateRange: 'All Time' });\n    setSearchQuery('');\n  };\n\n  const stats = {\n    all: invoicesData.length,\n    paid: invoicesData.filter(i => i.status === 'paid').length,\n    pending: invoicesData.filter(i => i.status === 'pending').length,\n    overdue: invoicesData.filter(i => i.status === 'overdue').length,\n    draft: invoicesData.filter(i => i.status === 'draft').length\n  };\n\n  const totalRevenue = invoicesData\n    .filter(i => i.status === 'paid')\n    .reduce((sum, inv) => sum + inv.amount, 0);\n\n  const pendingAmount = invoicesData\n    .filter(i => i.status === 'pending' || i.status === 'overdue')\n    .reduce((sum, inv) => sum + inv.amount, 0);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'paid':\n        return 'bg-[#E8F5E9] text-[#4CAF50]';\n      case 'pending':\n        return 'bg-[#FFF3E0] text-[#FF9800]';\n      case 'overdue':\n        return 'bg-[#FFEBEE] text-[#ff3b3b]';\n      case 'draft':\n        return 'bg-[#F7F7F7] text-[#999999]';\n      default:\n        return 'bg-[#F7F7F7] text-[#666666]';\n    }\n  };\n\n  return (\n    <PageLayout\n      title=\"Invoices\"\n      tabs={[\n        { id: 'all', label: 'All' },\n        { id: 'paid', label: 'Paid' },\n        { id: 'pending', label: 'Pending', count: stats.pending },\n        { id: 'overdue', label: 'Overdue', count: stats.overdue },\n        { id: 'draft', label: 'Draft' }\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => setActiveTab(tabId as any)}\n      searchPlaceholder=\"Search invoices...\"\n      searchValue={searchQuery}\n      onSearchChange={setSearchQuery}\n      showExport\n      titleAction={{\n        onClick: () => { }\n      }}\n    >\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-3 gap-4 mb-6\">\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <DollarSign className=\"w-5 h-5 text-[#4CAF50]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Total Revenue\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            ${totalRevenue.toLocaleString()}\n          </p>\n          <p className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] mt-1\">\n            From {stats.paid} paid invoices\n          </p>\n        </div>\n\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <DollarSign className=\"w-5 h-5 text-[#FF9800]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Pending Amount\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            ${pendingAmount.toLocaleString()}\n          </p>\n          <p className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] mt-1\">\n            {stats.pending + stats.overdue} invoices unpaid\n          </p>\n        </div>\n\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Calendar className=\"w-5 h-5 text-[#ff3b3b]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Overdue\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#ff3b3b]\">\n            {stats.overdue}\n          </p>\n          <p className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666] mt-1\">\n            Requires immediate action\n          </p>\n        </div>\n      </div>\n\n      {/* Filter Bar */}\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={handleFilterChange}\n          onClearFilters={clearFilters}\n        />\n      </div>\n\n      {/* Invoices List */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"space-y-3\">\n          {filteredInvoices.map((invoice) => (\n            <div\n              key={invoice.id}\n              className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-6 hover:border-[#ff3b3b]/20 hover:shadow-lg transition-all duration-300 cursor-pointer group\"\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex-1 grid grid-cols-5 gap-4 items-center\">\n                  {/* Invoice Number & Client */}\n                  <div>\n                    <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-1\">\n                      {invoice.invoiceNumber}\n                    </h4>\n                    <p className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                      {invoice.client}\n                    </p>\n                  </div>\n\n                  {/* Project */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] mb-1\">\n                      Workspace\n                    </p>\n                    <p className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111] truncate\">\n                      {invoice.workspace}\n                    </p>\n                  </div>\n\n                  {/* Amount */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] mb-1\">\n                      Amount\n                    </p>\n                    <p className=\"font-['Manrope:Bold',sans-serif] text-[16px] text-[#111111]\">\n                      ${invoice.amount.toLocaleString()}\n                    </p>\n                  </div>\n\n                  {/* Dates */}\n                  <div>\n                    {invoice.status !== 'draft' ? (\n                      <>\n                        <p className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999] mb-1\">\n                          Issue / Due Date\n                        </p>\n                        <div className=\"flex items-center gap-1 text-[12px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                          <Calendar className=\"w-3 h-3\" />\n                          {new Date(invoice.issueDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - {new Date(invoice.dueDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                        </div>\n                      </>\n                    ) : (\n                      <p className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#999999] italic\">\n                        Draft - Not sent\n                      </p>\n                    )}\n                  </div>\n\n                  {/* Status */}\n                  <div>\n                    <span\n                      className={`inline-block px-3 py-1.5 rounded-full text-[12px] font-['Manrope:SemiBold',sans-serif] ${getStatusColor(\n                        invoice.status\n                      )}`}\n                    >\n                      {invoice.status.charAt(0).toUpperCase() + invoice.status.slice(1)}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity ml-4\">\n                  <button className=\"p-2 hover:bg-white rounded-[8px] transition-colors\" title=\"View\">\n                    <Eye className=\"w-4 h-4 text-[#666666]\" />\n                  </button>\n                  <button className=\"p-2 hover:bg-white rounded-[8px] transition-colors\" title=\"Download\">\n                    <Download className=\"w-4 h-4 text-[#666666]\" />\n                  </button>\n                  {invoice.status !== 'paid' && invoice.status !== 'draft' && (\n                    <button className=\"p-2 hover:bg-white rounded-[8px] transition-colors\" title=\"Send Reminder\">\n                      <Send className=\"w-4 h-4 text-[#666666]\" />\n                    </button>\n                  )}\n                  <button className=\"p-2 hover:bg-white rounded-[8px] transition-colors\" title=\"More\">\n                    <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n                  </button>\n                </div>\n              </div>\n            </div>\n          ))}\n\n          {filteredInvoices.length === 0 && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                No invoices found\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    </PageLayout>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/leaves/LeavesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is assigned a value but never used.","line":15,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2231,2234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2231,2234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DAY_TYPES' is assigned a value but never used.","line":107,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":107,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":112,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":112,"endColumn":19},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":112,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":112,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4987,4987],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":118,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":118,"endColumn":19},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":118,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":118,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5161,5161],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":132,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":132,"endColumn":19},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":132,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":132,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5610,5610],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6897,6900],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6897,6900],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { Spin, Modal, Form, DatePicker, Select, Input, Button, App, Checkbox } from 'antd';\nimport { useCompanyLeaves, useUpdateLeaveStatus, useApplyForLeave } from '../../../hooks/useLeave';\nimport { LeaveType } from '../../../services/leave';\nimport { LeaveRow, Leave } from './rows/LeaveRow';\nimport dayjs from 'dayjs';\nimport type { Dayjs } from 'dayjs';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nexport function LeavesPage() {\n  const { message } = App.useApp();\n  const [activeTab, setActiveTab] = useState<'all' | 'pending' | 'approved' | 'rejected'>('all');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    leaveType: 'All',\n    employee: 'All'\n  });\n  const [selectedLeaves, setSelectedLeaves] = useState<string[]>([]);\n  const [isApplyLeaveModalOpen, setIsApplyLeaveModalOpen] = useState(false);\n  const [form] = Form.useForm<ApplyLeaveFormValues>();\n\n  const { data: leavesData, isLoading, error } = useCompanyLeaves();\n  const updateStatusMutation = useUpdateLeaveStatus();\n  const applyLeaveMutation = useApplyForLeave();\n\n  // Helper functions\n  const formatDate = (dateString: string): string => dayjs(dateString).format('DD-MMM-YYYY');\n  const normalizeStatus = (status: string): 'pending' | 'approved' | 'rejected' => {\n    const upper = status.toUpperCase();\n    if (upper === 'APPROVED') return 'approved';\n    if (upper === 'REJECTED') return 'rejected';\n    return 'pending';\n  };\n  const normalizeLeaveType = (type: string): 'sick' | 'casual' | 'vacation' => {\n    const lower = type.toLowerCase();\n    if (lower.includes('sick')) return 'sick';\n    if (lower.includes('casual')) return 'casual';\n    if (lower.includes('vacation')) return 'vacation';\n    return 'casual';\n  };\n\n  // Process leaves data\n  const processedLeaves: Leave[] = useMemo(() => {\n    if (!leavesData?.result) return [];\n    return leavesData.result.map((leave: LeaveType) => {\n      const daysValue = typeof leave.days === 'number' ? leave.days : (parseFloat(leave.days as any) || leave.days_count || 0);\n      return {\n        id: String(leave.id),\n        employeeName: leave.user?.name || 'Unknown Employee',\n        leaveType: normalizeLeaveType(leave.leave_type),\n        startDate: formatDate(leave.start_date),\n        endDate: formatDate(leave.end_date),\n        days: Math.round(daysValue) || 1,\n        reason: leave.reason || 'No reason provided',\n        status: normalizeStatus(leave.status),\n        appliedOn: leave.created_at ? formatDate(leave.created_at) : formatDate(leave.start_date),\n      };\n    });\n  }, [leavesData]);\n\n  // Filter leaves\n  const filteredLeaves = useMemo(() => {\n    return processedLeaves.filter(leave => {\n      const matchesTab = activeTab === 'all' || leave.status === activeTab;\n      const matchesSearch = searchQuery === '' ||\n        leave.employeeName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        leave.reason.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesLeaveType = filters.leaveType === 'All' || leave.leaveType === filters.leaveType.toLowerCase();\n      const matchesEmployee = filters.employee === 'All' || leave.employeeName === filters.employee;\n      return matchesTab && matchesSearch && matchesLeaveType && matchesEmployee;\n    });\n  }, [processedLeaves, activeTab, searchQuery, filters]);\n\n  // Tab counts\n  const stats = useMemo(() => {\n    const counts = { all: processedLeaves.length, pending: 0, approved: 0, rejected: 0 };\n    processedLeaves.forEach(l => {\n        if (l.status === 'pending') counts.pending++;\n        else if (l.status === 'approved') counts.approved++;\n        else if (l.status === 'rejected') counts.rejected++;\n    });\n    return counts;\n  }, [processedLeaves]);\n\n  // Selection logic\n  const toggleSelectAll = () => {\n    if (selectedLeaves.length === filteredLeaves.length) setSelectedLeaves([]);\n    else setSelectedLeaves(filteredLeaves.map(l => l.id));\n  };\n  const toggleSelect = (id: string) => {\n    setSelectedLeaves(prev => prev.includes(id) ? prev.filter(lid => lid !== id) : [...prev, id]);\n  };\n\n  // Get unique leave types for the apply leave form dropdown\n  const availableLeaveTypes = useMemo(() => {\n    if (!leavesData?.result) return ['Sick Leave', 'Casual Leave', 'Vacation'];\n    const types = new Set(leavesData.result.map((leave: LeaveType) => leave.leave_type));\n    return Array.from(types).filter(Boolean).length > 0\n      ? Array.from(types).filter(Boolean) as string[]\n      : ['Sick Leave', 'Casual Leave', 'Vacation'];\n  }, [leavesData]);\n\n  const DAY_TYPES = ['Full Day', 'First Half', 'Second Half'];\n\n  const handleApprove = async (leaveId: number) => {\n    try {\n      await updateStatusMutation.mutateAsync({ id: leaveId, status: 'APPROVED' });\n    } catch (error) {}\n  };\n\n  const handleReject = async (leaveId: number) => {\n    try {\n      await updateStatusMutation.mutateAsync({ id: leaveId, status: 'REJECTED' });\n    } catch (error) {}\n  };\n\n  const handleApplyLeave = async (values: ApplyLeaveFormValues) => {\n    try {\n      await applyLeaveMutation.mutateAsync({\n        start_date: values.start_date.format('YYYY-MM-DD'),\n        end_date: values.end_date.format('YYYY-MM-DD'),\n        day_type: values.day_type,\n        leave_type: values.leave_type,\n        reason: values.reason,\n      });\n      form.resetFields();\n      setIsApplyLeaveModalOpen(false);\n    } catch (error) {}\n  };\n\n  // Filter options\n  const leaveTypes = useMemo(() => {\n    const types = new Set(processedLeaves.map(l => l.leaveType.charAt(0).toUpperCase() + l.leaveType.slice(1)));\n    return ['All', ...Array.from(types)];\n  }, [processedLeaves]);\n\n  const employees = useMemo(() => {\n    const names = new Set(processedLeaves.map(l => l.employeeName));\n    return ['All', ...Array.from(names)];\n  }, [processedLeaves]);\n\n  const filterOptions: FilterOption[] = [\n    { id: 'leaveType', label: 'Leave Type', options: leaveTypes, placeholder: 'Leave Type', defaultValue: 'All' },\n    { id: 'employee', label: 'Employee', options: employees, placeholder: 'Employee', defaultValue: 'All' }\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n  };\n\n  const clearFilters = () => {\n    setFilters({ leaveType: 'All', employee: 'All' });\n    setSearchQuery('');\n  };\n\n  return (\n    <PageLayout\n      title=\"Leaves\"\n      tabs={[\n        { id: 'all', label: 'All' },\n        { id: 'pending', label: 'Pending', count: stats.pending },\n        { id: 'approved', label: 'Approved' },\n        { id: 'rejected', label: 'Rejected' },\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => setActiveTab(tabId as any)}\n      searchPlaceholder=\"Search leave requests...\"\n      searchValue={searchQuery}\n      onSearchChange={setSearchQuery}\n      titleAction={{\n        onClick: () => setIsApplyLeaveModalOpen(true),\n        label: \"Apply Leave\"\n      }}\n    >\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={handleFilterChange}\n          onClearFilters={clearFilters}\n        />\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto relative min-h-[400px]\">\n        {/* Table Header */}\n        <div className=\"sticky top-0 z-20 bg-white grid grid-cols-[40px_48px_1.5fr_1fr_1.5fr_0.8fr_1fr_120px_40px] gap-4 px-4 py-3 mb-2 items-center\">\n          <div className=\"flex justify-center\">\n            <Checkbox\n              checked={filteredLeaves.length > 0 && selectedLeaves.length === filteredLeaves.length}\n              onChange={toggleSelectAll}\n              className=\"red-checkbox\"\n            />\n          </div>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\"></p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Employee</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Type</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Duration</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Days</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Status</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-right pr-4\">Actions</p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-right\"></p>\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Spin size=\"large\" />\n          </div>\n        ) : error ? (\n          <div className=\"flex items-center justify-center py-12 text-[#666666]\">\n            Unable to load leave requests. Please try again later.\n          </div>\n        ) : filteredLeaves.length === 0 ? (\n          <div className=\"flex items-center justify-center py-12 text-[#666666]\">\n            No leave requests found.\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {filteredLeaves.map((leave) => (\n              <LeaveRow\n                key={leave.id}\n                leave={leave}\n                selected={selectedLeaves.includes(leave.id)}\n                onSelect={() => toggleSelect(leave.id)}\n                onApprove={handleApprove}\n                onReject={handleReject}\n                isActionLoading={updateStatusMutation.isPending}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Apply Leave Modal */}\n      <Modal\n        title=\"Apply Leave\"\n        open={isApplyLeaveModalOpen}\n        onCancel={() => { form.resetFields(); setIsApplyLeaveModalOpen(false); }}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        destroyOnHidden={true}\n      >\n        <Form form={form} layout=\"vertical\" onFinish={handleApplyLeave} className=\"mt-6\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <Form.Item\n              name=\"start_date\"\n              label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Start Date</span>}\n              rules={[{ required: true, message: 'Please select start date' }]}\n            >\n              <DatePicker className=\"w-full h-10 rounded-lg\" format=\"YYYY-MM-DD\" />\n            </Form.Item>\n            <Form.Item\n              name=\"end_date\"\n              label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">End Date</span>}\n              rules={[{ required: true, message: 'Please select end date' }]}\n            >\n              <DatePicker className=\"w-full h-10 rounded-lg\" format=\"YYYY-MM-DD\" />\n            </Form.Item>\n          </div>\n          <Form.Item\n            name=\"day_type\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Day Type</span>}\n            rules={[{ required: true, message: 'Please select day type' }]}\n          >\n            <Select className=\"w-full h-10 rounded-lg\" placeholder=\"Select day type\">\n              {['Full Day', 'First Half', 'Second Half'].map(t => <Option key={t} value={t}>{t}</Option>)}\n            </Select>\n          </Form.Item>\n          <Form.Item\n            name=\"leave_type\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Leave Type</span>}\n            rules={[{ required: true, message: 'Please select leave type' }]}\n          >\n            <Select className=\"w-full h-10 rounded-lg\" placeholder=\"Select leave type\">\n              {availableLeaveTypes.map(t => <Option key={t} value={t}>{t}</Option>)}\n            </Select>\n          </Form.Item>\n          <Form.Item\n            name=\"reason\"\n            label={<span className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#666666]\">Reason</span>}\n            rules={[{ required: true, message: 'Please enter reason' }]}\n          >\n            <TextArea rows={4} className=\"rounded-lg\" placeholder=\"Type or select a reason\" />\n          </Form.Item>\n          <div className=\"flex items-center justify-end gap-4 pt-4 mt-6 border-t border-[#EEEEEE]\">\n            <Button onClick={() => { form.resetFields(); setIsApplyLeaveModalOpen(false); }} className=\"h-[44px] px-4 rounded-lg\">Cancel</Button>\n            <Button type=\"primary\" htmlType=\"submit\" loading={applyLeaveMutation.isPending} className=\"h-[44px] px-8 rounded-lg bg-[#111111] border-none\">Save</Button>\n          </div>\n        </Form>\n      </Modal>\n    </PageLayout>\n  );\n}\n\ninterface ApplyLeaveFormValues {\n  start_date: Dayjs;\n  end_date: Dayjs;\n  day_type: string;\n  leave_type: string;\n  reason: string;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/leaves/rows/LeaveRow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/notes/NotesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ApiError' is defined but never used.","line":11,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'convertItemsToBackendFormat' is assigned a value but never used.","line":137,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":137,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'textNotes' is assigned a value but never used.","line":265,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":265,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checklistNotes' is assigned a value but never used.","line":266,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":266,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'archived' is assigned a value but never used.","line":267,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":267,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'entry' is assigned a value but never used.","line":313,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":313,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'el' is defined but never used.","line":382,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":382,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onEdit' is defined but never used.","line":471,"column":61,"nodeType":null,"messageId":"unusedVar","endLine":471,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'el' is defined but never used.","line":479,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":479,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { PageLayout } from '../../layout/PageLayout';\nimport { useState, useMemo, useCallback, useRef, useEffect } from 'react';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { sanitizeRichText } from '../../../utils/sanitizeHtml';\nimport { Plus, Archive, Trash2, FileText, ArchiveRestore } from 'lucide-react';\nimport { Checkbox, App } from 'antd';\nimport { NoteComposerModal } from '../../common/NoteComposerModal';\nimport { NoteViewModal } from '../../common/NoteViewModal';\nimport { getNotes, createNote, updateNote, deleteNote, archiveNote, unarchiveNote, Note, NoteType, ChecklistItem } from '../../../services/notes';\nimport { ApiError, getErrorMessage } from '../../../types/errors';\nimport { DEFAULT_NOTE_COLOR } from '../../../utils/colorUtils';\nimport { isArray } from '../../../utils/validation';\nimport { normalizeNoteType } from '../../../utils/noteUtils';\n\ntype TabType = 'all' | 'text' | 'checklist' | 'archive';\n\ninterface NoteSaveData {\n  title: string;\n  type: NoteType;\n  content?: string;\n  items?: ChecklistItem[];\n  color: string;\n}\n\nexport function NotesPage() {\n  const queryClient = useQueryClient();\n  const { message: messageApi, modal } = App.useApp();\n  /* Manual router/params removed */\n  const [activeTab, setActiveTab] = useTabSync<TabType>({\n    defaultTab: 'all',\n    validTabs: ['all', 'text', 'checklist', 'archive']\n  });\n\n  // Sync activeTab with URL - handled by useTabSync\n  \n  const [searchQuery, setSearchQuery] = useState('');\n  const [showDialog, setShowDialog] = useState(false);\n  const [editingNote, setEditingNote] = useState<Note | null>(null);\n  const [viewingNote, setViewingNote] = useState<Note | null>(null);\n  const [showViewModal, setShowViewModal] = useState(false);\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const [cardHeight, setCardHeight] = useState<number>(280);\n\n  // Fetch all notes (both archived and non-archived) for accurate tab counts\n  // Using separate queries for better cache management\n  const { data: nonArchivedData, isLoading: isLoadingNonArchived } = useQuery({\n    queryKey: ['notes', 'non-archived'],\n    queryFn: () => getNotes(0, 100, false),\n    staleTime: 30000, // 30 seconds\n  });\n\n  const { data: archivedData, isLoading: isLoadingArchived } = useQuery({\n    queryKey: ['notes', 'archived'],\n    queryFn: () => getNotes(0, 100, true),\n    staleTime: 30000, // 30 seconds\n  });\n\n  const isLoading = isLoadingNonArchived || isLoadingArchived;\n\n  // Memoize notes list to avoid unnecessary recalculations\n  const notesList: Note[] = useMemo(() => {\n    const nonArchived = isArray<Note>(nonArchivedData?.result) ? nonArchivedData.result : [];\n    const archived = isArray<Note>(archivedData?.result) ? archivedData.result : [];\n    return [...nonArchived, ...archived];\n  }, [nonArchivedData?.result, archivedData?.result]);\n\n  // Mutations with proper error handling\n  const createMutation = useMutation({\n    mutationFn: createNote,\n    onSuccess: () => {\n      messageApi.success(\"Note created\");\n      setShowDialog(false);\n      setEditingNote(null);\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n    },\n    onError: (error: unknown) => {\n      const errorMessage = getErrorMessage(error);\n      messageApi.error(`Failed to create note: ${errorMessage}`);\n    }\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<Note> }) => updateNote(id, data),\n    onSuccess: () => {\n      messageApi.success(\"Note updated\");\n      setShowDialog(false);\n      setEditingNote(null);\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n    },\n    onError: (error: unknown) => {\n      const errorMessage = getErrorMessage(error);\n      messageApi.error(`Failed to update note: ${errorMessage}`);\n    }\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: deleteNote,\n    onSuccess: () => {\n      messageApi.success(\"Note permanently deleted\");\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n    },\n    onError: (error: unknown) => {\n      const errorMessage = getErrorMessage(error);\n      messageApi.error(`Failed to delete note: ${errorMessage}`);\n    }\n  });\n\n  const archiveMutation = useMutation({\n    mutationFn: archiveNote,\n    onSuccess: () => {\n      messageApi.success(\"Note archived\");\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n    },\n    onError: (error: unknown) => {\n      const errorMessage = getErrorMessage(error);\n      messageApi.error(`Failed to archive note: ${errorMessage}`);\n    }\n  });\n\n  const unarchiveMutation = useMutation({\n    mutationFn: unarchiveNote,\n    onSuccess: () => {\n      messageApi.success(\"Note unarchived\");\n      queryClient.invalidateQueries({ queryKey: ['notes'] });\n    },\n    onError: (error: unknown) => {\n      const errorMessage = getErrorMessage(error);\n      messageApi.error(`Failed to unarchive note: ${errorMessage}`);\n    }\n  });\n\n\n  /**\n   * Convert ChecklistItem[] to backend format\n   */\n  const convertItemsToBackendFormat = (items: ChecklistItem[] | undefined) => {\n    if (!items || items.length === 0) {\n      return undefined;\n    }\n\n    return items.map(item => ({\n      text: item.text,\n      checked: item.isChecked,\n    }));\n  };\n\n  /**\n   * Handle saving a note (create or update)\n   */\n  const handleSaveNote = useCallback(async (noteData: NoteSaveData) => {\n    if (editingNote) {\n      // Update existing note\n      await updateMutation.mutateAsync({\n        id: editingNote.id,\n        data: {\n          title: noteData.title,\n          type: noteData.type,\n          content: noteData.content,\n          items: noteData.items,\n          color: noteData.color,\n        }\n      });\n    } else {\n      // Create new note\n      await createMutation.mutateAsync({\n        title: noteData.title,\n        type: noteData.type,\n        content: noteData.content,\n        items: noteData.items,\n        color: noteData.color,\n      });\n    }\n  }, [editingNote, createMutation, updateMutation]);\n\n  /**\n   * Handle note deletion with confirmation\n   */\n  const handleDelete = useCallback((noteId: number) => {\n    modal.confirm({\n      title: 'Delete Note',\n      content: 'Are you sure you want to permanently delete this note? This action cannot be undone.',\n      okText: 'Delete',\n      okType: 'danger',\n      cancelText: 'Cancel',\n      onOk: () => deleteMutation.mutate(noteId)\n    });\n  }, [deleteMutation, modal]);\n\n  /**\n   * Handle archiving a note\n   */\n  const handleArchive = useCallback((noteId: number) => {\n    archiveMutation.mutate(noteId);\n  }, [archiveMutation]);\n\n  /**\n   * Handle unarchiving a note\n   */\n  const handleUnarchive = useCallback((noteId: number) => {\n    unarchiveMutation.mutate(noteId);\n  }, [unarchiveMutation]);\n\n  /**\n   * Normalize note type for filtering\n   * Helper function to handle both frontend and backend type formats\n   */\n  const normalizeNoteTypeForFilter = useCallback((type: string | NoteType): 'text' | 'checklist' => {\n    if (type === 'TEXT_NOTE' || type === 'text') {\n      return 'text';\n    }\n    return 'checklist';\n  }, []);\n\n  /**\n   * Check if note matches search query\n   */\n  const matchesSearch = useCallback((note: Note, query: string): boolean => {\n    if (!query.trim()) {\n      return true;\n    }\n\n    const lowerQuery = query.toLowerCase();\n    const titleMatch = note.title.toLowerCase().includes(lowerQuery);\n    const contentMatch = note.content\n      ? note.content.toLowerCase().includes(lowerQuery)\n      : false;\n\n    // Also search in checklist items\n    const itemsMatch = note.items?.some(item =>\n      item.text.toLowerCase().includes(lowerQuery)\n    ) || false;\n\n    return titleMatch || contentMatch || itemsMatch;\n  }, []);\n\n  /**\n   * Filter notes by tab and search - memoized for performance\n   */\n  const filteredNotes = useMemo(() => {\n    return notesList.filter(note => {\n      // Handle archive tab\n      if (activeTab === 'archive') {\n        if (!note.is_archived) return false;\n      } else {\n        // Exclude archived notes from main tabs\n        if (note.is_archived) return false;\n      }\n\n      // Filter by type\n      const normalizedType = normalizeNoteTypeForFilter(note.type);\n      if (activeTab === 'text' && normalizedType !== 'text') return false;\n      if (activeTab === 'checklist' && normalizedType !== 'checklist') return false;\n\n      // Search filter\n      return matchesSearch(note, searchQuery);\n    });\n  }, [notesList, activeTab, searchQuery, matchesSearch]);\n\n  /**\n   * Calculate tab counts - memoized for performance\n   */\n  const tabs = useMemo(() => {\n    const nonArchived = notesList.filter(n => !n.is_archived);\n    const textNotes = nonArchived.filter(n => normalizeNoteTypeForFilter(n.type) === 'text');\n    const checklistNotes = nonArchived.filter(n => normalizeNoteTypeForFilter(n.type) === 'checklist');\n    const archived = notesList.filter(n => n.is_archived);\n\n    return [\n      { id: 'all' as TabType, label: 'All Notes' },\n      { id: 'text' as TabType, label: 'Text Notes' },\n      { id: 'checklist' as TabType, label: 'Checklists' },\n      { id: 'archive' as TabType, label: 'Archived' },\n    ];\n  }, [notesList, normalizeNoteTypeForFilter]);\n\n  // Calculate card height to fit exactly 2 rows without scrolling\n  useEffect(() => {\n    const calculateCardHeight = () => {\n      if (!scrollContainerRef.current) return;\n\n      const containerHeight = scrollContainerRef.current.clientHeight;\n      if (containerHeight <= 0) return;\n\n      // 2 rows + 1 gap (24px) + bottom padding (24px) = containerHeight\n      // cardHeight * 2 + 24 + 24 = containerHeight\n      // cardHeight = (containerHeight - 48) / 2\n      const newCardHeight = Math.floor((containerHeight - 48) / 2);\n\n      // Set minimum height of 200px and maximum of 350px for reasonable card sizes\n      if (newCardHeight >= 200 && newCardHeight <= 350) {\n        setCardHeight(newCardHeight);\n      }\n    };\n\n    // Wait for container to be available, then calculate\n    const checkAndCalculate = () => {\n      if (scrollContainerRef.current && scrollContainerRef.current.clientHeight > 0) {\n        calculateCardHeight();\n      } else {\n        // Retry after a short delay if container not ready\n        setTimeout(checkAndCalculate, 50);\n      }\n    };\n\n    // Initial check\n    checkAndCalculate();\n\n    // Use ResizeObserver for more reliable size tracking\n    let resizeObserver: ResizeObserver | null = null;\n    if (scrollContainerRef.current) {\n      resizeObserver = new ResizeObserver((entries) => {\n        for (const entry of entries) {\n          calculateCardHeight();\n        }\n      });\n      resizeObserver.observe(scrollContainerRef.current);\n    }\n\n    // Also listen to window resize as fallback\n    window.addEventListener('resize', calculateCardHeight);\n\n    return () => {\n      if (resizeObserver) {\n        resizeObserver.disconnect();\n      }\n      window.removeEventListener('resize', calculateCardHeight);\n    };\n  }, []);\n\n  return (\n    <>\n      <PageLayout\n        title=\"Notes\"\n        tabs={tabs.map(tab => ({ id: tab.id, label: tab.label }))}\n        activeTab={activeTab}\n        onTabChange={(tabId) => setActiveTab(tabId as TabType)}\n        searchPlaceholder=\"Search notes by title or content...\"\n        searchValue={searchQuery}\n        onSearchChange={setSearchQuery}\n        titleAction={{\n          onClick: () => setShowDialog(true),\n          label: 'Add Note',\n          icon: <Plus className=\"size-5 text-[#ff3b3b]\" strokeWidth={2} />\n        }}\n      >\n        {/* Notes Grid */}\n        <div\n          className=\"h-full overflow-y-auto\"\n          ref={(el) => {\n            scrollContainerRef.current = el;\n            // Trigger calculation when ref is set\n            if (el && el.clientHeight > 0) {\n              const containerHeight = el.clientHeight;\n              const newCardHeight = Math.floor((containerHeight - 48) / 2);\n              if (newCardHeight >= 200 && newCardHeight <= 350) {\n                setCardHeight(newCardHeight);\n              }\n            }\n          }}\n        >\n          {isLoading ? (\n            <div className=\"h-full flex items-center justify-center\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[#ff3b3b]\"></div>\n            </div>\n          ) : filteredNotes.length === 0 ? (\n            <div className=\"h-full flex flex-col items-center justify-center text-center py-12\">\n              <div className=\"w-16 h-16 bg-[#FFF4F4] rounded-full flex items-center justify-center mb-4\">\n                <div className=\"text-[#ff3b3b]\"><FileText className=\"size-8\" /></div>\n              </div>\n              <h3 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-1\">\n                {activeTab === 'archive' ? 'Archive is empty' : 'No notes found'}\n              </h3>\n              <p className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                {activeTab === 'archive' ? 'Archived notes will appear here' : 'Create your first note to get started'}\n              </p>\n            </div>\n          ) : (\n            <div\n              className=\"grid grid-cols-4 gap-6 pb-6\"\n              style={{ gridAutoRows: `${cardHeight}px` }}\n              ref={(el) => {\n                // Grid container ref\n              }}\n            >\n              {filteredNotes.map((note) => (\n                <NoteCard\n                  key={note.id}\n                  note={note}\n                  onArchive={handleArchive}\n                  onUnarchive={handleUnarchive}\n                  onDelete={handleDelete}\n                  onEdit={(note) => {\n                    setEditingNote(note);\n                    setShowDialog(true);\n                  }}\n                  onClick={(note) => {\n                    setViewingNote(note);\n                    setShowViewModal(true);\n                  }}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </PageLayout>\n\n      {/* Note Composer Modal */}\n      <NoteComposerModal\n        open={showDialog}\n        onClose={() => {\n          setShowDialog(false);\n          setEditingNote(null);\n        }}\n        onSave={handleSaveNote}\n        initialNote={editingNote ? {\n          id: editingNote.id,\n          title: editingNote.title,\n          type: normalizeNoteTypeForFilter(editingNote.type) === 'text' ? 'TEXT_NOTE' : 'CHECKLIST_NOTE',\n          content: editingNote.content,\n          items: editingNote.items ? editingNote.items.map((item, index) => {\n            // Handle both backend format {text, checked} and frontend format ChecklistItem\n            const isBackendFormat = 'checked' in item && !('isChecked' in item);\n\n            return {\n              id: item.id || `item-${editingNote.id}-${index}`,\n              text: item.text || '',\n              isChecked: isBackendFormat\n                ? (item as { checked?: boolean }).checked || false\n                : (item as ChecklistItem).isChecked || false,\n              order: item.order !== undefined ? item.order : index,\n              indentLevel: item.indentLevel || 0,\n              parentId: item.parentId || null,\n              createdAt: item.createdAt || new Date().toISOString(),\n              updatedAt: item.updatedAt || new Date().toISOString(),\n            };\n          }) : undefined,\n          color: editingNote.color || DEFAULT_NOTE_COLOR,\n        } : null}\n      />\n\n      {/* Note View Modal */}\n      <NoteViewModal\n        open={showViewModal}\n        note={viewingNote}\n        onClose={() => {\n          setShowViewModal(false);\n          setViewingNote(null);\n        }}\n        onEdit={(note) => {\n          setEditingNote(note);\n          setShowViewModal(false);\n          setShowDialog(true);\n        }}\n        onArchive={handleArchive}\n        onDelete={handleDelete}\n      />\n    </>\n  );\n}\n\ninterface NoteCardProps {\n  note: Note;\n  onArchive: (id: number) => void;\n  onUnarchive: (id: number) => void;\n  onDelete: (id: number) => void;\n  onEdit: (note: Note) => void;\n  onClick: (note: Note) => void;\n}\n\nfunction NoteCard({ note, onArchive, onUnarchive, onDelete, onEdit, onClick }: NoteCardProps) {\n  const noteColor = note.color || DEFAULT_NOTE_COLOR;\n  const borderColorNormal = '#EEEEEE';\n  const borderColorHover = noteColor;\n\n  return (\n    <div\n      className=\"relative group w-full h-full\"\n      ref={(el) => {\n        // NoteCard ref\n      }}\n    >\n      {/* Card with white background */}\n      <div\n        className=\"relative h-full w-full bg-white rounded-xl border transition-all duration-300 p-4 flex flex-col cursor-pointer hover:shadow-lg\"\n        style={{\n          borderColor: borderColorNormal,\n          borderWidth: '1px'\n        }}\n        onMouseEnter={(e) => {\n          e.currentTarget.style.borderColor = borderColorHover;\n        }}\n        onMouseLeave={(e) => {\n          e.currentTarget.style.borderColor = borderColorNormal;\n        }}\n        onClick={(e) => {\n          // Only trigger if click is not on action buttons\n          const target = e.target as HTMLElement;\n          const isActionButton = target.closest('button');\n\n          if (!isActionButton) {\n            onClick(note);\n          }\n        }}\n      >\n        {/* Header with action buttons */}\n        <div className=\"flex items-start justify-between mb-3 gap-2 flex-shrink-0\">\n          {/* Title */}\n          <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[16px] text-[#111111] flex-1 leading-tight\">\n            {note.title}\n          </h4>\n\n          {/* Action icons - appear on hover */}\n          <div className=\"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1 flex-shrink-0 z-10 relative\">\n            {note.is_archived ? (\n              <button\n                className=\"p-1.5 hover:bg-[#F7F7F7] rounded-md transition-colors\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onUnarchive(note.id);\n                }}\n                title=\"Unarchive\"\n              >\n                <ArchiveRestore className=\"size-4 text-[#666666]\" strokeWidth={2} />\n              </button>\n            ) : (\n              <button\n                className=\"p-1.5 hover:bg-[#F7F7F7] rounded-md transition-colors\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onArchive(note.id);\n                }}\n                title=\"Archive\"\n              >\n                <Archive className=\"size-4 text-[#666666]\" strokeWidth={2} />\n              </button>\n            )}\n            <button\n              className=\"p-1.5 hover:bg-[#F7F7F7] rounded-md transition-colors\"\n              onClick={(e) => {\n                e.stopPropagation();\n                onDelete(note.id);\n              }}\n              title=\"Delete\"\n            >\n              <Trash2 className=\"size-4 text-[#ff3b3b]\" strokeWidth={2} />\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-hidden min-h-0\">\n          {normalizeNoteType(note.type) === 'text' && note.content && (\n            <div\n              className=\"font-['Inter:Regular',sans-serif] text-[13px] text-[#666666] line-clamp-[8] leading-relaxed prose prose-sm max-w-none [&>p]:mb-2 [&>p]:last:mb-0 h-full\"\n              dangerouslySetInnerHTML={{ __html: sanitizeRichText(note.content) }}\n            />\n          )}\n\n          {normalizeNoteType(note.type) === 'checklist' && note.items && isArray(note.items) && (\n            <div className=\"flex flex-col gap-2 h-full overflow-hidden\">\n              {note.items\n                .filter((item) => {\n                  // Handle both backend format {checked} and frontend format {isChecked}\n                  const isBackendFormat = 'checked' in item && !('isChecked' in item);\n                  return isBackendFormat\n                    ? !(item as { checked?: boolean }).checked\n                    : !(item as ChecklistItem).isChecked;\n                })\n                .slice(0, 5)\n                .map((item, index) => {\n                  const itemText = 'text' in item ? item.text : String(item);\n                  return (\n                    <div key={`unchecked-${item.id || index}`} className=\"flex items-start gap-2 flex-shrink-0\">\n                      <Checkbox\n                        checked={false}\n                        disabled\n                        className=\"mt-0.5 custom-checkbox-wrapper\"\n                      />\n                      <span className=\"font-['Inter:Regular',sans-serif] text-[13px] flex-1 leading-tight text-[#666666]\">\n                        {itemText}\n                      </span>\n                    </div>\n                  );\n                })}\n              {(() => {\n                const completedItems = note.items.filter((item) => {\n                  const isBackendFormat = 'checked' in item && !('isChecked' in item);\n                  return isBackendFormat\n                    ? (item as { checked?: boolean }).checked\n                    : (item as ChecklistItem).isChecked;\n                });\n\n                if (completedItems.length === 0) return null;\n\n                return (\n                  <div className=\"mt-2 pt-2 border-t border-[#EEEEEE] flex-shrink-0\">\n                    <div className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999] mb-1 uppercase\">\n                      Completed ({completedItems.length})\n                    </div>\n                    {completedItems.slice(0, 2).map((item, index) => {\n                      const itemText = 'text' in item ? item.text : String(item);\n                      return (\n                        <div key={`checked-${item.id || index}`} className=\"flex items-start gap-2 opacity-60 flex-shrink-0\">\n                          <Checkbox\n                            checked={true}\n                            disabled\n                            className=\"mt-0.5 custom-checkbox-wrapper\"\n                          />\n                          <span className=\"font-['Inter:Regular',sans-serif] text-[13px] flex-1 leading-tight line-through text-[#999999]\">\n                            {itemText}\n                          </span>\n                        </div>\n                      );\n                    })}\n                  </div>\n                );\n              })()}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/partners/PartnersPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":5,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":17,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":21,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":22,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":23,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Building' is defined but never used.","line":27,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":28,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BankOutlined' is defined but never used.","line":39,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarOutlined' is defined but never used.","line":39,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Option' is assigned a value but never used.","line":42,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":57,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1579,1582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1579,1582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":58,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2758,2761],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2758,2761],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2900,2903],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2900,2903],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":114,"column":46,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":114,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5475,5478],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5475,5478],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":207,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":207,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[7899,7900],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11658,11661],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11658,11661],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":310,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":310,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12190,12193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12190,12193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13179,13182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13179,13182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":357,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":357,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13939,13942],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13939,13942],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'filterOptions' is assigned a value but never used.","line":373,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":373,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":429,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":429,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16630,16633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16630,16633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":441,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":441,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17238,17241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17238,17241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":752,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":752,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":23,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport {\n    Button,\n    Input,\n    Select,\n    Modal,\n    Form,\n    Checkbox,\n    Tag,\n    App,\n    Dropdown\n} from 'antd';\nimport { PageLayout } from '../../layout/PageLayout';\nimport {\n    Plus,\n    Trash2,\n    Users,\n    Download,\n    ChevronLeft,\n    ChevronRight,\n    Loader2,\n    Globe,\n    Mail,\n    MoreVertical,\n    Building,\n    User,\n    Check,\n    X\n} from 'lucide-react';\nimport { PaginationBar } from '../../ui/PaginationBar';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport axiosApi from '../../../config/axios';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { PartnerRow, Partner, PartnerStatus } from './rows/PartnerRow';\nimport { acceptInvitation, updatePartnerStatus, getReceivedInvites, acceptInviteById, declineInviteById, getPartners, deletePartner } from '@/services/user';\nimport { BankOutlined, UserOutlined, MailOutlined, PhoneOutlined, CalendarOutlined } from '@ant-design/icons';\n\n// Mock Data\nconst { Option } = Select;\n\nconst countryCodes = [\n    { code: \"+1\", country: \"US\" },\n    { code: \"+91\", country: \"IN\" },\n    { code: \"+44\", country: \"UK\" },\n    { code: \"+61\", country: \"AU\" },\n    { code: \"+81\", country: \"JP\" },\n    { code: \"+49\", country: \"DE\" },\n    { code: \"+971\", country: \"AE\" },\n];\n\nexport function PartnersPageContent() {\n    const { message } = App.useApp();\n    const [partners, setPartners] = useState<Partner[]>([]);\n    const [pendingInvites, setPendingInvites] = useState<any[]>([]); // New state\n    const [loading, setLoading] = useState(true);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingPartner, setEditingPartner] = useState<Partner | null>(null);\n    const searchParams = useSearchParams();\n    const router = useRouter();\n    const [activeTab, setActiveTab] = useTabSync<'active' | 'inactive' | 'requests'>({\n        defaultTab: 'active',\n        validTabs: ['active', 'inactive', 'requests']\n    });\n    const [searchQuery, setSearchQuery] = useState('');\n    const [filters, setFilters] = useState({\n        type: 'All',\n        country: 'All'\n    });\n    const [selectedPartners, setSelectedPartners] = useState<number[]>([]);\n    const [requestTypeFilter, setRequestTypeFilter] = useState<'All' | 'Sent' | 'Received'>('All');\n    const [form] = Form.useForm();\n\n    const fetchPartners = async () => {\n        try {\n            setLoading(true);\n            const [partnersRes, invitesRes] = await Promise.all([\n                getPartners(),\n                getReceivedInvites() // Fetch invites\n            ]);\n\n            if (invitesRes.success) {\n                setPendingInvites(invitesRes.result as any[]);\n            }\n\n            if (partnersRes.success) {\n                const mappedPartners: Partner[] = partnersRes.result.map((item: any) => {\n                    let status: 'active' | 'inactive' | 'pending' = 'pending';\n                    if (item.status === 'ACCEPTED') {\n                        status = item.is_active ? 'active' : 'inactive';\n                    }\n\n                    return {\n                        id: item.association_id || item.invite_id,\n                        association_id: item.association_id,\n                        name: item.name || '',\n                        company: item.company || '',\n                        type: item.company ? 'ORGANIZATION' : 'INDIVIDUAL',\n                        email: item.email || '',\n                        phone: item.phone || '',\n                        country: item.country || '',\n                        timezone: item.timezone || '',\n                        status,\n                        requirements: 0,\n                        onboarding: item.associated_date ? new Date(item.associated_date).toLocaleDateString() : '-',\n                        rawStatus: item.status,\n                        isOrgAccount: !!item.company,\n                        partner_user_id: item.partner_user_id,\n                        company_id: item.company_id\n                    };\n                });\n                setPartners(mappedPartners); ``\n            }\n        } catch (error) {\n            console.error('Failed to fetch data:', error);\n            message.error('Failed to load data');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        fetchPartners();\n    }, []);\n\n    // Sync activeTab with URL\n    // Sync activeTab with URL - handled by useTabSync\n    // useEffect(() => {\n    //     const tab = searchParams.get('tab');\n    //     if (tab === 'active' || tab === 'inactive' || tab === 'requests') {\n    //         setActiveTab(tab);\n    //     }\n    // }, [searchParams]);\n\n    // Handle invitation acceptance from URL\n    const inviteToken = searchParams.get('invite');\n\n    useEffect(() => {\n        if (inviteToken) {\n            const processInvite = async () => {\n                const hide = message.loading('Accepting invitation...', 0);\n                try {\n                    const result = await acceptInvitation(inviteToken);\n                    if (result.success) {\n                        message.success('Invitation accepted! You are now partners.');\n                        fetchPartners();\n                    } else {\n                        message.error(result.message || 'Failed to accept invitation.');\n                    }\n                } catch (error: any) {\n                    const msg = error?.response?.data?.message || 'Something went wrong while accepting invitation.';\n                    message.error(msg);\n                } finally {\n                    hide();\n                    // Clean up URL\n                    const params = new URLSearchParams(searchParams.toString());\n                    params.delete('invite');\n                    params.delete('email'); // Also clean up email if present\n                    const newPath = `${window.location.pathname}${params.toString() ? `?${params.toString()}` : ''}`;\n                    router.replace(newPath);\n                }\n            };\n            processInvite();\n        }\n    }, [inviteToken, searchParams, router]);\n\n    // Pagination\n    const [pagination, setPagination] = useState({\n        current: 1,\n        pageSize: 10\n    });\n\n    // Stats\n    const stats = {\n        active: partners.filter(p => p.status === 'active').length,\n        inactive: partners.filter(p => p.status === 'inactive').length,\n        requests: pendingInvites.length + partners.filter(p => p.status === 'pending').length\n    };\n\n    const [lastStandardTab, setLastStandardTab] = useState<'active' | 'inactive'>('active');\n\n    // Update lastStandardTab when activeTab changes\n    useEffect(() => {\n        if (activeTab === 'active' || activeTab === 'inactive') {\n            setLastStandardTab(activeTab);\n        }\n    }, [activeTab]);\n\n    // Data Preparation Logic (Hoisted)\n    // 1. Prepare Standard Partners (Active/Inactive)\n    const effectiveStatusFilter = activeTab === 'requests' ? lastStandardTab : activeTab;\n\n    const filteredPartners = partners.filter(item => {\n        const matchesTab = item.status === effectiveStatusFilter;\n        const matchesSearch =\n            item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            item.company.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            item.email.toLowerCase().includes(searchQuery.toLowerCase());\n        const matchesType = filters.type === 'All' || item.type.toUpperCase() === filters.type.toUpperCase();\n        const matchesCountry = filters.country === 'All' || (() => {\n            if (!item.country) return false;\n            let fullName = item.country;\n            try {\n                fullName = new Intl.DisplayNames(['en'], { type: 'region' }).of(item.country) || item.country;\n            } catch { }\n            return fullName.toLowerCase() === filters.country.toLowerCase();\n        })();\n        return matchesTab && matchesSearch && matchesType && matchesCountry;\n    });\n\n    const standardStartIndex = (pagination.current - 1) * pagination.pageSize;\n    const paginatedPartners = filteredPartners.slice(standardStartIndex, standardStartIndex + pagination.pageSize);\n\n    // 2. Prepare Requests\n    const receivedRequests = (requestTypeFilter === 'All' || requestTypeFilter === 'Received')\n        ? pendingInvites.map(invite => ({ type: 'received' as const, data: invite }))\n        : [];\n    const sentRequests = (requestTypeFilter === 'All' || requestTypeFilter === 'Sent')\n        ? partners.filter(p => p.status === 'pending').map(partner => ({ type: 'sent' as const, data: partner }))\n        : [];\n\n    const allRequests = [...receivedRequests, ...sentRequests];\n    const requestsStartIndex = (pagination.current - 1) * pagination.pageSize;\n    const paginatedRequests = allRequests.slice(requestsStartIndex, requestsStartIndex + pagination.pageSize);\n\n    // Handlers\n    const handleAdd = () => {\n        setEditingPartner(null);\n        form.resetFields();\n        setIsModalOpen(true);\n    };\n\n    const handleEdit = (record: Partner) => {\n        setEditingPartner(record);\n        const nameParts = (record.name || \"\").split(\" \");\n        form.setFieldsValue({\n            ...record,\n            firstName: nameParts[0] || \"\",\n            lastName: nameParts.slice(1).join(\" \") || \"\"\n        });\n        setIsModalOpen(true);\n    };\n\n    const handleStatusUpdate = async (partner: Partner, newStatus: PartnerStatus) => {\n        if (!partner.association_id) {\n            message.warning('Cannot change status of a pending invitation');\n            return;\n        }\n\n        const isActive = newStatus === 'active';\n        const action = isActive ? 'activate' : 'deactivate';\n\n        Modal.confirm({\n            title: `${isActive ? 'Activate' : 'Deactivate'} Partner`,\n            content: `Are you sure you want to ${action} this partner?`,\n            okText: isActive ? 'Activate' : 'Deactivate',\n            okType: isActive ? 'primary' : 'danger',\n            cancelText: 'Cancel',\n            async onOk() {\n                try {\n                    if (!partner.association_id) {\n                        message.error(\"Invalid Association ID\");\n                        return;\n                    }\n                    const result = await updatePartnerStatus({\n                        association_id: partner.association_id,\n                        is_active: isActive\n                    });\n                    if (result.success) {\n                        message.success(`Partner ${isActive ? 'activated' : 'deactivated'}`);\n                        fetchPartners();\n                    } else {\n                        message.error(result.message || `Failed to ${action} partner`);\n                    }\n                } catch (error) {\n                    console.error(`Failed to ${action} partner:`, error);\n                    message.error(`Failed to ${action} partner`);\n                }\n            }\n        });\n    };\n\n    const handleAcceptInvite = async (inviteId: number) => {\n        try {\n            const res = await acceptInviteById(inviteId);\n            if (res.success) {\n                message.success('Invite accepted successfully');\n                // Optimistically remove from pending list\n                setPendingInvites(prev => prev.filter(inv => inv.id !== inviteId));\n                fetchPartners(); // Refresh both lists to get updated active partners\n            } else {\n                message.error(res.message || 'Failed to accept invite');\n            }\n        } catch (error: any) {\n            message.error(error?.response?.data?.message || 'Failed to accept invite');\n        }\n    };\n\n    const handleDeclineInvite = async (inviteId: number) => {\n        try {\n            const res = await declineInviteById(inviteId);\n            if (res.success) {\n                message.success('Invite declined successfully');\n                fetchPartners(); // Refresh both lists\n            } else {\n                message.error(res.message || 'Failed to decline invite');\n            }\n        } catch (error: any) {\n            message.error(error?.response?.data?.message || 'Failed to decline invite');\n        }\n    };\n\n    const handleCancelRequest = async (inviteId: number) => {\n        Modal.confirm({\n            title: 'Cancel Request',\n            content: 'Are you sure you want to cancel this request? The invitation link will no longer be valid.',\n            okText: 'Yes, Cancel',\n            okType: 'danger',\n            centered: true,\n            async onOk() {\n                try {\n                    const result = await deletePartner({\n                        userType: 'PARTNER',\n                        inviteId: inviteId\n                    });\n                    if (result.success) {\n                        message.success('Request cancelled successfully');\n                        fetchPartners();\n                    } else {\n                        message.error(result.message || 'Failed to cancel request');\n                    }\n                } catch (error: any) {\n                     message.error(error?.response?.data?.message || 'Failed to cancel request');\n                }\n            }\n        });\n    };\n\n    const handleModalOk = async () => {\n        try {\n            const values = await form.validateFields();\n\n            // Sending invitation\n            const fullName = [values.firstName, values.lastName].filter(Boolean).join(' ').trim();\n            await axiosApi.post('/user/invite', {\n                email: values.email,\n                name: fullName,\n                requestSentFor: 'PARTNER'\n            });\n\n            message.success('Invitation sent successfully');\n            setIsModalOpen(false);\n            form.resetFields();\n            fetchPartners();\n        } catch (error: any) {\n            console.error('Failed to send invitation:', error);\n            const errorMessage = error?.response?.data?.message || error?.message || 'Failed to send invitation. Please check your connection and try again.';\n            message.error(errorMessage);\n        }\n    };\n\n    // Filter Configuration\n    const countries = ['All', ...Array.from(new Set(partners.map(p => {\n        if (!p.country) return 'N/A';\n        try {\n            return new Intl.DisplayNames(['en'], { type: 'region' }).of(p.country) || p.country;\n        } catch {\n            return p.country;\n        }\n    })))];\n    const filterOptions: FilterOption[] = [\n        { id: 'type', label: 'Type', options: ['All', 'Individual', 'Organization'], defaultValue: 'All' },\n        { id: 'country', label: 'Country', options: countries, defaultValue: 'All' }\n    ];\n\n    const handleFilterChange = (filterId: string, value: string) => {\n        setFilters(prev => ({ ...prev, [filterId]: value }));\n        setPagination(prev => ({ ...prev, current: 1 }));\n    };\n\n    const clearFilters = () => {\n        setFilters({ type: 'All', country: 'All' });\n        setSearchQuery('');\n        setPagination(prev => ({ ...prev, current: 1 }));\n    };\n\n    const toggleSelectAll = () => {\n        if (selectedPartners.length === paginatedPartners.length) {\n            setSelectedPartners([]);\n        } else {\n            setSelectedPartners(paginatedPartners.map(p => p.id));\n        }\n    };\n\n    const toggleSelect = (id: number) => {\n        if (selectedPartners.includes(id)) {\n            setSelectedPartners(selectedPartners.filter(pid => pid !== id));\n        } else {\n            setSelectedPartners([...selectedPartners, id]);\n        }\n    };\n\n    // Tab-specific Filter Options\n    const requestsFilterOptions: FilterOption[] = [\n        { id: 'requestType', label: 'Show', options: ['All', 'Received', 'Sent'], defaultValue: 'All' }\n    ];\n\n    const activeFilterOptions: FilterOption[] = [\n        { id: 'type', label: 'Type', options: ['All', 'Individual', 'Organization'], defaultValue: 'All' },\n        { id: 'country', label: 'Country', options: countries, defaultValue: 'All' }\n    ];\n\n    return (\n        <PageLayout\n            title=\"Partners\"\n            titleAction={{\n                onClick: handleAdd,\n                label: \"Add Partner\"\n            }}\n            tabs={[\n                { id: 'active', label: 'Active' },\n                { id: 'inactive', label: 'Deactivated' },\n                { id: 'requests', label: 'Requests', count: stats.requests }\n            ]}\n            activeTab={activeTab}\n            onTabChange={(tabId) => {\n                setActiveTab(tabId as any);\n                setPagination(prev => ({ ...prev, current: 1 }));\n                setSelectedPartners([]);\n            }}\n        >\n            {/* Toolbar / Filters */}\n            <div className=\"mb-6\">\n                <FilterBar\n                    filters={activeTab === 'requests' ? requestsFilterOptions : activeFilterOptions}\n                    selectedFilters={activeTab === 'requests' ? { requestType: requestTypeFilter } : filters}\n                    onFilterChange={(id, val) => {\n                        if (id === 'requestType') {\n                            setRequestTypeFilter(val as any);\n                            setPagination(prev => ({ ...prev, current: 1 }));\n                        } else {\n                            handleFilterChange(id, val);\n                        }\n                    }}\n                    onClearFilters={clearFilters}\n                    searchPlaceholder=\"Search partners...\"\n                    searchValue={searchQuery}\n                    onSearchChange={setSearchQuery}\n                />\n            </div>\n\n            {/* Content Container */}\n            <div className=\"flex-1 overflow-y-auto relative pb-5\">\n\n                {/* 1. Requests View (Toggle Visibility) */}\n                <div style={{ display: activeTab === 'requests' ? 'block' : 'none' }}>\n                    {/* Header */}\n                    <div className=\"sticky top-0 z-20 bg-white grid grid-cols-[40px_1.5fr_2fr_1fr_100px] gap-4 px-4 py-3 mb-2 items-center\">\n                        <div className=\"flex justify-center\"></div>\n                        <div className=\"pl-[44px]\">\n                            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Contact Person</p>\n                        </div>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Email</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Status</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-right pr-10\">Actions</p>\n                    </div>\n\n                    {/* Content */}\n                    <div className=\"px-4 space-y-2\">\n                        {allRequests.length === 0 ? (\n                            <div className=\"text-center py-20 bg-[#FAFAFA] rounded-2xl border border-dashed border-[#EEEEEE] mx-4\">\n                                <Users className=\"w-10 h-10 text-[#CCCCCC] mx-auto mb-3\" />\n                                <p className=\"text-[#999999] font-['Manrope:Medium',sans-serif]\">\n                                    {requestTypeFilter === 'All'\n                                        ? 'No pending requests'\n                                        : requestTypeFilter === 'Received'\n                                            ? 'No received invitations'\n                                            : 'No sent invitations'}\n                                </p>\n                            </div>\n                        ) : (\n                            <>\n                                {paginatedRequests.map((item) => (\n                                    <div key={item.type === 'received' ? item.data.id : `sent-${item.data.id}`}>\n                                        {/* Render Logic Inline for simplicity/preservation of original row structure */}\n                                        {item.type === 'received' ? (\n                                            <div className=\"group bg-white border border-[#EEEEEE] rounded-[16px] px-4 py-3 transition-all duration-300 hover:border-[#ff3b3b]/20 hover:shadow-lg flex items-center\">\n                                                {/* [Previous Receiver Row Code] - Recreated here for clarity */}\n                                                <div className=\"grid grid-cols-[40px_1.5fr_2fr_1fr_100px] gap-4 items-center w-full\">\n                                                    <div className=\"flex justify-center\">\n                                                        <div className={`w-2 h-2 rounded-full ${item.data.status === 'REJECTED' ? 'bg-[#EF4444]' : 'bg-[#3b8eff]'}`} title={item.data.status === 'REJECTED' ? \"Rejected\" : \"New Invitation\"} />\n                                                    </div>\n                                                    <div className=\"flex items-center gap-3\">\n                                                        <div className=\"w-8 h-8 rounded-full bg-[#EFF6FF] text-[#2563EB] flex items-center justify-center text-[10px] font-bold shrink-0\">\n                                                            {(item.data.inviterName || \"?\")[0].toUpperCase()}\n                                                        </div>\n                                                        <div className=\"flex flex-col\">\n                                                            <span className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111]\">\n                                                                {item.data.inviterName?.replace(' undefined', '')}\n                                                            </span>\n                                                            {item.data.inviterCompany && (\n                                                                <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                                                                    {item.data.inviterCompany}\n                                                                </span>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"flex items-center gap-2 text-[#666666] overflow-hidden\">\n                                                        <Mail className=\"w-3.5 h-3.5 shrink-0\" />\n                                                        <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] truncate block text-[#111111]\">\n                                                            {(item.data).inviterEmail || (item.data).email || (item.data).inviter_email || 'Not provided'}\n                                                        </span>\n                                                    </div>\n                                                    <div>\n                                                        {item.data.status === 'REJECTED' ? (\n                                                            <div className=\"w-2 h-2 rounded-full bg-[#EF4444]\" title=\"Rejected\" />\n                                                        ) : (\n                                                            <Tag color=\"processing\" className=\"text-[10px] font-bold uppercase rounded-full border-none px-2.5\">Action Required</Tag>\n                                                        )}\n                                                    </div>\n                                                    <div className=\"flex justify-end gap-2 pr-5\">\n                                                        {item.data.status === 'REJECTED' ? (\n                                                            <Tag color=\"error\" className=\"text-[10px] font-bold uppercase rounded-full border-none px-2.5\">Rejected</Tag>\n                                                        ) : (\n                                                            <>\n                                                                <button onClick={() => handleAcceptInvite(item.data.id)} className=\"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#DCFCE7] text-[#16A34A] transition-colors\"><Check className=\"w-4 h-4\" /></button>\n                                                                <button onClick={() => handleDeclineInvite(item.data.id)} className=\"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#FEE2E2] text-[#DC2626] transition-colors\"><X className=\"w-4 h-4\" /></button>\n                                                            </>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        ) : (\n                                            <div className=\"group bg-white border border-[#EEEEEE] rounded-[16px] px-4 py-3 transition-all duration-300 hover:border-[#ff3b3b]/20 hover:shadow-lg flex items-center\">\n                                                {/* [Previous Sent Row Code] */}\n                                                <div className=\"grid grid-cols-[40px_1.5fr_2fr_1fr_100px] gap-4 items-center w-full\">\n                                                    <div className=\"flex justify-center\"><div className=\"w-2 h-2 rounded-full bg-[#f59e0b]\" title=\"Pending\" /></div>\n                                                    <div className=\"flex items-center gap-3\">\n                                                        <div className={`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-bold shrink-0 ${item.data.company ? 'bg-[#FEF2F2] text-[#DC2626]' : 'bg-[#EFF6FF] text-[#2563EB]'}`}>\n                                                            {(item.data.name || \"?\")[0].toUpperCase()}\n                                                        </div>\n                                                        <div className=\"flex flex-col\">\n                                                            <span className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111]\">\n                                                                {(item.data.name || item.data.email)?.replace(' undefined', '')}\n                                                            </span>\n                                                            {item.data.company && <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">{item.data.company}</span>}\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"flex items-center gap-2 text-[#666666] overflow-hidden\">\n                                                        <Mail className=\"w-3.5 h-3.5 shrink-0\" />\n                                                        <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] truncate block text-[#111111]\">{item.data.email}</span>\n                                                    </div>\n                                                    <div><Tag color=\"orange\" className=\"text-[10px] font-bold uppercase rounded-full border-none px-2.5\">Pending</Tag></div>\n                                                    <div className=\"flex justify-end pr-5\">\n                                                        <Dropdown\n                                                            menu={{\n                                                                items: [\n                                                                    {\n                                                                        key: 'cancel',\n                                                                        label: 'Cancel Request',\n                                                                        icon: <Trash2 className=\"w-3.5 h-3.5\" />,\n                                                                        onClick: () => handleCancelRequest(item.data.id),\n                                                                        danger: true,\n                                                                        className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                                                                    }\n                                                                ]\n                                                            }}\n                                                            trigger={['click']}\n                                                            placement=\"bottomRight\"\n                                                        >\n                                                            <button className=\"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] transition-colors\">\n                                                                <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n                                                            </button>\n                                                        </Dropdown>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                </div>\n\n                {/* 2. Standard View (Active/Inactive) (Toggle Visibility) */}\n                <div style={{ display: activeTab !== 'requests' ? 'block' : 'none' }}>\n                    {/* Header */}\n                    <div className=\"sticky top-0 z-20 bg-white grid grid-cols-[40px_2fr_1fr_0.8fr_1.5fr_0.8fr_0.7fr_0.7fr_40px] gap-4 px-4 py-3 items-center\">\n                        <div className=\"flex justify-center\">\n                            <Checkbox\n                                checked={paginatedPartners.length > 0 && selectedPartners.length === paginatedPartners.length}\n                                onChange={toggleSelectAll}\n                                className=\"red-checkbox\"\n                            />\n                        </div>\n                        <div className=\"pl-[48px]\">\n                            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Business Name</p>\n                        </div>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Contact Person</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Type</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Email</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Onboarding</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Status</p>\n                        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Country</p>\n                        <p></p>\n                    </div>\n\n                    {/* Content */}\n                    <div className=\"space-y-2\">\n                        {paginatedPartners.map(partner => (\n                            <PartnerRow\n                                key={partner.id}\n                                partner={partner}\n                                selected={selectedPartners.includes(partner.id)}\n                                onSelect={() => toggleSelect(partner.id)}\n                                onEdit={() => handleEdit(partner)}\n                                onStatusUpdate={(isActive) => handleStatusUpdate(partner, isActive)}\n                            />\n                        ))}\n                    </div>\n\n                    {filteredPartners.length === 0 && (\n                        <div className=\"text-center py-12\">\n                            <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                                No partners found\n                            </p>\n                        </div>\n                    )}\n\n                    {/* Bulk Action Bar */}\n                    {selectedPartners.length > 0 && (\n                        <div className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-[#111111] text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-6 z-20 animate-in slide-in-from-bottom-4 duration-200\">\n                            <div className=\"flex items-center gap-2 border-r border-white/20 pr-6\">\n                                <div className=\"bg-[#ff3b3b] text-white text-[12px] font-bold px-2 py-0.5 rounded-full\">\n                                    {selectedPartners.length}\n                                </div>\n                                <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif]\">Selected</span>\n                            </div>\n\n                            <div className=\"flex items-center gap-2\">\n                                <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors\" title=\"Export\">\n                                    <Download className=\"w-4 h-4\" />\n                                </button>\n                                <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#ff3b3b]\" title=\"Deactivate\">\n                                    <Trash2 className=\"w-4 h-4\" />\n                                </button>\n                            </div>\n\n                            <button onClick={() => setSelectedPartners([])} className=\"ml-2 text-[12px] text-[#999999] hover:text-white transition-colors\">\n                                Cancel\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Pagination */}\n            {(() => {\n                const total = activeTab === 'requests' ? allRequests.length : filteredPartners.length;\n\n                return (\n                    <div className=\"shrink-0 bg-white border-t border-[#EEEEEE] px-6 z-10 w-full\">\n                        <PaginationBar\n                            currentPage={pagination.current}\n                            totalItems={total}\n                            pageSize={pagination.pageSize}\n                            onPageChange={(page) => setPagination(prev => ({ ...prev, current: page }))}\n                            onPageSizeChange={(size) => setPagination(prev => ({ ...prev, pageSize: size, current: 1 }))}\n                            itemLabel={activeTab === 'requests' ? \"requests\" : \"partners\"}\n                            className=\"!border-none !mt-0 !pt-3 !pb-3\"\n                        />\n                    </div>\n                );\n            })()}\n\n            {/* Modal */}\n            <Modal\n                title={\n                    <div className=\"flex items-center gap-2 text-[18px] font-['Manrope:Bold',sans-serif]\">\n                        <UserOutlined className=\"p-2 bg-[#F7F7F7] rounded-full text-[#666666]\" />\n                        {editingPartner ? 'Partner Details' : 'Invite Partner'}\n                    </div>\n                }\n                open={isModalOpen}\n                onOk={editingPartner ? () => setIsModalOpen(false) : handleModalOk}\n                onCancel={() => setIsModalOpen(false)}\n                okText={editingPartner ? 'Close' : 'Send Invitation'}\n                okButtonProps={{\n                    className: editingPartner\n                        ? \"bg-[#666666] hover:bg-[#555555] border-none rounded-[8px] h-10 px-6 font-['Manrope:SemiBold',sans-serif]\"\n                        : \"bg-[#111111] hover:bg-black border-none rounded-[8px] h-10 px-6 font-['Manrope:SemiBold',sans-serif]\"\n                }}\n                cancelButtonProps={{\n                    style: { display: editingPartner ? 'none' : 'inline-block' },\n                    className: \"rounded-[8px] h-10 px-6 font-['Manrope:SemiBold',sans-serif]\"\n                }}\n                centered\n                className=\"rounded-[16px] overflow-hidden\"\n            >\n                {editingPartner ? (\n                    <div className=\"mt-6 space-y-6\">\n                        <div className=\"grid grid-cols-2 gap-6\">\n                            <div>\n                                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Contact Person</p>\n                                <p className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">{editingPartner.name}</p>\n                            </div>\n                            {editingPartner.company && (\n                                <div>\n                                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Company Name</p>\n                                    <p className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">{editingPartner.company}</p>\n                                </div>\n                            )}\n                        </div>\n\n                        <div className=\"grid grid-cols-2 gap-6\">\n                            <div>\n                                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Email Address</p>\n                                <div className=\"flex items-center gap-2\">\n                                    <MailOutlined className=\"text-[#666666] text-[12px]\" />\n                                    <p className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">{editingPartner.email}</p>\n                                </div>\n                            </div>\n                            <div>\n                                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Contact</p>\n                                <div className=\"flex items-center gap-2\">\n                                    <PhoneOutlined className=\"text-[#666666] text-[12px]\" />\n                                    <p className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                                        {(() => {\n                                            const phone = editingPartner.phone || '';\n                                            if (phone.startsWith('+')) return phone;\n                                            const code = countryCodes.find(c => c.country === editingPartner.country)?.code || '';\n                                            return code ? `${code} ${phone}` : (phone || 'N/A');\n                                        })()}\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-2 gap-6\">\n                            <div>\n                                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Country</p>\n                                <div className=\"flex items-center gap-2\">\n                                    <Globe className=\"w-3.5 h-3.5 text-[#666666]\" />\n                                    <p className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                                        {(() => {\n                                            if (!editingPartner.country) return 'N/A';\n                                            try {\n                                                return new Intl.DisplayNames(['en'], { type: 'region' }).of(editingPartner.country);\n                                            } catch (e) {\n                                                return editingPartner.country;\n                                            }\n                                        })()}\n                                    </p>\n                                </div>\n                            </div>\n                            <div>\n                                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-1\">Timezone</p>\n                                <p className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">{editingPartner.timezone || 'N/A'}</p>\n                            </div>\n                        </div>\n                    </div>\n                ) : (\n                    <Form form={form} layout=\"vertical\" className=\"mt-6\" initialValues={{ countryCode: '+91' }}>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <Form.Item\n                                name=\"firstName\"\n                                label={<span className=\"font-['Manrope:Bold',sans-serif] text-[13px]\">First Name</span>}\n                                rules={[{ required: true, message: 'First name is required' }]}\n                            >\n                                <Input\n                                    prefix={<UserOutlined className=\"text-gray-400\" />}\n                                    className=\"h-10\"\n                                    placeholder=\"First Name\"\n                                />\n                            </Form.Item>\n\n                            <Form.Item\n                                name=\"lastName\"\n                                label={<span className=\"font-['Manrope:Bold',sans-serif] text-[13px]\">Last Name</span>}\n                            >\n                                <Input\n                                    prefix={<UserOutlined className=\"text-gray-400\" />}\n                                    className=\"h-10\"\n                                    placeholder=\"Last Name (Optional)\"\n                                />\n                            </Form.Item>\n                        </div>\n\n                        <Form.Item\n                            name=\"email\"\n                            label={<span className=\"font-['Manrope:Bold',sans-serif] text-[13px]\">Email Address</span>}\n                            rules={[{ required: true, type: 'email', message: 'Valid email is required' }]}\n                        >\n                            <Input\n                                prefix={<MailOutlined className=\"text-gray-400\" />}\n                                className=\"h-10\"\n                                placeholder=\"email@example.com\"\n                            />\n                        </Form.Item>\n                    </Form>\n                )}\n\n            </Modal>\n        </PageLayout >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/partners/rows/PartnerRow.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Avatar' is defined but never used.","line":1,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used.","line":2,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":2,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":2,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeIcon' is defined but never used.","line":2,"column":92,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":99},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":4,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":154,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Checkbox, Dropdown, MenuProps, Avatar, Tag } from \"antd\";\nimport { MoreVertical, Edit, Trash2, Mail, Phone, Globe, User, Briefcase, Building, Eye as EyeIcon } from \"lucide-react\";\nimport { EyeOutlined } from '@ant-design/icons';\nimport Link from \"next/link\";\n\nexport type PartnerStatus = 'active' | 'inactive' | 'pending';\n\nexport interface Partner {\n    id: number;\n    association_id?: number | null;\n    name: string; // Contact Person\n    company: string; // Business Name\n    type: 'INDIVIDUAL' | 'ORGANIZATION';\n    email: string;\n    phone: string;\n    country: string;\n    timezone?: string;\n    status: PartnerStatus;\n    requirements: number;\n    onboarding: string;\n    rawStatus?: string;\n    isOrgAccount?: boolean;\n    partner_user_id?: number;\n    company_id?: number;\n}\n\ninterface PartnerRowProps {\n    partner: Partner;\n    selected: boolean;\n    onSelect: () => void;\n    onEdit: () => void;\n    onStatusUpdate: (status: PartnerStatus) => void;\n}\n\nexport function PartnerRow({\n    partner,\n    selected,\n    onSelect,\n    onEdit,\n    onStatusUpdate\n}: PartnerRowProps) {\n\n    const getInitials = (name: string) => {\n        if (!name) return '?';\n        const parts = name.split(' ').filter(Boolean);\n        if (parts.length === 0) return '?';\n        return parts\n            .map(part => part[0])\n            .join('')\n            .toUpperCase()\n            .slice(0, 2);\n    };\n\n    const isOrg = partner.type === 'ORGANIZATION';\n\n    return (\n        <div\n            onClick={onEdit}\n            className={`\n        group bg-white border rounded-[16px] px-4 py-3 transition-all duration-300 cursor-pointer relative z-10\n        ${selected\n                    ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n                    : 'border-[#EEEEEE] hover:border-[#ff3b3b]/20 hover:shadow-lg'\n                }\n      `}\n        >\n            <div className=\"grid grid-cols-[40px_2fr_1fr_0.8fr_1.5fr_0.8fr_0.7fr_0.7fr_40px] gap-4 items-center\">\n                {/* Checkbox */}\n                <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n                    <Checkbox\n                        checked={selected}\n                        onChange={(e) => {\n                            e.stopPropagation();\n                            onSelect();\n                        }}\n                        className=\"red-checkbox\"\n                    />\n                </div>\n\n                {/* Business / Name */}\n                <div className=\"flex items-center gap-3\">\n                    <div className={`\n             w-9 h-9 rounded-full flex items-center justify-center text-[11px] font-bold shrink-0\n             ${isOrg ? 'bg-[#FEF2F2] text-[#DC2626]' : 'bg-[#EFF6FF] text-[#2563EB]'}\n           `}>\n                        {getInitials(partner.company)}\n                    </div>\n                    <div className=\"flex flex-col\">\n                        <span className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111] group-hover:text-[#ff3b3b] transition-colors\">\n                            {partner.company}\n                        </span>\n                        {isOrg && (\n                            <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                                Organization\n                            </span>\n                        )}\n                    </div>\n                </div>\n\n                {/* Contact Person */}\n                <div>\n                    <span className=\"font-['Manrope:Medium',sans-serif] text-[13px] text-[#111111]\">\n                        {partner.name}\n                    </span>\n                </div>\n\n                {/* Type */}\n                <div>\n                    <span className={`\n             inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[11px] font-bold capitalize\n             ${!isOrg ? 'bg-[#EFF6FF] text-[#2563EB]' : 'bg-[#FEF2F2] text-[#DC2626]'}\n           `}>\n                        {isOrg ? <Building className=\"w-3 h-3\" /> : <User className=\"w-3 h-3\" />}\n                        {partner.type === 'ORGANIZATION' ? 'Organization' : 'Individual'}\n                    </span>\n                </div>\n\n                {/* Email */}\n                <div onClick={(e) => e.stopPropagation()} className=\"flex items-center gap-2 text-[#666666] overflow-hidden\">\n                    <Mail className=\"w-3.5 h-3.5 shrink-0\" />\n                    <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] truncate block text-[#111111]\">\n                        {partner.email}\n                    </span>\n                </div>\n\n                {/* Onboarding */}\n                <div>\n                    <span className=\"text-[13px] text-[#111111] font-['Inter:Medium',sans-serif]\">\n                        {partner.onboarding}\n                    </span>\n                </div>\n\n                {/* Status */}\n                <div>\n                    <Tag\n                        color={\n                            partner.status === 'active' ? 'success' :\n                                partner.status === 'pending' ? 'warning' : 'default'\n                        }\n                        className=\"capitalize\"\n                    >\n                        {partner.status}\n                    </Tag>\n                </div>\n\n                {/* Country */}\n                <div className=\"flex items-center gap-2 text-[#666666]\">\n                    <Globe className=\"w-3.5 h-3.5 shrink-0\" />\n                    <span className=\"text-[13px] font-['Inter:Medium',sans-serif]\">\n                        {(() => {\n                            if (!partner.country) return 'N/A';\n                            try {\n                                return new Intl.DisplayNames(['en'], { type: 'region' }).of(partner.country);\n                            } catch (e) {\n                                return partner.country;\n                            }\n                        })()}\n                    </span>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex justify-end\" onClick={(e) => e.stopPropagation()}>\n                    <Dropdown\n                        menu={{\n                            items: [\n                                {\n                                    key: 'edit',\n                                    label: 'View Details',\n                                    icon: <EyeOutlined className=\"w-3.5 h-3.5\" />,\n                                    onClick: onEdit,\n                                    className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                                },\n                                ...(partner.status !== 'pending' ? [{\n                                    key: 'status',\n                                    label: partner.status === 'active' ? 'Deactivate' : 'Activate',\n                                    icon: partner.status === 'active' ? <Trash2 className=\"w-3.5 h-3.5\" /> : <Globe className=\"w-3.5 h-3.5\" />,\n                                    onClick: () => onStatusUpdate(partner.status === 'active' ? 'inactive' : 'active'),\n                                    danger: partner.status === 'active',\n                                    className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                                }] : [{\n                                    key: 'pending',\n                                    label: 'Invitation Pending',\n                                    icon: <Globe className=\"w-3.5 h-3.5\" />,\n                                    disabled: true,\n                                    className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                                }])\n                            ] as MenuProps['items']\n                        }}\n                        trigger={['click']}\n                        placement=\"bottomRight\"\n                    >\n                        <button className=\"w-7 h-7 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] transition-colors\">\n                            <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n                        </button>\n                    </Dropdown>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/profile/ProfilePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":2,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UploadIcon' is defined but never used.","line":3,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":46},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2856,2859],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2856,2859],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":74,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2926,2929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2926,2929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4680,4683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4680,4683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4768,4771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4768,4771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4865,4868],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4865,4868],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":146,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6063,6066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6063,6066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":154,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":349,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":349,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13799,13802],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13799,13802],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":866,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":866,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42654,42657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42654,42657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useRef } from \"react\";\nimport { Button, Input, Select, Divider, Upload, Switch, Progress, App } from \"antd\";\nimport { Camera, Pencil, Upload as UploadIcon, FileText, Bell, Shield } from \"lucide-react\";\nimport Image from \"next/image\";\nimport { PageLayout } from \"../../layout/PageLayout\";\nimport { useUserDetails, useUpdateProfile, useUpdatePassword } from \"@/hooks/useUser\";\nimport { DocumentCard } from \"@/components/ui/DocumentCard\";\nimport { DocumentPreviewModal } from \"@/components/ui/DocumentPreviewModal\";\nimport { UserDocument, DocumentType } from \"@/types/genericTypes\";\nimport {\n    DEFAULT_DOCUMENT_TYPES,\n    DOCUMENT_TYPES_STORAGE_KEY,\n} from \"@/constants/documentTypes\";\n\nconst { Option } = Select;\n\nconst countryCodes = [\n    { code: \"+1\", country: \"US\" },\n    { code: \"+91\", country: \"IN\" },\n    { code: \"+44\", country: \"UK\" },\n    { code: \"+61\", country: \"AU\" },\n    { code: \"+81\", country: \"JP\" },\n    { code: \"+49\", country: \"DE\" },\n];\n\nexport function ProfilePage() {\n    const { message } = App.useApp();\n    const { data: currentUserData } = useUserDetails();\n    const user = currentUserData?.result?.user;\n    const updateProfileMutation = useUpdateProfile();\n    const updatePasswordMutation = useUpdatePassword();\n\n    // Initialize profile state with real data or fallback to mock data\n    const initialProfile = useMemo(() => {\n        // user_profile is an array in the User model definition\n        const rawUserProfile = user?.user_profile;\n        const userProfile = Array.isArray(rawUserProfile) ? rawUserProfile[0] : rawUserProfile || {};\n\n        const fullName = user?.name || \"\";\n        const nameParts = fullName.split(\" \");\n\n        // Robust mobile number resolution (same as EmployeesPage)\n        const fullMobileNumber =\n            userProfile?.mobile_number ||\n            user?.mobile_number ||\n            userProfile?.phone ||\n            user?.phone ||\n            \"\";\n\n        let phone = fullMobileNumber;\n        let countryCode = \"+91\";\n\n        // Parse country code\n        if (phone && phone.startsWith(\"+\")) {\n            const matched = countryCodes.find(c => phone.startsWith(c.code));\n            if (matched) {\n                countryCode = matched.code;\n                phone = phone.replace(matched.code, \"\").trim();\n            }\n        } else if (!phone) {\n            // Default if no phone\n            phone = \"\";\n        }\n\n        // Parse address\n        const fullAddress = userProfile?.address || \"\";\n        const addressParts = fullAddress.split(\",\").map((p: string) => p.trim());\n        const addressLine1 = addressParts[0] || \"\";\n        const addressLine2 = addressParts.slice(1).join(\", \") || \"\";\n\n        // Parse Working Hours\n        const workingHours = userProfile?.working_hours || {};\n        const startTime = (workingHours as any)?.start_time || \"09:30\";\n        const endTime = (workingHours as any)?.end_time || \"18:30\";\n\n        return {\n            firstName: userProfile?.first_name || nameParts[0] || \"\",\n            middleName: userProfile?.middle_name || (nameParts.length > 2 ? nameParts[1] : \"\") || \"\",\n            lastName: userProfile?.last_name || nameParts.slice(nameParts.length > 2 ? 2 : 1).join(\" \") || \"\",\n            email: user?.email || \"\",\n            phone: phone,\n            countryCode: countryCode,\n            designation: userProfile?.designation || user?.designation || \"\",\n            dob: userProfile?.date_of_birth\n                ? new Date(userProfile.date_of_birth)\n                    .toISOString()\n                    .split(\"T\")[0]\n                : \"\",\n            gender: userProfile?.gender || \"\",\n            employeeId: user?.employee_id || userProfile?.employee_id || \"\",\n\n            // Employment Details\n            employmentType: userProfile?.employment_type || \"Full-time\",\n            dateOfJoining: userProfile?.date_of_joining\n                ? new Date(userProfile.date_of_joining)\n                    .toISOString()\n                    .split(\"T\")[0]\n                : \"\",\n            experience: userProfile?.experience || 0,\n            startTime: startTime,\n            endTime: endTime,\n            salary: userProfile?.salary_yearly || 0,\n            hourlyRate: userProfile?.hourly_rates || 0,\n            leaves: userProfile?.no_of_leaves || 0,\n\n            addressLine1: addressLine1,\n            addressLine2: addressLine2,\n            city: userProfile?.city || \"\",\n            state: userProfile?.state || \"\",\n            zipCode: userProfile?.zipcode || \"\",\n            country: userProfile?.country || \"India\",\n            emergencyContactName: (userProfile?.emergency_contact as any)?.name || \"\",\n            emergencyRelationship: (userProfile?.emergency_contact as any)?.relationship || \"\",\n            emergencyContactNumber: (userProfile?.emergency_contact as any)?.phone || \"\",\n        };\n    }, [user]);\n\n    const [passwordForm, setPasswordForm] = useState({\n        currentPassword: \"\",\n        newPassword: \"\",\n        confirmPassword: \"\"\n    });\n\n    const [isEditing, setIsEditing] = useState(false);\n    const [profile, setProfile] = useState(initialProfile);\n\n    // Notification preferences state\n    const [notificationPreferences, setNotificationPreferences] = useState({\n        emailNotifications: true,\n        securityAlerts: true,\n    });\n    const [selectedDocument, setSelectedDocument] =\n        useState<UserDocument | null>(null);\n    const [isPreviewModalOpen, setIsPreviewModalOpen] = useState(false);\n\n    // Document types configuration shared with Settings page (via localStorage)\n    const documentTypes: DocumentType[] = useMemo(() => {\n        try {\n            if (typeof window !== \"undefined\") {\n                const stored = window.localStorage.getItem(\n                    DOCUMENT_TYPES_STORAGE_KEY\n                );\n                if (stored) {\n                    const parsed = JSON.parse(stored);\n                    if (Array.isArray(parsed) && parsed.length > 0) {\n                        return parsed.map((doc: any, index: number) => ({\n                            id: String(doc.id ?? index + 1),\n                            name: String(doc.name ?? \"\"),\n                            required: Boolean(doc.required),\n                        }));\n                    }\n                }\n            }\n        } catch (error) {\n            // Error reading document types from localStorage\n        }\n\n        return DEFAULT_DOCUMENT_TYPES;\n    }, []);\n\n    // Mock documents data - TODO: Replace with actual API call when available\n    const documents = useMemo(() => {\n        // Check if user data has documents\n        const userDocs = user?.documents || user?.user_profile?.documents || [];\n        if (Array.isArray(userDocs) && userDocs.length > 0) {\n            return userDocs;\n        }\n        // Mock documents from docs folder - all 4 types\n        const mockDocuments: UserDocument[] = [\n            {\n                id: \"1\",\n                documentTypeId: documentTypes[0]?.id || \"1\",\n                documentTypeName:\n                    documentTypes[0]?.name || \"Resume / CV\",\n                fileName: \"Resume_Gaurav.pdf\",\n                fileSize: 2400000, // 2.4 MB\n                fileUrl: \"/documents/Jayendra_Jadhav_Resume.pdf\",\n                uploadedDate: \"2024-10-24T00:00:00Z\",\n                fileType: \"pdf\",\n                isRequired: documentTypes[0]?.required ?? true,\n            },\n            {\n                id: \"2\",\n                documentTypeId: documentTypes[1]?.id || \"2\",\n                documentTypeName: documentTypes[1]?.name || \"ID Proof\",\n                fileName: \"profile_photo.webp\",\n                fileSize: 1000000, // 1 MB\n                fileUrl: \"https://github.com/shadcn.png\",\n                uploadedDate: \"2024-01-15T00:00:00Z\",\n                fileType: \"image\",\n                isRequired: documentTypes[1]?.required ?? true,\n            },\n            {\n                id: \"3\",\n                documentTypeId: documentTypes[2]?.id || \"3\",\n                documentTypeName:\n                    documentTypes[2]?.name || \"Contract Agreement\",\n                fileName: \"Employment_Contract.docx\",\n                fileSize: 206000, // 206 KB\n                fileUrl: \"/documents/AI Agent Documentation.docx\",\n                uploadedDate: \"2024-01-20T00:00:00Z\",\n                fileType: \"docx\",\n                isRequired: documentTypes[2]?.required ?? true,\n            },\n            {\n                id: \"4\",\n                documentTypeId: documentTypes[3]?.id || \"4\",\n                documentTypeName:\n                    documentTypes[3]?.name || \"Supporting Documents\",\n                fileName: \"sample_csv.csv\",\n                fileSize: 50000, // 50 KB\n                fileUrl: \"/documents/ollama_filtered_json_support.csv\",\n                uploadedDate: \"2024-12-17T00:00:00Z\",\n                fileType: \"csv\",\n                isRequired: documentTypes[3]?.required ?? false,\n            },\n            {\n                id: \"5\",\n                documentTypeId: documentTypes[4]?.id || \"5\",\n                documentTypeName:\n                    documentTypes[4]?.name || \"Additional Document\",\n                fileName: \"\",\n                fileSize: 0,\n                fileUrl: \"\",\n                uploadedDate: \"\",\n                fileType: \"pdf\",\n                isRequired: documentTypes[4]?.required ?? false,\n            },\n        ];\n        return mockDocuments;\n    }, [user, documentTypes]);\n\n    // Update profile when user data changes\n    useEffect(() => {\n        setProfile(initialProfile);\n    }, [initialProfile]);\n\n    const handleDocumentPreview = (document: UserDocument) => {\n        setSelectedDocument(document);\n        setIsPreviewModalOpen(true);\n    };\n\n    const handleDocumentDownload = (document: UserDocument) => {\n        if (document.fileUrl) {\n            window.open(document.fileUrl, \"_blank\");\n        } else {\n            message.warning(\"Document URL not available\");\n        }\n    };\n\n    const handleDocumentUpload = (documentTypeId: string) => {\n        message.info(\n            `Upload functionality for document type ${documentTypeId} - To be implemented`\n        );\n        // TODO: Implement upload functionality\n    };\n\n    const renderField = (\n        label: string,\n        value: string,\n        field: keyof typeof profile,\n        type: string = \"text\",\n        placeholder: string = \"-\"\n    ) => {\n        return (\n            <div className=\"space-y-2\">\n                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                    {label}\n                </div>\n                <Input\n                    value={profile[field]}\n                    onChange={(e) =>\n                        setProfile({ ...profile, [field]: e.target.value })\n                    }\n                    placeholder={placeholder}\n                    type={type}\n                    disabled={!isEditing}\n                    className={`h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] focus:ring-[#ff3b3b]/10 font-['Manrope:Medium',sans-serif] text-[13px] ${!isEditing ? \"bg-[#FAFAFA] text-[#666666]\" : \"bg-white\"\n                        }`}\n                />\n            </div>\n        );\n    };\n\n    const renderSelect = (\n        label: string,\n        value: string,\n        field: keyof typeof profile,\n        options: string[]\n    ) => {\n        return (\n            <div className=\"space-y-2\">\n                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                    {label}\n                </div>\n                <Select\n                    value={profile[field]}\n                    onChange={(v) =>\n                        setProfile({ ...profile, [field]: String(v) })\n                    }\n                    disabled={!isEditing}\n                    className={`w-full h-11 ${!isEditing ? \"bg-[#FAFAFA]\" : \"\"\n                        }`}\n                >\n                    {options.map((opt) => (\n                        <Option key={opt} value={opt}>\n                            {opt}\n                        </Option>\n                    ))}\n                </Select>\n            </div>\n        );\n    };\n\n    const handleSaveChanges = async () => {\n        try {\n            // Prepare user profile payload\n            const fullMobileNumber = `${profile.countryCode || \"+91\"} ${profile.phone}`.trim();\n            const userProfilePayload = {\n                name: `${profile.firstName} ${profile.lastName}`.trim(),\n                email: profile.email,\n                first_name: profile.firstName,\n                middle_name: profile.middleName || null,\n                last_name: profile.lastName,\n                mobile_number: fullMobileNumber,\n                designation: profile.designation,\n                date_of_birth: profile.dob\n                    ? new Date(profile.dob).toISOString()\n                    : null,\n                gender: profile.gender,\n                employee_id: profile.employeeId,\n                address:\n                    `${profile.addressLine1}, ${profile.addressLine2}`.trim(),\n                city: profile.city,\n                state: profile.state,\n                zipcode: profile.zipCode,\n                country: profile.country,\n                emergency_contact: {\n                    name: profile.emergencyContactName,\n                    relationship: profile.emergencyRelationship,\n                    phone: profile.emergencyContactNumber,\n                },\n            };\n\n            await updateProfileMutation.mutateAsync(userProfilePayload);\n\n            message.success(\"Profile updated successfully!\");\n            setIsEditing(false);\n        } catch (error: any) {\n            const errorMessage =\n                error?.response?.data?.message || \"Failed to update profile\";\n            message.error(errorMessage);\n        }\n    };\n\n    const handleCancelEdit = () => {\n        setIsEditing(false);\n        // Reset changes if needed\n    };\n\n    const handleEdit = () => {\n        setIsEditing(true);\n    };\n\n    // Calculate profile completion percentage\n    const profileCompletion = useMemo(() => {\n        const requiredFields = [\n            profile.firstName,\n            profile.lastName,\n            profile.designation,\n            profile.email,\n            profile.dob,\n            profile.gender,\n            profile.employeeId,\n            profile.country,\n            profile.addressLine1,\n            profile.city,\n            profile.state,\n            profile.zipCode,\n            profile.emergencyContactName,\n            profile.emergencyContactNumber,\n        ];\n\n        const filledFields = requiredFields.filter(\n            (field) => field && field.toString().trim() !== \"\"\n        ).length;\n\n        const totalFields = requiredFields.length;\n        const percentage = Math.round((filledFields / totalFields) * 100);\n        return percentage;\n    }, [profile]);\n\n    return (\n        <PageLayout\n            title=\"My Profile\"\n            titleExtra={\n                <div className=\"flex items-center gap-8\">\n                    {/* Profile Completion - Back in header, no background */}\n                    <div className=\"min-w-[180px]\">\n                        <div className=\"flex items-center justify-between mb-1.5\">\n                            <span className=\"text-[12px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                                Profile Completion\n                            </span>\n                            <span className={`text-[12px] font-['Manrope:SemiBold',sans-serif] ${profileCompletion === 100\n                                ? 'text-[#2ecc71]'\n                                : profileCompletion >= 50\n                                    ? 'text-[#3b8eff]'\n                                    : 'text-[#ff3b3b]'\n                                }`}>\n                                {profileCompletion}%\n                            </span>\n                        </div>\n                        <Progress\n                            percent={profileCompletion}\n                            showInfo={false}\n                            strokeColor={\n                                profileCompletion === 100\n                                    ? \"#2ecc71\"\n                                    : profileCompletion >= 50\n                                        ? \"#3b8eff\"\n                                        : \"#ff3b3b\"\n                            }\n                            trailColor=\"#EEEEEE\"\n                            strokeWidth={6}\n                            className=\"m-0\"\n                        />\n                    </div>\n\n                    {/* Actions */}\n                    {!isEditing ? (\n                        <Button\n                            onClick={handleEdit}\n                            className=\"bg-[#111111] hover:bg-[#000000]/90 text-white font-['Manrope:SemiBold',sans-serif] px-6 h-10 rounded-full text-[13px] flex items-center gap-2 border-none\"\n                        >\n                            <Pencil className=\"w-4 h-4\" />\n                            Edit\n                        </Button>\n                    ) : (\n                        <div className=\"flex items-center gap-3\">\n                            <Button\n                                onClick={handleCancelEdit}\n                                type=\"text\"\n                                className=\"text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] font-['Manrope:SemiBold',sans-serif] px-6 h-10 rounded-full text-[13px]\"\n                            >\n                                Cancel\n                            </Button>\n                            <Button\n                                onClick={handleSaveChanges}\n                                loading={updateProfileMutation.isPending}\n                                className=\"bg-[#ff3b3b] hover:bg-[#ff3b3b]/90 text-white font-['Manrope:SemiBold',sans-serif] px-8 h-10 rounded-full shadow-lg shadow-[#ff3b3b]/20 text-[13px] border-none\"\n                            >\n                                Save Changes\n                            </Button>\n                        </div>\n                    )}\n                </div>\n            }\n        >\n            <div className=\"flex flex-col h-full\">\n                {/* Header Info - Static area */}\n                <div className=\"mb-4\">\n                    <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif]\">\n                        Manage your account settings and preferences\n                    </p>\n                </div>\n\n                <div className=\"flex-1 overflow-y-auto pr-2 pb-10\">\n                    {/* Personal Details */}\n                    <section className=\"mb-6\">\n                        <div className=\"flex flex-col md:flex-row gap-10 items-stretch mb-8\">\n                            {/* Left Sidebar: Heading & Avatar */}\n                            <div className=\"shrink-0 w-32 flex flex-col justify-between\">\n                                <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] whitespace-nowrap self-start\">\n                                    Personal Details\n                                </h2>\n\n                                <div className=\"relative group cursor-pointer self-center\">\n                                    <div className=\"w-32 h-32 rounded-full overflow-hidden border border-[#EEEEEE] shadow-sm\">\n                                        <Image\n                                            src={\n                                                user?.user_profile?.profile_pic ||\n                                                user?.profile_pic ||\n                                                \"https://github.com/shadcn.png\"\n                                            }\n                                            alt=\"Profile\"\n                                            width={128}\n                                            height={128}\n                                            className=\"w-full h-full object-cover\"\n                                        />\n                                    </div>\n                                    <div className=\"absolute inset-0 bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\n                                        <Camera className=\"w-8 h-8 text-white\" />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Fields Grid */}\n                            <div className=\"flex-1 w-full space-y-6\">\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {renderField(\n                                        \"First Name\",\n                                        profile.firstName,\n                                        \"firstName\"\n                                    )}\n                                    {renderField(\n                                        \"Middle Name\",\n                                        profile.middleName,\n                                        \"middleName\"\n                                    )}\n                                </div>\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {renderField(\n                                        \"Last Name\",\n                                        profile.lastName,\n                                        \"lastName\"\n                                    )}\n                                    {renderField(\n                                        \"Designation\",\n                                        profile.designation,\n                                        \"designation\"\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n                            {renderField(\"Email Address\", profile.email, \"email\")}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Phone Number\n                                </div>\n                                <div className=\"flex gap-2\">\n                                    <Select\n                                        value={profile.countryCode}\n                                        onChange={(v) =>\n                                            setProfile({ ...profile, countryCode: String(v) })\n                                        }\n                                        disabled={!isEditing}\n                                        className={`w-[85px] h-11 ${!isEditing ? \"bg-[#FAFAFA]\" : \"\"}`}\n                                        suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                                    >\n                                        {countryCodes.map((c) => (\n                                            <Option key={c.code} value={c.code}>{c.code} {c.country}</Option>\n                                        ))}\n                                    </Select>\n                                    <Input\n                                        value={profile.phone}\n                                        onChange={(e) =>\n                                            setProfile({ ...profile, phone: e.target.value })\n                                        }\n                                        placeholder=\"123 456 7890\"\n                                        disabled={!isEditing}\n                                        className={`flex-1 h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] focus:ring-[#ff3b3b]/10 font-['Manrope:Medium',sans-serif] text-[13px] ${!isEditing ? \"bg-[#FAFAFA] text-[#666666]\" : \"bg-white\"\n                                            }`}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                            {renderField(\"DOB\", profile.dob, \"dob\", \"date\")}\n                            {renderSelect(\"Gender\", profile.gender, \"gender\", [\n                                \"Male\",\n                                \"Female\",\n                                \"Other\",\n                            ])}\n                            {renderField(\n                                \"Employee ID\",\n                                profile.employeeId,\n                                \"employeeId\"\n                            )}\n                        </div>\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Employment Details */}\n                    <section className=\"mb-10\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Employment Details\n                        </h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n                            {/* Employment Type - Read Only */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Employment Type\n                                </div>\n                                <Input\n                                    value={profile.employmentType}\n                                    disabled={true}\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                            {/* Date of Joining - Read Only */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Date of Joining\n                                </div>\n                                <Input\n                                    value={profile.dateOfJoining}\n                                    type=\"date\"\n                                    disabled={true}\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6\">\n                            {/* Experience */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Experience (Years)\n                                </div>\n                                <Input\n                                    value={profile.experience}\n                                    disabled={true}\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                            {/* Working Hours */}\n                            <div className=\"col-span-2 space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Working Hours\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                    <Input\n                                        value={profile.startTime}\n                                        disabled={true}\n                                        className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                    />\n                                    <span className=\"text-[#666666] text-sm\">to</span>\n                                    <Input\n                                        value={profile.endTime}\n                                        disabled={true}\n                                        className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                            {/* Salary */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Salary (Yearly)\n                                </div>\n                                <Input\n                                    value={profile.salary}\n                                    disabled={true}\n                                    prefix=\"$\"\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                            {/* Hourly Rate */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Hourly Rate\n                                </div>\n                                <Input\n                                    value={profile.hourlyRate}\n                                    disabled={true}\n                                    suffix=\"/Hr\"\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                            {/* Leaves Balance */}\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Leaves Balance\n                                </div>\n                                <Input\n                                    value={profile.leaves}\n                                    disabled={true}\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] font-['Manrope:Medium',sans-serif] text-[13px] bg-[#FAFAFA] text-[#666666]\"\n                                />\n                            </div>\n                        </div>\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Address Information */}\n                    <section className=\"mb-10\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Address Information\n                        </h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                            {renderField(\n                                \"Address Line 1\",\n                                profile.addressLine1,\n                                \"addressLine1\"\n                            )}\n                            {renderField(\n                                \"Address Line 2\",\n                                profile.addressLine2,\n                                \"addressLine2\"\n                            )}\n                            {renderField(\"City\", profile.city, \"city\")}\n                            {renderField(\"State\", profile.state, \"state\")}\n                            {renderField(\"ZIP Code\", profile.zipCode, \"zipCode\")}\n                            {renderField(\"Country\", profile.country, \"country\")}\n                        </div>\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Emergency Contact Information */}\n                    <section className=\"mb-10\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Emergency Contact Information\n                        </h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                            {renderField(\n                                \"Emergency Contact Name\",\n                                profile.emergencyContactName,\n                                \"emergencyContactName\"\n                            )}\n                            {renderField(\n                                \"Relationship\",\n                                profile.emergencyRelationship,\n                                \"emergencyRelationship\"\n                            )}\n                            {renderField(\n                                \"Emergency Contact Number\",\n                                profile.emergencyContactNumber,\n                                \"emergencyContactNumber\"\n                            )}\n                        </div>\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Professional Documents */}\n                    <section className=\"mb-10\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Professional Documents\n                        </h2>\n                        {documentTypes && documentTypes.length > 0 ? (\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                                {documentTypes.map((docType) => {\n                                    const matchingDoc = documents?.find(\n                                        (doc: UserDocument) =>\n                                            doc.documentTypeId === docType.id\n                                    );\n\n                                    const documentForCard: UserDocument =\n                                        matchingDoc ||\n                                        ({\n                                            id: docType.id,\n                                            documentTypeId: docType.id,\n                                            documentTypeName: docType.name,\n                                            fileName: \"\",\n                                            fileSize: 0,\n                                            fileUrl: \"\",\n                                            uploadedDate: \"\",\n                                            fileType: \"pdf\",\n                                            isRequired: docType.required,\n                                        } as UserDocument);\n\n                                    return (\n                                        <div key={docType.id} className=\"space-y-3\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                                    {docType.name}\n                                                </div>\n                                                {!docType.required && (\n                                                    <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                                                        Optional\n                                                    </span>\n                                                )}\n                                            </div>\n                                            <DocumentCard\n                                                document={documentForCard}\n                                                onPreview={handleDocumentPreview}\n                                                onDownload={handleDocumentDownload}\n                                                showUpload={!documentForCard.fileUrl}\n                                                onUpload={handleDocumentUpload}\n                                            />\n                                        </div>\n                                    );\n                                })}\n                            </div>\n                        ) : (\n                            <div className=\"border border-[#EEEEEE] border-dashed rounded-lg p-8 bg-[#FAFAFA] text-center\">\n                                <FileText className=\"w-12 h-12 text-[#CCCCCC] mx-auto mb-3\" />\n                                <p className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666] mb-1\">\n                                    No documents configured\n                                </p>\n                                <p className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                                    Add required documents in Settings to manage employee files.\n                                </p>\n                            </div>\n                        )}\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Password */}\n                    {/* Password */}\n                    <section className=\"mb-10\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Change Password\n                        </h2>\n                        <div className=\"grid grid-cols-1 gap-6 max-w-md\">\n                           <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Current Password\n                                </div>\n                                <Input.Password\n                                    value={passwordForm.currentPassword}\n                                    onChange={(e) => setPasswordForm(prev => ({ ...prev, currentPassword: e.target.value }))}\n                                    placeholder=\"Enter current password\"\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px] bg-white\"\n                                />\n                            </div>\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    New Password\n                                </div>\n                                <Input.Password\n                                    value={passwordForm.newPassword}\n                                    onChange={(e) => setPasswordForm(prev => ({ ...prev, newPassword: e.target.value }))}\n                                    placeholder=\"Enter new password\"\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px] bg-white\"\n                                />\n                            </div>\n                            <div className=\"space-y-2\">\n                                <div className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                                    Confirm New Password\n                                </div>\n                                <Input.Password\n                                    value={passwordForm.confirmPassword}\n                                    onChange={(e) => setPasswordForm(prev => ({ ...prev, confirmPassword: e.target.value }))}\n                                    placeholder=\"Confirm new password\"\n                                    className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px] bg-white\"\n                                />\n                            </div>\n                            <div>\n                                <Button \n                                    type=\"primary\" \n                                    onClick={async () => {\n                                        if (!passwordForm.currentPassword) {\n                                            message.error(\"Please enter your current password\");\n                                            return;\n                                        }\n                                        if (!passwordForm.newPassword || !passwordForm.confirmPassword) {\n                                            message.error(\"Please enter a new password\");\n                                            return;\n                                        }\n                                        if (passwordForm.newPassword !== passwordForm.confirmPassword) {\n                                            message.error(\"Passwords do not match\");\n                                            return;\n                                        }\n                                        if (passwordForm.newPassword.length < 8) {\n                                            message.error(\"Password must be at least 8 characters\");\n                                            return;\n                                        }\n                                        \n                                        try {\n                                            await updatePasswordMutation.mutateAsync({\n                                                password: passwordForm.newPassword,\n                                                currentPassword: passwordForm.currentPassword\n                                            });\n                                            setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n                                            message.success(\"Password updated successfully!\");\n                                        } catch (error: any) {\n                                            message.error(error?.response?.data?.message || \"Failed to update password\");\n                                        }\n                                    }}\n                                    loading={updatePasswordMutation.isPending}\n                                    className=\"bg-[#111111] h-10 px-6 rounded-lg font-['Manrope:SemiBold',sans-serif] w-full sm:w-auto\"\n                                >\n                                    Update Password\n                                </Button>\n                            </div>\n                        </div>\n                    </section>\n\n                    <Divider className=\"my-8 bg-[#EEEEEE]\" />\n\n                    {/* Notification Preferences */}\n                    <section className=\"mb-6\">\n                        <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">\n                            Notification Preferences\n                        </h2>\n                        <div className=\"space-y-6\">\n                            {/* Email Notifications */}\n                            <div className=\"flex items-center justify-between p-4 bg-[#FAFAFA] rounded-lg border border-[#EEEEEE]\">\n                                <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-10 h-10 bg-[#FFF4F4] rounded-lg flex items-center justify-center\">\n                                        <Bell className=\"w-5 h-5 text-[#ff3b3b]\" />\n                                    </div>\n                                    <div>\n                                        <div className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-1\">\n                                            Email Notifications\n                                        </div>\n                                        <div className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                                            Receive updates via email for important activities.\n                                        </div>\n                                    </div>\n                                </div>\n                                <Switch\n                                    checked={notificationPreferences.emailNotifications}\n                                    onChange={(checked) =>\n                                        setNotificationPreferences({\n                                            ...notificationPreferences,\n                                            emailNotifications: checked,\n                                        })\n                                    }\n                                    className=\"bg-[#CCCCCC]\"\n                                    checkedChildren=\"ON\"\n                                    unCheckedChildren=\"OFF\"\n                                    style={{\n                                        backgroundColor: notificationPreferences.emailNotifications\n                                            ? \"#ff3b3b\"\n                                            : undefined,\n                                    }}\n                                />\n                            </div>\n\n                            {/* Security Alerts */}\n                            <div className=\"flex items-center justify-between p-4 bg-[#FAFAFA] rounded-lg border border-[#EEEEEE]\">\n                                <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-10 h-10 bg-[#FFF4F4] rounded-lg flex items-center justify-center\">\n                                        <Shield className=\"w-5 h-5 text-[#ff3b3b]\" />\n                                    </div>\n                                    <div>\n                                        <div className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-1\">\n                                            Security Alerts\n                                        </div>\n                                        <div className=\"text-[13px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                                            Get notified about new sign-ins and suspicious activity.\n                                        </div>\n                                    </div>\n                                </div>\n                                <Switch\n                                    checked={notificationPreferences.securityAlerts}\n                                    onChange={(checked) =>\n                                        setNotificationPreferences({\n                                            ...notificationPreferences,\n                                            securityAlerts: checked,\n                                        })\n                                    }\n                                    className=\"bg-[#CCCCCC]\"\n                                    checkedChildren=\"ON\"\n                                    unCheckedChildren=\"OFF\"\n                                    style={{\n                                        backgroundColor: notificationPreferences.securityAlerts\n                                            ? \"#ff3b3b\"\n                                            : undefined,\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    </section>\n                </div>\n\n                {/* Document Preview Modal */}\n                <DocumentPreviewModal\n                    open={isPreviewModalOpen}\n                    onClose={() => {\n                        setIsPreviewModalOpen(false);\n                        setSelectedDocument(null);\n                    }}\n                    document={selectedDocument}\n                />\n            </div>\n        </PageLayout>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/reports/ReportsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BrandLogo' is defined but never used.","line":7,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EmployeeReport' is defined but never used.","line":18,"column":88,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":102},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MemberRow' is defined but never used.","line":24,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1441,1444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1441,1444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4341,4344],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4341,4344],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4510,4513],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4510,4513],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4682,4685],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4682,4685],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedTaskStatus' is assigned a value but never used.","line":125,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":125,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedTaskStatus' is assigned a value but never used.","line":125,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":125,"endColumn":51},{"ruleId":"@typescript-eslint/no-unnecessary-type-constraint","severity":2,"message":"Constraining the generic type `T` to `any` does nothing and is unnecessary.","line":288,"column":21,"nodeType":"TSTypeParameter","messageId":"unnecessaryConstraint","endLine":288,"endColumn":34,"suggestions":[{"messageId":"removeUnnecessaryConstraint","data":{"constraint":"any"},"fix":{"range":[9757,9769],"text":","},"desc":"Remove the unnecessary `any` constraint."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9766,9769],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9766,9769],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":292,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9885,9888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9885,9888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":293,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":293,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9932,9935],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9932,9935],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingWorklogs' is assigned a value but never used.","line":353,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":353,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":376,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":376,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13340,13343],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13340,13343],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'percentage' is assigned a value but never used.","line":511,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":511,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isOverBudget' is assigned a value but never used.","line":512,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":512,"endColumn":37}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport {\n  Download,\n  Clock, CheckCircle2, AlertCircle, Loader2,\n  ChevronDown\n} from 'lucide-react';\nimport BrandLogo from '@/assets/images/logo.png';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { DateRangeSelector } from '../../common/DateRangeSelector';\nimport { Drawer, Tooltip, Button } from \"antd\";\nimport { ReportsPdfTemplate, IndividualEmployeePdfTemplate, generatePdf } from './ReportsPdfGeneration'; // New Import\nimport dayjs from 'dayjs';\nimport isBetween from 'dayjs/plugin/isBetween';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { useQuery } from '@tanstack/react-query';\nimport { usePartners, useEmployees, useCompanyDepartments, useCurrentUserCompany } from '@/hooks/useUser';\nimport { getRequirementReports, getTaskReports, getEmployeeReports, getMemberWorklogs, EmployeeReport, EmployeeKPI } from '../../../services/report';\n\n// Initialize dayjs plugins\ndayjs.extend(isBetween);\n\n// --- Types ---\ninterface MemberRow {\n  id: string;\n  member: string;\n  department: string;\n  taskStats: { assigned: number; completed: number; inProgress: number; delayed: number };\n  totalWorkingHrs: number;\n  actualEngagedHrs: number;\n  costPerHour: number;\n  billablePerHour: number;\n}\n\n\n// --- Helper Components ---\n\nfunction StatusBadge({ status }: { status: string }) {\n  const config: Record<string, { icon: any, color: string, label: string }> = {\n    'Completed': { icon: CheckCircle2, color: 'text-[#0F9D58]', label: 'Completed' },\n    'In Progress': { icon: Loader2, color: 'text-[#2196F3]', label: 'In Progress' },\n    'Delayed': { icon: AlertCircle, color: 'text-[#FF3B3B]', label: 'Delayed' },\n    'Paid': { icon: CheckCircle2, color: 'text-[#0F9D58]', label: 'Paid' },\n    'Pending': { icon: Clock, color: 'text-[#F59E0B]', label: 'Pending' },\n    'Overdue': { icon: AlertCircle, color: 'text-[#FF3B3B]', label: 'Overdue' },\n  };\n\n  const style = config[status] || { icon: Clock, color: 'text-[#999999]', label: status };\n  const Icon = style.icon;\n\n  return (\n    <Tooltip title={style.label}>\n      <div className=\"cursor-help inline-flex items-center justify-center p-1\">\n        <Icon className={`w-5 h-5 ${style.color} ${status === 'In Progress' ? 'animate-spin' : ''}`} />\n      </div>\n    </Tooltip>\n  );\n}\n\nfunction TableHeader({\n  label,\n  sortKey,\n  currentSort,\n  onSort,\n  align = 'left'\n}: {\n  label: string;\n  sortKey?: string;\n  currentSort?: { key: string; direction: 'asc' | 'desc' } | null;\n  onSort?: (key: string) => void;\n  align?: 'left' | 'right' | 'center';\n}) {\n  const isSorted = currentSort?.key === sortKey;\n\n  return (\n    <button\n      className={`flex items-center gap-1 group outline-none ${sortKey ? 'cursor-pointer' : 'cursor-default'} ${align === 'right' ? 'ml-auto' : align === 'center' ? 'mx-auto' : ''}`}\n      onClick={() => sortKey && onSort?.(sortKey)}\n      disabled={!sortKey}\n    >\n      <span className={`text-[11px] font-['Manrope:Bold',sans-serif] uppercase tracking-wide transition-colors ${isSorted ? 'text-[#111111]' : 'text-[#999999] group-hover:text-[#666666]'}`}>\n        {label}\n      </span>\n      {sortKey && (\n        <span className={`flex flex-col items-center justify-center transition-all ${isSorted ? 'opacity-100' : 'opacity-0 group-hover:opacity-50'}`}>\n          <ChevronDown className={`w-3 h-3 transition-transform ${isSorted && currentSort?.direction === 'desc' ? 'rotate-180 text-[#111111]' : 'text-[#999999]'}`} />\n        </span>\n      )}\n    </button>\n  );\n}\n\n\n// --- Main Component ---\n\nexport function ReportsPage() {\n  const [activeTab, setActiveTab] = useTabSync<'requirement' | 'task' | 'member'>({\n    defaultTab: 'requirement',\n    validTabs: ['requirement', 'task', 'member']\n  });\n\n\n  const { data: companyData } = useCurrentUserCompany();\n  const companyName = companyData?.result?.name; // Correctly accessing 'name' nested in 'result' property of ApiResponse\n\n  // Fetch Dropdown Data\n  const { data: partnersData } = usePartners();\n  const { data: employeesData } = useEmployees(\"is_active=true&limit=1000\"); // Fetch all active for filters\n  const { data: departmentsData } = useCompanyDepartments();\n\n  const partnerOptions = [\n      { label: 'All', value: 'All' }, \n      ...(partnersData?.result || []).map((p: any) => ({ label: p.name, value: String(p.id) }))\n  ];\n  const employeeOptions = [\n      { label: 'All', value: 'All' }, \n      ...(employeesData?.result || []).map((e: any) => ({ label: e.name, value: String(e.id) }))\n  ];\n  const departmentOptions = [\n      { label: 'All', value: 'All' },\n      ...(departmentsData?.result || []).map((d: any) => ({ label: d.name, value: String(d.id) }))\n  ];\n\n  const [selectedMemberId, setSelectedMemberId] = useState<string | null>(null);\n  const [selectedTaskStatus, setSelectedTaskStatus] = useState<string>('All');\n  const [isDownloading, setIsDownloading] = useState(false);\n  const [isDownloadingIndividual, setIsDownloadingIndividual] = useState(false);\n\n\n  // Filters State\n  const [filters, setFilters] = useState<Record<string, string>>({\n    partner: 'All',\n    member: 'All',\n    leader: 'All',\n    assigned: 'All',\n    status: 'All'\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Sorting State\n  const [sortConfig, setSortConfig] = useState<{ key: string; direction: 'asc' | 'desc' } | null>(null);\n\n  const handleSort = (key: string) => {\n    setSortConfig(current => {\n      if (current?.key === key && current.direction === 'asc') {\n        return { key, direction: 'desc' };\n      }\n      return { key, direction: 'asc' };\n    });\n  };\n\n  // Date Picker State using dayjs for AntD\n  const [dateRange, setDateRange] = useState<[dayjs.Dayjs | null, dayjs.Dayjs | null] | null>([\n    dayjs().startOf('month'),\n    dayjs().endOf('month')\n  ]);\n\n  // Handle Filters\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n  };\n\n  const clearFilters = () => {\n    setFilters({\n      partner: 'All',\n      member: 'All',\n      status: 'All',\n      manager: 'All',\n      leader: 'All',\n      assigned: 'All',\n      department: 'All'\n    });\n    setSearchQuery('');\n  };\n\n  const handleDownloadPDF = async () => {\n    setIsDownloading(true);\n    try {\n      const fileName = `alsonotify_${activeTab}_report_${dayjs().format('YYYY-MM-DD')}.pdf`;\n      await generatePdf(fileName, 'pdf-report-container');\n    } catch (error) {\n      console.error('PDF Generation failed:', error);\n      alert(\"Failed to generate PDF. Please check console for details.\");\n    } finally {\n      setIsDownloading(false);\n    }\n  };\n\n  const handleDownloadIndividualPDF = async () => {\n    if(!selectedMember) return;\n    setIsDownloadingIndividual(true);\n    try {\n      const fileName = `alsonotify_employee_${selectedMember.member.replace(/\\s+/g, '_')}_${dayjs().format('YYYY-MM-DD')}.pdf`;\n      await generatePdf(fileName, 'pdf-individual-report-container');\n    } catch (error) {\n         console.error('PDF Generation failed:', error);\n         alert(\"Failed to generate PDF\");\n    } finally {\n        setIsDownloadingIndividual(false);\n    }\n  }\n\n  const handleExport = () => {\n      handleDownloadPDF();\n  };\n\n  // --- Queries ---\n\n  // Requirements Query\n  const { data: requirementData, isLoading: isLoadingRequirements } = useQuery({\n    queryKey: ['requirement-reports', filters, searchQuery, dateRange],\n    queryFn: () => getRequirementReports({\n      search: searchQuery,\n      partner_id: filters.partner,\n      status: filters.status,\n      start_date: dateRange && dateRange[0] ? dateRange[0].toISOString() : undefined,\n      end_date: dateRange && dateRange[1] ? dateRange[1].toISOString() : undefined,\n    }),\n    enabled: activeTab === 'requirement' || true\n  });\n\n\n  // Tasks Query\n  const { data: taskData, isLoading: isLoadingTasks } = useQuery({\n    queryKey: ['task-reports', filters, searchQuery, dateRange],\n    queryFn: () => getTaskReports({\n      search: searchQuery,\n      leader_id: filters.leader,\n      assigned_id: filters.assigned,\n      status: filters.status,\n      start_date: dateRange && dateRange[0] ? dateRange[0].toISOString() : undefined,\n      end_date: dateRange && dateRange[1] ? dateRange[1].toISOString() : undefined,\n    }),\n    enabled: activeTab === 'task' || true\n  });\n\n  // Employees Query\n  const { data: employeeData, isLoading: isLoadingEmployees } = useQuery({\n    queryKey: ['employee-reports', filters, searchQuery, dateRange],\n    queryFn: () => getEmployeeReports({\n      search: searchQuery,\n      department_id: filters.department,\n      member_id: filters.member,\n      start_date: dateRange && dateRange[0] ? dateRange[0].toISOString() : undefined,\n      end_date: dateRange && dateRange[1] ? dateRange[1].toISOString() : undefined,\n    }),\n    enabled: activeTab === 'member' || true\n  });\n\n  console.log('Reports Debug:', { \n      requirementData, \n      taskData, \n      employeeData,\n      reqLoading: isLoadingRequirements,\n      taskLoading: isLoadingTasks \n  });\n\n\n  // Process Data\n  const requirements = requirementData?.data || [];\n  const kpi = requirementData?.kpi || {\n    totalRequirements: 0,\n    onTimeCompleted: 0,\n    delayedCompleted: 0,\n    totalExtraHrs: 0,\n    efficiency: 0\n  };\n\n  const tasks = taskData?.data || [];\n  const taskKPI = taskData?.kpi || {\n    totalTasks: 0,\n    onTimeCompleted: 0,\n    delayedCompleted: 0,\n    totalExtraHrs: 0,\n    efficiency: 0\n  };\n\n  const employees = employeeData?.data || [];\n  const employeeKPI: EmployeeKPI = employeeData?.kpi || {\n    totalInvestment: 0,\n    totalRevenue: 0,\n    netProfit: 0,\n    avgRatePerHr: 0\n  };\n\n\n  // Client-side Sorting\n  const sortData = <T extends any>(data: T[]) => {\n    if (!sortConfig) return data;\n\n    return [...data].sort((a, b) => {\n      const aVal = (a as any)[sortConfig.key];\n      const bVal = (b as any)[sortConfig.key];\n\n      if (aVal === bVal) return 0;\n      if (aVal === null || aVal === undefined) return 1;\n      if (bVal === null || bVal === undefined) return -1;\n\n      if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;\n      return sortConfig.direction === 'asc' ? 1 : -1;\n    });\n  };\n\n  const filteredRequirements = sortData(requirements);\n  const filteredTasks = sortData(tasks);\n  const filteredEmployees = sortData(employees);\n\n  // Debug Logs\n  console.log('ReportsPage Render:', { \n    activeTab, \n    requirementsCount: requirements.length, \n    tasksCount: tasks.length,\n    reqData: requirementData,\n    taskData: taskData\n  });\n\n\n  // Filter Configuration\n  const filterOptions: FilterOption[] = [];\n\n  if (activeTab === 'requirement') {\n    filterOptions.push(\n      { id: 'partner', label: 'Partner', options: partnerOptions, defaultValue: 'All', placeholder: 'Select Partner' },\n      { id: 'status', label: 'Status', options: ['All', 'Completed', 'In Progress', 'Delayed'], defaultValue: 'All' }\n    );\n  } else if (activeTab === 'task') {\n    filterOptions.push(\n      { id: 'leader', label: 'Leader', options: employeeOptions, defaultValue: 'All', placeholder: 'Select Leader' },\n      { id: 'assigned', label: 'Assigned', options: employeeOptions, defaultValue: 'All', placeholder: 'Select Member' },\n      { id: 'status', label: 'Status', options: ['All', 'Completed', 'In Progress', 'Delayed'], defaultValue: 'All' }\n    );\n  } else if (activeTab === 'member') {\n    filterOptions.push({ id: 'member', label: 'Member', options: employeeOptions, defaultValue: 'All', placeholder: 'Select Member' });\n    filterOptions.push({ id: 'department', label: 'Department', options: departmentOptions, defaultValue: 'All', placeholder: 'Select Department' });\n  }\n\n  // Selected Member Logic\n  // Find member in the fetched employees list\n  const selectedMemberData = employees.find(m => String(m.id) === selectedMemberId) || null;\n  \n  // Adapt EmployeeReport to the shape expected by the drawer (MemberRow-like)\n  const selectedMember = selectedMemberData ? {\n      ...selectedMemberData,\n      id: String(selectedMemberData.id), // Ensure ID is string\n      totalWorkingHrs: selectedMemberData.utilization > 0 ? Math.round(selectedMemberData.engagedHrs / (selectedMemberData.utilization / 100)) : 0,\n      actualEngagedHrs: selectedMemberData.engagedHrs,\n      costPerHour: selectedMemberData.hourlyCost,\n      billablePerHour: 0 // Not in API yet\n  } : null;\n\n  // Placeholder task filtering for member drawer - Mock worklogs as we don't have an endpoint for user worklogs yet\n  // Query Member Worklogs\n  const { data: memberWorklogs, isLoading: isLoadingWorklogs } = useQuery({\n      queryKey: ['member-worklogs', selectedMemberId, dateRange],\n      queryFn: () => getMemberWorklogs(\n          selectedMemberId!, \n          dateRange && dateRange[0] ? dateRange[0].toISOString() : undefined,\n          dateRange && dateRange[1] ? dateRange[1].toISOString() : undefined\n      ),\n      enabled: !!selectedMemberId\n  });\n\n  const selectedMemberWorklogs = memberWorklogs || [];\n\n\n  return (\n    <PageLayout\n      title=\"Reports\" \n      tabs={[\n        { id: 'requirement', label: 'Requirement' },\n        { id: 'task', label: 'Tasks' },\n        { id: 'member', label: 'Employee' }\n\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => setActiveTab(tabId as any)}\n      customFilters={\n        <div className=\"flex items-center gap-3\">\n          <Button\n            onClick={handleExport}\n            icon={<Download className=\"w-4 h-4\" />}\n            className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] rounded-full\"\n            disabled={isDownloading}\n          >\n            {isDownloading ? 'Generating...' : 'Download'}\n          </Button>\n          <DateRangeSelector\n            value={dateRange}\n            onChange={setDateRange}\n          />\n        </div>\n      }\n    >\n      <div className=\"flex flex-col h-full relative\">\n        {/* Filter Bar */}\n        <div className=\"mb-6 space-y-4\">\n          <FilterBar\n            filters={filterOptions}\n            selectedFilters={filters}\n            onFilterChange={handleFilterChange}\n            onClearFilters={clearFilters}\n            searchPlaceholder=\"Search reports...\"\n            searchValue={searchQuery}\n            onSearchChange={setSearchQuery}\n            showClearButton={true}\n          />\n\n          {/* Summary Cards */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4\">\n            {activeTab === 'requirement' && (\n              <>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Total Requirements</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{kpi.totalRequirements}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">On Time Completed</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#0F9D58]\">{kpi.onTimeCompleted}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Delayed but Completed</span>\n                  <div className=\"flex items-baseline gap-2\">\n                    <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{kpi.delayedCompleted}</span>\n                    {kpi.totalExtraHrs > 0 && <span className=\"text-sm font-medium text-[#FF3B3B]\">(+{kpi.totalExtraHrs}h)</span>}\n                  </div>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Avg. Efficiency</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#2196F3]\">\n                    {kpi.efficiency}%\n                  </span>\n                </div>\n              </>\n            )}\n\n            {activeTab === 'task' && (\n              <>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Total Tasks</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{taskKPI.totalTasks}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">On Time Completed</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#0F9D58]\">{taskKPI.onTimeCompleted}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Delayed but Completed</span>\n                  <div className=\"flex items-baseline gap-2\">\n                    <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{taskKPI.delayedCompleted}</span>\n                    {taskKPI.totalExtraHrs > 0 && <span className=\"text-sm font-medium text-[#FF3B3B]\">(+{taskKPI.totalExtraHrs}h)</span>}\n                  </div>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Avg. Efficiency</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#2196F3]\">\n                    {taskKPI.efficiency}%\n                  </span>\n                </div>\n              </>\n            )}\n\n            {activeTab === 'member' && (\n              <>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Total Investment</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">${employeeKPI.totalInvestment.toLocaleString()}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Total Revenue</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#0F9D58]\">${employeeKPI.totalRevenue.toLocaleString()}</span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Net Profit</span>\n                  <span className={`text-2xl font-['Manrope:Bold',sans-serif] ${employeeKPI.netProfit >= 0 ? 'text-[#0F9D58]' : 'text-[#FF3B3B]'}`}>\n                    ${employeeKPI.netProfit.toLocaleString()}\n                  </span>\n                </div>\n                <div className=\"p-4 rounded-xl border border-[#EEEEEE] bg-[#FAFAFA] flex flex-col gap-1\">\n                  <span className=\"text-[12px] font-medium text-[#666666]\">Avg. Rate/Hr</span>\n                  <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#2196F3]\">\n                    ${employeeKPI.avgRatePerHr.toLocaleString()}\n                  </span>\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n\n\n        {/* Table Content */}\n        <div className=\"flex-1 overflow-y-auto pb-6\">\n          {isLoadingRequirements || (activeTab === 'task' && isLoadingTasks) || (activeTab === 'member' && isLoadingEmployees) ? (\n            <div className=\"flex items-center justify-center h-40\">\n              <Loader2 className=\"w-6 h-6 animate-spin text-[#999999]\" />\n            </div>\n          ) : activeTab === 'requirement' && (\n            <table className=\"w-full text-left border-collapse min-w-[1000px]\">\n              <thead className=\"sticky top-0 z-10 bg-white\">\n                <tr className=\"border-b border-[#EEEEEE] h-10\">\n                   <th className=\"pl-6 pr-4 w-[50px]\"><TableHeader label=\"No\" /></th>\n                   <th className=\"px-4 w-[250px]\"><TableHeader label=\"Requirement\" sortKey=\"requirement\" currentSort={sortConfig} onSort={handleSort} /></th>\n                   <th className=\"px-4\"><TableHeader label=\"Manager\" sortKey=\"manager\" currentSort={sortConfig} onSort={handleSort} /></th>\n                   <th className=\"px-4 w-[140px]\"><TableHeader label=\"Timeline\" /></th>\n                   <th className=\"px-4 w-[150px]\"><TableHeader label=\"Hours Utilization\" sortKey=\"efficiency\" currentSort={sortConfig} onSort={handleSort} /></th>\n                   <th className=\"px-4\"><TableHeader label=\"Revenue\" sortKey=\"revenue\" currentSort={sortConfig} onSort={handleSort} /></th>\n                   <th className=\"px-4\"><TableHeader label=\"Status\" sortKey=\"status\" currentSort={sortConfig} onSort={handleSort} /></th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredRequirements.map((row, idx) => {\n                  const percentage = row.allottedHrs > 0 ? Math.min((row.engagedHrs / row.allottedHrs) * 100, 100) : 0;\n                  const isOverBudget = row.engagedHrs > row.allottedHrs;\n\n                  return (\n                    <tr key={row.id} className=\"border-b border-[#FAFAFA] hover:bg-[#FAFAFA] transition-colors h-16 group\">\n                      <td className=\"pl-6 pr-4 text-[13px] text-[#999999] font-['Inter:Medium',sans-serif]\">{idx + 1}</td>\n                      <td className=\"px-4\">\n                        <div className=\"flex flex-col justify-center h-full\">\n                          <span className=\"text-[14px] text-[#111111] font-['Manrope:Bold',sans-serif] mb-0.5\">{row.requirement}</span>\n                          <span className=\"text-[12px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.partner}</span>\n                        </div>\n                      </td>\n                      <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.manager || 'Unassigned'}</td>\n                     <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">\n                        <div className=\"flex flex-col gap-0.5\">\n                            <span className=\"text-[#111111] font-medium\">{row.startDate ? dayjs(row.startDate).format('MMM DD') : '-'}</span>\n                            <span className=\"text-[11px] text-[#999999]\">to {row.endDate ? dayjs(row.endDate).format('MMM DD') : '-'}</span>\n                        </div>\n                     </td>\n                     <td className=\"px-4\">\n                         <div className=\"flex flex-col gap-1.5 justify-center h-full\">\n                           <div className=\"flex justify-between text-[11px]\">\n                             <span className=\"font-medium text-[#111111]\">{row.engagedHrs}h</span>\n                             <span className=\"text-[#999999]\">of {row.allottedHrs}h</span>\n                           </div>\n                           <div className=\"w-full h-1.5 bg-[#F0F0F0] rounded-full overflow-hidden\">\n                             <div \n                                className={`h-full rounded-full ${row.engagedHrs > row.allottedHrs ? 'bg-[#FF3B3B]' : 'bg-[#111111]'}`}\n                                style={{ width: `${Math.min((row.engagedHrs / (row.allottedHrs || 1)) * 100, 100)}%` }}\n                             ></div>\n                           </div>\n                         </div>\n                     </td>\n                     <td className=\"px-4 text-[13px] text-[#111111] font-['Manrope:Bold',sans-serif]\">${row.revenue?.toLocaleString() || 0}</td>\n                     <td className=\"px-4\"><StatusBadge status={row.status} /></td>\n                    </tr>\n                  );\n                })}\n                {filteredRequirements.length === 0 && (\n                  <tr><td colSpan={7} className=\"text-center py-8 text-[#999999] text-[13px]\">No requirements found matching your filters.</td></tr>\n                )}\n              </tbody>\n            </table>\n          )}\n\n          {activeTab === 'task' && (\n            <table className=\"w-full text-left border-collapse min-w-[1000px]\">\n              <thead className=\"sticky top-0 z-10 bg-white\">\n                <tr className=\"border-b border-[#EEEEEE] h-10\">\n                  <th className=\"pl-6 pr-4 w-[50px]\"><TableHeader label=\"No\" /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Task\" sortKey=\"task\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Requirement\" sortKey=\"requirement\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Leader\" sortKey=\"leader\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Assigned\" sortKey=\"assigned\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Allotted\" sortKey=\"allottedHrs\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Engaged\" sortKey=\"engagedHrs\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Extra\" sortKey=\"extraHrs\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Status\" sortKey=\"status\" currentSort={sortConfig} onSort={handleSort} /></th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredTasks.map((row, idx) => (\n                  <tr key={row.id} className=\"border-b border-[#FAFAFA] hover:bg-[#FAFAFA] transition-colors h-14\">\n                    <td className=\"pl-6 pr-4 text-[13px] text-[#999999] font-['Inter:Medium',sans-serif]\">{idx + 1}</td>\n                    <td className=\"px-4 text-[13px] text-[#111111] font-['Manrope:SemiBold',sans-serif]\">{row.task}</td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.requirement}</td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.leader}</td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.assigned}</td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.dueDate ? dayjs(row.dueDate).format('MMM D, YYYY') : '-'}</td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.allottedHrs}h</td>\n                    <td className=\"px-4 text-[13px] text-[#111111] font-['Manrope:Bold',sans-serif]\">{row.engagedHrs}h</td>\n                    <td className=\"px-4 text-[13px] font-['Inter:Medium',sans-serif] text-[#FF3B3B]\">{row.extraHrs > 0 ? `+${row.extraHrs}h` : '-'}</td>\n                    <td className=\"px-4\"><StatusBadge status={row.status} /></td>\n                  </tr>\n                ))}\n                {filteredTasks.length === 0 && (\n                  <tr><td colSpan={10} className=\"text-center py-8 text-[#999999] text-[13px]\">No tasks found matching your filters.</td></tr>\n                )}\n              </tbody>\n            </table>\n          )}\n\n          {activeTab === 'member' && (\n             <table className=\"w-full text-left border-collapse min-w-[1000px]\">\n              <thead className=\"sticky top-0 z-10 bg-white\">\n                <tr className=\"border-b border-[#EEEEEE] h-10\">\n                  <th className=\"pl-6 pr-4 w-[50px]\"><TableHeader label=\"No\" /></th>\n                  <th className=\"px-4 w-[250px]\"><TableHeader label=\"Employee\" sortKey=\"member\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Tasks Performance\" /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Load\" sortKey=\"utilization\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Investment\" sortKey=\"hourlyCost\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Revenue\" sortKey=\"revenue\" currentSort={sortConfig} onSort={handleSort} /></th>\n                  <th className=\"px-4\"><TableHeader label=\"Net Profit\" sortKey=\"profit\" currentSort={sortConfig} onSort={handleSort} /></th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredEmployees.map((row, idx) => (\n                  <tr key={row.id} className=\"border-b border-[#FAFAFA] hover:bg-[#FAFAFA] transition-colors h-16 cursor-pointer group\" onClick={() => setSelectedMemberId(String(row.id))}>\n                    <td className=\"pl-6 pr-4 text-[13px] text-[#999999] font-['Inter:Medium',sans-serif]\">{idx + 1}</td>\n                    <td className=\"px-4\">\n                        <div className=\"flex flex-col justify-center\">\n                            <span className=\"text-[14px] text-[#111111] font-['Manrope:Bold',sans-serif]\">{row.member}</span>\n                            <span className=\"text-[12px] text-[#666666] font-['Inter:Regular',sans-serif]\">{row.designation} <span className=\"text-[#E5E5E5] mx-1\">|</span> {row.department}</span>\n                        </div>\n                    </td>\n                    <td className=\"px-4\">\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[14px] text-[#111111] font-['Manrope:Bold',sans-serif]\">\n                                {row.taskStats.assigned} <span className=\"text-[#666666] font-['Inter:Regular',sans-serif] text-[13px]\">Assigned</span>\n                            </span>\n                            <div className=\"flex gap-3 mt-1 text-[11px] font-medium text-[#666666]\">\n                                <div className=\"flex items-center gap-1.5\">\n                                    <div className=\"w-1.5 h-1.5 rounded-full bg-[#0F9D58]\"></div>\n                                    <span>{row.taskStats.completed}</span>\n                                </div>\n                                <div className=\"flex items-center gap-1.5\">\n                                    <div className=\"w-1.5 h-1.5 rounded-full bg-[#1A73E8]\"></div>\n                                    <span>{row.taskStats.inProgress}</span>\n                                </div>\n                                <div className=\"flex items-center gap-1.5\">\n                                    <div className=\"w-1.5 h-1.5 rounded-full bg-[#FF3B3B]\"></div>\n                                    <span>{row.taskStats.delayed}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                    <td className=\"px-4 w-[150px]\">\n                        <div className=\"flex flex-col gap-1\">\n                             <div className=\"flex justify-between text-[11px]\">\n                                <span className=\"font-medium text-[#111111]\">{row.utilization}%</span>\n                            </div>\n                            <div className=\"w-full h-1.5 bg-[#F0F0F0] rounded-full overflow-hidden\">\n                                <div\n                                  className={`h-full rounded-full ${row.utilization > 100 ? 'bg-[#FF3B3B]' : 'bg-[#111111]'}`}\n                                  style={{ width: `${Math.min(row.utilization, 100)}%` }}\n                                ></div>\n                            </div>\n                        </div>\n                    </td>\n                    <td className=\"px-4 text-[13px] text-[#666666] font-['Inter:Medium',sans-serif]\">${row.hourlyCost.toLocaleString()}</td>\n                    <td className=\"px-4 text-[13px] text-[#111111] font-['Manrope:Bold',sans-serif]\">${row.revenue.toLocaleString()}</td>\n                    <td className={`px-4 text-[13px] font-['Manrope:Bold',sans-serif] ${row.profit >= 0 ? 'text-[#0F9D58]' : 'text-[#FF3B3B]'}`}>\n                        ${row.profit.toLocaleString()}\n                    </td>\n                  </tr>\n                ))}\n                 {filteredEmployees.length === 0 && (\n                  <tr><td colSpan={8} className=\"text-center py-8 text-[#999999] text-[13px]\">No employees found matching your filters.</td></tr>\n                )}\n              </tbody>\n            </table>\n          )}\n        </div>\n\n        <Drawer\n          title={null}\n          closable={false}\n          width={850}\n          onClose={() => setSelectedMemberId(null)}\n          open={!!selectedMemberId}\n          styles={{ body: { padding: 0 } }}\n        >\n          {selectedMember && (\n            <div className=\"flex flex-col h-full bg-white\">\n              {/* Drawer Header */}\n              <div className=\"p-6 border-b border-[#EEEEEE] sticky top-0 bg-white z-10\">\n                <div className=\"flex items-center justify-between w-full\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-14 h-14 rounded-full bg-[#111111] flex items-center justify-center text-white text-lg font-['Manrope:Bold',sans-serif] shrink-0\">\n                      {selectedMember.member.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase()}\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-['Manrope:Bold',sans-serif] text-[#111111] m-0\">\n                        {selectedMember.member}\n                      </h2>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        <span className=\"text-sm text-[#666666] font-['Inter:Medium',sans-serif]\">\n                          {selectedMember.designation} <span className=\"text-[#E5E5E5] mx-1\">|</span> {selectedMember.department}\n                        </span>\n                        <span className=\"w-1 h-1 rounded-full bg-[#999999]/30\"></span>\n                        <span className=\"px-2 py-0.5 rounded-full bg-[#7ccf00]/10 text-[#7ccf00] text-[11px] font-bold uppercase tracking-wide\">\n                          Active\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <button \n                    onClick={handleDownloadIndividualPDF}\n                    disabled={isDownloadingIndividual}\n                    className=\"p-2 hover:bg-[#FAFAFA] rounded-full transition-colors text-[#666666]\"\n                    title=\"Download Report\"\n                  >\n                    {isDownloadingIndividual ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : <Download className=\"w-5 h-5\" />}\n                  </button>\n                </div>\n              </div>\n\n              {/* Drawer Scrollable Content */}\n              <div className=\"flex-1 overflow-y-auto p-6 space-y-8\">\n                \n                {/* Stats Cards */}\n                <div className=\"grid grid-cols-3 gap-4\">\n                    <div className=\"p-4 bg-[#FAFAFA] rounded-xl border border-[#EEEEEE] flex flex-col items-center text-center\">\n                        <span className=\"text-[11px] font-bold text-[#666666] uppercase tracking-wide mb-1\">Total Hours</span>\n                        <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{selectedMember.totalWorkingHrs}h</span>\n                    </div>\n                    <div className=\"p-4 bg-[#FAFAFA] rounded-xl border border-[#EEEEEE] flex flex-col items-center text-center\">\n                        <span className=\"text-[11px] font-bold text-[#666666] uppercase tracking-wide mb-1\">Engaged</span>\n                        <span className=\"text-2xl font-['Manrope:Bold',sans-serif] text-[#111111]\">{selectedMember.actualEngagedHrs}h</span>\n                    </div>\n                    <div className=\"p-4 bg-[#FAFAFA] rounded-xl border border-[#EEEEEE] flex flex-col items-center text-center\">\n                        <span className=\"text-[11px] font-bold text-[#666666] uppercase tracking-wide mb-1\">Efficiency</span>\n                        <span className={`text-2xl font-['Manrope:Bold',sans-serif] ${\n                          (selectedMember.actualEngagedHrs / selectedMember.totalWorkingHrs * 100) >= 90 ? 'text-[#7ccf00]' : \n                          (selectedMember.actualEngagedHrs / selectedMember.totalWorkingHrs * 100) >= 75 ? 'text-[#2196F3]' : 'text-[#FF3B3B]'\n                        }`}>\n                          {Math.round(selectedMember.actualEngagedHrs / selectedMember.totalWorkingHrs * 100)}%\n                        </span>\n                    </div>\n                </div>\n\n                {/* Work History */}\n                <div>\n                    <h3 className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] uppercase tracking-wide mb-3\">Work History</h3>\n                    <div className=\"border border-[#EEEEEE] rounded-lg overflow-x-auto\">\n                        <table className=\"w-full text-left border-collapse min-w-[600px]\">\n                            <thead className=\"bg-[#FAFAFA] border-b border-[#EEEEEE]\">\n                                <tr>\n                                    <th className=\"py-2 px-3 text-[11px] font-bold text-[#666666] uppercase w-[100px]\">Date</th>\n                                    <th className=\"py-2 px-3 text-[11px] font-bold text-[#666666] uppercase w-[150px]\">Task</th>\n                                    <th className=\"py-2 px-3 text-[11px] font-bold text-[#666666] uppercase min-w-[200px]\">Details</th>\n                                    <th className=\"py-2 px-3 text-[11px] font-bold text-[#666666] uppercase w-[120px] text-right\">Time</th>\n                                    <th className=\"py-2 px-3 text-[11px] font-bold text-[#666666] uppercase w-[80px] text-right\">Duration</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {selectedMemberWorklogs.map((log) => (\n                                    <tr key={log.id} className=\"border-b border-[#EEEEEE] last:border-0 hover:bg-[#FAFAFA] transition-colors group h-9\">\n                                        <td className=\"px-3 text-[12px] font-medium text-[#111111] whitespace-nowrap\">{log.date}</td>\n                                        <td className=\"px-3 text-[12px] font-medium text-[#111111] truncate max-w-[150px]\" title={log.task}>{log.task}</td>\n                                        <td className=\"px-3 text-[12px] text-[#666666] truncate max-w-[250px]\" title={log.details}>{log.details}</td>\n                                        <td className=\"px-3 text-[11px] text-[#666666] text-right whitespace-nowrap\">{log.startTime} - {log.endTime}</td>\n                                        <td className=\"px-3 text-right\">\n                                            <span className=\"text-[11px] font-bold text-[#111111] bg-[#EEEEEE] px-1.5 py-0.5 rounded group-hover:bg-white group-hover:shadow-sm transition-all\">{log.engagedTime}</span>\n                                        </td>\n                                    </tr>\n                                ))}\n                                {selectedMemberWorklogs.length === 0 && (\n                                    <tr>\n                                        <td colSpan={5} className=\"py-8 text-center text-[13px] text-[#666666] italic\">No work history found.</td>\n                                    </tr>\n                                )}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n\n              </div>\n            </div>\n          )}\n        </Drawer>\n      </div>\n      \n      \n      {/* Hidden PDF Template Component */}\n      <ReportsPdfTemplate \n        activeTab={activeTab}\n        data={activeTab === 'requirement' ? filteredRequirements : activeTab === 'task' ? filteredTasks : filteredEmployees}\n        kpis={activeTab === 'requirement' ? kpi : activeTab === 'task' ? taskKPI : employeeKPI}\n        dateRange={dateRange}\n        companyName={companyName}\n      />\n\n      {/* Hidden Individual Employee PDF Template */}\n      {selectedMember && (\n          <IndividualEmployeePdfTemplate \n            member={selectedMember}\n            worklogs={selectedMemberWorklogs}\n            dateRange={dateRange}\n            companyName={companyName}\n          />\n      )}\n\n\n    </PageLayout>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/reports/ReportsPdfGeneration.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[964,967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[964,967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1424,1427],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1424,1427],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":641,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":641,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29246,29249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29246,29249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport html2canvas from 'html2canvas';\nimport jsPDF from 'jspdf';\nimport dayjs from 'dayjs';\nimport BrandLogo from '@/assets/images/logo.png';\nimport { RequirementReport, TaskReport, EmployeeReport, ReportKPI, EmployeeKPI } from '../../../services/report';\n\n// --- Types ---\nexport interface MemberRow {\n  id: string;\n  member: string;\n  department: string;\n  designation?: string;\n  taskStats: { assigned: number; completed: number; inProgress: number; delayed: number };\n  totalWorkingHrs: number;\n  actualEngagedHrs: number;\n  costPerHour: number;\n  billablePerHour: number;\n}\n\nexport interface WorklogRow {\n    id: string;\n    date: string;\n    task: string;\n    details: string;\n    startTime: string;\n    endTime: string;\n    engagedTime: string;\n}\n\ninterface ReportsPdfTemplateProps {\n  activeTab: 'requirement' | 'task' | 'member';\n  data: RequirementReport[] | TaskReport[] | EmployeeReport[];\n  kpis: ReportKPI | EmployeeKPI | any;\n  dateRange: [dayjs.Dayjs | null, dayjs.Dayjs | null] | null;\n  companyName?: string;\n}\n\n// --- Pagination Constants ---\n// Approximate row limits to ensure safety margins.\n// A4 @ 96 DPI is ~794px width x 1123px height.\n// We are scaling by 2 for quality, but the DOM layout is 1:1.\nconst PAGE_1_ROWS = 12; // Fewer rows due to KPIs\nconst PAGE_N_ROWS = 20; // More rows on subsequent pages (no KPIs)\n\n// --- Helper Functions ---\nconst chunkData = (data: any[], firstPageSize: number, otherPageSize: number) => {\n    const chunks = [];\n    if (data.length === 0) return [];\n    \n    // First chunk\n    chunks.push(data.slice(0, firstPageSize));\n    \n    // Subsequent chunks\n    let i = firstPageSize;\n    while (i < data.length) {\n        chunks.push(data.slice(i, i + otherPageSize));\n        i += otherPageSize;\n    }\n    return chunks;\n};\n\nconst getStatusColor = (status: string) => {\n    switch (status) {\n      case 'Completed': return { bg: '#E6F4EA', text: '#1E8E3E' };\n      case 'In Progress': return { bg: '#E8F0FE', text: '#1967D2' };\n      case 'Delayed': return { bg: '#FCE8E6', text: '#C5221F' }; // Or Overdue\n      case 'Paid': return { bg: '#E6F4EA', text: '#1E8E3E' };\n      case 'Pending': return { bg: '#FEF3C7', text: '#B45309' }; \n      default: return { bg: '#F3F4F6', text: '#4B5563' };\n    }\n  };\n\n\n// --- Components ---\n\nexport const ReportsPdfTemplate = ({ activeTab, data, kpis, dateRange, companyName }: ReportsPdfTemplateProps) => {\n  const generatedDate = dayjs().format('MMM DD, YYYY');\n  const periodStart = dateRange && dateRange[0] ? dateRange[0].format('MMM DD, YYYY') : 'Start';\n  const periodEnd = dateRange && dateRange[1] ? dateRange[1].format('MMM DD, YYYY') : 'End';\n\n  // Chunk Data\n  const chunks = chunkData(data, PAGE_1_ROWS, PAGE_N_ROWS);\n  const totalPages = chunks.length || 1;\n\n  // If no data, render at least one page\n  if (chunks.length === 0) {\n      chunks.push([]); \n  }\n\n  return (\n    <div id=\"pdf-report-container\" style={{ position: 'absolute', left: '-9999px', top: 0 }}>\n        {chunks.map((chunk, pageIndex) => (\n            <div \n                key={pageIndex} \n                className=\"pdf-page\"\n                style={{\n                    width: '210mm',\n                    height: '296mm', // Fixed A4 height\n                    padding: '40px',\n                    backgroundColor: 'white',\n                    fontFamily: \"'Inter', sans-serif\",\n                    color: '#111111',\n                    position: 'relative',\n                    boxSizing: 'border-box',\n                    overflow: 'hidden', // Ensure no overflow\n                    display: 'flex',\n                    flexDirection: 'column'\n                }}\n            >\n                {/* Header Section (On every page for context, or Simplified?) */}\n                <div style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'flex-start',\n                    borderBottom: '2px solid #EEEEEE',\n                    paddingBottom: '20px',\n                    marginBottom: '20px',\n                    flexShrink: 0\n                }}>\n                    <div className=\"brand-section\">\n                        <h1 style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 800, fontSize: '24px', margin: 0, color: '#111111' }}>\n                            {companyName || 'Company Name'}\n                        </h1>\n                    </div>\n                    <div style={{ textAlign: 'right', fontSize: '12px', color: '#666666' }}>\n                        <span style={{\n                            fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, fontSize: '16px', color: '#111111', marginBottom: '4px', display: 'block'\n                        }}>\n                             {activeTab === 'requirement' ? 'Requirements Report' : activeTab === 'task' ? 'Tasks Report' : 'Employees Report'}\n                        </span>\n                        <span>Generated: {generatedDate}</span><br />\n                        <span>Period: {periodStart} - {periodEnd}</span>\n                    </div>\n                </div>\n\n                {/* KPIs (Page 1 Only) */}\n                {pageIndex === 0 && (\n                    <div style={{\n                        display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '15px', marginBottom: '30px', flexShrink: 0\n                    }}>\n                        {activeTab === 'requirement' && renderRequirementKPIs(kpis as ReportKPI)}\n                        {activeTab === 'task' && renderTaskKPIs(kpis)}\n                        {activeTab === 'member' && renderEmployeeKPIs(kpis as EmployeeKPI)}\n                    </div>\n                )}\n\n                {/* Table Section */}\n                <div style={{ flex: 1 }}> {/* Table takes remaining space */}\n                    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}>\n                        <thead>\n                            <tr>\n                                {activeTab === 'requirement' && renderReqHeader()}\n                                {activeTab === 'task' && renderTaskHeader()}\n                                {activeTab === 'member' && renderEmpHeader()}\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {chunk.map((row, idx) => {\n                                // Calculate global index\n                                const globalIdx = (pageIndex === 0 ? idx : PAGE_1_ROWS + (pageIndex - 1) * PAGE_N_ROWS + idx);\n                                return (\n                                    <tr key={idx} style={idx % 2 === 0 ? {} : { backgroundColor: '#F9FAFB' }}>\n                                        {activeTab === 'requirement' && renderReqRow(row as RequirementReport, globalIdx)}\n                                        {activeTab === 'task' && renderTaskRow(row as TaskReport, globalIdx)}\n                                        {activeTab === 'member' && renderEmpRow(row as EmployeeReport, globalIdx)}\n                                    </tr>\n                                );\n                            })}\n                            {chunk.length === 0 && (\n                                <tr><Td colSpan={7} style={{textAlign:'center', padding:'30px', color:'#999'}}>No data available for this period.</Td></tr>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n\n                {/* Footer Section - Absolute bottom to ensure margin */}\n                <div style={{\n                    position: 'absolute',\n                    bottom: '40px',\n                    left: '40px',\n                    right: '40px',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'flex-end',\n                    borderTop: '1px solid #EEEEEE',\n                    paddingTop: '20px'\n                }}>\n                    <img src={BrandLogo.src} alt=\"Alsonotify\" className=\"h-6 object-contain\" />\n                    <span style={{ fontSize: '10px', color: '#999999' }}>Page {pageIndex + 1} of {totalPages}</span>\n                </div>\n            </div>\n        ))}\n    </div>\n  );\n};\n\n\nexport const IndividualEmployeePdfTemplate = ({ member, worklogs, dateRange, companyName }: { member: MemberRow, worklogs: WorklogRow[], dateRange: [dayjs.Dayjs | null, dayjs.Dayjs | null] | null, companyName?: string }) => {\n    const generatedDate = dayjs().format('MMM DD, YYYY');\n    const periodStart = dateRange && dateRange[0] ? dateRange[0].format('MMM DD, YYYY') : 'Start';\n    const periodEnd = dateRange && dateRange[1] ? dateRange[1].format('MMM DD, YYYY') : 'End';\n    const efficiency = member.totalWorkingHrs > 0 ? Math.round((member.actualEngagedHrs / member.totalWorkingHrs) * 100) : 0;\n\n    // Chunk worklogs\n    // Page 1: Profile + KPIs + History Header + ~5 rows\n    // Page N: History Header + ~20 rows\n    const EMP_PAGE_1_ROWS = 8;\n    const EMP_PAGE_N_ROWS = 25;\n    \n    const chunks = chunkData(worklogs, EMP_PAGE_1_ROWS, EMP_PAGE_N_ROWS);\n    const totalPages = chunks.length || 1;\n    if (chunks.length === 0) chunks.push([]);\n\n    return (\n        <div id=\"pdf-individual-report-container\" style={{ position: 'absolute', left: '-9999px', top: 0 }}>\n            {chunks.map((chunk, pageIndex) => (\n                <div \n                    key={pageIndex}\n                    className=\"pdf-page\"\n                    style={{\n                        width: '210mm',\n                        height: '296mm',\n                        padding: '40px',\n                        backgroundColor: 'white',\n                        fontFamily: \"'Inter', sans-serif\",\n                        color: '#111111',\n                        position: 'relative',\n                        boxSizing: 'border-box',\n                        overflow: 'hidden'\n                    }}\n                >\n                    {/* Header */}\n                    <div style={{\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'flex-start',\n                        borderBottom: '2px solid #EEEEEE',\n                        paddingBottom: '20px',\n                        marginBottom: '30px'\n                    }}>\n                        <div className=\"brand-section\">\n                             <h1 style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 800, fontSize: '24px', margin: 0, color: '#111111' }}>\n                                {companyName || 'Company Name'}\n                            </h1>\n                        </div>\n                        <div style={{ textAlign: 'right', fontSize: '12px', color: '#666666' }}>\n                            <span style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, fontSize: '16px', color: '#111111', marginBottom: '4px', display: 'block' }}>\n                                Employee Performance Report\n                            </span>\n                            <span>Generated: {generatedDate}</span><br />\n                            <span>Period: {periodStart} - {periodEnd}</span>\n                        </div>\n                    </div>\n\n                    {/* Profile & KPIs (Page 1 Only) */}\n                    {pageIndex === 0 && (\n                        <div style={{ display: 'flex', gap: '20px', marginBottom: '30px' }}>\n                            {/* Profile Card */}\n                            <div style={{ flex: 1, padding: '20px', background: '#FAFAFA', border: '1px solid #EEEEEE', borderRadius: '12px' }}>\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>\n                                    <div style={{\n                                        width: '48px', height: '48px', borderRadius: '50%', backgroundColor: '#111111',\n                                        color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center',\n                                        fontSize: '20px', fontFamily: \"'Manrope', sans-serif\", fontWeight: 700\n                                    }}>\n                                        {member.member.charAt(0)}\n                                    </div>\n                                    <div>\n                                        <div style={{ fontSize: '18px', fontWeight: 700, color: '#111111', fontFamily: \"'Manrope', sans-serif\" }}>{member.member}</div>\n                                        <div style={{ fontSize: '13px', color: '#666666' }}>{member.department}</div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* KPI Cards */}\n                            <div style={{ display:'flex', gap:'15px', flex:2 }}>\n                                <div style={{ flex:1, padding: '16px', borderRadius: '12px', border: '1px solid #EEEEEE', backgroundColor: '#FAFAFA', display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                                    <span style={{ fontSize: '12px', fontWeight: 500, color: '#666666', textTransform:'uppercase' }}>Total Hours</span>\n                                    <span style={{ fontSize: '24px', fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, color: '#111111' }}>{member.totalWorkingHrs}h</span>\n                                </div>\n                                <div style={{ flex:1, padding: '16px', borderRadius: '12px', border: '1px solid #EEEEEE', backgroundColor: '#FAFAFA', display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                                    <span style={{ fontSize: '12px', fontWeight: 500, color: '#666666', textTransform:'uppercase' }}>Engaged</span>\n                                    <span style={{ fontSize: '24px', fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, color: '#111111' }}>{member.actualEngagedHrs}h</span>\n                                </div>\n                                <div style={{ flex:1, padding: '16px', borderRadius: '12px', border: '1px solid #EEEEEE', backgroundColor: '#FAFAFA', display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                                    <span style={{ fontSize: '12px', fontWeight: 500, color: '#666666', textTransform:'uppercase' }}>Efficiency</span>\n                                    <span style={{ fontSize: '24px', fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, color: efficiency >= 90 ? '#0F9D58' : efficiency >= 75 ? '#2196F3' : '#FF3B3B' }}>\n                                        {efficiency}%\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Table Section */}\n                    <div style={{ marginBottom: '15px' }}>\n                         {/* Title only page 1 */}\n                        {pageIndex === 0 && (\n                            <h3 style={{ fontSize: '14px', fontWeight: 700, fontFamily: \"'Manrope', sans-serif\", color: '#111111', textTransform: 'uppercase', marginBottom: '15px' }}>Work History</h3>\n                        )}\n                        \n                        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}>\n                            <thead>\n                                <tr>\n                                    <Th style={{ width: '100px' }}>Date</Th>\n                                    <Th style={{ width: '150px' }}>Task</Th>\n                                    <Th>Details</Th>\n                                    <Th style={{ width: '120px', textAlign: 'right' }}>Time</Th>\n                                    <Th style={{ width: '80px', textAlign: 'right' }}>Duration</Th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {chunk.map((log, idx) => (\n                                    <tr key={idx} style={idx % 2 === 0 ? {} : { backgroundColor: '#F9FAFB' }}>\n                                        <Td style={{ fontWeight: 500, color: '#111111' }}>{dayjs(log.date).format('MMM DD')}</Td>\n                                        <Td style={{ fontWeight: 500, color: '#111111' }}>{log.task}</Td>\n                                        <Td style={{ color: '#666666' }}>{log.details}</Td>\n                                        <Td style={{ textAlign: 'right', color: '#666666' }}>{log.startTime} - {log.endTime}</Td>\n                                        <Td style={{ textAlign: 'right', fontWeight: 700, color: '#111111' }}>{log.engagedTime}</Td>\n                                    </tr>\n                                ))}\n                                {chunk.length === 0 && pageIndex === 0 && (\n                                     <tr><Td style={{textAlign:'center', color:'#999'}} colSpan={5}>No work history found.</Td></tr>\n                                )}\n                            </tbody>\n                        </table>\n                    </div>\n\n                     {/* Footer */}\n                     <div style={{\n                        position: 'absolute',\n                        bottom: '40px',\n                        left: '40px',\n                        right: '40px',\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'flex-end',\n                        borderTop: '1px solid #EEEEEE',\n                        paddingTop: '20px'\n                    }}>\n                        <img src={BrandLogo.src} alt=\"Alsonotify\" className=\"h-6 object-contain\" />\n                        <span style={{ fontSize: '10px', color: '#999999' }}>Page {pageIndex + 1} of {totalPages}</span>\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n};\n\n\n// --- Generator Function ---\n\nexport const generatePdf = async (fileName: string, containerId: string = 'pdf-report-container') => {\n    // If containerId is generic, we might want to be specific, but for now strict IDs are passed.\n    // However, for the individual report, we passed 'pdf-report-container' by prop default or override.\n    // The components above use hardcoded IDs 'pdf-report-container' and 'pdf-individual-report-container'.\n    // We should ensure the caller passes the right ID or we query based on presence.\n    \n    // Actually, let's select ALL elements with class 'pdf-page' inside the container.\n    const container = document.getElementById(containerId);\n    if (!container) {\n        console.error(`PDF Container ${containerId} not found`);\n        return;\n    }\n\n    const pages = container.querySelectorAll('.pdf-page');\n    if (pages.length === 0) {\n        console.error('No PDF pages found');\n        return;\n    }\n\n    try {\n        const pdf = new jsPDF('p', 'mm', 'a4');\n        const pdfWidth = pdf.internal.pageSize.getWidth();\n        const pdfHeight = pdf.internal.pageSize.getHeight();\n\n        for (let i = 0; i < pages.length; i++) {\n            const pageEl = pages[i] as HTMLElement;\n            \n            // Render the page\n            const canvas = await html2canvas(pageEl, {\n                scale: 2,\n                useCORS: true,\n                logging: false,\n                backgroundColor: '#ffffff',\n                width: pageEl.offsetWidth, // Ensure we capture full width/height\n                height: pageEl.offsetHeight\n            });\n\n            const imgData = canvas.toDataURL('image/png');\n            \n            if (i > 0) pdf.addPage();\n            \n            // Add image full scale to PDF page\n            // We set DOM element to 210mm x 297mm, so it maps 1:1\n            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);\n        }\n\n        pdf.save(fileName);\n        return true;\n    } catch (error) {\n        console.error('PDF Generation failed:', error);\n        throw error;\n    }\n};\n\n\n// --- Render Helpers (Split out for cleaner code) ---\nfunction renderReqHeader() {\n    return (\n        <>\n            <Th style={{ width: '50px' }}>No</Th>\n            <Th style={{ width: '25%' }}>Requirement</Th>\n            <Th style={{ width: '15%' }}>Manager</Th>\n            <Th style={{ width: '15%' }}>Timeline</Th>\n            <Th style={{ width: '20%' }}>Hours Utilization</Th>\n            <Th style={{ width: '10%' }}>Revenue</Th>\n            <Th style={{ width: '10%' }}>Status</Th>\n        </>\n    )\n}\n\nfunction renderTaskHeader() {\n    return (\n        <>\n            <Th style={{ width: '50px' }}>No</Th>\n            <Th>Task</Th>\n            <Th>Requirement</Th>\n            <Th>Assigned To</Th>\n            <Th>Allotted</Th>\n            <Th>Engaged</Th>\n            <Th>Status</Th>\n        </>\n    )\n}\n\nfunction renderEmpHeader() {\n    return (\n        <>\n            <Th style={{ width: '50px' }}>No</Th>\n            <Th style={{ width: '20%' }}>Employee</Th>\n            <Th style={{ width: '25%' }}>Tasks Performance</Th>\n            <Th style={{ width: '20%' }}>Load</Th>\n            <Th style={{ width: '15%' }}>Investment</Th>\n            <Th style={{ width: '15%' }}>Net Profit</Th>\n        </>\n    )\n}\n\nfunction renderReqRow(row: RequirementReport, idx: number) {\n    return (\n        <>\n          <Td>{idx + 1}</Td>\n          <Td>\n            <div style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, fontSize: '13px', color: '#111111' }}>{row.requirement}</div>\n            <div style={{ fontSize: '11px', color: '#666666' }}>{row.partner}</div>\n          </Td>\n          <Td>{row.manager || '-'}</Td>\n          <Td>\n             <div style={{display:'flex', flexDirection:'column'}}>\n                <span>{row.startDate ? dayjs(row.startDate).format('MMM DD') : '-'}</span>\n                <span style={{color: '#999', fontSize: '10px'}}>to {row.endDate ? dayjs(row.endDate).format('MMM DD') : '-'}</span>\n             </div>\n          </Td>\n          <Td>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                <div style={{display:'flex', justifyContent:'space-between', fontSize:'11px'}}>\n                     <span style={{ fontWeight: 700, color: row.engagedHrs > row.allottedHrs ? '#FF3B3B' : '#111111' }}>{row.engagedHrs}h</span>\n                     <span style={{ color: '#666666' }}>of {row.allottedHrs}h</span>\n                </div>\n                <ProgressBar filled={row.engagedHrs} total={row.allottedHrs} color={row.engagedHrs > row.allottedHrs ? '#FF3B3B' : '#111111'} />\n            </div>\n          </Td>\n          <Td style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 700 }}>${row.revenue?.toLocaleString()}</Td>\n          <Td>\n            <span style={{\n               display: 'inline-block',\n               padding: '4px 8px',\n               borderRadius: '99px',\n               fontSize: '10px',\n               fontWeight: 600,\n               textTransform: 'uppercase',\n               backgroundColor: getStatusColor(row.status).bg,\n               color: getStatusColor(row.status).text\n            }}>\n              {row.status}\n            </span>\n          </Td>\n        </>\n    )\n}\n\nfunction renderTaskRow(row: TaskReport, idx: number) {\n    return (\n         <>\n            <Td>{idx + 1}</Td>\n            <Td style={{ fontWeight: 600, color: '#111' }}>{row.task}</Td>\n            <Td style={{ color: '#666' }}>{row.requirement}</Td>\n            <Td>{row.assigned}</Td>\n            <Td>{row.allottedHrs}h</Td>\n            <Td style={{ fontWeight: 700 }}>{row.engagedHrs}h</Td>\n            <Td>\n                <span style={{\n                    display: 'inline-block',\n                    padding: '4px 8px',\n                    borderRadius: '99px',\n                    fontSize: '10px',\n                    fontWeight: 600,\n                    textTransform: 'uppercase',\n                    backgroundColor: getStatusColor(row.status).bg,\n                    color: getStatusColor(row.status).text\n                }}>\n                {row.status}\n                </span>\n            </Td>\n         </>\n    )\n}\n\nfunction renderEmpRow(row: EmployeeReport, idx: number) {\n    return (\n         <>\n            <Td>{idx + 1}</Td>\n            <Td>\n                <div style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, fontSize: '13px', color: '#111111' }}>{row.member}</div>\n                <div style={{ fontSize: '11px', color: '#666666' }}>{row.designation} <span style={{color:'#E5E5E5'}}>|</span> {row.department}</div>\n            </Td>\n            <Td>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                    <span style={{fontWeight: 700, fontSize: '12px'}}>{row.taskStats.assigned} <span style={{fontWeight:400, color:'#666'}}>Assigned</span></span>\n                    <div style={{display:'flex', gap:'8px', fontSize:'10px', color:'#666'}}>\n                         <div style={{display:'flex', alignItems:'center', gap:'4px'}}><div style={{width:6, height:6, borderRadius:'50%', background:'#0F9D58'}}></div> {row.taskStats.completed}</div>\n                         <div style={{display:'flex', alignItems:'center', gap:'4px'}}><div style={{width:6, height:6, borderRadius:'50%', background:'#1A73E8'}}></div> {row.taskStats.inProgress}</div>\n                         <div style={{display:'flex', alignItems:'center', gap:'4px'}}><div style={{width:6, height:6, borderRadius:'50%', background:'#FF3B3B'}}></div> {row.taskStats.delayed}</div>\n                    </div>\n                </div>\n            </Td>\n            <Td>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                    <div style={{display:'flex', justifyContent:'space-between', fontSize:'11px'}}>\n                         <span style={{ fontWeight: 700, color: '#111111' }}>{row.utilization}%</span>\n                    </div>\n                    <ProgressBar filled={row.utilization} total={100} color={row.utilization > 100 ? '#FF3B3B' : '#111111'} />\n                </div>\n            </Td>\n            <Td style={{color: '#666'}}>${row.hourlyCost?.toLocaleString()}/hr</Td>\n            <Td style={{ fontFamily: \"'Manrope', sans-serif\", fontWeight: 700, color: row.profit >= 0 ? '#0F9D58' : '#FF3B3B' }}>\n                ${row.profit?.toLocaleString()}\n            </Td>\n         </>\n    )\n}\n\n// Reuse Sub-components like KPICard, Th, Td, ProgressBar from before\nconst KPICard = ({ label, value, color = '#111111', subValue = null }: { label: string, value: string | number, color?: string, subValue?: React.ReactNode }) => (\n  <div style={{\n    background: '#FAFAFA',\n    border: '1px solid #EEEEEE',\n    borderRadius: '12px',\n    padding: '15px'\n  }}>\n    <span style={{\n      fontSize: '11px',\n      fontWeight: 500,\n      color: '#666666',\n      textTransform: 'uppercase',\n      letterSpacing: '0.5px',\n      marginBottom: '5px',\n      display: 'block'\n    }}>{label}</span>\n    <div style={{display:'flex', alignItems:'baseline', gap:'8px'}}>\n        <p style={{\n        fontFamily: \"'Manrope', sans-serif\",\n        fontWeight: 700,\n        fontSize: '20px',\n        margin: 0,\n        color: color\n        }}>{value}</p>\n        {subValue}\n    </div>\n  </div>\n);\n\nconst Th = ({ children, style, ...props }: React.ThHTMLAttributes<HTMLTableCellElement>) => (\n  <th style={{\n    backgroundColor: '#111111',\n    color: 'white',\n    fontFamily: \"'Manrope', sans-serif\",\n    fontWeight: 600,\n    textAlign: 'left',\n    padding: '12px 15px',\n    fontSize: '11px',\n    textTransform: 'uppercase',\n    letterSpacing: '0.5px',\n    ...style\n  }} {...props}>\n    {children}\n  </th>\n);\n\nconst Td = ({ children, style, ...props }: React.TdHTMLAttributes<HTMLTableCellElement>) => (\n  <td style={{\n    padding: '12px 15px',\n    borderBottom: '1px solid #EEEEEE',\n    fontWeight: 500,\n    verticalAlign: 'middle',\n    color: '#111111', \n    ...style\n  }} {...props}>\n    {children}\n  </td>\n);\n\nconst ProgressBar = ({ filled, total, color }: { filled: number, total: number, color: string }) => {\n    const pct = Math.min((filled / (total || 1)) * 100, 100);\n    return (\n        <div style={{ width: '100%', height: '6px', backgroundColor: '#F0F0F0', borderRadius: '50px', overflow: 'hidden' }}>\n            <div style={{ height: '100%', width: `${pct}%`, backgroundColor: color, borderRadius: '50px' }}></div>\n        </div>\n    )\n}\n\nfunction renderRequirementKPIs(kpi: ReportKPI) {\n    if(!kpi) return null;\n    return (\n        <>\n            <KPICard label=\"Total Requirements\" value={kpi.totalRequirements} />\n            <KPICard label=\"On Time Completed\" value={kpi.onTimeCompleted} color=\"#0F9D58\" />\n            <KPICard \n                label=\"Delayed\" \n                value={kpi.delayedCompleted} \n                color=\"#FF3B3B\" \n                subValue={kpi.totalExtraHrs > 0 ? <span style={{fontSize:'12px', fontWeight:500, color:'#666'}}>(+{kpi.totalExtraHrs}h)</span> : null}\n            />\n            <KPICard label=\"Avg. Efficiency\" value={`${kpi.efficiency}%`} color=\"#2196F3\" />\n        </>\n    )\n}\n\nfunction renderTaskKPIs(kpi: any) {\n    if(!kpi) return null;\n    return (\n        <>\n             <KPICard label=\"Total Tasks\" value={kpi.totalTasks} />\n            <KPICard label=\"On Time Completed\" value={kpi.onTimeCompleted} color=\"#0F9D58\" />\n             <KPICard \n                label=\"Delayed\" \n                value={kpi.delayedCompleted} \n                color=\"#FF3B3B\" \n                subValue={kpi.totalExtraHrs > 0 ? <span style={{fontSize:'12px', fontWeight:500, color:'#666'}}>(+{kpi.totalExtraHrs}h)</span> : null}\n            />\n            <KPICard label=\"Avg. Efficiency\" value={`${kpi.efficiency}%`} color=\"#2196F3\" />\n        </>\n    )\n}\n\nfunction renderEmployeeKPIs(kpi: EmployeeKPI) {\n    if(!kpi) return null;\n    return (\n        <>\n             <KPICard label=\"Total Investment\" value={`$${kpi.totalInvestment?.toLocaleString()}`} />\n             <KPICard label=\"Total Revenue\" value={`$${kpi.totalRevenue?.toLocaleString()}`} color=\"#0F9D58\" />\n             <KPICard label=\"Net Profit\" value={`$${kpi.netProfit?.toLocaleString()}`} color={kpi.netProfit >= 0 ? \"#0F9D58\" : \"#FF3B3B\"} />\n             <KPICard label=\"Avg. Rate/Hr\" value={`$${kpi.avgRatePerHr?.toLocaleString()}`} color=\"#2196F3\" />\n        </>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/requirements/GanttChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSameDay' is defined but never used.","line":4,"column":96,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":105},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getDay' is defined but never used.","line":4,"column":107,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":113}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { format, startOfWeek, endOfWeek, eachDayOfInterval, addDays, startOfMonth, endOfMonth, isSameDay, getDay } from 'date-fns';\nimport { BarChart2 } from 'lucide-react';\n\ninterface GanttTask {\n  id: string;\n  name: string;\n  startDate: Date;\n  endDate: Date;\n  assignee: string;\n  status: 'completed' | 'in-progress' | 'delayed';\n  isRevision?: boolean;\n}\n\ntype TimeScale = 'day' | 'week' | 'month';\n\ninterface GanttChartProps {\n  tasks: GanttTask[];\n}\n\nexport function GanttChart({ tasks }: GanttChartProps) {\n  const [timeScale, setTimeScale] = useState<TimeScale>('week');\n\n  // Generate mock tasks if none provided\n  const mockTasks: GanttTask[] = useMemo(() => {\n    if (tasks.length > 0) return tasks;\n    \n    const today = new Date();\n    const baseDate = new Date(today.getFullYear(), today.getMonth(), 20); // Start from 20th\n    \n    return [\n      {\n        id: '101',\n        name: 'Homepage UI Design',\n        startDate: new Date(baseDate),\n        endDate: addDays(baseDate, 0),\n        assignee: 'Siddique',\n        status: 'completed',\n      },\n      {\n        id: '102',\n        name: 'User Dashboard Layout',\n        startDate: addDays(baseDate, 1),\n        endDate: addDays(baseDate, 3),\n        assignee: 'Siddique',\n        status: 'in-progress',\n      },\n      {\n        id: '103',\n        name: 'Login Flow Integration',\n        startDate: addDays(baseDate, 2),\n        endDate: addDays(baseDate, 6),\n        assignee: 'Appurva',\n        status: 'in-progress',\n      },\n      {\n        id: '104',\n        name: 'Reporting Module - Backend',\n        startDate: addDays(baseDate, 4),\n        endDate: addDays(baseDate, 5),\n        assignee: 'Appurva',\n        status: 'in-progress',\n      },\n      {\n        id: '105',\n        name: 'Chart Components Implementation',\n        startDate: addDays(baseDate, 6),\n        endDate: addDays(baseDate, 8),\n        assignee: 'Siddique',\n        status: 'in-progress',\n      },\n      {\n        id: '106',\n        name: 'Export Functionality (PDF/CSV)',\n        startDate: new Date(baseDate),\n        endDate: addDays(baseDate, 2),\n        assignee: 'Appurva',\n        status: 'delayed',\n      },\n      {\n        id: 'REV-01',\n        name: 'Fix Mobile Responsiveness',\n        startDate: addDays(baseDate, 1),\n        endDate: addDays(baseDate, 3),\n        assignee: 'Siddique',\n        status: 'delayed',\n        isRevision: true,\n      },\n      {\n        id: 'REV-02',\n        name: 'Update Color Contrast for Accessibility',\n        startDate: addDays(baseDate, 3),\n        endDate: addDays(baseDate, 5),\n        assignee: 'Siddique',\n        status: 'in-progress',\n        isRevision: true,\n      },\n    ];\n  }, [tasks]);\n\n  // Calculate date range based on tasks\n  const dateRange = useMemo(() => {\n    if (mockTasks.length === 0) {\n      const today = new Date();\n      return {\n        start: startOfWeek(today),\n        end: endOfWeek(addDays(today, 7)),\n      };\n    }\n\n    const dates = mockTasks.flatMap(t => [t.startDate, t.endDate]);\n    const minDate = new Date(Math.min(...dates.map(d => d.getTime())));\n    const maxDate = new Date(Math.max(...dates.map(d => d.getTime())));\n\n    let start: Date, end: Date;\n    if (timeScale === 'day') {\n      start = new Date(minDate);\n      end = addDays(maxDate, 1);\n    } else if (timeScale === 'week') {\n      start = startOfWeek(minDate);\n      end = endOfWeek(addDays(maxDate, 7));\n    } else {\n      start = startOfMonth(minDate);\n      end = endOfMonth(maxDate);\n    }\n\n    return { start, end };\n  }, [mockTasks, timeScale]);\n\n  // Generate timeline dates\n  const timelineDates = useMemo(() => {\n    if (timeScale === 'day') {\n      return eachDayOfInterval({ start: dateRange.start, end: dateRange.end });\n    } else if (timeScale === 'week') {\n      const days = eachDayOfInterval({ start: dateRange.start, end: dateRange.end });\n      // Show each day in week view\n      return days;\n    } else {\n      // For month view, show first day of each month\n      const months: Date[] = [];\n      let current = new Date(dateRange.start);\n      while (current <= dateRange.end) {\n        months.push(startOfMonth(current));\n        current = addDays(endOfMonth(current), 1);\n      }\n      return months;\n    }\n  }, [dateRange, timeScale]);\n\n  // Calculate bar position and width\n  const getBarStyle = (task: GanttTask) => {\n    const start = dateRange.start.getTime();\n    const taskStart = task.startDate.getTime();\n    const taskEnd = task.endDate.getTime();\n    \n    let dayWidth = 60; // Base width per day\n    if (timeScale === 'week') {\n      dayWidth = 80;\n    } else if (timeScale === 'month') {\n      dayWidth = 100;\n    }\n\n    const left = ((taskStart - start) / (1000 * 60 * 60 * 24)) * dayWidth;\n    const width = ((taskEnd - taskStart) / (1000 * 60 * 60 * 24) + 1) * dayWidth;\n\n    return {\n      left: Math.max(0, left),\n      width: Math.max(60, width),\n    };\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'bg-[#0F9D58]';\n      case 'delayed':\n        return 'bg-[#EB5757]';\n      default:\n        return 'bg-[#2F80ED]';\n    }\n  };\n\n  const taskListWidth = 300;\n  const timelineWidth = timelineDates.length * (timeScale === 'week' ? 80 : timeScale === 'month' ? 100 : 60);\n\n  return (\n    <div className=\"w-full h-full flex flex-col bg-white\">\n      {/* Header with Time Scale Selectors */}\n      <div className=\"flex items-center justify-between mb-6 px-2\">\n        <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n          <BarChart2 className=\"w-5 h-5 text-[#ff3b3b]\" />\n          Gantt Chart\n        </h3>\n        <div className=\"flex items-center gap-2 bg-[#F7F7F7] p-1 rounded-lg border border-[#EEEEEE]\">\n          <button\n            onClick={() => setTimeScale('day')}\n            className={`px-4 py-1.5 rounded-md text-[13px] font-['Manrope:SemiBold',sans-serif] transition-colors ${\n              timeScale === 'day'\n                ? 'bg-white text-[#ff3b3b] shadow-sm'\n                : 'text-[#666666] hover:text-[#111111]'\n            }`}\n          >\n            Day\n          </button>\n          <button\n            onClick={() => setTimeScale('week')}\n            className={`px-4 py-1.5 rounded-md text-[13px] font-['Manrope:SemiBold',sans-serif] transition-colors ${\n              timeScale === 'week'\n                ? 'bg-white text-[#ff3b3b] shadow-sm'\n                : 'text-[#666666] hover:text-[#111111]'\n            }`}\n          >\n            Week\n          </button>\n          <button\n            onClick={() => setTimeScale('month')}\n            className={`px-4 py-1.5 rounded-md text-[13px] font-['Manrope:SemiBold',sans-serif] transition-colors ${\n              timeScale === 'month'\n                ? 'bg-white text-[#ff3b3b] shadow-sm'\n                : 'text-[#666666] hover:text-[#111111]'\n            }`}\n          >\n            Month\n          </button>\n        </div>\n      </div>\n\n      {/* Gantt Chart Container */}\n      <div className=\"flex-1 overflow-auto border border-[#EEEEEE] rounded-[16px]\">\n        <div className=\"flex\" style={{ minWidth: taskListWidth + timelineWidth }}>\n          {/* Task List (Left Side) */}\n          <div\n            className=\"border-r border-[#EEEEEE] bg-[#FAFAFA] sticky left-0 z-10\"\n            style={{ width: taskListWidth, minWidth: taskListWidth }}\n          >\n            <div className=\"p-4 border-b border-[#EEEEEE] bg-white\">\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                Task Name\n              </p>\n            </div>\n            <div className=\"divide-y divide-[#EEEEEE]\">\n              {mockTasks.map((task) => (\n                <div\n                  key={task.id}\n                  className=\"p-4 bg-white hover:bg-[#FAFAFA] transition-colors\"\n                  style={{ minHeight: '50px' }}\n                >\n                  <p className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                    #{task.id} {task.name}\n                  </p>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Timeline (Right Side) */}\n          <div className=\"flex-1 overflow-x-auto\">\n            {/* Timeline Header */}\n            <div\n              className=\"border-b border-[#EEEEEE] bg-white sticky top-0 z-20\"\n              style={{ minWidth: timelineWidth }}\n            >\n              <div className=\"flex\">\n                {timelineDates.map((date, idx) => {\n                  const dayWidth = timeScale === 'week' ? 80 : timeScale === 'month' ? 100 : 60;\n                  return (\n                    <div\n                      key={idx}\n                      className=\"border-r border-[#EEEEEE] p-3 text-center\"\n                      style={{ width: dayWidth, minWidth: dayWidth }}\n                    >\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                        {timeScale === 'week' \n                          ? format(date, 'EEE d').toUpperCase()\n                          : timeScale === 'month'\n                          ? format(date, 'MMM yyyy').toUpperCase()\n                          : format(date, 'EEE d').toUpperCase()}\n                      </p>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Gantt Bars */}\n            <div className=\"relative\" style={{ minWidth: timelineWidth, minHeight: mockTasks.length * 50 }}>\n              {mockTasks.map((task, taskIdx) => {\n                const barStyle = getBarStyle(task);\n                return (\n                  <div\n                    key={task.id}\n                    className=\"absolute\"\n                    style={{\n                      top: `${taskIdx * 50 + 10}px`,\n                      left: `${taskListWidth + barStyle.left}px`,\n                      width: `${barStyle.width}px`,\n                      height: '30px',\n                    }}\n                  >\n                    <div\n                      className={`${getStatusColor(task.status)} rounded-md h-full flex items-center px-2 text-white text-[11px] font-['Manrope:Medium',sans-serif] shadow-sm`}\n                    >\n                      {task.assignee}\n                    </div>\n                  </div>\n                );\n              })}\n\n              {/* Grid Lines */}\n              {timelineDates.map((date, idx) => {\n                const dayWidth = timeScale === 'week' ? 80 : timeScale === 'month' ? 100 : 60;\n                return (\n                  <div\n                    key={idx}\n                    className=\"absolute border-r border-[#EEEEEE]\"\n                    style={{\n                      left: `${taskListWidth + idx * dayWidth}px`,\n                      top: 0,\n                      bottom: 0,\n                      width: '1px',\n                    }}\n                  />\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/requirements/RequirementDetailsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SubTask' is defined but never used.","line":27,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RequirementDto' is defined but never used.","line":31,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":77,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3124,3127],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3124,3127],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3356,3359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3356,3359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4524,4527],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4524,4527],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\*.","line":349,"column":68,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":349,"endColumn":69,"suggestions":[{"messageId":"removeEscape","fix":{"range":[15593,15594],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[15593,15593],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\*.","line":367,"column":68,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":367,"endColumn":69,"suggestions":[{"messageId":"removeEscape","fix":{"range":[16585,16586],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[16585,16585],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":570,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":570,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27850,27853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27850,27853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":579,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":579,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28382,28385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28382,28385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":592,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":592,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29140,29143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29140,29143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":620,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":620,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30279,30282],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30279,30282],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":865,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":865,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42513,42516],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42513,42516],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":934,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":934,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46534,46537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46534,46537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":951,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":951,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[47362,47365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[47362,47365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":986,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":986,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[49820,49823],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[49820,49823],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1322,"column":106,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1322,"endColumn":109,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[68767,68770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[68767,68770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1344,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1344,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[69334,69337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[69334,69337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showLabel' is defined but never used.","line":1420,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":1420,"endColumn":41}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport {\n  FileText, ListTodo, BarChart2, Columns,\n  Plus, RotateCcw, Clock, MoreVertical,\n  Paperclip, X, Send, MessageSquare, Calendar,\n  TrendingUp, TrendingDown, Briefcase,\n  CheckCircle2, AlertCircle, Loader2\n} from 'lucide-react';\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip as RechartsTooltip,\n  ResponsiveContainer,\n  Legend,\n} from 'recharts';\nimport { Breadcrumb, Checkbox, Button, Tooltip, App, Input, Select, Modal } from 'antd';\nimport { sanitizeRichText } from '@/utils/sanitizeHtml';\nimport { useWorkspace, useRequirements, useUpdateRequirement, useWorkspaces } from '@/hooks/useWorkspace';\nimport { useTasks, useRequestRevision } from '@/hooks/useTask';\nimport { useUserDetails } from '@/hooks/useUser';\nimport { SubTask } from '@/types/genericTypes';\nimport { format } from 'date-fns';\nimport { TaskRow } from '@/components/features/tasks/rows/TaskRow';\nimport { Requirement, Task } from '@/types/domain';\nimport { RequirementDto } from '@/types/dto/requirement.dto';\nconst { Option } = Select;\n\nexport function RequirementDetailsPage() {\n  const { message } = App.useApp();\n  const params = useParams();\n  const router = useRouter();\n  const workspaceId = Number(params.workspaceId);\n  const reqId = Number(params.reqId);\n\n  const { data: workspaceData, isLoading: isLoadingWorkspace } = useWorkspace(workspaceId);\n  const { data: requirementsData, isLoading: isLoadingRequirements } = useRequirements(workspaceId);\n  const { data: tasksData } = useTasks(`workspace_id=${workspaceId}`);\n  const { data: userData } = useUserDetails();\n\n  const [activeTab, setActiveTab] = useState<'details' | 'tasks' | 'gantt' | 'kanban' | 'pnl'>('details');\n  const [selectedTasks, setSelectedTasks] = useState<string[]>([]);\n  const [messageText, setMessageText] = useState('');\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [ganttView, setGanttView] = useState<'day' | 'week' | 'month'>('week');\n\n  // Partner / Receiver Logic\n  const [isAcceptModalOpen, setIsAcceptModalOpen] = useState(false);\n  const [selectedReceiverWorkspace, setSelectedReceiverWorkspace] = useState<string | undefined>(undefined);\n  const { mutate: updateRequirement } = useUpdateRequirement();\n  const { data: myWorkspacesData } = useWorkspaces();\n  const { mutate: requestRevision } = useRequestRevision();\n\n  const [isRevisionModalOpen, setIsRevisionModalOpen] = useState(false);\n  const [revisionNotes, setRevisionNotes] = useState('');\n  const [targetTaskId, setTargetTaskId] = useState<number | null>(null);\n\n\n  const handleAcceptRequirement = () => {\n     if (!selectedReceiverWorkspace) {\n        message.error(\"Please select a workspace to import this requirement into.\");\n        return;\n     }\n     if (!requirement) return;\n\n     updateRequirement({\n        id: reqId,\n        workspace_id: requirement.workspace_id,\n        title: requirement.title,\n        status: 'Assigned',\n        receiver_workspace_id: Number(selectedReceiverWorkspace)\n     } as unknown as any, {\n        onSuccess: () => {\n           message.success(\"Requirement accepted and assigned to workspace.\");\n           setIsAcceptModalOpen(false);\n        },\n        onError: (err: Error) => {\n           message.error((err as any).message || \"Failed to accept requirement\");\n        }\n     });\n  };\n\n  const workspace = useMemo(() => {\n    if (!workspaceData?.result) return null;\n    return workspaceData.result;\n  }, [workspaceData]);\n\n  const requirement = useMemo((): Requirement | undefined => {\n    if (!requirementsData?.result) return undefined;\n    return requirementsData.result.find((r: Requirement) => r.id === reqId);\n  }, [requirementsData, reqId]);\n\n  const isSender = useMemo(() => {\n    if (!requirement || !userData?.result) return false;\n    return requirement.sender_company_id === userData.result.company_id;\n  }, [requirement, userData]);\n\n  const mapRequirementStatus = (status: string): 'in-progress' | 'completed' | 'delayed' => {\n    const statusLower = status?.toLowerCase() || '';\n    if (statusLower.includes('completed') || statusLower === 'done') return 'completed';\n    if (statusLower.includes('delayed') || statusLower.includes('stuck') || statusLower.includes('impediment')) return 'delayed';\n    return 'in-progress';\n  };\n\n  const tasks = useMemo((): Task[] => {\n    if (!tasksData?.result || !requirement) return [];\n    return tasksData.result.filter((t: any) => Number(t.requirement_id) === reqId && (!t.type || t.type === 'task'));\n  }, [tasksData, requirement, reqId]);\n\n  const revisions = useMemo(() => {\n    if (!tasksData?.result || !requirement) return [];\n    return tasksData.result.filter((t: Task & { type?: string }) => t.requirement_id === reqId && t.type === 'revision');\n  }, [tasksData, requirement, reqId]);\n\n  if (isLoadingWorkspace || isLoadingRequirements) {\n    return <div className=\"p-8\">Loading...</div>;\n  }\n\n  if (!workspace || !requirement) {\n    return <div className=\"p-8\">Requirement or Workspace not found</div>;\n  }\n\n\n\n  const handleSendMessage = () => {\n    if (messageText.trim() || attachments.length > 0) {\n      setMessageText('');\n      setAttachments([]);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setAttachments([...attachments, ...Array.from(e.target.files)]);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  // Mock activity data\n  const activityData = [\n    { id: 1, type: 'comment', user: 'Siddique Ahmed', avatar: 'SA', date: '2 hours ago', message: 'The homepage design looks great! Just a few minor tweaks needed on the spacing.', attachments: [] },\n    { id: 2, type: 'file', user: 'Appurva Panchabhai', avatar: 'AP', date: '5 hours ago', message: 'Uploaded design mockups', attachments: ['homepage-v2.fig', 'assets-bundle.zip'] },\n    { id: 3, type: 'worklog', user: 'Siddique Ahmed', avatar: 'SA', date: 'Yesterday', message: 'Logged 4h 30m on Homepage UI Design', time: '4h 30m', task: 'Homepage UI Design' },\n    { id: 4, type: 'comment', user: 'Manager', avatar: 'M', date: '2 days ago', message: 'Great progress team! Let\\'s aim to complete this by end of week.', attachments: [] },\n    { id: 5, type: 'status', user: 'System', avatar: 'S', date: '3 days ago', message: 'Status changed from \"Todo\" to \"In Progress\"', isSystem: true },\n    { id: 6, type: 'worklog', user: 'Appurva Panchabhai', avatar: 'AP', date: '3 days ago', message: 'Logged 3h 00m on Login Flow Integration', time: '3h', task: 'Login Flow Integration' },\n  ];\n\n  const requirementStatus = mapRequirementStatus(requirement.status || 'in-progress');\n  const assignedTo = requirement.assignedTo || [];\n\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] flex overflow-hidden\">\n      {/* Main Content */}\n      <div className=\"flex-1 flex flex-col overflow-hidden\">\n        {/* Header */}\n        <div className=\"p-8 pb-0\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <div className=\"flex items-center gap-2\">\n              <Breadcrumb\n                separator={<span className=\"text-[20px] font-['Manrope:SemiBold',sans-serif] text-[#999999]\">/</span>}\n                items={[\n                  {\n                    title: (\n                      <span\n                        onClick={() => router.push('/dashboard/workspace')}\n                        className=\"cursor-pointer font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#999999] hover:text-[#666666] transition-colors\"\n                      >\n                        Workspaces\n                      </span>\n                    ),\n                  },\n                  {\n                    title: (\n                      <span\n                        onClick={() => router.push(`/dashboard/workspace/${workspace.id}`)}\n                        className=\"cursor-pointer font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#999999] hover:text-[#666666] transition-colors\"\n                      >\n                        {workspace.name}\n                      </span>\n                    ),\n                  },\n                  {\n                    title: (\n                      <span className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111] line-clamp-1 max-w-[300px]\">\n                        {requirement.title}\n                      </span>\n                    ),\n                  },\n                ]}\n              />\n            </div>\n\n            <div className=\"flex items-center gap-4\">\n              {/* Receiver Confirmation Action */}\n              {requirement.status === 'Waiting' && (\n                 <>\n                   <Button \n                      type=\"primary\" \n                      className=\"bg-[#111111] hover:bg-[#000000]/90\"\n                      onClick={() => setIsAcceptModalOpen(true)}\n                   >\n                     Accept & Assign Workspace\n                   </Button>\n                   <Modal\n                      open={isAcceptModalOpen}\n                      onCancel={() => setIsAcceptModalOpen(false)}\n                      title=\"Accept Requirement\"\n                      onOk={handleAcceptRequirement}\n                      okText=\"Accept & Import\"\n                      okButtonProps={{ className: \"bg-[#111111]\" }}\n                   >\n                      <div className=\"py-4\">\n                         <p className=\"text-sm text-gray-600 mb-2\">\n                           Select one of your existing workspaces to assign this requirement to.\n                         </p>\n                         <Select\n                            className=\"w-full\"\n                            placeholder=\"Select your workspace\"\n                            value={selectedReceiverWorkspace}\n                            onChange={setSelectedReceiverWorkspace}\n                         >\n                            {myWorkspacesData?.result?.workspaces?.map((w: { id: number; name: string }) => (\n                               <Option key={w.id} value={String(w.id)}>{w.name}</Option>\n                            ))}\n                         </Select>\n                      </div>\n                   </Modal>\n                 </>\n              )}\n\n              <StatusBadge status={requirementStatus} showLabel />\n              {requirement.is_high_priority && (\n                <span className=\"px-3 py-1.5 rounded-full text-[11px] font-['Manrope:SemiBold',sans-serif] uppercase tracking-wide bg-[#FFF5F5] text-[#ff3b3b]\">\n                  HIGH PRIORITY\n                </span>\n              )}\n              <div className=\"flex -space-x-2\">\n                {Array.isArray(assignedTo) && assignedTo.slice(0, 3).map((person: { name: string } | string, i: number) => {\n                  const name = typeof person === 'string' ? person : person?.name || 'U';\n                  return (\n                    <div key={i} className=\"w-8 h-8 rounded-full border-2 border-white bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center shadow-sm\" title={name}>\n                      <span className=\"text-[10px] text-white font-['Manrope:Bold',sans-serif]\">\n                        {name.split(' ').map((n: string) => n[0]).join('').toUpperCase()}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n\n          {/* Tabs */}\n          <div className=\"border-b border-[#EEEEEE]\">\n            <div className=\"flex items-center gap-8\">\n              <TabButton\n                active={activeTab === 'details'}\n                onClick={() => setActiveTab('details')}\n                icon={FileText}\n                label=\"Details\"\n              />\n              <TabButton\n                active={activeTab === 'tasks'}\n                onClick={() => setActiveTab('tasks')}\n                icon={ListTodo}\n                label=\"Tasks & Revisions\"\n              />\n              <TabButton\n                active={activeTab === 'gantt'}\n                onClick={() => setActiveTab('gantt')}\n                icon={BarChart2}\n                label=\"Gantt Chart\"\n              />\n              <TabButton\n                active={activeTab === 'kanban'}\n                onClick={() => setActiveTab('kanban')}\n                icon={Columns}\n                label=\"Kanban Board\"\n              />\n              <TabButton\n                active={activeTab === 'pnl'}\n                onClick={() => setActiveTab('pnl')}\n                icon={TrendingUp}\n                label=\"P&L\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-8 bg-[#FAFAFA]\">\n          {activeTab === 'details' && (\n            <div className=\"max-w-5xl mx-auto space-y-8\">\n              {/* Description Section */}\n              <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-4 flex items-center gap-2\">\n                  <FileText className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Description\n                </h3>\n\n                {/* Parse description to extract sections */}\n                {(() => {\n                  const desc = requirement.description || '';\n                  // Create a clean version without HTML tags for parsing logic\n                  const cleanDesc = desc.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\n\n                  const overviewMatch = cleanDesc.match(/Overview:\\s*(.+?)(?=\\s*Key Deliverables:|$)/i);\n                  const deliverablesMatch = cleanDesc.match(/Key Deliverables:\\s*([\\s\\S]+?)(?=\\s*Technical Requirements:|$)/i);\n                  const technicalMatch = cleanDesc.match(/Technical Requirements:\\s*([\\s\\S]+?)$/i);\n\n                  const overview = overviewMatch ? overviewMatch[1].trim() : '';\n                  const listPattern = /•|\\s-\\s|\\s-|-\\s|\\d+\\./;\n                  const deliverables = deliverablesMatch\n                    ? deliverablesMatch[1].split(listPattern).filter(line => line.trim())\n                    : [];\n                  const technical = technicalMatch\n                    ? technicalMatch[1].split(listPattern).filter(line => line.trim())\n                    : [];\n\n                  return (\n                    <div className=\"space-y-6\">\n                      {/* Overview */}\n                      {overview && (\n                        <div>\n                          <h4 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">Overview</h4>\n                          <p className=\"text-[14px] text-[#444444] font-['Inter:Regular',sans-serif] leading-relaxed\">\n                            {overview}\n                          </p>\n                        </div>\n                      )}\n\n                      {/* Key Deliverables */}\n                      {deliverables.length > 0 && (\n                        <div>\n                          <h4 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">Key Deliverables</h4>\n                          <ul className=\"space-y-2\">\n                            {deliverables.map((item, idx) => {\n                              const cleanItem = item.replace(/^[•\\-\\*]\\s*/, '').trim();\n                              return (\n                                <li key={idx} className=\"text-[14px] text-[#444444] font-['Inter:Regular',sans-serif] leading-relaxed flex items-start\">\n                                  <span className=\"text-[#ff3b3b] mr-2\">•</span>\n                                  <span>{cleanItem}</span>\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </div>\n                      )}\n\n                      {/* Technical Requirements */}\n                      {technical.length > 0 && (\n                        <div>\n                          <h4 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">Technical Requirements</h4>\n                          <ul className=\"space-y-2\">\n                            {technical.map((item, idx) => {\n                              const cleanItem = item.replace(/^[•\\-\\*]\\s*/, '').trim();\n                              return (\n                                <li key={idx} className=\"text-[14px] text-[#444444] font-['Inter:Regular',sans-serif] leading-relaxed flex items-start\">\n                                  <span className=\"text-[#ff3b3b] mr-2\">•</span>\n                                  <span>{cleanItem}</span>\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </div>\n                      )}\n\n                      {/* Fallback: if no structured format, show as-is but render as sanitized HTML */}\n                      {!overview && deliverables.length === 0 && technical.length === 0 && (\n                        <div\n                          className=\"text-[14px] text-[#444444] font-['Inter:Regular',sans-serif] leading-relaxed prose prose-sm max-w-none\"\n                          dangerouslySetInnerHTML={{ __html: sanitizeRichText(requirement.description || '') }}\n                        />\n                      )}\n                    </div>\n                  );\n                })()}\n              </div>\n\n              {/* Requirement Details Section */}\n              <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-6 flex items-center gap-2\">\n                  <Briefcase className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Requirement Details\n                </h3>\n\n                {/* Details Grid */}\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n                  {/* Type */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Type</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      {workspace?.in_house ? 'In-house' : 'Client Project'}\n                    </p>\n                  </div>\n\n                  {/* Pricing Model */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Pricing Model</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111] flex items-center gap-1\">\n                      <span className=\"text-[#ff3b3b]\">$</span>\n                      {requirement.pricing_model || 'Requirement Basis'}\n                    </p>\n                  </div>\n\n                  {/* Partner / Company */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Partner / Company</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      {requirement.sender_company?.name || 'In-house'}\n                    </p>\n                  </div>\n\n                  {/* Requirement Budget */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Requirement Budget</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      ${requirement.budget ? Number(requirement.budget).toFixed(2) : '0.00'}\n                    </p>\n                  </div>\n\n                  {/* Start Date */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Start Date</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      {requirement.start_date ? format(new Date(requirement.start_date), 'MMM d, yyyy') : 'Not set'}\n                    </p>\n                  </div>\n\n                  {/* End Date */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Due Date</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      {requirement.end_date ? format(new Date(requirement.end_date), 'MMM d, yyyy') : 'Not set'}\n                    </p>\n                  </div>\n\n                  {/* Quoted Price */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Quoted Price</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      ${requirement.quoted_price ? Number(requirement.quoted_price).toFixed(2) : '0.00'}\n                    </p>\n                  </div>\n\n                  {/* Total Tasks */}\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Total Tasks</p>\n                    <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                      {requirement.total_task || tasks.length || 0}\n                    </p>\n                  </div>\n\n                  {/* Leader */}\n                  {requirement.leader_user && (\n                    <div>\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Leader</p>\n                      <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                        {requirement.leader_user.name || 'N/A'}\n                      </p>\n                    </div>\n                  )}\n\n                  {/* Manager */}\n                  {requirement.manager_user && (\n                    <div>\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Manager</p>\n                      <p className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#111111]\">\n                        {requirement.manager_user.name || 'N/A'}\n                      </p>\n                    </div>\n                  )}\n\n                  {/* Document Link */}\n                  {requirement.document_link && (\n                    <div>\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Document</p>\n                      <a\n                        href={requirement.document_link}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"text-[14px] font-['Inter:Medium',sans-serif] text-[#2F80ED] hover:underline truncate block\"\n                      >\n                        View Document\n                      </a>\n                    </div>\n                  )}\n\n                  {/* Priority */}\n                  {requirement.is_high_priority && (\n                    <div>\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">Priority</p>\n                      <span className=\"px-2 py-1 bg-[#FFF5F5] text-[#ff3b3b] text-[12px] font-['Manrope:Bold',sans-serif] rounded-full\">\n                        High Priority\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'tasks' && (\n            <div className=\"max-w-5xl mx-auto space-y-8\">\n              {/* Tasks Section */}\n              <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                <div className=\"flex items-center justify-between mb-6\">\n                  <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n                    <ListTodo className=\"w-5 h-5 text-[#ff3b3b]\" />\n                    Tasks Breakdown\n                  </h3>\n                  <Button type=\"default\" size=\"small\" className=\"h-8 text-[12px] border-[#EEEEEE]\">\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Task\n                  </Button>\n                </div>\n\n                {/* Table Header - matches TaskRow grid (without requirements) */}\n                <div className=\"px-4 pb-3 mb-2\">\n                  <div className=\"grid grid-cols-[40px_2.5fr_1.1fr_1fr_0.8fr_1.5fr_0.6fr_40px] gap-4 items-center\">\n                    <div className=\"flex justify-center\">\n                      <Checkbox\n                        checked={tasks.length > 0 && selectedTasks.length === tasks.length}\n                        onChange={(e) => {\n                          if (e.target.checked) setSelectedTasks(tasks.map((t: Task) => String(t.id)));\n                          else setSelectedTasks([]);\n                        }}\n                        className=\"border-[#DDDDDD] [&.ant-checkbox-checked]:bg-[#ff3b3b] [&.ant-checkbox-checked]:border-[#ff3b3b]\"\n                      />\n                    </div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Task</p>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Timeline</p>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Assigned</p>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Duration</p>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Progress</p>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide text-center\">Status</p>\n                    <p></p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  {tasks.length > 0 ? (\n                    tasks.map((task: Task) => {\n                      // Map task data to TaskRow expected format\n                      const mappedTask = {\n                        id: String(task.id),\n                        name: task.name || task.title || 'Untitled',\n                        taskId: String(task.id),\n                        client: workspace?.client_user?.name || workspace?.name || 'N/A',\n                        project: requirement?.title || 'N/A',\n                        leader: task.leader_user?.name || '',\n                        assignedTo: task.member_user?.name || task.task_members?.[0]?.user?.name || 'Unassigned',\n                        startDate: task.start_date || '',\n                        dueDate: task.end_date || '',\n                        estTime: Number(task.estimated_time) || 0,\n                        timeSpent: task.time_spent || 0,\n                        total_seconds_spent: task.total_seconds_spent || 0,\n                        activities: 0,\n                        status: task.status || 'Assigned',\n                        is_high_priority: task.is_high_priority || (task as any).priority === 'HIGH' || false,\n                        timelineDate: task.end_date ? format(new Date(task.end_date), 'MMM dd') : 'N/A',\n                        timelineLabel: task.status === 'Delayed' ? 'Overdue' : '',\n                        execution_mode: task.execution_mode,\n                        task_members: task.task_members || []\n                      };\n                      return (\n                        <TaskRow\n                          key={task.id}\n                          task={mappedTask as unknown as any}\n                          selected={selectedTasks.includes(String(task.id))}\n                          onSelect={() => {\n                            if (selectedTasks.includes(String(task.id))) {\n                              setSelectedTasks(selectedTasks.filter(id => id !== String(task.id)));\n                            } else {\n                              setSelectedTasks([...selectedTasks, String(task.id)]);\n                            }\n                          }}\n                          onStatusChange={() => {}} // Handle if needed\n                          hideRequirements={true}\n                          isSender={isSender}\n                          onRequestRevision={() => {\n                            setTargetTaskId(task.id as any);\n                            setIsRevisionModalOpen(true);\n                          }}\n                        />\n                      );\n                    })\n                  ) : (\n                    <div className=\"text-center py-8 text-[#999999] text-[13px]\">No tasks created yet</div>\n                  )}\n              </div>\n\n              {/* Revision Confirmation Modal */}\n              <Modal\n                title=\"Request Revision\"\n                open={isRevisionModalOpen}\n                onCancel={() => {\n                   setIsRevisionModalOpen(false);\n                   setRevisionNotes('');\n                }}\n                onOk={() => {\n                  if (!targetTaskId || !revisionNotes.trim()) return;\n                  requestRevision({ id: targetTaskId, revisionNotes }, {\n                    onSuccess: () => {\n                      message.success(\"Revision requested successfully\");\n                      setIsRevisionModalOpen(false);\n                      setRevisionNotes('');\n                    },\n                    onError: (err: Error) => {\n                      message.error((err as any).message || \"Failed to request revision\");\n                    }\n                  });\n                }}\n                okText=\"Submit Revision\"\n                okButtonProps={{ className: \"bg-[#111111]\" }}\n              >\n                <div className=\"py-4\">\n                  <p className=\"text-sm text-gray-600 mb-2\">\n                    Describe exactly what needs to be changed. This will create a new revision task for the team.\n                  </p>\n                  <Input.TextArea \n                    rows={4}\n                    placeholder=\"Revision details...\"\n                    value={revisionNotes}\n                    onChange={(e) => setRevisionNotes(e.target.value)}\n                  />\n                </div>\n              </Modal>\n\n              </div>\n\n              {/* Revisions Section */}\n              {revisions.length > 0 && (\n                <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                  <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-6 flex items-center gap-2\">\n                    <RotateCcw className=\"w-5 h-5 text-[#ff3b3b]\" />\n                    Revisions\n                  </h3>\n                  {/* Table Header */}\n                  <div className=\"grid grid-cols-[40px_1fr_200px_150px_120px_40px] gap-4 px-4 pb-3 mb-2 border-b border-[#EEEEEE] items-center\">\n                    <div className=\"flex justify-center\">\n                      <Checkbox disabled className=\"border-[#DDDDDD]\" />\n                    </div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Revision</p>\n                    <div className=\"flex justify-center\">\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Assigned</p>\n                    </div>\n                    <div className=\"flex justify-center\">\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Due Date</p>\n                    </div>\n                    <div className=\"flex justify-center\">\n                      <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Status</p>\n                    </div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\"></p>\n                  </div>\n                  <div className=\"space-y-2\">\n                    {revisions.map((task: Task) => (\n                      <SubTaskRow key={task.id} task={task} isRevision />\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'gantt' && (() => {\n            // Calculate timeline from actual task dates\n            const allTasks = [...tasks, ...revisions];\n            const today = new Date();\n            today.setHours(0, 0, 0, 0);\n\n            // Find earliest start and latest end dates\n            let minDate = new Date();\n            let maxDate = new Date();\n            let hasValidDates = false;\n\n            allTasks.forEach((task: Task) => {\n              if (task.start_date) {\n                const start = new Date(task.start_date);\n                if (!hasValidDates || start < minDate) minDate = new Date(start);\n                hasValidDates = true;\n              }\n              if (task.end_date) {\n                const end = new Date(task.end_date);\n                if (!hasValidDates || end > maxDate) maxDate = new Date(end);\n                hasValidDates = true;\n              }\n            });\n\n            // If no valid dates, use today +/- 2 weeks\n            if (!hasValidDates) {\n              minDate = new Date(today);\n              minDate.setDate(minDate.getDate() - 7);\n              maxDate = new Date(today);\n              maxDate.setDate(maxDate.getDate() + 14);\n            } else {\n              // Add buffer days\n              minDate.setDate(minDate.getDate() - 3);\n              maxDate.setDate(maxDate.getDate() + 7);\n            }\n\n            minDate.setHours(0, 0, 0, 0);\n            maxDate.setHours(0, 0, 0, 0);\n\n            // Calculate columns based on view mode\n            const columnDates: Date[] = [];\n            const totalDays = Math.ceil((maxDate.getTime() - minDate.getTime()) / (1000 * 60 * 60 * 24)) + 1;\n\n            if (ganttView === 'day') {\n              // Show individual days (max 21 days)\n              const daysToShow = Math.min(totalDays, 21);\n              for (let i = 0; i < daysToShow; i++) {\n                const d = new Date(minDate);\n                d.setDate(d.getDate() + i);\n                columnDates.push(d);\n              }\n            } else if (ganttView === 'week') {\n              // Show days grouped by week (14 days)\n              const daysToShow = Math.min(totalDays, 14);\n              for (let i = 0; i < daysToShow; i++) {\n                const d = new Date(minDate);\n                d.setDate(d.getDate() + i);\n                columnDates.push(d);\n              }\n            } else {\n              // Month view - show weeks (28 days)\n              const daysToShow = Math.min(totalDays, 28);\n              for (let i = 0; i < daysToShow; i++) {\n                const d = new Date(minDate);\n                d.setDate(d.getDate() + i);\n                columnDates.push(d);\n              }\n            }\n\n            const timelineStart = columnDates[0];\n            const timelineEnd = columnDates[columnDates.length - 1];\n            const timelineDays = Math.ceil((timelineEnd.getTime() - timelineStart.getTime()) / (1000 * 60 * 60 * 24)) + 1;\n\n            // Calculate today position\n            const todayPosition = today >= timelineStart && today <= timelineEnd\n              ? ((today.getTime() - timelineStart.getTime()) / (1000 * 60 * 60 * 24)) / timelineDays * 100\n              : -1;\n\n            // Calculate bar position for a task\n            const getBarPosition = (task: Task) => {\n              const startDate = task.start_date ? new Date(task.start_date) : today;\n              const endDate = task.end_date ? new Date(task.end_date) : new Date(startDate.getTime() + 3 * 24 * 60 * 60 * 1000);\n              startDate.setHours(0, 0, 0, 0);\n              endDate.setHours(0, 0, 0, 0);\n\n              const startDiff = (startDate.getTime() - timelineStart.getTime()) / (1000 * 60 * 60 * 24);\n              const duration = (endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24) + 1;\n\n              const left = Math.max(0, (startDiff / timelineDays) * 100);\n              const width = Math.min(100 - left, (duration / timelineDays) * 100);\n\n              return { left, width };\n            };\n\n            // Get status color\n            const getStatusColor = (task: Task) => {\n              const status = (task.status || '').toLowerCase();\n              if (status === 'completed' || status === 'done') return 'bg-[#E8F5E9] border-[#0F9D58] text-[#0F9D58]';\n              if (status === 'delayed' || status === 'stuck' || status === 'impediment') return 'bg-[#FFF5F5] border-[#ff3b3b] text-[#ff3b3b]';\n              if (status === 'in_progress') return 'bg-[#E3F2FD] border-[#2F80ED] text-[#2F80ED]';\n              return 'bg-[#FFF8E1] border-[#F59E0B] text-[#F59E0B]';\n            };\n\n            // Get assigned name\n            const getAssignedName = (task: Task) => {\n              if (task.member_user?.name) return task.member_user.name;\n              if (task.task_members?.[0]?.user?.name) return task.task_members[0].user.name;\n              return 'Unassigned';\n            };\n\n            return (\n              <div className=\"bg-white rounded-[16px] border border-[#EEEEEE] shadow-sm overflow-hidden flex flex-col h-[600px]\">\n                <div className=\"p-6 border-b border-[#EEEEEE] flex justify-between items-center shrink-0\">\n                  <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n                    <BarChart2 className=\"w-5 h-5 text-[#ff3b3b]\" />\n                    Gantt Chart\n                  </h3>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      type={ganttView === 'day' ? 'primary' : 'default'}\n                      size=\"small\"\n                      className=\"h-8 text-[12px] !rounded-lg\"\n                      style={ganttView === 'day' ? { backgroundColor: '#ff3b3b', borderColor: '#ff3b3b' } : { borderColor: '#EEEEEE' }}\n                      onClick={() => setGanttView('day')}\n                    >\n                      Day\n                    </Button>\n                    <Button\n                      type={ganttView === 'week' ? 'primary' : 'default'}\n                      size=\"small\"\n                      className=\"h-8 text-[12px] !rounded-lg\"\n                      style={ganttView === 'week' ? { backgroundColor: '#ff3b3b', borderColor: '#ff3b3b' } : { borderColor: '#EEEEEE' }}\n                      onClick={() => setGanttView('week')}\n                    >\n                      Week\n                    </Button>\n                    <Button\n                      type={ganttView === 'month' ? 'primary' : 'default'}\n                      size=\"small\"\n                      className=\"h-8 text-[12px] !rounded-lg\"\n                      style={ganttView === 'month' ? { backgroundColor: '#ff3b3b', borderColor: '#ff3b3b' } : { borderColor: '#EEEEEE' }}\n                      onClick={() => setGanttView('month')}\n                    >\n                      Month\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex-1 overflow-auto\">\n                  {/* Gantt Header */}\n                  <div className=\"flex border-b border-[#EEEEEE] min-w-[800px] sticky top-0 bg-white z-20\">\n                    <div className=\"w-[250px] p-4 font-['Manrope:Bold',sans-serif] text-[13px] text-[#111111] border-r border-[#EEEEEE] sticky left-0 bg-white z-30 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]\">\n                      Task Name\n                    </div>\n                    <div className=\"flex-1 flex relative\">\n                      {columnDates.map((date, i) => {\n                        const isToday = date.toDateString() === today.toDateString();\n                        const isWeekend = date.getDay() === 0 || date.getDay() === 6;\n                        return (\n                          <div\n                            key={i}\n                            className={`flex-1 border-r border-[#EEEEEE] p-2 text-center min-w-[60px] ${isWeekend ? 'bg-[#FAFAFA]' : ''} ${isToday ? 'bg-[#FFF5F5]' : ''}`}\n                          >\n                            <div className=\"text-[10px] text-[#999999] font-['Inter:SemiBold',sans-serif] uppercase\">\n                              {date.toLocaleDateString('en-US', { weekday: 'short' })}\n                            </div>\n                            <div className={`text-[12px] font-['Manrope:Bold',sans-serif] ${isToday ? 'text-[#ff3b3b]' : 'text-[#111111]'}`}>\n                              {date.getDate()}\n                            </div>\n                            {ganttView !== 'day' && i === 0 && (\n                              <div className=\"text-[9px] text-[#999999] mt-0.5\">\n                                {date.toLocaleDateString('en-US', { month: 'short' })}\n                              </div>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n\n                  {/* Gantt Body */}\n                  <div className=\"min-w-[800px] relative\">\n                    {/* Today Marker */}\n                    {todayPosition >= 0 && todayPosition <= 100 && (\n                      <div\n                        className=\"absolute top-0 bottom-0 w-0.5 bg-[#ff3b3b] z-10 pointer-events-none\"\n                        style={{ left: `calc(250px + ${todayPosition}% * (100% - 250px) / 100)` }}\n                      />\n                    )}\n\n                    {allTasks.length > 0 ? allTasks.map((task: any) => {\n                      const { left, width } = getBarPosition(task);\n                      const statusColor = getStatusColor(task);\n                      const assignedName = getAssignedName(task);\n                      const isRevision = task.type === 'revision';\n\n                      return (\n                        <div key={task.id} className=\"flex border-b border-[#FAFAFA] hover:bg-[#FAFAFA] transition-colors group\">\n                          <div className=\"w-[250px] p-3 border-r border-[#EEEEEE] flex items-center gap-3 sticky left-0 bg-white group-hover:bg-[#FAFAFA] z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]\">\n                            <span className={`text-[10px] px-1.5 py-0.5 rounded font-mono ${isRevision ? 'bg-[#FFF5F5] text-[#ff3b3b]' : 'bg-[#F7F7F7] text-[#999999]'}`}>\n                              #{task.id}\n                            </span>\n                            <span className=\"text-[13px] text-[#111111] font-['Inter:Medium',sans-serif] truncate\">\n                              {task.name || task.title}\n                            </span>\n                          </div>\n                          <div className=\"flex-1 relative py-3\" style={{ minHeight: '44px' }}>\n                            {/* Grid Lines */}\n                            {columnDates.map((date, i) => {\n                              const isWeekend = date.getDay() === 0 || date.getDay() === 6;\n                              return (\n                                <div\n                                  key={i}\n                                  className={`absolute inset-y-0 ${isWeekend ? 'bg-[#FAFAFA]' : ''}`}\n                                  style={{ left: `${(i / columnDates.length) * 100}%`, width: `${100 / columnDates.length}%`, borderRight: '1px solid #FAFAFA' }}\n                                />\n                              );\n                            })}\n\n                            {/* Task Bar */}\n                            <Tooltip title={\n                              <div className=\"text-xs\">\n                                <div className=\"font-bold\">{task.name || task.title}</div>\n                                <div>Start: {task.start_date ? format(new Date(task.start_date), 'MMM d, yyyy') : 'Not set'}</div>\n                                <div>End: {task.end_date ? format(new Date(task.end_date), 'MMM d, yyyy') : 'Not set'}</div>\n                                <div>Assigned: {assignedName}</div>\n                                <div>Status: {task.status || 'Pending'}</div>\n                              </div>\n                            }>\n                              <div\n                                className={`absolute h-6 rounded-[4px] top-1/2 -translate-y-1/2 flex items-center px-2 shadow-sm border cursor-pointer hover:shadow-md transition-shadow ${statusColor}`}\n                                style={{\n                                  left: `${left}%`,\n                                  width: `${Math.max(width, 5)}%`,\n                                  minWidth: '40px'\n                                }}\n                              >\n                                <span className=\"text-[10px] font-['Manrope:Bold',sans-serif] truncate w-full\">\n                                  {assignedName.split(' ')[0]}\n                                </span>\n                              </div>\n                            </Tooltip>\n                          </div>\n                        </div>\n                      );\n                    }) : (\n                      <div className=\"text-center py-12 text-[#999999] text-[13px]\">No tasks to display</div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            );\n          })()}\n\n          {activeTab === 'kanban' && (() => {\n            // Map actual statuses to Kanban columns\n            const allTasks = [...tasks, ...revisions];\n\n            const getColumnTasks = (column: string) => {\n              return allTasks.filter((t: any) => {\n                const status = (t.status || '').toLowerCase().replace(' ', '_');\n                switch (column) {\n                  case 'todo':\n                    return status === 'assigned' || status === 'pending' || status === 'todo' || !t.status;\n                  case 'in-progress':\n                    return status === 'in_progress' || status === 'inprogress';\n                  case 'impediment':\n                    return status === 'stuck' || status === 'impediment' || status === 'delayed' || status === 'blocked';\n                  case 'completed':\n                    return status === 'completed' || status === 'done' || status === 'review';\n                  default:\n                    return false;\n                }\n              });\n            };\n\n            const getAssignedInfo = (task: any) => {\n              if (task.member_user?.name) return { name: task.member_user.name, pic: task.member_user.profile_pic };\n              if (task.task_members?.[0]?.user?.name) return { name: task.task_members[0].user.name, pic: task.task_members[0].user.profile_pic };\n              return { name: 'Unassigned', pic: null };\n            };\n\n            return (\n              <div className=\"h-full overflow-x-auto\">\n                <div className=\"flex gap-6 min-w-[1000px] h-full pb-4\">\n                  {['todo', 'in-progress', 'impediment', 'completed'].map((status) => {\n                    const columnTasks = getColumnTasks(status);\n\n                    const getStatusStyle = (s: string) => {\n                      switch (s) {\n                        case 'todo': return { color: 'text-[#666666]', bg: 'bg-[#F7F7F7]', dotBg: 'bg-[#666666]', label: 'To Do' };\n                        case 'in-progress': return { color: 'text-[#2F80ED]', bg: 'bg-[#E3F2FD]', dotBg: 'bg-[#2F80ED]', label: 'In Progress' };\n                        case 'impediment': return { color: 'text-[#ff3b3b]', bg: 'bg-[#FFF5F5]', dotBg: 'bg-[#ff3b3b]', label: 'Blocked / Delayed' };\n                        case 'completed': return { color: 'text-[#0F9D58]', bg: 'bg-[#E8F5E9]', dotBg: 'bg-[#0F9D58]', label: 'Completed' };\n                        default: return { color: 'text-[#666666]', bg: 'bg-[#F5F5F5]', dotBg: 'bg-[#666666]', label: 'Unknown' };\n                      }\n                    };\n\n                    const style = getStatusStyle(status);\n\n                    return (\n                      <div key={status} className=\"flex-1 min-w-[280px] flex flex-col bg-[#F7F7F7] rounded-[16px] p-4 border border-[#EEEEEE]\">\n                        <div className=\"flex items-center justify-between mb-4\">\n                          <div className={`flex items-center gap-2 px-3 py-1.5 rounded-full ${style.bg} w-fit`}>\n                            <div className={`w-2 h-2 rounded-full ${style.dotBg}`} />\n                            <span className={`text-[12px] font-['Manrope:Bold',sans-serif] ${style.color}`}>{style.label}</span>\n                          </div>\n                          <span className=\"text-[12px] font-['Inter:SemiBold',sans-serif] text-[#999999]\">{columnTasks.length}</span>\n                        </div>\n\n                        <div className=\"flex-1 space-y-3 overflow-y-auto pr-1\">\n                          {columnTasks.map((task: any) => {\n                            const assigned = getAssignedInfo(task);\n                            const initials = assigned.name.split(' ').map((n: string) => n[0]).join('').toUpperCase().slice(0, 2);\n                            const isRevision = task.type === 'revision';\n                            return (\n                              <div key={task.id} className=\"bg-white p-4 rounded-[12px] border border-[#EEEEEE] shadow-sm hover:shadow-md transition-shadow cursor-pointer group\">\n                                <div className=\"flex items-center justify-between mb-3\">\n                                  <span className={`text-[10px] px-1.5 py-0.5 rounded font-mono ${isRevision ? 'bg-[#FFF5F5] text-[#ff3b3b]' : 'bg-[#F7F7F7] text-[#999999]'}`}>\n                                    {isRevision ? '#REV-' : '#'}{task.id}\n                                  </span>\n                                  {isRevision && (\n                                    <Tooltip title=\"Revision\">\n                                      <RotateCcw className=\"w-3.5 h-3.5 text-[#ff3b3b]\" />\n                                    </Tooltip>\n                                  )}\n                                </div>\n                                <h4 className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-3 leading-snug\">\n                                  {task.name || task.title}\n                                </h4>\n                                <div className=\"flex items-center justify-between pt-3 border-t border-[#FAFAFA]\">\n                                  <div className=\"flex items-center gap-2\">\n                                    {assigned.pic ? (\n                                      <img src={assigned.pic} alt={assigned.name} className=\"w-6 h-6 rounded-full object-cover\" />\n                                    ) : (\n                                      <div className=\"w-6 h-6 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center\">\n                                        <span className=\"text-[9px] text-white font-['Manrope:Bold',sans-serif]\">\n                                          {initials}\n                                        </span>\n                                      </div>\n                                    )}\n                                    <span className=\"text-[11px] text-[#666666] truncate max-w-[80px]\">{assigned.name.split(' ')[0]}</span>\n                                  </div>\n                                  <div className=\"flex items-center gap-1 text-[#999999]\">\n                                    <Calendar className=\"w-3 h-3\" />\n                                    <span className=\"text-[10px]\">{task.end_date ? format(new Date(task.end_date), 'dd-MMM') : 'N/A'}</span>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n\n                        <button className=\"mt-3 flex items-center justify-center gap-2 py-2 rounded-[8px] hover:bg-[#EAEAEA] transition-colors text-[#666666] text-[12px] font-['Manrope:SemiBold',sans-serif] border border-dashed border-[#DDDDDD]\">\n                          <Plus className=\"w-4 h-4\" /> Add Task\n                        </button>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })()}\n\n          {activeTab === 'pnl' && (\n            <div className=\"max-w-5xl mx-auto space-y-8\">\n              <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-6 flex items-center gap-2\">\n                  <TrendingUp className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Profit & Loss Analysis\n                </h3>\n\n                {/* Summary Cards */}\n                <div className=\"grid grid-cols-3 gap-6 mb-8\">\n                  <div className=\"p-4 rounded-xl bg-[#F7F7F7] border border-[#EEEEEE]\">\n                    <p className=\"text-[12px] text-[#666666] font-['Inter:Medium',sans-serif] mb-1\">Total Requirement Price</p>\n                    <p className=\"text-[24px] text-[#111111] font-['Manrope:Bold',sans-serif]\">$12,500</p>\n                  </div>\n                  <div className=\"p-4 rounded-xl bg-[#F7F7F7] border border-[#EEEEEE]\">\n                    <p className=\"text-[12px] text-[#666666] font-['Inter:Medium',sans-serif] mb-1\">Resource Investment</p>\n                    <p className=\"text-[24px] text-[#111111] font-['Manrope:Bold',sans-serif]\">$8,200</p>\n                  </div>\n                  <div className=\"p-4 rounded-xl bg-[#ECFDF3] border border-[#D1FADF]\">\n                    <p className=\"text-[12px] text-[#027A48] font-['Inter:Medium',sans-serif] mb-1\">Net Profit</p>\n                    <p className=\"text-[24px] text-[#027A48] font-['Manrope:Bold',sans-serif]\">+$4,300</p>\n                  </div>\n                </div>\n\n                {/* Chart */}\n                <div className=\"h-[400px] w-full\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={[\n                      { name: 'Week 1', price: 2500, invested: 1200 },\n                      { name: 'Week 2', price: 4000, invested: 2500 },\n                      { name: 'Week 3', price: 6500, invested: 4000 },\n                      { name: 'Week 4', price: 8500, invested: 5800 },\n                      { name: 'Week 5', price: 10500, invested: 7200 },\n                      { name: 'Week 6', price: 12500, invested: 8200 },\n                    ]} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>\n                      <defs>\n                        <linearGradient id=\"colorPrice\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\" stopColor=\"#ff3b3b\" stopOpacity={0.2} />\n                          <stop offset=\"95%\" stopColor=\"#ff3b3b\" stopOpacity={0} />\n                        </linearGradient>\n                        <linearGradient id=\"colorInvested\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                          <stop offset=\"5%\" stopColor=\"#111111\" stopOpacity={0.2} />\n                          <stop offset=\"95%\" stopColor=\"#111111\" stopOpacity={0} />\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#F0F0F0\" />\n                      <XAxis\n                        dataKey=\"name\"\n                        axisLine={false}\n                        tickLine={false}\n                        tick={{ fill: '#999999', fontSize: 12 }}\n                        dy={10}\n                      />\n                      <YAxis\n                        axisLine={false}\n                        tickLine={false}\n                        tick={{ fill: '#999999', fontSize: 12 }}\n                        tickFormatter={(value) => `$${value}`}\n                      />\n                      <RechartsTooltip\n                        contentStyle={{ backgroundColor: '#fff', borderRadius: '12px', border: '1px solid #EEEEEE', boxShadow: '0 4px 12px rgba(0,0,0,0.05)' }}\n                        itemStyle={{ fontSize: '12px', fontWeight: '500' }}\n                      />\n                      <Legend wrapperStyle={{ paddingTop: '20px' }} />\n                      <Area\n                        type=\"monotone\"\n                        dataKey=\"price\"\n                        name=\"Total Requirement Price\"\n                        stroke=\"#ff3b3b\"\n                        strokeWidth={2}\n                        fillOpacity={1}\n                        fill=\"url(#colorPrice)\"\n                      />\n                      <Area\n                        type=\"monotone\"\n                        dataKey=\"invested\"\n                        name=\"Amount Invested\"\n                        stroke=\"#111111\"\n                        strokeWidth={2}\n                        fillOpacity={1}\n                        fill=\"url(#colorInvested)\"\n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                </div>\n              </div>\n\n              {/* Analysis Section */}\n              <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-6 flex items-center gap-2\">\n                  <BarChart2 className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Cost Analysis Breakdown\n                </h3>\n\n                <div className=\"overflow-x-auto rounded-xl border border-[#EEEEEE]\">\n                  <table className=\"w-full min-w-[900px]\">\n                    <thead className=\"bg-[#F7F7F7] border-b border-[#EEEEEE]\">\n                      <tr>\n                        <th className=\"px-6 py-4 text-left text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Task</th>\n                        <th className=\"px-6 py-4 text-left text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Employee</th>\n                        <th className=\"px-6 py-4 text-right text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Allotted Hrs</th>\n                        <th className=\"px-6 py-4 text-right text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Engaged Hrs</th>\n                        <th className=\"px-6 py-4 text-right text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Extra Hrs</th>\n                        <th className=\"px-6 py-4 text-right text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">\n                          Resource Invested\n                          <span className=\"block text-[10px] normal-case text-[#999999] font-normal\">(Engaged × Rate)</span>\n                        </th>\n                        <th className=\"px-6 py-4 text-right text-[12px] font-['Manrope:Bold',sans-serif] text-[#666666] uppercase tracking-wider\">Profit/Loss</th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-[#EEEEEE]\">\n                      {/* Mock data rows */}\n                      <tr className=\"bg-white hover:bg-[#FAFAFA] transition-colors\">\n                        <td className=\"px-6 py-4 align-middle\">\n                          <span className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Backend API Integration</span>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle\">\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center shadow-sm shrink-0\">\n                              <span className=\"text-[10px] text-white font-['Manrope:Bold',sans-serif]\">SA</span>\n                            </div>\n                            <div>\n                              <p className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Sharifudeen</p>\n                              <p className=\"text-[11px] text-[#999999] font-['Inter:Medium',sans-serif]\">Developer ($40/hr)</p>\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle text-right\">\n                          <span className=\"text-[13px] font-['Inter:Medium',sans-serif] text-[#666666]\">40</span>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle text-right\">\n                          <span className=\"text-[13px] font-['Inter:Medium',sans-serif] text-[#111111]\">55</span>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle text-right\">\n                          <span className=\"text-[13px] font-['Inter:Bold',sans-serif] text-[#DC2626]\">+15</span>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle text-right\">\n                          <span className=\"text-[13px] font-['Inter:Medium',sans-serif] text-[#111111]\">$2,200</span>\n                        </td>\n                        <td className=\"px-6 py-4 align-middle text-right\">\n                          <div className=\"flex items-center justify-end gap-1 text-[#DC2626]\">\n                            <TrendingDown className=\"w-4 h-4\" />\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif]\">-$600</span>\n                          </div>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Right Drawer - Activity & Chat */}\n      <div className=\"w-[400px] border-l border-[#EEEEEE] flex flex-col bg-white rounded-tr-[24px] rounded-br-[24px]\">\n        {/* Drawer Header */}\n        <div className=\"p-6 border-b border-[#EEEEEE]\">\n          <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n            <MessageSquare className=\"w-5 h-5 text-[#ff3b3b]\" />\n            Activity & Chat\n          </h3>\n          <p className=\"text-[12px] text-[#666666] font-['Inter:Regular',sans-serif] mt-1\">\n            Team collaboration and updates\n          </p>\n        </div>\n\n        {/* Activity Feed */}\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n          {activityData.map((activity) => (\n            <div key={activity.id} className=\"flex gap-3\">\n              <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${activity.isSystem\n                ? 'bg-[#F0F0F0]'\n                : 'bg-gradient-to-br from-[#666666] to-[#999999]'\n                }`}>\n                <span className={`text-[11px] font-['Manrope:Bold',sans-serif] ${activity.isSystem ? 'text-[#999999]' : 'text-white'\n                  }`}>\n                  {activity.avatar}\n                </span>\n              </div>\n\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-baseline gap-2 mb-1\">\n                  <span className={`text-[13px] font-['Manrope:SemiBold',sans-serif] ${activity.isSystem ? 'text-[#999999]' : 'text-[#111111]'\n                    }`}>\n                    {activity.user}\n                  </span>\n                  <span className=\"text-[11px] text-[#999999] font-['Inter:Regular',sans-serif]\">\n                    {activity.date}\n                  </span>\n                </div>\n\n                <div className={`${activity.type === 'comment'\n                  ? 'bg-[#F7F7F7] p-3 rounded-[12px] rounded-tl-none'\n                  : ''\n                  }`}>\n                  <p className=\"text-[13px] text-[#444444] font-['Inter:Regular',sans-serif]\">\n                    {activity.message}\n                  </p>\n\n                  {activity.type === 'worklog' && activity.time && (\n                    <div className=\"flex items-center gap-2 mt-2\">\n                      <span className=\"px-2 py-1 rounded bg-white text-[#666666] text-[11px] font-mono border border-[#EEEEEE]\">\n                        {activity.time}\n                      </span>\n                      <span className=\"text-[11px] text-[#ff3b3b] font-['Inter:Medium',sans-serif]\">\n                        {activity.task}\n                      </span>\n                    </div>\n                  )}\n\n                  {activity.attachments && activity.attachments.length > 0 && (\n                    <div className=\"mt-2 space-y-1\">\n                      {activity.attachments.map((file, idx) => (\n                        <div key={idx} className=\"flex items-center gap-2 p-2 bg-white rounded border border-[#EEEEEE]\">\n                          <Paperclip className=\"w-3.5 h-3.5 text-[#666666]\" />\n                          <span className=\"text-[11px] text-[#444444] truncate\">{file}</span>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Message Input */}\n        <div className=\"p-4 border-t border-[#EEEEEE] bg-white\">\n          {attachments.length > 0 && (\n            <div className=\"mb-3 space-y-1\">\n              {attachments.map((file, index) => (\n                <div key={index} className=\"flex items-center justify-between p-2 bg-white rounded border border-[#EEEEEE]\">\n                  <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                    <Paperclip className=\"w-3.5 h-3.5 text-[#666666] shrink-0\" />\n                    <span className=\"text-[11px] text-[#444444] truncate\">{file.name}</span>\n                  </div>\n                  <button\n                    onClick={() => setAttachments(attachments.filter((_, i) => i !== index))}\n                    className=\"p-1 hover:bg-[#FAFAFA] rounded transition-colors shrink-0\"\n                  >\n                    <X className=\"w-3.5 h-3.5 text-[#999999]\" />\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n\n          <div className=\"relative\">\n            <textarea\n              value={messageText}\n              onChange={(e) => setMessageText(e.target.value)}\n              onKeyPress={handleKeyPress}\n              placeholder=\"Type a message or comment...\"\n              className=\"w-full min-h-[80px] p-3 pr-10 rounded-[12px] border border-[#DDDDDD] bg-[#FAFAFA] text-[13px] focus:outline-none focus:border-[#ff3b3b]/30 resize-none font-['Inter:Medium',sans-serif]\"\n            />\n            <div className=\"absolute bottom-3 right-3 flex gap-2\">\n              <label htmlFor=\"file-upload\" className=\"cursor-pointer text-[#999999] hover:text-[#666666] transition-colors\">\n                <Paperclip className=\"w-4 h-4\" />\n                <input\n                  id=\"file-upload\"\n                  type=\"file\"\n                  multiple\n                  className=\"hidden\"\n                  onChange={handleFileSelect}\n                />\n              </label>\n              <button\n                onClick={handleSendMessage}\n                disabled={!messageText.trim() && attachments.length === 0}\n                className=\"text-[#ff3b3b] hover:text-[#E03131] disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              >\n                <Send className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction TabButton({ active, onClick, icon: Icon, label }: { active: boolean; onClick: () => void; icon: any; label: string }) {\n  return (\n    <button\n      onClick={onClick}\n      className={`\n        flex items-center gap-2 pb-4 relative transition-colors\n        ${active ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'}\n      `}\n    >\n      <Icon className=\"w-4 h-4\" />\n      <span className=\"text-[13px] font-['Manrope:Bold',sans-serif]\">{label}</span>\n      {active && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n    </button>\n  );\n}\n\nfunction SubTaskRow({\n  task,\n  isRevision,\n  selected = false,\n  onSelect\n}: {\n  task: any;\n  isRevision?: boolean;\n  selected?: boolean;\n  onSelect?: () => void;\n}) {\n  const assignedName = task.assigned_to ? `User ${task.assigned_to}` : 'Unassigned';\n  const initials = assignedName.split(' ').map((n: string) => n[0]).join('').toUpperCase();\n\n  return (\n    <div\n      onClick={onSelect}\n      className={`\n        group bg-white border rounded-[16px] p-4 transition-all duration-300 cursor-pointer relative z-10\n        ${selected\n          ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n          : 'border-[#EEEEEE] hover:border-[#ff3b3b]/20 hover:shadow-lg'\n        }\n      `}\n    >\n      <div className=\"grid grid-cols-[40px_2fr_1fr_1fr_0.6fr_0.3fr] gap-4 items-center\">\n        {/* Checkbox */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            checked={selected}\n            onChange={onSelect}\n            disabled={isRevision}\n            className=\"border-[#DDDDDD] [&.ant-checkbox-checked]:bg-[#ff3b3b] [&.ant-checkbox-checked]:border-[#ff3b3b]\"\n          />\n        </div>\n\n        {/* Task Info */}\n        <div>\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h3 className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111] group-hover:text-[#ff3b3b] transition-colors\">\n              {task.title || task.name}\n            </h3>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-[11px] text-[#999999] font-['Inter:Regular',sans-serif]\">\n              #{task.id}\n            </span>\n          </div>\n        </div>\n\n        {/* Assigned To */}\n        <div className=\"flex items-center justify-center gap-2\">\n          <div className=\"w-7 h-7 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center\">\n            <span className=\"text-[11px] text-white font-['Manrope:Bold',sans-serif]\">\n              {initials}\n            </span>\n          </div>\n        </div>\n\n        {/* Due Date */}\n        <div className=\"flex justify-center\">\n          <span className=\"text-[13px] text-[#666666] font-['Inter:Medium',sans-serif]\">\n            {task.due_date ? format(new Date(task.due_date), 'MMM d, yyyy') : 'N/A'}\n          </span>\n        </div>\n\n        {/* Status */}\n        <div className=\"flex justify-center\">\n          <StatusBadge status={task.status || 'todo'} />\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end\" onClick={(e) => e.stopPropagation()}>\n          <button className=\"w-7 h-7 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] transition-colors\">\n            <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction StatusBadge({ status, showLabel }: { status: string; showLabel?: boolean }) {\n  let color = \"bg-[#F7F7F7] text-[#666666]\";\n  let icon = <Clock className=\"w-3.5 h-3.5\" />;\n  let label = status;\n\n  switch (status?.toLowerCase()) {\n    case 'completed':\n    case 'done':\n      color = \"bg-[#E8F5E9] text-[#0F9D58]\";\n      icon = <CheckCircle2 className=\"w-3.5 h-3.5\" />;\n      label = \"Completed\";\n      break;\n    case 'delayed':\n      color = \"bg-[#FFF5F5] text-[#ff3b3b]\";\n      icon = <AlertCircle className=\"w-3.5 h-3.5\" />;\n      label = \"Delayed\";\n      break;\n    case 'in-progress':\n    case 'in_progress':\n      color = \"bg-[#E3F2FD] text-[#2F80ED]\";\n      icon = <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />;\n      label = \"In Progress\";\n      break;\n    case 'todo':\n    case 'pending':\n      color = \"bg-[#F7F7F7] text-[#666666]\";\n      icon = <Clock className=\"w-3.5 h-3.5\" />;\n      label = \"To Do\";\n      break;\n    case 'impediment':\n      color = \"bg-[#FFF5F5] text-[#ff3b3b]\";\n      icon = <AlertCircle className=\"w-3.5 h-3.5\" />;\n      label = \"Impediment\";\n      break;\n  }\n\n  return (\n    <Tooltip title={label}>\n      <div className={`flex items-center justify-center w-7 h-7 rounded-full ${color} border border-current/10 cursor-help transition-transform hover:scale-110`}>\n        {icon}\n      </div>\n    </Tooltip>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/requirements/RequirementsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":13,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dayjs' is defined but never used.","line":20,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RequirementDto' is defined but never used.","line":32,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'queryClient' is assigned a value but never used.","line":289,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":289,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingCollaborative' is assigned a value but never used.","line":314,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":314,"endColumn":69},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":356,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12448,12451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12448,12451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12780,12783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12780,12783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":380,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":380,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13358,13361],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13358,13361],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":477,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":477,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18492,18495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18492,18495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":496,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":496,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19725,19728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19725,19728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":496,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":496,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19762,19765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19762,19765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":496,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":496,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19798,19801],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19798,19801],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":622,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":622,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24534,24537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24534,24537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":643,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":643,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25152,25155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25152,25155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":685,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":685,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26575,26578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26575,26578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":690,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":690,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26735,26738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26735,26738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":715,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":715,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27699,27702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27699,27702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":721,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":721,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27893,27896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27893,27896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":798,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":798,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30857,30860],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30857,30860],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":804,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":804,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31117,31120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31117,31120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":805,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":805,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31280,31283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31280,31283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":889,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":889,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[34560,34563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[34560,34563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":903,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":903,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35032,35035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35032,35035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":908,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":908,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35223,35226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35223,35226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":921,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":921,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35703,35706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35703,35706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":934,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":934,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36181,36184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36181,36184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":949,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":949,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36747,36750],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36747,36750],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":954,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":954,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[36941,36944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[36941,36944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":968,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":968,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37460,37463],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37460,37463],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":973,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":973,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37640,37643],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37640,37643],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":978,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":978,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37794,37797],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37794,37797],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":991,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":991,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38234,38237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38234,38237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":996,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":996,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38454,38457],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38454,38457],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1083,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1083,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[41053,41056],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[41053,41056],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1113,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1113,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42646,42649],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42646,42649],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1131,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1131,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[43262,43265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[43262,43265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1220,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1220,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[47052,47055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[47052,47055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1297,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1297,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[49963,49966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[49963,49966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1323,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1323,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[50955,50958],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[50955,50958],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1331,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1331,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51243,51246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51243,51246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":40,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo, useEffect } from 'react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { DateRangeSelector } from '../../common/DateRangeSelector';\nimport {\n  X, Calendar as CalendarIcon, Clock, CheckCircle, CheckSquare, Users, Trash2,\n  FilePlus, Receipt, MoreHorizontal, Play, XCircle, RotateCcw, ChevronDown, AlertCircle\n} from 'lucide-react';\n\nimport { PaginationBar } from '../../ui/PaginationBar';\nimport { Modal, Button, Input, Select, Tooltip, Popover, Checkbox, App } from 'antd';\nimport { useWorkspaces, useCreateRequirement, useUpdateRequirement, useDeleteRequirement, useApproveRequirement, useCollaborativeRequirements } from '@/hooks/useWorkspace';\nimport { useEmployees, useUserDetails } from '@/hooks/useUser';\nimport { getRequirementsByWorkspaceId } from '@/services/workspace';\nimport { useQueries, useQueryClient } from '@tanstack/react-query';\nimport { format, isPast, isToday, differenceInDays } from 'date-fns';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport dayjs, { Dayjs } from 'dayjs';\n\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nimport { RequirementsForm, RequirementFormData } from '../../modals/RequirementsForm';\nimport { WorkspaceForm } from '../../modals/WorkspaceForm';\n\n\n\nimport { Requirement, Workspace } from '@/types/domain';\nimport { RequirementDto } from '@/types/dto/requirement.dto';\n\n// Quotation Dialog Component\nfunction QuotationDialog({\n  open,\n  onOpenChange,\n  onConfirm,\n  pricingModel\n}: {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: (data: { cost?: number, rate?: number, hours?: number }) => void;\n  pricingModel?: 'hourly' | 'project';\n}) {\n  const { message: messageApi } = App.useApp();\n  const [amount, setAmount] = useState('');\n  const [rate, setRate] = useState('');\n  const [hours, setHours] = useState('');\n\n  useEffect(() => {\n    if (open) {\n      setAmount('');\n      setRate('');\n      setHours('');\n    }\n  }, [open]);\n\n  const handleConfirm = () => {\n    if (pricingModel === 'hourly') {\n      if (!rate || !hours) {\n        messageApi.error(\"Please enter rate and hours\");\n        return;\n      }\n      onConfirm({\n        rate: parseFloat(rate),\n        hours: parseFloat(hours),\n        cost: parseFloat(rate) * parseFloat(hours)\n      });\n    } else {\n      if (!amount) {\n        messageApi.error(\"Please enter an amount\");\n        return;\n      }\n      onConfirm({ cost: parseFloat(amount) });\n    }\n    onOpenChange(false);\n  };\n\n  return (\n    <Modal\n      open={open}\n      onCancel={() => onOpenChange(false)}\n      onOk={handleConfirm}\n      title=\"Submit Quotation\"\n      okText=\"Send Quotation\"\n      cancelText=\"Cancel\"\n      okButtonProps={{ className: 'bg-[#111111] hover:bg-[#000000]/90' }}\n      width={400}\n      centered\n    >\n      <div className=\"space-y-4 py-4\">\n        <p className=\"text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">\n          Please provide the final quotation details for this {pricingModel === 'hourly' ? 'hourly' : 'project'} requirement.\n        </p>\n        {pricingModel === 'hourly' ? (\n          <>\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Confirmed Hourly Rate ($)</label>\n              <Input\n                type=\"number\"\n                placeholder=\"0.00\"\n                className=\"h-11 rounded-lg\"\n                value={rate}\n                onChange={(e) => setRate(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Estimated Hours</label>\n              <Input\n                type=\"number\"\n                placeholder=\"0\"\n                className=\"h-11 rounded-lg\"\n                value={hours}\n                onChange={(e) => setHours(e.target.value)}\n              />\n            </div>\n            <div className=\"pt-2 border-t border-[#EEEEEE] flex justify-between items-center\">\n              <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Total Estimated:</span>\n              <span className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#ff3b3b]\">\n                ${((parseFloat(rate) || 0) * (parseFloat(hours) || 0)).toFixed(2)}\n              </span>\n            </div>\n          </>\n        ) : (\n          <div className=\"space-y-2\">\n            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Total Project Cost ($)</label>\n            <Input\n              type=\"number\"\n              placeholder=\"0.00\"\n              className=\"h-11 rounded-lg\"\n              value={amount}\n              onChange={(e) => setAmount(e.target.value)}\n            />\n          </div>\n        )}\n      </div>\n    </Modal>\n  );\n}\n\n// Reject Dialog Component\nfunction RejectDialog({\n  open,\n  onOpenChange,\n  onConfirm\n}: {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: (reason: string) => void;\n}) {\n  const { message: messageApi } = App.useApp();\n  const [reason, setReason] = useState('');\n\n  const handleConfirm = () => {\n    if (!reason) {\n      messageApi.error(\"Please enter a reason\");\n      return;\n    }\n    onConfirm(reason);\n    setReason('');\n    onOpenChange(false);\n  };\n  return (\n    <Modal\n      open={open}\n      onCancel={() => onOpenChange(false)}\n      onOk={handleConfirm}\n      title=\"Reject Requirement\"\n      okText=\"Reject\"\n      cancelText=\"Cancel\"\n      okButtonProps={{ className: 'bg-[#ff3b3b] hover:bg-[#d93232]' }}\n      width={400}\n      centered\n    >\n      <div className=\"space-y-4 py-4\">\n        <p className=\"text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">\n          Please provide a reason for rejecting this requirement. It will be moved to drafts.\n        </p>\n        <div className=\"space-y-2\">\n          <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Reason</label>\n          <TextArea\n            placeholder=\"e.g. Budget too low, Out of scope...\"\n            className=\"min-h-[100px] rounded-lg resize-none\"\n            value={reason}\n            onChange={(e) => setReason(e.target.value)}\n            rows={4}\n          />\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Internal Mapping Dialog Component\nfunction InternalMappingModal({\n  open,\n  onOpenChange,\n  onConfirm,\n  workspaces\n}: {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: (workspaceId: number) => void;\n  workspaces: { id: number | string; name: string }[];\n}) {\n  const { message: messageApi } = App.useApp();\n  const [selectedWorkspace, setSelectedWorkspace] = useState<number | undefined>(undefined);\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n\n  const handleConfirm = () => {\n    if (!selectedWorkspace) {\n      messageApi.error(\"Please select an internal workspace\");\n      return;\n    }\n    onConfirm(selectedWorkspace);\n    setSelectedWorkspace(undefined);\n    onOpenChange(false);\n  };\n\n  return (\n    <>\n      <Modal\n        open={open}\n        onCancel={() => onOpenChange(false)}\n        onOk={handleConfirm}\n        title=\"Map to Internal Workspace\"\n        okText=\"Activate Requirement\"\n        cancelText=\"Cancel\"\n        okButtonProps={{ className: 'bg-[#111111] hover:bg-[#000000]/90 text-white border-none' }}\n        width={400}\n        centered\n      >\n        <div className=\"space-y-4 py-4\">\n          <p className=\"text-[13px] text-[#666666] font-['Inter:Regular',sans-serif]\">\n            Select one of your internal workspaces to map this requirement to.\n          </p>\n          <div className=\"space-y-2\">\n            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Internal Workspace</label>\n            <Select\n              className=\"w-full h-11\"\n              placeholder=\"Select workspace\"\n              value={selectedWorkspace}\n              onChange={(v: string | number) => {\n                if (v === 'create_new') {\n                  setIsCreateOpen(true);\n                  // Reset selection until created\n                  setSelectedWorkspace(undefined);\n                } else {\n                  setSelectedWorkspace(v as number);\n                }\n              }}\n              suffixIcon={<ChevronDown className=\"w-4 h-4 text-gray-400\" />}\n            >\n              <Option key=\"create_new\" value=\"create_new\" className=\"text-[#ff3b3b] font-medium border-b border-gray-100 pb-2 mb-2\">\n                + Create New Workspace\n              </Option>\n              {workspaces.map((w: { id: number | string; name: string }) => (\n                <Option key={String(w.id)} value={w.id}>\n                  {w.name}\n                </Option>\n              ))}\n            </Select>\n          </div>\n        </div>\n      </Modal>\n\n      <WorkspaceForm\n        open={isCreateOpen}\n        onCancel={() => setIsCreateOpen(false)}\n        onSuccess={(data: { result?: { id: number }; id?: number }) => {\n           // data needs to be inspected. Usually creation returns result object.\n           // Assuming standard hook return { result: { id, name, ... } } or just result.\n           // We will try to extract ID.\n           const newId = data?.result?.id || data?.id;\n           if (newId) {\n             setSelectedWorkspace(newId);\n           }\n           setIsCreateOpen(false);\n        }}\n      />\n    </>\n  );\n}\n\nexport function RequirementsPage() {\n  const { message: messageApi } = App.useApp();\n  const router = useRouter();\n  const queryClient = useQueryClient();\n  const createRequirementMutation = useCreateRequirement();\n  const updateRequirementMutation = useUpdateRequirement();\n  const deleteRequirementMutation = useDeleteRequirement();\n  const approveRequirementMutation = useApproveRequirement();\n\n  // Fetch all workspaces first to get requirements for each\n  const { data: workspacesData, isLoading: isLoadingWorkspaces } = useWorkspaces();\n  const { data: employeesData } = useEmployees();\n\n  // Get all workspace IDs\n  const workspaceIds = useMemo(() => {\n    return workspacesData?.result?.workspaces?.map((w: { id: number }) => w.id) || [];\n  }, [workspacesData]);\n\n  // Fetch requirements for all workspaces\n  const requirementQueries = useQueries({\n    queries: workspaceIds.map((id: number) => ({\n      queryKey: ['requirements', id],\n      queryFn: () => getRequirementsByWorkspaceId(id),\n      enabled: !!id && workspaceIds.length > 0,\n    })),\n  });\n\n  // Fetch collaborative requirements (where my company is receiver)\n  const { data: collaborativeData, isLoading: isLoadingCollaborative } = useCollaborativeRequirements();\n  const { data: userData } = useUserDetails();\n  // userData.result = { user, access, token }\n  // We need user.company_id for role detection\n  const currentUser = userData?.result?.user;\n  \n  console.log('CurrentUser DEBUG:', {\n    rawUserData: userData,\n    resultUser: userData?.result?.user,\n    companyId: userData?.result?.user?.company_id,\n  });\n\n\n  const isLoadingRequirements = requirementQueries.some(q => q.isLoading);\n  const isLoading = isLoadingWorkspaces || isLoadingRequirements;\n\n  // Helper function to strip HTML tags from text\n  const stripHtmlTags = useMemo(() => {\n    // Return a function that uses a single cached div for performance\n    if (typeof document === 'undefined') return (html: string) => html.replace(/<[^>]*>/g, '').trim();\n    const tmp = document.createElement('div');\n    return (html: string): string => {\n      if (!html) return '';\n      tmp.innerHTML = html;\n      return (tmp.textContent || tmp.innerText || '').trim();\n    };\n  }, []);\n\n  const mapRequirementStatus = (status: string): 'in-progress' | 'completed' | 'delayed' | 'draft' => {\n    const statusLower = status?.toLowerCase() || '';\n    if (statusLower.includes('completed') || statusLower === 'done') return 'completed';\n    if (statusLower.includes('delayed')) return 'delayed';\n    if (statusLower.includes('draft')) return 'draft';\n    return 'in-progress';\n  };\n\n  const allRequirements = useMemo(() => {\n    const combined: Requirement[] = [];\n\n    requirementQueries.forEach((query, index) => {\n      const workspaceIdFromQuery = workspaceIds[index];\n      if (query.data?.result && workspaceIdFromQuery) {\n        const requirementsWithWorkspace = query.data.result.map((req: any) => ({\n          ...req,\n          workspace_id: req.workspace_id ?? workspaceIdFromQuery,\n        }));\n        combined.push(...requirementsWithWorkspace);\n      }\n    });\n\n    // Add collaborative requirements (avoid duplicates if possible)\n    if (collaborativeData?.result) {\n      collaborativeData.result.forEach((collab: any) => {\n        if (!combined.some(req => req.id === collab.id)) {\n          combined.push(collab as Requirement);\n        }\n      });\n    }\n\n    return combined;\n  }, [requirementQueries.map(q => q.data), workspaceIds, collaborativeData]);\n\n  // Create a map of workspace ID to workspace data for client/company lookup\n  // Workspace API returns: { client: {id, name}, client_company_name, company_name }\n  const workspaceMap = useMemo(() => {\n    const map = new Map<number, Workspace>(); // using simplified type for now\n    workspacesData?.result?.workspaces?.forEach((w: any) => {\n      map.set(w.id, w);\n    });\n    return map;\n  }, [workspacesData]);\n\n  // Transform backend data to UI format with placeholder/mock data where API data is not available\n  const requirements = useMemo(() => {\n    const mappedData = allRequirements.map((req: Requirement) => {\n      // Get workspace data for this requirement to access client/company information\n      // NOTE: The requirement API (getRequirements.sql) doesn't include project/client data\n      // It only returns: requirement fields, department, manager, leader, created_user, approved_by\n      // So we must get client/company from the workspace data we already fetched\n      // Determine which workspace to show\n      // If I am the receiver (Vendor) and I have mapped this to an internal project (receiver_project_id),\n      // I should see MY internal workspace, not the client's source workspace.\n      const myCompanyId = currentUser?.company_id ? Number(currentUser.company_id) : null;\n      const reqReceiverCompanyId = req.receiver_company_id ? Number(req.receiver_company_id) : null;\n      const reqSenderCompanyId = req.sender_company_id ? Number(req.sender_company_id) : null;\n      const isReceiver = myCompanyId !== null && reqReceiverCompanyId === myCompanyId;\n      const isSender = myCompanyId !== null && reqSenderCompanyId === myCompanyId;\n      \n      const effectiveWorkspaceId = (isReceiver && req.receiver_workspace_id) \n        ? req.receiver_workspace_id \n        : req.workspace_id;\n        \n      const workspace = workspaceMap.get(effectiveWorkspaceId || 0);\n\n      // PLACEHOLDER DATA: Invoice status - not directly available in requirement API\n      // In real implementation, this would come from a separate invoice API or join query\n      const mockInvoiceStatus = req.invoice_id\n        ? (req.invoice?.status === 'paid' ? 'paid' : req.invoice?.status === 'open' ? 'billed' : undefined)\n        : undefined;\n\n      // Contact Person: Use the name from the joined user record (or placeholder if missing)\n      const contactPersonName = req.contact_person?.name || null;\n      const mockContactPerson = req.type === 'outsourced' && !contactPersonName\n        ? 'External Vendor' \n        : contactPersonName;\n\n      // PLACEHOLDER DATA: Pricing model - infer from available data if not explicitly set\n      const mockPricingModel = req.pricingModel || (req.hourlyRate ? 'hourly' : 'project');\n\n      // PLACEHOLDER DATA: Rejection reason - may not be stored in requirement table\n      const mockRejectionReason = req.status?.toLowerCase().includes('rejected') && !req.rejectionReason\n        ? 'Requirement was rejected during review process' // Placeholder - would need separate field or table\n        : req.rejectionReason;\n\n      // Get client name from workspace data\n      // Workspace API structure: { client: {id, name}, client_company_name: string, company_name: string }\n      // Match the pattern used in WorkspacePage.tsx line 85\n      const clientName = workspace?.client?.name || workspace?.client_company_name || null;\n\n      // Get company name from workspace data (agency/company name)\n      const companyName = workspace?.company_name || 'Internal';\n\n      // Department: Only use actual department name if it exists, don't default to 'General'\n      // The old frontend (Requirements.tsx line 772) only shows department tag if record.department?.name exists\n      const departmentName = req.department?.name || null;\n\n      // Determine roles - STRICT checks with type coercion for safety\n      // A is Sender: sender_company_id matches current user's company\n      // B is Receiver: receiver_company_id matches current user's company\n\n      \n      // For outsourced requirements:\n      // - Sender sees: OUTSOURCED badge, shows Receiver's name/company\n      // - Receiver sees: INHOUSE badge, shows Sender's name/company\n      \n      // Header Contact: Who is on the OTHER end of this requirement?\n      // - If I'm Sender (A): Show Receiver's contact (contact_person / receiver)\n      // - If I'm Receiver (B): Show Sender's name (created_user_data / created_user / sender)\n      let headerContact: string;\n      let headerCompany: string | undefined;\n      \n      if (req.type === 'outsourced') {\n        if (isSender) {\n          // Sender views: Show receiver info\n          headerContact = req.contact_person?.name || 'Unknown Vendor';\n          headerCompany = req.receiver_company?.name || 'Unknown Vendor Company';\n        } else if (isReceiver) {\n          // Receiver views: Show sender info\n          headerContact = req.created_user_data?.name || req.created_user?.name || 'Unknown Client';\n          headerCompany = req.sender_company?.name || 'Unknown Client Company';\n        } else {\n          // Not directly involved (shouldn't happen for outsourced)\n          headerContact = 'Unknown';\n          headerCompany = undefined;\n        }\n      } else {\n        // Inhouse requirements - use client/default\n        headerContact = clientName || 'Unknown Contact';\n        headerCompany = undefined;\n      }\n\n      const mappedReq = {\n        id: req.id,\n        title: req.title || (req as any).name || 'Untitled Requirement',\n        description: stripHtmlTags(req.description || 'No description provided'),\n        company: companyName,\n        client: clientName || (workspace ? 'N/A' : 'N/A'),\n        assignedTo: req.manager ? [req.manager.name] : req.leader ? [req.leader.name] : [],\n        dueDate: req.end_date ? format(new Date(req.end_date), 'dd-MMM-yyyy') : 'TBD',\n        startDate: req.start_date ? format(new Date(req.start_date), 'dd-MMM-yyyy') : undefined,\n        createdDate: req.start_date ? format(new Date(req.start_date), 'dd-MMM-yyyy') : 'TBD',\n        is_high_priority: req.is_high_priority ?? false,\n        type: (req.type || 'inhouse') as 'inhouse' | 'outsourced' | 'client',\n        status: mapRequirementStatus(req.status),\n        category: departmentName || null,\n        departments: departmentName ? [departmentName] : [],\n        progress: req.progress || 0,\n        tasksCompleted: req.total_tasks ? Math.floor(req.total_tasks * (req.progress || 0) / 100) : 0,\n        tasksTotal: req.total_tasks || 0,\n        workspaceId: req.workspace_id,\n        workspace: workspace?.name || 'Unknown Workspace',\n        approvalStatus: (req.approved_by?.id ? 'approved' :\n          ((req.status as any) === 'Waiting' || (req.status as any) === 'Review' || (req.status as any) === 'Rejected' || req.status?.toLowerCase() === 'review' || req.status?.toLowerCase() === 'waiting' || req.status?.toLowerCase() === 'rejected' || req.status?.toLowerCase().includes('pending')) ? 'pending' :\n            undefined\n        ) as 'pending' | 'approved' | 'rejected' | undefined,\n        invoiceStatus: mockInvoiceStatus as 'paid' | 'billed' | undefined,\n        estimatedCost: req.estimatedCost || (req.budget || undefined),\n        budget: req.budget || undefined,\n        quotedPrice: req.quotedPrice || undefined, // Add quoted_price for vendor quotes\n        hourlyRate: req.hourlyRate || undefined,\n        estimatedHours: req.estimatedHours || undefined,\n        pricingModel: mockPricingModel as 'hourly' | 'project' | undefined,\n        contactPerson: mockContactPerson,\n        rejectionReason: mockRejectionReason,\n        headerContact,\n        headerCompany,\n        isReceiver,\n        isSender,\n        rawStatus: req.status,\n        sender_company_id: req.sender_company_id,\n        receiver_company_id: req.receiver_company_id,\n        receiver_workspace_id: req.receiver_workspace_id,\n        receiver_project_id: req.receiver_workspace_id, // Backward compat if needed, but safer to rely on new field\n        negotiation_reason: req.negotiation_reason,\n      };\n\n\n      console.log('RequirementDebug:', {\n        reqId: req.id,\n        rawType: req.type,\n        rawStatus: req.status,\n        myCompanyId,\n\n        reqSenderCompanyId,\n        reqReceiverCompanyId,\n        isSender,\n        isReceiver,\n        headerContact,\n        headerCompany,\n        // Raw data from backend\n        rawContactPerson: req.contact_person,\n        rawCreatedUser: req.created_user,\n        rawCreatedUserData: req.created_user_data,\n        rawSenderCompany: req.sender_company,\n        rawReceiverCompany: req.receiver_company,\n      });\n\n      return mappedReq;\n\n    });\n    return mappedData;\n\n  }, [allRequirements, workspaceMap, currentUser]);\n\n  // Read tab from URL params\n  const searchParams = useSearchParams();\n  const tabFromUrl = searchParams.get('tab');\n  const initialTab = (tabFromUrl === 'draft' || tabFromUrl === 'pending' || tabFromUrl === 'active' || tabFromUrl === 'completed' || tabFromUrl === 'delayed')\n    ? tabFromUrl\n    : 'active';\n  const [activeStatusTab, setActiveStatusTab] = useState<string>(initialTab);\n\n  // Update tab when URL changes\n  useEffect(() => {\n    const tabFromUrl = searchParams.get('tab');\n    if (tabFromUrl === 'draft' || tabFromUrl === 'pending' || tabFromUrl === 'active' || tabFromUrl === 'completed' || tabFromUrl === 'delayed') {\n      setActiveStatusTab(tabFromUrl);\n    } else if (tabFromUrl === null) {\n      setActiveStatusTab('active');\n    }\n  }, [searchParams]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedReqs, setSelectedReqs] = useState<number[]>([]);\n\n  // Date Picker State\n  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\n\n  // Quotation Dialog State\n  const [isQuotationOpen, setIsQuotationOpen] = useState(false);\n  const [isRejectOpen, setIsRejectOpen] = useState(false);\n  const [isMappingOpen, setIsMappingOpen] = useState(false);\n  const [pendingReqId, setPendingReqId] = useState<number | null>(null);\n\n  const [filters, setFilters] = useState<Record<string, string>>({\n    type: 'All',\n    billing: 'All',\n    category: 'All',\n    priority: 'All',\n\n    client: 'All',\n    assignee: 'All'\n  });\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingReq, setEditingReq] = useState<Requirement | undefined>(undefined);\n\n  const handleOpenCreate = () => {\n    setEditingReq(undefined);\n    setIsDialogOpen(true);\n  };\n\n  const handleEditDraft = (req: Requirement) => {\n    setEditingReq(req);\n\n    setIsDialogOpen(true);\n  };\n\n  const handleQuotationConfirm = (data: { cost?: number; rate?: number; hours?: number }) => {\n    const amount = data.cost || 0;\n    const hours = data.hours || 0;\n    // Determine the ID: editingReq for basic edits, or pendingReqId for workflow actions\n    const reqId = pendingReqId;\n    if (!reqId) {\n      return;\n    }\n\n    // Call mutation to update requirement with quote\n    updateRequirementMutation.mutate({\n      id: reqId,\n      project_id: requirements.find(r => r.id === reqId)?.workspaceId || 0,\n      quote_workspace_id: requirements.find(r => r.id === reqId)?.workspaceId || 0,\n      // We only update specific fields for quotation\n      quoted_price: amount,\n      estimated_hours: hours,\n      status: 'Review' // Or PENDING_CLIENT_APPROVAL as per design, using Review as proxy\n    } as unknown as any, {\n      onSuccess: () => {\n        messageApi.success(\"Quotation submitted successfully\");\n        setIsQuotationOpen(false);\n        setPendingReqId(null);\n      },\n      onError: (err: Error) => {\n        messageApi.error(err?.message || \"Failed to submit quotation\");\n      }\n    });\n  };\n\n  const handleRejectConfirm = (reason: string) => {\n    const reqId = pendingReqId;\n    if (!reqId) return;\n\n    updateRequirementMutation.mutate({\n      id: reqId,\n      workspace_id: requirements.find(r => r.id === reqId)?.workspaceId || 0,\n      status: 'Rejected',\n      rejection_reason: reason\n    } as unknown as any, {\n      onSuccess: () => {\n        messageApi.success(\"Requirement rejected\");\n        setIsRejectOpen(false);\n        setPendingReqId(null);\n      }\n    });\n  };\n\n  const handleCreateRequirement = (data: RequirementFormData) => {\n    if (!data.title) {\n      messageApi.error(\"Requirement title is required\");\n      return;\n    }\n    if (!data.workspace) {\n      messageApi.error(\"Please select a workspace\");\n      return;\n    }\n\n    console.log('handleCreateRequirement DEBUG:', {\n      type: data.type,\n      contact_person_id: data.contact_person_id,\n      receiver_company_id: data.receiver_company_id,\n      // priority: data.priority, // removed\n      // project_id: data.project_id, // removed\n    });\n\n    createRequirementMutation.mutate({\n      workspace_id: Number(data.workspace),\n      project_id: Number(data.workspace),\n      name: data.title,\n      description: data.description || '',\n      start_date: new Date().toISOString(),\n      end_date: data.dueDate ? new Date(data.dueDate).toISOString() : undefined,\n      // Status is determined by backend based on type (outsourced=Waiting, etc.)\n      is_high_priority: data.is_high_priority,\n\n      type: data.type,\n      budget: Number(data.budget) || 0,\n      contact_person_id: data.contact_person_id,\n      contact_person: data.contactPerson,\n      receiver_company_id: data.receiver_company_id, // Pass the receiver company ID\n    } as unknown as any, {\n      onSuccess: () => {\n        messageApi.success(\"Requirement created successfully\");\n        setIsDialogOpen(false);\n      },\n      onError: (error: any) => {\n        // Keeping error as any for now as AxiosError typing can be verbose to import\n        messageApi.error(error?.response?.data?.message || \"Failed to create requirement\");\n      }\n    });\n\n  };\n\n  const handleUpdateRequirement = (data: RequirementFormData) => {\n    if (!editingReq) return;\n\n    updateRequirementMutation.mutate({\n      requirement_id: editingReq.id,\n      name: data.title,\n      description: data.description || '',\n      workspace_id: Number(data.workspace),\n      project_id: Number(data.workspace),\n      is_high_priority: data.is_high_priority,\n      start_date: editingReq.startDate,\n      end_date: data.dueDate ? new Date(data.dueDate).toISOString() : undefined,\n      type: data.type,\n      budget: Number(data.budget) || 0,\n      contact_person_id: data.contact_person_id,\n      contact_person: data.contactPerson,\n      receiver_company_id: data.receiver_company_id, // Pass the receiver company ID\n    } as unknown as any, {\n      onSuccess: () => {\n        messageApi.success(\"Requirement updated successfully\");\n        setIsDialogOpen(false);\n        setEditingReq(undefined);\n      },\n      onError: (error: any) => {\n        messageApi.error(error?.response?.data?.message || \"Failed to update requirement\");\n      }\n    });\n  };\n\n\n\n  // Filter Logic:\n  // 1. First apply all filters EXCEPT the Status Tab\n  const baseFilteredReqs = requirements.filter(req => {\n    // Type\n    const typeMatch = filters.type === 'All' ||\n      (filters.type === 'In-house' && req.type === 'inhouse') ||\n      (filters.type === 'Outsourced' && req.type === 'outsourced') ||\n      (filters.type === 'Client Work' && req.type === 'client');\n\n    // Billing Status\n    let billingMatch = true;\n    if (filters.billing !== 'All') {\n      if (filters.billing === 'Paid') {\n        billingMatch = req.invoiceStatus === 'paid';\n      } else if (filters.billing === 'Invoiced') {\n        billingMatch = req.invoiceStatus === 'billed';\n      } else if (filters.billing === 'Ready to Bill') {\n        billingMatch = req.status === 'completed' && !req.invoiceStatus;\n      }\n    }\n\n    // Priority\n    const priorityMatch = filters.priority === 'All' || \n      (filters.priority === 'High Priority' && req.is_high_priority) ||\n      (filters.priority === 'Normal Priority' && !req.is_high_priority);\n\n    // Client\n    const clientMatch = filters.client === 'All' || req.client === filters.client;\n\n    // Search\n    const searchMatch = searchQuery === '' ||\n      req.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      req.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (req.company || '').toLowerCase().includes(searchQuery.toLowerCase()) ||\n      req.client.toLowerCase().includes(searchQuery.toLowerCase());\n\n    // Category - match if filter is 'All' or if requirement has the selected department\n    const categoryMatch = filters.category === 'All' ||\n      (filters.category && req.departments && req.departments.length > 0 && req.departments.includes(filters.category));\n\n    // Assignee\n    const assigneeMatch = filters.assignee === 'All' || (req.assignedTo && req.assignedTo.includes(filters.assignee));\n\n    // Date Range Filter\n    let dateMatch = true;\n    if (dateRange && dateRange[0] && dateRange[1] && req.dueDate && req.dueDate !== 'TBD') {\n      try {\n        const due = new Date(req.dueDate);\n        const from = dateRange[0].toDate();\n        const to = dateRange[1].toDate();\n        dateMatch = due >= from && due <= to;\n      } catch {\n        dateMatch = true;\n      }\n    }\n\n    return typeMatch && billingMatch && priorityMatch && clientMatch && searchMatch && dateMatch && categoryMatch && assigneeMatch;\n  });\n\n  // 2. Apply Status Tab filter\n  const finalFilteredReqs = baseFilteredReqs.filter(req => {\n    // Draft Tab: Normal drafts\n    if (activeStatusTab === 'draft') {\n      if (req.status === 'draft') return true;\n      return false;\n    }\n\n    // Pending Tab: Waiting/Review status for either side\n    if (activeStatusTab === 'pending') {\n      const isPendingWorkflow = req.rawStatus === 'Waiting' || (req.rawStatus as any) === 'Review';\n      return isPendingWorkflow || req.approvalStatus === 'pending';\n    }\n\n    // Active Tab: Assigned status (and not review/waiting), excluding delayed\n    if (activeStatusTab === 'active') {\n      const isActiveState = ((req.rawStatus as any) === 'Assigned' || req.status === 'in-progress') && req.status !== 'delayed';\n      const isPendingWorkflow = req.rawStatus === 'Waiting' || (req.rawStatus as any) === 'Review';\n      return isActiveState && !isPendingWorkflow && req.approvalStatus !== 'pending';\n    }\n\n    // Delayed Tab\n    if (activeStatusTab === 'delayed') {\n      return req.status === 'delayed';\n    }\n\n    // Completed Tab\n    if (activeStatusTab === 'completed') return req.status === 'completed';\n\n    return true;\n  });\n\n  // Get unique clients for filter options\n  const allClients = ['All', ...Array.from(new Set(requirements.map(r => r.client).filter(Boolean)))];\n  const priorities = ['All', 'High Priority', 'Normal Priority'];\n\n  // Get unique departments/categories - only include actual department names from requirements\n  const allCategories = useMemo(() => {\n    const depts = Array.from(new Set(requirements.flatMap(r => r.departments || []).filter(Boolean)));\n    // Return 'All' plus actual department names (no 'General' placeholder)\n    return ['All', ...depts];\n  }, [requirements]);\n\n  // Get unique assignees - add placeholder if no assignees available\n  // PLACEHOLDER DATA: If no assignees exist, show \"Unassigned\" option\n  const allAssignees = useMemo(() => {\n    const assignees = Array.from(new Set(requirements.flatMap(r => r.assignedTo || [])));\n    // Add placeholder if no assignees found\n    if (assignees.length === 0) {\n      return ['All', 'Unassigned'];\n    }\n    return ['All', ...assignees];\n  }, [requirements]);\n\n  const filterOptions: FilterOption[] = [\n    { id: 'type', label: 'Type', options: ['All', 'In-house', 'Outsourced', 'Client Work'], placeholder: 'Type' },\n    { id: 'priority', label: 'Priority', options: priorities, placeholder: 'Priority' },\n    { id: 'client', label: 'Client', options: allClients, placeholder: 'Client' },\n    { id: 'category', label: 'Department', options: allCategories, placeholder: 'Department' },\n    { id: 'assignee', label: 'Assigned To', options: allAssignees, placeholder: 'Assignee' },\n    // Only show Billing filter when on Completed tab - moved to last position to prevent layout shift\n    ...(activeStatusTab === 'completed' ? [{ id: 'billing', label: 'Billing', options: ['All', 'Ready to Bill', 'Invoiced', 'Paid'], placeholder: 'Billing Status' }] : [])\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n    setCurrentPage(1);\n  };\n\n  const clearFilters = () => {\n    setFilters({\n      type: 'All',\n      billing: 'All',\n      priority: 'All',\n      client: 'All',\n      category: 'All',\n      assignee: 'All'\n    });\n    setSearchQuery('');\n    setDateRange(null);\n    setCurrentPage(1);\n  };\n\n  const toggleSelect = (id: number) => {\n    if (selectedReqs.includes(id)) {\n      setSelectedReqs(selectedReqs.filter(reqId => reqId !== id));\n    } else {\n      setSelectedReqs([...selectedReqs, id]);\n    }\n  };\n\n  const handleBulkDelete = async () => {\n    try {\n      const deletePromises = selectedReqs.map(id => {\n        const req = requirements.find(r => r.id === id);\n        if (!req) return Promise.resolve();\n        return deleteRequirementMutation.mutateAsync({ id, workspace_id: req.workspaceId || 0 });\n      });\n      await Promise.all(deletePromises);\n      messageApi.success(`Deleted ${selectedReqs.length} requirement(s)`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to delete requirements\");\n    }\n  };\n\n  const handleBulkComplete = async () => {\n    try {\n      const updatePromises = selectedReqs.map(id => {\n        const req = requirements.find(r => r.id === id);\n        if (!req) return Promise.resolve();\n        return updateRequirementMutation.mutateAsync({\n          id,\n          workspace_id: req.workspaceId,\n          status: 'Completed',\n        } as any);\n      });\n      await Promise.all(updatePromises);\n      messageApi.success(`Marked ${selectedReqs.length} requirement(s) as completed`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to update requirements\");\n    }\n  };\n\n  const handleBulkApprove = async () => {\n    try {\n      const approvePromises = selectedReqs.map(id =>\n        approveRequirementMutation.mutateAsync({ requirement_id: id, status: \"Assigned\" })\n      );\n      await Promise.all(approvePromises);\n      messageApi.success(`Approved ${selectedReqs.length} requirement(s)`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to approve requirements\");\n    }\n  };\n\n  const handleBulkReject = async () => {\n    try {\n      const rejectPromises = selectedReqs.map(id =>\n        approveRequirementMutation.mutateAsync({ requirement_id: id, status: \"Rejected\" })\n      );\n      await Promise.all(rejectPromises);\n      messageApi.success(`Rejected ${selectedReqs.length} requirement(s)`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to reject requirements\");\n    }\n  };\n\n  const handleBulkSubmit = async () => {\n    try {\n      // Submit for approval by updating status to pending\n      const updatePromises = selectedReqs.map(id => {\n        const req = requirements.find(r => r.id === id);\n        if (!req) return Promise.resolve();\n        return updateRequirementMutation.mutateAsync({\n          id,\n          workspace_id: req.workspaceId,\n          status: 'Assigned', // This will trigger pending approval\n        } as any);\n      });\n      await Promise.all(updatePromises);\n      messageApi.success(`Submitted ${selectedReqs.length} requirement(s) for approval`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to submit requirements\");\n    }\n  };\n\n  const handleBulkReopen = async () => {\n    try {\n      const updatePromises = selectedReqs.map(id => {\n        const req = requirements.find(r => r.id === id);\n        if (!req) return Promise.resolve();\n        return updateRequirementMutation.mutateAsync({\n          id,\n          workspace_id: req.workspaceId,\n          status: 'Assigned', // Reopen by setting back to assigned/in-progress\n        } as any);\n      });\n      await Promise.all(updatePromises);\n      messageApi.success(`Reopened ${selectedReqs.length} requirement(s)`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to reopen requirements\");\n    }\n  };\n\n  const handleBulkAssign = async (employee: any) => {\n    try {\n      const updatePromises = selectedReqs.map(id => {\n        const req = requirements.find(r => r.id === id);\n        if (!req) return Promise.resolve();\n\n        const leaderId = employee?.user_id || employee?.id;\n        if (!leaderId) return Promise.resolve();\n\n        return updateRequirementMutation.mutateAsync({\n          id,\n          workspace_id: req.workspaceId,\n          leader_id: leaderId,\n        } as any);\n      });\n      await Promise.all(updatePromises);\n      messageApi.success(`Assigned ${employee?.name || 'selected user'} to ${selectedReqs.length} requirement(s)`);\n      setSelectedReqs([]);\n    } catch (error: any) {\n      messageApi.error(error?.response?.data?.message || \"Failed to assign requirements\");\n    }\n  };\n\n  const handleReqAccept = (id: number) => {\n    setPendingReqId(id);\n    setIsQuotationOpen(true);\n  };\n\n  const handleReqReject = (id: number) => {\n    setPendingReqId(id);\n    setIsRejectOpen(true);\n  };\n\n\n\n  // Tabs Configuration\n  const tabs = [\n    {\n      id: 'active', label: 'Active'\n    },\n    {\n      id: 'pending', label: 'Pending', count: baseFilteredReqs.filter(req => {\n        const isPendingWorkflow = req.rawStatus === 'Waiting' || (req.rawStatus as string) === 'Review';\n        return isPendingWorkflow || req.approvalStatus === 'pending';\n      }).length\n    },\n    {\n      id: 'draft', label: 'Drafts', count: baseFilteredReqs.filter(req => {\n        if (req.status === 'draft') return true;\n        return false;\n      }).length\n    },\n    {\n      id: 'delayed', label: 'Delayed', count: baseFilteredReqs.filter(req => req.status === 'delayed').length\n    },\n    { id: 'completed', label: 'Completed' },\n  ];\n\n\n\n  return (\n    <PageLayout\n      title=\"Requirements\"\n      titleAction={{\n        onClick: handleOpenCreate\n      }}\n      tabs={tabs}\n      activeTab={activeStatusTab}\n      onTabChange={(tabId) => {\n        setActiveStatusTab(tabId);\n        const params = new URLSearchParams(searchParams.toString());\n        if (tabId === 'active') {\n          params.delete('tab');\n        } else {\n          params.set('tab', tabId);\n        }\n        router.push(`?${params.toString()}`);\n      }}\n      titleExtra={\n        <DateRangeSelector\n          value={dateRange}\n          onChange={setDateRange}\n          availablePresets={['this_week', 'this_month', 'last_month', 'this_year', 'all_time', 'custom']}\n        />\n      }\n    >\n      {/* Filters Bar */}\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={handleFilterChange}\n          onClearFilters={clearFilters}\n          searchPlaceholder=\"Search requirements...\"\n          searchValue={searchQuery}\n          onSearchChange={setSearchQuery}\n        />\n      </div>\n\n      <div className=\"flex-1 min-h-0 relative flex flex-col\">\n        <div className=\"flex-1 overflow-y-auto pb-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\n            {finalFilteredReqs.slice((currentPage - 1) * pageSize, (currentPage - 1) * pageSize + pageSize).map((requirement) => (\n              <RequirementCard\n                key={requirement.id}\n                requirement={requirement as any}\n                selected={selectedReqs.includes(requirement.id)}\n                onSelect={() => toggleSelect(requirement.id)}\n                onAccept={() => {\n                  console.log('onAccept Triggered', {\n                    id: requirement.id,\n                    type: requirement.type,\n                    isSender: requirement.isSender,\n                    rawStatus: requirement.rawStatus\n                  });\n                  const req = requirement;\n                  if (req.type === 'outsourced') {\n                    if (req.isReceiver) {\n                      const status = req.rawStatus?.toLowerCase();\n                      if (status === 'waiting' || status === 'rejected') {\n                        setPendingReqId(requirement.id);\n                        setIsQuotationOpen(true);\n                      } else if (status === 'assigned' && !req.receiver_workspace_id) {\n                        setPendingReqId(requirement.id);\n                        setIsMappingOpen(true);\n                      }\n                    } else if (req.isSender) {\n                      const status = req.rawStatus?.toLowerCase();\n                      if (status === 'review') {\n                        console.log('Attempting to approve requirement...', requirement.id);\n                        approveRequirementMutation.mutate({\n                          requirement_id: requirement.id,\n                          status: 'Assigned'\n                        });\n                      } else if (status === 'rejected') {\n                        handleEditDraft(requirement as any);\n                      }\n                    }\n                  } else {\n                    handleReqAccept(requirement.id)\n                  }\n                }}\n                onReject={() => {\n                  const req = requirement;\n                  if (req.type === 'outsourced') {\n                    setPendingReqId(requirement.id);\n                    setIsRejectOpen(true);\n                  } else {\n                    handleReqReject(requirement.id);\n                  }\n                }}\n                onEdit={() => handleEditDraft({\n                  ...requirement,\n                } as any)}\n                onNavigate={() =>\n                  router.push(`/dashboard/workspace/${requirement.workspaceId}/requirements/${requirement.id}`)\n                }\n              />\n            ))}\n          </div>\n\n          {finalFilteredReqs.length === 0 && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-[#999999] font-['Inter:Regular',sans-serif]\">\n                {isLoading ? \"Loading requirements...\" : \"No requirements found\"}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {finalFilteredReqs.length > 0 && (\n          <div className=\"bg-white\">\n            <PaginationBar\n              currentPage={currentPage}\n              totalItems={finalFilteredReqs.length}\n              pageSize={pageSize}\n              onPageChange={setCurrentPage}\n              onPageSizeChange={(size) => {\n                setPageSize(size);\n                setCurrentPage(1);\n              }}\n              itemLabel=\"requirements\"\n            />\n          </div>\n        )}\n\n        {/* Bulk Action Bar */}\n        {selectedReqs.length > 0 && (\n          <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 bg-[#111111] text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-6 z-50 animate-in slide-in-from-bottom-4 duration-200\">\n            <div className=\"flex items-center gap-2 border-r border-white/20 pr-6\">\n              <div className=\"bg-[#ff3b3b] text-white text-[12px] font-bold px-2 py-0.5 rounded-full\">\n                {selectedReqs.length}\n              </div>\n              <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif]\">Selected</span>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              {/* Context Aware Actions */}\n              {activeStatusTab === 'draft' && (\n                <Tooltip title=\"Submit for Approval\">\n                  <button onClick={handleBulkSubmit} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#4CAF50]\">\n                    <Play className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n              )}\n\n              {activeStatusTab === 'pending' && (\n                <>\n                  <Tooltip title=\"Approve\">\n                    <button onClick={handleBulkApprove} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#4CAF50]\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                    </button>\n                  </Tooltip>\n                  <Tooltip title=\"Reject\">\n                    <button onClick={handleBulkReject} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#ff3b3b]\">\n                      <XCircle className=\"w-4 h-4\" />\n                    </button>\n                  </Tooltip>\n                </>\n              )}\n\n              {activeStatusTab === 'active' && (\n                <Tooltip title=\"Mark as Completed\">\n                  <button onClick={handleBulkComplete} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#4CAF50]\">\n                    <CheckSquare className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n              )}\n\n              {activeStatusTab === 'completed' && (\n                <Tooltip title=\"Reopen\">\n                  <button onClick={handleBulkReopen} className=\"p-2 hover:bg-white/10 rounded-full transition-colors\">\n                    <RotateCcw className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n              )}\n\n              {/* Common Actions */}\n              <Popover\n                content={\n                  <div className=\"w-48\">\n                    {employeesData?.result && employeesData.result.length > 0 ? (\n                      employeesData.result.map((emp: any) => (\n                        <button\n                          key={String(emp.user_id || emp.id || '')}\n                          onClick={() => handleBulkAssign(emp)}\n                          className=\"w-full text-left px-3 py-2 text-[13px] hover:bg-gray-50 rounded\"\n                        >\n                          {emp.name}\n                        </button>\n                      ))\n                    ) : (\n                      <div className=\"px-3 py-2 text-[13px] text-[#999999]\">\n                        No employees available\n                      </div>\n                    )}\n                  </div>\n                }\n                trigger=\"click\"\n                placement=\"top\"\n              >\n                <Tooltip title=\"Assign To\">\n                  <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors\">\n                    <Users className=\"w-4 h-4\" />\n                  </button>\n                </Tooltip>\n              </Popover>\n\n              <Tooltip title=\"Delete Requirements\">\n                <button onClick={handleBulkDelete} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#ff3b3b]\">\n                  <Trash2 className=\"w-4 h-4\" />\n                </button>\n              </Tooltip>\n            </div>\n\n            <button onClick={() => setSelectedReqs([])} className=\"ml-2 text-[12px] text-[#999999] hover:text-white transition-colors\">\n              Cancel\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Create/Edit Requirement Modal - Using existing modal structure */}\n      <Modal\n        open={isDialogOpen}\n        onCancel={() => {\n          setIsDialogOpen(false);\n          setEditingReq(undefined);\n        }}\n        footer={null}\n        width={700}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        styles={{\n          body: {\n            padding: 0,\n            maxHeight: 'calc(100vh - 100px)',\n            display: 'flex',\n            flexDirection: 'column',\n          },\n        }}\n      >\n        <RequirementsForm\n          isEditing={!!editingReq}\n          initialData={editingReq ? {\n            title: editingReq.title,\n            workspace: String(editingReq.workspaceId),\n            type: editingReq.type === 'client' ? 'inhouse' : (editingReq.type || 'inhouse') as 'inhouse' | 'outsourced',\n            description: editingReq.description,\n            dueDate: editingReq.dueDate,\n            is_high_priority: editingReq.is_high_priority,\n            contactPerson: editingReq.contactPerson,\n            budget: String(editingReq.budget || ''),\n          } : undefined}\n          onSubmit={editingReq ? handleUpdateRequirement : handleCreateRequirement}\n          onCancel={() => {\n            setIsDialogOpen(false);\n            setEditingReq(undefined);\n          }}\n          workspaces={workspacesData?.result?.workspaces?.map((w: any) => ({ id: w.id, name: w.name })) || []}\n          isLoading={createRequirementMutation.isPending || updateRequirementMutation.isPending}\n        />\n      </Modal>\n\n      <QuotationDialog\n        open={isQuotationOpen}\n        onOpenChange={setIsQuotationOpen}\n        onConfirm={handleQuotationConfirm}\n        pricingModel={requirements.find(r => r.id === pendingReqId)?.pricingModel}\n      />\n      <RejectDialog\n        open={isRejectOpen}\n        onOpenChange={setIsRejectOpen}\n        onConfirm={handleRejectConfirm}\n      />\n      <InternalMappingModal\n        open={isMappingOpen}\n        onOpenChange={setIsMappingOpen}\n        onConfirm={(workspaceId) => {\n          if (!pendingReqId) return;\n          updateRequirementMutation.mutate({\n            id: pendingReqId,\n            workspace_id: allRequirements.find(r => r.id === pendingReqId)?.workspaceId || 0, // Required field\n            receiver_workspace_id: workspaceId,\n            status: 'In_Progress'\n          } as any, {\n            onSuccess: () => {\n              messageApi.success(\"Requirement mapped and activated!\");\n              setIsMappingOpen(false);\n              setPendingReqId(null);\n            }\n          });\n        }}\n        workspaces={workspacesData?.result?.workspaces?.map((w: any) => ({ id: w.id, name: w.name })) || []}\n      />\n    </PageLayout>\n  );\n}\n\nfunction RequirementCard({\n  requirement,\n  selected,\n  onSelect,\n  onAccept,\n  onReject,\n  onEdit,\n  onNavigate\n}: {\n  requirement: Requirement,\n  selected: boolean,\n  onSelect: () => void,\n  onAccept?: () => void,\n  onReject?: () => void,\n  onEdit?: () => void,\n  onNavigate?: () => void\n}) {\n  const isPending = useMemo(() => {\n    // Special case for Receiver Mapping (Post-Approval)\n    if (requirement.type === 'outsourced' && requirement.isReceiver) {\n       const s = requirement.rawStatus?.toLowerCase();\n       if (s === 'assigned' && !requirement.receiver_workspace_id) return true;\n    }\n\n    if (requirement.approvalStatus !== 'pending') return false;\n    \n    const status = requirement.rawStatus?.toLowerCase();\n    \n    if (requirement.type === 'outsourced') {\n      if (requirement.isSender) {\n         // Client acts only on 'review'\n         return status === 'review';\n      }\n      if (requirement.isReceiver) {\n         // Vendor acts on 'waiting' (new) or 'rejected' (resubmit)\n         return status === 'waiting' || status === 'rejected';\n      }\n    }\n    return true;\n  }, [requirement]);\n\n\n\n  const getUnifiedStatusConfig = () => {\n    // 1. Billing / Financial Status (Highest Priority)\n    if (requirement.invoiceStatus === 'paid') {\n      return {\n        label: requirement.type === 'outsourced' ? 'Payment Cleared' : 'Payment Received',\n        icon: <CheckCircle className=\"w-3 h-3\" />,\n        className: 'bg-[#E8F5E9] text-[#0F9D58] border-[#A5D6A7]',\n        onClick: null\n      };\n    }\n    if (requirement.invoiceStatus === 'billed') {\n      return {\n        label: requirement.type === 'outsourced' ? 'Invoice Received' : 'Invoice Sent',\n        icon: <CheckCircle className=\"w-3 h-3\" />,\n        className: 'bg-[#E3F2FD] text-[#2196F3] border-[#90CAF9]',\n        onClick: null\n      };\n    }\n\n    // 2. Pending Actions (Workflow)\n    if (requirement.approvalStatus === 'pending') {\n      // Determine label based on role and precise status\n      let label = 'Pending';\n      let isActionNeeded = false;\n\n      if (requirement.type === 'outsourced') {\n        if (requirement.isSender) {\n          // I am Client (Gaurav)\n          // Status 'Review' means Vendor (Jayendra) submitted quote -> Action Needed\n          if (requirement.rawStatus === 'Review' || requirement.rawStatus?.toLowerCase() === 'review') {\n             label = 'Action Needed'; // Vendor submitted quote, I need to approve\n             isActionNeeded = true;\n          } else {\n             label = 'Pending'; // Waiting for vendor (Waiting or Rejected)\n          }\n        } else if (requirement.isReceiver) {\n          // I am Vendor (Jayendra)\n          // Status 'Waiting' means Client created req -> Action Needed\n          // Status 'Rejected' means Client rejected quote -> Action Needed (Resubmit)\n          if (requirement.rawStatus === 'Waiting' || requirement.rawStatus?.toLowerCase() === 'waiting' || \n              requirement.rawStatus === 'Rejected' || requirement.rawStatus?.toLowerCase() === 'rejected') {\n             label = 'Action Needed'; // Need to submit/resubmit quote\n             isActionNeeded = true;\n          } else {\n             label = 'Pending'; // Waiting for client approval (Review)\n          }\n        }\n      }\n\n      if (isActionNeeded) {\n        return {\n          label: label,\n          icon: <AlertCircle className=\"w-3 h-3\" />,\n          className: 'bg-[#FEFCE8] text-[#D97706] border-[#FEF08A] cursor-pointer hover:bg-[#FEF08A]',\n          onClick: null\n        };\n      } else {\n        return {\n          label: label,\n          icon: <Clock className=\"w-3 h-3\" />,\n          className: 'bg-[#F3F4F6] text-[#6B7280] border-[#D1D5DB]',\n          onClick: null\n        };\n      }\n    }\n\n    // 3. Project Status\n    switch (requirement.status) {\n      case 'completed':\n        if (requirement.type === 'outsourced') {\n          return {\n            label: 'Invoice Received',\n            icon: <Receipt className=\"w-3 h-3\" />,\n            className: 'bg-[#F3E5F5] text-[#9C27B0] border-[#E1BEE7]',\n            onClick: null\n          };\n        }\n        return {\n          label: 'Ready to Bill',\n          icon: <Receipt className=\"w-3 h-3\" />,\n          className: 'bg-[#FFF3E0] text-[#EF6C00] border-[#FFE0B2] cursor-pointer hover:bg-[#FFE0B2]',\n          onClick: (e: React.MouseEvent) => {\n            e.stopPropagation();\n            // Navigate to invoices\n          }\n        };\n      case 'in-progress':\n        return {\n          label: 'In Progress',\n          icon: <Clock className=\"w-3 h-3\" />,\n          className: 'bg-[#E3F2FD] text-[#2F80ED] border-[#90CAF9]',\n          onClick: null\n        };\n      case 'delayed':\n        return {\n          label: 'Delayed',\n          icon: <Clock className=\"w-3 h-3\" />,\n          className: 'bg-[#FEE2E2] text-[#EB5757] border-[#FCA5A5]',\n          onClick: null\n        };\n      case 'draft':\n        return {\n          label: 'Draft',\n          icon: <FilePlus className=\"w-3 h-3\" />,\n          className: 'bg-[#F3F4F6] text-[#666666] border-[#D1D5DB]',\n          onClick: null\n        };\n      default:\n        return {\n          label: 'To Do',\n          icon: <Clock className=\"w-3 h-3\" />,\n          className: 'bg-[#F3F4F6] text-[#6B7280] border-[#D1D5DB]',\n          onClick: null\n        };\n    }\n  };\n\n  const statusConfig = getUnifiedStatusConfig();\n\n  const handleApproveClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onAccept?.();\n  };\n\n  const handleRejectClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onReject?.();\n  };\n\n  const handleEditClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onEdit?.();\n  };\n\n  const getTimelineStatus = (dueDate?: string) => {\n    if (!dueDate || dueDate === 'TBD') return null;\n    try {\n      const due = new Date(dueDate);\n      if (isPast(due) && !isToday(due)) {\n        const daysOverdue = differenceInDays(new Date(), due);\n        return { text: `Overdue by ${daysOverdue} days`, color: 'text-[#DC2626]' };\n      }\n      if (isToday(due)) return { text: 'Deadline today', color: 'text-[#F59E0B]' };\n      const daysLeft = differenceInDays(due, new Date());\n      return { text: `${daysLeft} days to deadline`, color: 'text-[#666666]' };\n    } catch {\n      return null;\n    }\n  };\n\n  const timelineStatus = getTimelineStatus(requirement.dueDate);\n\n  const getPendingStatusText = () => {\n    if (requirement.type === 'outsourced') {\n      if (requirement.rawStatus === 'Waiting') {\n        return requirement.isReceiver ? 'New outsourced requirement. Needs a quote.' : 'Awaiting quote from vendor...';\n      }\n      if (requirement.rawStatus === 'Review') {\n        return requirement.isSender ? 'Vendor submitted quote. Needs review.' : 'Quote submitted. Awaiting client decision...';\n      }\n      if (requirement.rawStatus === 'Rejected' && requirement.isSender) {\n        return 'Requirement declined by vendor. Please review and resubmit.';\n      }\n      return `Collaborative interaction pending...`;\n    }\n    if (requirement.type === 'client') {\n      return `Client Request. Awaiting review...`;\n    }\n    return 'Waiting for approval...';\n  };\n\n  const getApproveButtonText = () => {\n    if (requirement.type === 'outsourced') {\n      if (requirement.isReceiver) {\n        if (requirement.rawStatus === 'Waiting' || requirement.rawStatus?.toLowerCase() === 'waiting') return 'Submit Quote';\n        if (requirement.rawStatus === 'Rejected' || requirement.rawStatus?.toLowerCase() === 'rejected') return 'Resubmit Quote';\n        if (requirement.rawStatus === 'Assigned' && !requirement.receiver_workspace_id) return 'Map Workspace';\n        return 'Action Needed';\n      }\n      if (requirement.isSender) {\n        if (requirement.rawStatus === 'Review') return 'Accept Quote';\n        if (requirement.rawStatus === 'Rejected') return 'Edit & Resubmit';\n        return 'Action Needed';\n      }\n      return 'Pending';\n    }\n    if (requirement.type === 'client') return 'Accept Job';\n    return 'Approve';\n  };\n\n  const getCostDisplay = () => {\n    // Priority: quotedPrice (vendor quote) > estimatedCost > budget\n    if (requirement.quotedPrice) {\n      return `$${requirement.quotedPrice.toLocaleString()}`;\n    }\n    if (requirement.estimatedCost) {\n      return `$${requirement.estimatedCost.toLocaleString()}`;\n    }\n    if (requirement.budget) {\n      return `$${requirement.budget.toLocaleString()}`;\n    }\n    return null;\n  };\n\n\n  const costDisplay = getCostDisplay();\n\n  return (\n    <div\n      onClick={onNavigate}\n      className={`\n        group border rounded-[20px] p-5 hover:border-[#ff3b3b]/20 hover:shadow-lg transition-all duration-300 cursor-pointer flex flex-col relative\n        ${selected\n          ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n          : isPending\n            ? 'border-dashed border-[#E5E7EB] bg-[#F9FAFB]'\n            : 'border-[#EEEEEE] bg-white'\n        }\n`}\n    >\n      {/* Top Right Controls: Checkbox & More Options */}\n      <div className=\"absolute top-4 right-4 z-20 flex items-center gap-2\" onClick={(e) => e.stopPropagation()}>\n        {/* Checkbox (Visible on hover or selected) */}\n        <div className={`transition-opacity duration-200 ${selected ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'} `} onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            checked={selected}\n            onChange={() => onSelect()}\n            onClick={(e) => e.stopPropagation()}\n            className=\"red-checkbox\"\n          />\n        </div>\n\n        {/* More Options Menu */}\n        <Popover\n          content={\n            <div className=\"w-40\">\n              <button onClick={handleEditClick} className=\"w-full text-left px-3 py-2 text-[13px] hover:bg-gray-50 rounded\">\n                Edit Details\n              </button>\n              <button className=\"w-full text-left px-3 py-2 text-[13px] hover:bg-gray-50 rounded\">\n                Duplicate\n              </button>\n              <button className=\"w-full text-left px-3 py-2 text-[13px] text-[#ff3b3b] hover:bg-gray-50 rounded\">\n                Delete\n              </button>\n            </div>\n          }\n          trigger=\"click\"\n          placement=\"bottomRight\"\n        >\n          <button className={`h-6 w-6 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] text-[#999999] hover:text-[#111111] transition-all ${selected ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'} `}>\n            <MoreHorizontal className=\"w-4 h-4\" />\n          </button>\n        </Popover>\n      </div>\n\n      {/* Header */}\n      <div className=\"mb-3\">\n        {/* Context Row: Badge | Contact | Company */}\n        <div className=\"flex items-center gap-1.5 mb-2.5 flex-wrap\">\n          {/* Badge */}\n          <span className=\"px-1.5 py-0.5 rounded text-[9px] font-['Inter:Medium',sans-serif] bg-[#F5F5F5] text-[#666666] uppercase border border-[#EEEEEE]\">\n            {requirement.isSender && requirement.type === 'outsourced' ? 'OUTSOURCED' : 'INHOUSE'}\n          </span>\n\n          {/* Separator */}\n          <span className=\"text-[#EEEEEE]\">|</span>\n\n          {/* Contact Person */}\n          <span className=\"text-[10px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n            {requirement.headerContact}\n          </span>\n\n          {/* Company Name (only if exists) */}\n          {requirement.headerCompany && (\n            <>\n              {/* Separator */}\n              <span className=\"text-[#EEEEEE]\">|</span>\n\n              <span className=\"text-[10px] font-['Manrope:Medium',sans-serif] text-[#999999] uppercase\">\n                {requirement.headerCompany}\n              </span>\n            </>\n          )}\n        </div>\n\n        {/* Title */}\n        <div className=\"flex justify-between items-start gap-2 pr-16\">\n          <h3 className=\"font-['Manrope:Bold',sans-serif] text-[15px] leading-snug text-[#111111] group-hover:text-[#ff3b3b] transition-colors line-clamp-2\">\n            {requirement.title}\n          </h3>\n        </div>\n      </div>\n\n      {/* Tags - Only show if department exists (not empty array) */}\n      {requirement.departments && requirement.departments.length > 0 && (\n        <div className=\"flex flex-wrap gap-1.5 mb-4\">\n          {requirement.departments.slice(0, 3).map((dept, i) => (\n            <span key={i} className=\"px-1.5 py-0.5 rounded-md bg-white border border-[#E5E5E5] text-[10px] text-[#666666] font-['Inter:Medium',sans-serif]\">\n              {dept}\n            </span>\n          ))}\n          {requirement.departments.length > 3 && (\n            <span className=\"px-1.5 py-0.5 text-[10px] text-[#999999]\">+{requirement.departments.length - 3}</span>\n          )}\n        </div>\n      )}\n\n      {/* Date & Description */}\n      <div className=\"mb-4\">\n        {(requirement.startDate || requirement.dueDate) && requirement.dueDate !== 'TBD' && (\n          <div className=\"flex items-center gap-2 text-[11px] text-[#666666] font-['Inter:Medium',sans-serif] mb-2 bg-[#F9FAFB] p-1.5 rounded-md w-fit\">\n            <CalendarIcon className=\"w-3 h-3 text-[#999999]\" />\n            <span>\n              {requirement.startDate ? format(new Date(requirement.startDate), 'MMM d') : ''}\n              {requirement.startDate && requirement.dueDate ? ' - ' : ''}\n              {requirement.dueDate && requirement.dueDate !== 'TBD' ? format(new Date(requirement.dueDate), 'MMM d') : ''}\n            </span>\n            {timelineStatus && (\n              <span className={`pl-1 border-l border-[#E5E5E5] ${timelineStatus.color} `}>\n                {timelineStatus.text}\n              </span>\n            )}\n          </div>\n        )}\n        <p className=\"text-[13px] text-[#666666] font-['Inter:Regular',sans-serif] line-clamp-3 leading-relaxed\">\n          {requirement.description}\n        </p>\n      </div>\n\n      {/* Progress Section */}\n      {!isPending && (\n        <div className=\"mb-4 mt-auto\">\n          <div className=\"flex items-center justify-between mb-1.5\">\n            <span className=\"text-[10px] text-[#999999] font-['Inter:Medium',sans-serif]\">\n              Progress\n            </span>\n            <span className=\"text-[10px] text-[#111111] font-['Inter:Bold',sans-serif]\">\n              {requirement.progress}%\n            </span>\n          </div>\n          <div className=\"w-full h-1.5 bg-[#F0F0F0] rounded-full overflow-hidden\">\n            <div\n              className={`h-full rounded-full transition-all duration-500 ${requirement.status === 'completed'\n                ? 'bg-[#0F9D58]'\n                : requirement.status === 'delayed'\n                  ? 'bg-[#ff3b3b]'\n                  : 'bg-[#2F80ED]'\n                } `}\n              style={{ width: `${requirement.progress}%` }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Pending Message */}\n      {isPending && (\n        <div className=\"mt-auto mb-4 min-h-[40px] flex items-center justify-center text-[12px] text-[#999999] italic bg-[#F9FAFB] rounded-lg border border-dashed border-[#E5E7EB] mx-1\">\n          {getPendingStatusText()}\n        </div>\n      )}\n\n      {/* Footer */}\n      <div className=\"pt-3 border-t border-[#EEEEEE] flex items-center justify-between mt-auto\">\n\n        {/* Left: Priority & Assignees */}\n        <div className=\"flex items-center gap-2\">\n          {/* Priority Badge */}\n          {requirement.is_high_priority && (\n            <div className=\"w-2 h-2 rounded-full bg-[#ff3b3b]\" title=\"High Priority\" />\n          )}\n\n          {/* Assignees */}\n          <div className=\"flex -space-x-1.5\">\n            {(requirement.assignedTo && requirement.assignedTo.length > 0 ? requirement.assignedTo : ['Unassigned']).slice(0, 3).map((person, i) => (\n              <div\n                key={i}\n                className=\"w-5 h-5 rounded-full bg-[#F7F7F7] border border-white flex items-center justify-center text-[8px] font-bold text-[#666666] relative z-[3] hover:z-10 hover:scale-110 transition-all shadow-sm\"\n                title={person}\n              >\n                {person.charAt(0)}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Right: Cost & Status/Action */}\n        <div className=\"flex items-center gap-3\">\n          {/* Cost Display - only show if we have actual price data */}\n          {costDisplay && (\n            <span className={`text-[12px] font-['Manrope:Bold',sans-serif] ${requirement.type === 'outsourced' ? 'text-[#ff3b3b]' : 'text-[#0F9D58]'}`}>\n              {costDisplay}\n            </span>\n          )}\n\n\n          {isPending ? (\n            <div className=\"flex gap-2\">\n              {!(requirement.isReceiver && requirement.type === 'outsourced' && requirement.rawStatus?.toLowerCase() === 'assigned') && (\n              <button\n                onClick={handleRejectClick}\n                className=\"w-6 h-6 flex items-center justify-center rounded-full bg-white border border-[#ff3b3b] text-[#ff3b3b] hover:bg-[#ff3b3b] hover:text-white transition-all shadow-sm\"\n                title=\"Reject\"\n              >\n                <X className=\"w-3 h-3\" />\n              </button>\n              )}\n              <button\n                onClick={handleApproveClick}\n                className=\"px-2 h-6 flex items-center justify-center rounded-full bg-[#0F9D58] text-white hover:bg-[#0B8043] transition-all shadow-sm text-[10px] font-bold whitespace-nowrap\"\n                title=\"Approve\"\n              >\n                {getApproveButtonText()}\n              </button>\n            </div>\n          ) : (\n            <div\n              onClick={statusConfig.onClick || undefined}\n              className={`\n                flex items-center gap-1.5 px-2 py-0.5 rounded text-[10px] font-['Manrope:Bold',sans-serif] border transition-all\n                ${statusConfig.className}\n`}\n            >\n              <span className=\"capitalize\">{statusConfig.label}</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/settings/SettingsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":3,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Database' is defined but never used.","line":3,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":3,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":93},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used.","line":3,"column":95,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":101},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used.","line":3,"column":111,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":122},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Role' is defined but never used.","line":12,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":87,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":13},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":87,"column":15,"nodeType":"BlockStatement","messageId":"unexpected","endLine":89,"endColumn":4,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4054,4058],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":226,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14267,14270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14267,14270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14383,14386],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14383,14386],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'bankDetails' is assigned a value but never used.","line":239,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":239,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setBankDetails' is assigned a value but never used.","line":239,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":239,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showPassword' is assigned a value but never used.","line":242,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":242,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setShowPassword' is assigned a value but never used.","line":242,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":242,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":303,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18148,18151],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18148,18151],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":311,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":311,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":327,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":327,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":521,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":521,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25043,25046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25043,25046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":534,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":534,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25479,25482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25479,25482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":564,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":564,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26346,26349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26346,26349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1275,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1275,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[62963,62966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[62963,62966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1276,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1276,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[63033,63036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[63033,63036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1276,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1276,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[63041,63044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[63041,63044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1285,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1285,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[63553,63556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[63553,63556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":1327,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1327,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[66005,66008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[66005,66008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":24,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useCallback } from 'react';\nimport { useSearchParams, useRouter, usePathname } from 'next/navigation';\nimport { Plus, Edit, Trash2, X, Pencil, CreditCard, Bell, Lock, Database, AlertTriangle, Eye, EyeOff, Shield, ChevronDown, ChevronRight, Check } from 'lucide-react';\nimport { Button, Input, Select, Switch, Divider, App, Modal, DatePicker, Collapse, Checkbox } from \"antd\";\nimport { useUpdateCompany, useCurrentUserCompany, useRoles, useRolePermissions, useUpsertRole, useUpdateRolePermissions, useUserDetails } from '@/hooks/useUser';\nimport { usePublicHolidays, useCreateHoliday, useUpdateHoliday, useDeleteHoliday } from '@/hooks/useHoliday';\nimport { DEFAULT_DOCUMENT_TYPES, DOCUMENT_TYPES_STORAGE_KEY } from '@/constants/documentTypes';\nimport { getRoleFromUser } from '@/utils/roleUtils';\nimport { People24Filled } from \"@fluentui/react-icons\";\nimport { commonCountries } from '@/data/defaultData';\nimport dayjs from 'dayjs';\nimport { Department, Holiday, Role } from '@/types/domain';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\n// Get all IANA timezones without duplicates\n// Only returns canonical (latest) timezone names, excluding deprecated aliases\nconst getTimezones = (): Array<{ value: string; label: string }> => {\n  // Mapping of deprecated timezone aliases to their canonical names\n  const deprecatedToCanonical: Record<string, string> = {\n    'Asia/Calcutta': 'Asia/Kolkata',      // India - Calcutta deprecated, use Kolkata\n    'America/Godthab': 'America/Nuuk',    // Greenland - Godthab deprecated, use Nuuk\n    'Europe/Kiev': 'Europe/Kyiv',         // Ukraine - Kiev deprecated, use Kyiv\n    'US/Alaska': 'America/Anchorage',     // US timezone aliases\n    'US/Aleutian': 'America/Adak',\n    'US/Arizona': 'America/Phoenix',\n    'US/Central': 'America/Chicago',\n    'US/East-Indiana': 'America/Indiana/Indianapolis',\n    'US/Eastern': 'America/New_York',\n    'US/Hawaii': 'Pacific/Honolulu',\n    'US/Indiana-Starke': 'America/Indiana/Knox',\n    'US/Michigan': 'America/Detroit',\n    'US/Mountain': 'America/Denver',\n    'US/Pacific': 'America/Los_Angeles',\n    'US/Pacific-New': 'America/Los_Angeles',\n    'US/Samoa': 'Pacific/Pago_Pago',\n    'Canada/Atlantic': 'America/Halifax',\n    'Canada/Central': 'America/Winnipeg',\n    'Canada/Eastern': 'America/Toronto',\n    'Canada/Mountain': 'America/Edmonton',\n    'Canada/Newfoundland': 'America/St_Johns',\n    'Canada/Pacific': 'America/Vancouver',\n    'Canada/Saskatchewan': 'America/Regina',\n    'Canada/Yukon': 'America/Whitehorse',\n    'Mexico/BajaNorte': 'America/Tijuana',\n    'Mexico/BajaSur': 'America/Mazatlan',\n    'Mexico/General': 'America/Mexico_City',\n    'Brazil/Acre': 'America/Rio_Branco',\n    'Brazil/DeNoronha': 'America/Noronha',\n    'Brazil/East': 'America/Sao_Paulo',\n    'Brazil/West': 'America/Manaus',\n    'Egypt': 'Africa/Cairo',\n    'Libya': 'Africa/Tripoli',\n    'Poland': 'Europe/Warsaw',\n    'Portugal': 'Europe/Lisbon',\n    'Turkey': 'Europe/Istanbul',\n    'GMT': 'UTC',\n    'GMT+0': 'UTC',\n    'GMT-0': 'UTC',\n    'GMT0': 'UTC',\n    'Greenwich': 'UTC',\n    'Universal': 'UTC',\n    'Zulu': 'UTC',\n  };\n\n  try {\n    // Use native Intl API if available (modern browsers)\n    if (typeof Intl !== 'undefined' && 'supportedValuesOf' in Intl) {\n      const timezones = Intl.supportedValuesOf('timeZone');\n\n      // Convert deprecated timezones to canonical names\n      const canonicalTimezones = timezones.map(tz => deprecatedToCanonical[tz] || tz);\n\n      // Create a Set to remove duplicates and ensure uniqueness\n      const uniqueTimezonesSet = new Set(canonicalTimezones);\n\n      // CRITICAL: Always ensure Asia/Kolkata is included (important for Indian users)\n      // This handles cases where the browser might not include it or it might be filtered out\n      uniqueTimezonesSet.add('Asia/Kolkata');\n\n      // Convert Set to sorted array\n      const uniqueTimezones = Array.from(uniqueTimezonesSet).sort();\n\n      return uniqueTimezones.map(tz => ({ value: tz, label: tz }));\n    }\n  } catch (e) {\n\n  }\n\n  // Fallback: Comprehensive list of IANA timezones (canonical names only, no deprecated aliases)\n  // This ensures compatibility with older browsers\n  // Note: Only latest/canonical timezone names are included\n  const commonTimezones = [\n    'Africa/Abidjan', 'Africa/Accra', 'Africa/Addis_Ababa', 'Africa/Algiers', 'Africa/Asmara',\n    'Africa/Bamako', 'Africa/Bangui', 'Africa/Banjul', 'Africa/Bissau', 'Africa/Blantyre',\n    'Africa/Brazzaville', 'Africa/Bujumbura', 'Africa/Cairo', 'Africa/Casablanca', 'Africa/Ceuta',\n    'Africa/Conakry', 'Africa/Dakar', 'Africa/Dar_es_Salaam', 'Africa/Djibouti', 'Africa/Douala',\n    'Africa/El_Aaiun', 'Africa/Freetown', 'Africa/Gaborone', 'Africa/Harare', 'Africa/Johannesburg',\n    'Africa/Juba', 'Africa/Kampala', 'Africa/Khartoum', 'Africa/Kigali', 'Africa/Kinshasa',\n    'Africa/Lagos', 'Africa/Libreville', 'Africa/Lome', 'Africa/Luanda', 'Africa/Lubumbashi',\n    'Africa/Lusaka', 'Africa/Malabo', 'Africa/Maputo', 'Africa/Maseru', 'Africa/Mbabane',\n    'Africa/Mogadishu', 'Africa/Monrovia', 'Africa/Nairobi', 'Africa/Ndjamena', 'Africa/Niamey',\n    'Africa/Nouakchott', 'Africa/Ouagadougou', 'Africa/Porto-Novo', 'Africa/Sao_Tome', 'Africa/Tripoli',\n    'Africa/Tunis', 'Africa/Windhoek',\n    'America/Adak', 'America/Anchorage', 'America/Anguilla', 'America/Antigua', 'America/Araguaina',\n    'America/Argentina/Buenos_Aires', 'America/Argentina/Catamarca', 'America/Argentina/Cordoba',\n    'America/Argentina/Jujuy', 'America/Argentina/La_Rioja', 'America/Argentina/Mendoza',\n    'America/Argentina/Rio_Gallegos', 'America/Argentina/Salta', 'America/Argentina/San_Juan',\n    'America/Argentina/San_Luis', 'America/Argentina/Tucuman', 'America/Argentina/Ushuaia',\n    'America/Aruba', 'America/Asuncion', 'America/Atikokan', 'America/Bahia', 'America/Bahia_Banderas',\n    'America/Barbados', 'America/Belem', 'America/Belize', 'America/Blanc-Sablon', 'America/Boa_Vista',\n    'America/Bogota', 'America/Boise', 'America/Cambridge_Bay', 'America/Campo_Grande', 'America/Cancun',\n    'America/Caracas', 'America/Cayenne', 'America/Cayman', 'America/Chicago', 'America/Chihuahua',\n    'America/Costa_Rica', 'America/Creston', 'America/Cuiaba', 'America/Curacao', 'America/Danmarkshavn',\n    'America/Dawson', 'America/Dawson_Creek', 'America/Denver', 'America/Detroit', 'America/Dominica',\n    'America/Edmonton', 'America/Eirunepe', 'America/El_Salvador', 'America/Fort_Nelson', 'America/Fortaleza',\n    'America/Glace_Bay', 'America/Goose_Bay', 'America/Grand_Turk', 'America/Grenada',\n    'America/Guadeloupe', 'America/Guatemala', 'America/Guayaquil', 'America/Guyana', 'America/Halifax',\n    'America/Havana', 'America/Hermosillo', 'America/Indiana/Indianapolis', 'America/Indiana/Knox',\n    'America/Indiana/Marengo', 'America/Indiana/Petersburg', 'America/Indiana/Tell_City',\n    'America/Indiana/Vevay', 'America/Indiana/Vincennes', 'America/Indiana/Winamac', 'America/Inuvik',\n    'America/Iqaluit', 'America/Jamaica', 'America/Juneau', 'America/Kentucky/Louisville',\n    'America/Kentucky/Monticello', 'America/Kralendijk', 'America/La_Paz', 'America/Lima',\n    'America/Los_Angeles', 'America/Lower_Princes', 'America/Maceio', 'America/Managua', 'America/Manaus',\n    'America/Marigot', 'America/Martinique', 'America/Matamoros', 'America/Mazatlan', 'America/Menominee',\n    'America/Merida', 'America/Metlakatla', 'America/Mexico_City', 'America/Miquelon', 'America/Moncton',\n    'America/Monterrey', 'America/Montevideo', 'America/Montserrat', 'America/Nassau', 'America/New_York',\n    'America/Nipigon', 'America/Nome', 'America/Noronha', 'America/North_Dakota/Beulah',\n    'America/North_Dakota/Center', 'America/North_Dakota/New_Salem', 'America/Nuuk', 'America/Ojinaga',\n    'America/Panama', 'America/Pangnirtung', 'America/Paramaribo', 'America/Phoenix', 'America/Port-au-Prince',\n    'America/Port_of_Spain', 'America/Porto_Velho', 'America/Puerto_Rico', 'America/Punta_Arenas',\n    'America/Rainy_River', 'America/Rankin_Inlet', 'America/Recife', 'America/Regina', 'America/Resolute',\n    'America/Rio_Branco', 'America/Santarem', 'America/Santiago', 'America/Santo_Domingo', 'America/Sao_Paulo',\n    'America/Scoresbysund', 'America/Sitka', 'America/St_Barthelemy', 'America/St_Johns', 'America/St_Kitts',\n    'America/St_Lucia', 'America/St_Thomas', 'America/St_Vincent', 'America/Swift_Current', 'America/Tegucigalpa',\n    'America/Thule', 'America/Thunder_Bay', 'America/Tijuana', 'America/Toronto', 'America/Tortola',\n    'America/Vancouver', 'America/Whitehorse', 'America/Winnipeg', 'America/Yakutat', 'America/Yellowknife',\n    'Antarctica/Casey', 'Antarctica/Davis', 'Antarctica/DumontDUrville', 'Antarctica/Macquarie',\n    'Antarctica/Mawson', 'Antarctica/McMurdo', 'Antarctica/Palmer', 'Antarctica/Rothera',\n    'Antarctica/Syowa', 'Antarctica/Troll', 'Antarctica/Vostok',\n    'Arctic/Longyearbyen',\n    'Asia/Aden', 'Asia/Almaty', 'Asia/Amman', 'Asia/Anadyr', 'Asia/Aqtau', 'Asia/Aqtobe', 'Asia/Ashgabat',\n    'Asia/Atyrau', 'Asia/Baghdad', 'Asia/Bahrain', 'Asia/Baku', 'Asia/Bangkok', 'Asia/Barnaul', 'Asia/Beirut',\n    'Asia/Bishkek', 'Asia/Brunei', 'Asia/Chita', 'Asia/Choibalsan', 'Asia/Colombo', 'Asia/Damascus',\n    'Asia/Dhaka', 'Asia/Dili', 'Asia/Dubai', 'Asia/Dushanbe', 'Asia/Famagusta', 'Asia/Gaza', 'Asia/Hebron',\n    'Asia/Ho_Chi_Minh', 'Asia/Hong_Kong', 'Asia/Hovd', 'Asia/Irkutsk', 'Asia/Jakarta', 'Asia/Jayapura',\n    'Asia/Jerusalem', 'Asia/Kabul', 'Asia/Kamchatka', 'Asia/Karachi', 'Asia/Kathmandu', 'Asia/Khandyga',\n    'Asia/Kolkata', 'Asia/Krasnoyarsk', 'Asia/Kuala_Lumpur', 'Asia/Kuching', 'Asia/Kuwait', 'Asia/Macau',\n    'Asia/Magadan', 'Asia/Makassar', 'Asia/Manila', 'Asia/Muscat', 'Asia/Nicosia', 'Asia/Novokuznetsk',\n    'Asia/Novosibirsk', 'Asia/Omsk', 'Asia/Oral', 'Asia/Phnom_Penh', 'Asia/Pontianak', 'Asia/Pyongyang',\n    'Asia/Qatar', 'Asia/Qostanay', 'Asia/Qyzylorda', 'Asia/Riyadh', 'Asia/Sakhalin', 'Asia/Samarkand',\n    'Asia/Seoul', 'Asia/Shanghai', 'Asia/Singapore', 'Asia/Srednekolymsk', 'Asia/Taipei', 'Asia/Tashkent',\n    'Asia/Tbilisi', 'Asia/Tehran', 'Asia/Thimphu', 'Asia/Tokyo', 'Asia/Tomsk', 'Asia/Ulaanbaatar',\n    'Asia/Urumqi', 'Asia/Ust-Nera', 'Asia/Vientiane', 'Asia/Vladivostok', 'Asia/Yakutsk', 'Asia/Yangon',\n    'Asia/Yekaterinburg', 'Asia/Yerevan',\n    'Atlantic/Azores', 'Atlantic/Bermuda', 'Atlantic/Canary', 'Atlantic/Cape_Verde', 'Atlantic/Faroe',\n    'Atlantic/Madeira', 'Atlantic/Reykjavik', 'Atlantic/South_Georgia', 'Atlantic/St_Helena', 'Atlantic/Stanley',\n    'Australia/Adelaide', 'Australia/Brisbane', 'Australia/Broken_Hill', 'Australia/Darwin', 'Australia/Eucla',\n    'Australia/Hobart', 'Australia/Lindeman', 'Australia/Lord_Howe', 'Australia/Melbourne', 'Australia/Perth',\n    'Australia/Sydney',\n    'Europe/Amsterdam', 'Europe/Andorra', 'Europe/Astrakhan', 'Europe/Athens', 'Europe/Belgrade',\n    'Europe/Berlin', 'Europe/Bratislava', 'Europe/Brussels', 'Europe/Bucharest', 'Europe/Budapest',\n    'Europe/Busingen', 'Europe/Chisinau', 'Europe/Copenhagen', 'Europe/Dublin', 'Europe/Gibraltar',\n    'Europe/Guernsey', 'Europe/Helsinki', 'Europe/Isle_of_Man', 'Europe/Istanbul', 'Europe/Jersey',\n    'Europe/Kaliningrad', 'Europe/Kirov', 'Europe/Kyiv', 'Europe/Lisbon', 'Europe/London', 'Europe/Luxembourg',\n    'Europe/Madrid', 'Europe/Malta', 'Europe/Mariehamn', 'Europe/Minsk', 'Europe/Monaco', 'Europe/Moscow',\n    'Europe/Oslo', 'Europe/Paris', 'Europe/Podgorica', 'Europe/Prague', 'Europe/Riga', 'Europe/Rome',\n    'Europe/Samara', 'Europe/San_Marino', 'Europe/Sarajevo', 'Europe/Saratov', 'Europe/Simferopol',\n    'Europe/Skopje', 'Europe/Sofia', 'Europe/Stockholm', 'Europe/Tallinn', 'Europe/Tirane', 'Europe/Ulyanovsk',\n    'Europe/Uzhgorod', 'Europe/Vaduz', 'Europe/Vatican', 'Europe/Vienna', 'Europe/Vilnius', 'Europe/Volgograd',\n    'Europe/Warsaw', 'Europe/Zagreb', 'Europe/Zaporozhye', 'Europe/Zurich',\n    'Indian/Antananarivo', 'Indian/Chagos', 'Indian/Christmas', 'Indian/Cocos', 'Indian/Comoro',\n    'Indian/Kerguelen', 'Indian/Mahe', 'Indian/Maldives', 'Indian/Mauritius', 'Indian/Mayotte',\n    'Indian/Reunion',\n    'Pacific/Apia', 'Pacific/Auckland', 'Pacific/Bougainville', 'Pacific/Chatham', 'Pacific/Chuuk',\n    'Pacific/Easter', 'Pacific/Efate', 'Pacific/Fakaofo', 'Pacific/Fiji', 'Pacific/Funafuti',\n    'Pacific/Galapagos', 'Pacific/Gambier', 'Pacific/Guadalcanal', 'Pacific/Guam', 'Pacific/Honolulu',\n    'Pacific/Kiritimati', 'Pacific/Kosrae', 'Pacific/Kwajalein', 'Pacific/Majuro', 'Pacific/Marquesas',\n    'Pacific/Midway', 'Pacific/Nauru', 'Pacific/Niue', 'Pacific/Norfolk', 'Pacific/Noumea',\n    'Pacific/Pago_Pago', 'Pacific/Palau', 'Pacific/Pitcairn', 'Pacific/Pohnpei', 'Pacific/Port_Moresby',\n    'Pacific/Rarotonga', 'Pacific/Saipan', 'Pacific/Tahiti', 'Pacific/Tarawa', 'Pacific/Tongatapu',\n    'Pacific/Wake', 'Pacific/Wallis',\n    'UTC'\n  ];\n\n  // Remove duplicates using Set (ensures uniqueness)\n  // Note: The hardcoded list already contains only canonical names, no deprecated aliases\n  const uniqueTimezonesSet = new Set(commonTimezones);\n\n  // CRITICAL: Always ensure Asia/Kolkata is included (important for Indian users)\n  uniqueTimezonesSet.add('Asia/Kolkata');\n\n  // Convert Set to sorted array\n  const uniqueTimezones = Array.from(uniqueTimezonesSet).sort();\n\n  return uniqueTimezones.map(tz => ({ value: tz, label: tz }));\n};\n\n// Removed local Department and Holiday interfaces in favor of domain types\n\ninterface LeaveType {\n  id: string;\n  name: string;\n  count: number;\n}\n\ninterface DocumentTypeLocal {\n  id: string;\n  name: string;\n  required: boolean;\n}\n\nexport function SettingsPage() {\n  const { message } = App.useApp();\n  const searchParams = useSearchParams();\n  const router = useRouter();\n  const pathname = usePathname();\n  \n  const [activeTab, setActiveTab] = useState<'company' | 'leaves' | 'working-hours' | 'integrations' | 'notifications' | 'security' | 'access-management'>('company');\n\n  // Sync state with URL on mount and param change\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    if (tabParam && ['company', 'leaves', 'working-hours', 'integrations', 'notifications', 'security', 'access-management'].includes(tabParam)) {\n      setActiveTab(tabParam as any);\n    }\n  }, [searchParams]);\n\n  const handleTabChange = useCallback((tab: string) => {\n    setActiveTab(tab as any);\n    const params = new URLSearchParams(searchParams.toString());\n    params.set('tab', tab);\n    router.replace(`${pathname}?${params.toString()}`, { scroll: false });\n  }, [searchParams, pathname, router]);\n  const [isEditing, setIsEditing] = useState(false);\n\n  // State for new tabs\n  const [bankDetails, setBankDetails] = useState({ accountName: '', bankName: '', accountNumber: '', ifscCode: '' });\n  const [notifications, setNotifications] = useState({ email: true, push: false, reports: true });\n  const [security, setSecurity] = useState({ currentPassword: '', newPassword: '', confirmPassword: '', twoFactor: false });\n  const [showPassword, setShowPassword] = useState({ current: false, new: false, confirm: false });\n  const updateCompanyMutation = useUpdateCompany();\n  const { data: companyData } = useCurrentUserCompany();\n  const { data: userDetails } = useUserDetails();\n\n  const isAdmin = useMemo(() => {\n    const userData = userDetails?.result?.user || userDetails?.result || {};\n    return getRoleFromUser(userData) === 'Admin';\n  }, [userDetails]);\n\n  // Get timezones list (memoized to avoid regenerating on every render)\n  const timezones = useMemo(() => getTimezones(), []);\n\n  // Company Details State - initialize from backend data\n  const [companyName, setCompanyName] = useState(companyData?.result?.name || '');\n  const [taxId, setTaxId] = useState(companyData?.result?.tax_id || '');\n  const [timeZone, setTimeZone] = useState(companyData?.result?.timezone || 'Asia/Kolkata');\n  const [currency, setCurrency] = useState(companyData?.result?.currency || 'USD');\n  const [country, setCountry] = useState(companyData?.result?.country || '');\n  const [address, setAddress] = useState(companyData?.result?.address || '');\n  const [defaultEmployeePassword, setDefaultEmployeePassword] = useState(companyData?.result?.default_employee_password || 'Pass@123');\n\n  // Update state when company data loads\n  useEffect(() => {\n    if (companyData?.result) {\n      setCompanyName(companyData.result.name || '');\n      setTaxId(companyData.result.tax_id || '');\n      setTimeZone(companyData.result.timezone || 'Asia/Kolkata');\n      setCurrency(companyData.result.currency || 'USD');\n      setCountry(companyData.result.country || '');\n      setAddress(companyData.result.address || '');\n      setDefaultEmployeePassword(companyData.result.default_employee_password || 'Pass@123');\n      \n      if (companyData.result.leaves) {\n        setLeaves(companyData.result.leaves);\n      }\n      \n      if (companyData.result.working_hours) {\n        setWorkStartTime(companyData.result.working_hours.start_time || '09:00');\n        setWorkEndTime(companyData.result.working_hours.end_time || '18:00');\n        setWorkingDays(companyData.result.working_hours.working_days || ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']);\n        setBreakTime(companyData.result.working_hours.break_time || '60');\n      }\n    }\n  }, [companyData]);\n  const [departments, setDepartments] = useState<Department[]>([\n    { id: '1', name: 'Design', active: true },\n    { id: '2', name: 'Development', active: true },\n    { id: '3', name: 'SEO', active: true },\n  ]);\n  const [isAddingDept, setIsAddingDept] = useState(false);\n  const [newDeptName, setNewDeptName] = useState('');\n\n  // Required Documents State - initialized from localStorage (saved settings) or defaults\n  const [requiredDocuments, setRequiredDocuments] = useState<DocumentTypeLocal[]>(() => {\n    try {\n      if (typeof window !== 'undefined') {\n        const stored = window.localStorage.getItem(DOCUMENT_TYPES_STORAGE_KEY);\n        if (stored) {\n          const parsed = JSON.parse(stored);\n          if (Array.isArray(parsed) && parsed.length > 0) {\n            return parsed.map((doc: any, index: number) => ({\n              id: String(doc.id ?? index + 1),\n              name: String(doc.name ?? ''),\n              required: Boolean(doc.required),\n            }));\n          }\n        }\n      }\n    } catch (error) {\n      // Error reading document types from localStorage\n    }\n\n    // Fallback to shared defaults\n    return DEFAULT_DOCUMENT_TYPES;\n  });\n  const [isAddingDoc, setIsAddingDoc] = useState(false);\n  const [newDocName, setNewDocName] = useState('');\n\n  // Persist required documents configuration so Profile page can read it\n  useEffect(() => {\n    try {\n      if (typeof window !== 'undefined') {\n        window.localStorage.setItem(DOCUMENT_TYPES_STORAGE_KEY, JSON.stringify(requiredDocuments));\n      }\n    } catch (error) {\n      // Error saving document types to localStorage\n    }\n  }, [requiredDocuments]);\n\n  // Leaves State\n  const [leaves, setLeaves] = useState<LeaveType[]>([\n    { id: '1', name: 'Sick Leave', count: 10 },\n    { id: '2', name: 'Casual Leave', count: 5 }\n  ]);\n\n  // Holidays - Fetch from API\n  const { data: holidaysData, isLoading: isLoadingHolidays } = usePublicHolidays();\n  const createHolidayMutation = useCreateHoliday();\n  const updateHolidayMutation = useUpdateHoliday();\n  const deleteHolidayMutation = useDeleteHoliday();\n\n  // Holiday modal state\n  const [isHolidayModalOpen, setIsHolidayModalOpen] = useState(false);\n  const [editingHoliday, setEditingHoliday] = useState<Holiday | null>(null);\n  const [holidayForm, setHolidayForm] = useState({ name: '', date: null as dayjs.Dayjs | null });\n\n  // Get holidays from API, filter out deleted ones\n  const publicHolidays = useMemo((): Holiday[] => {\n    if (!holidaysData?.result) return [];\n    return holidaysData.result\n      .filter((h: Holiday) => !h.is_deleted)\n      .map((h: Holiday) => ({\n        id: h.id,\n        name: h.name,\n        date: h.date,\n        is_api: h.is_api\n      }));\n  }, [holidaysData]);\n\n  // Working Hours State\n  const [workingDays, setWorkingDays] = useState(['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']);\n  const [workStartTime, setWorkStartTime] = useState('09:00');\n  const [workEndTime, setWorkEndTime] = useState('18:00');\n  const [breakTime, setBreakTime] = useState('60');\n\n  // Role Management State\n  const [selectedRoleId, setSelectedRoleId] = useState<number | null>(null);\n  const [isRoleModalOpen, setIsRoleModalOpen] = useState(false);\n  const [roleFormName, setRoleFormName] = useState('');\n  const [roleFormColor, setRoleFormColor] = useState('#BBBBBB');\n  const [editingRole, setEditingRole] = useState<{ id?: number; name: string; color?: string } | null>(null);\n  const [selectedPermissionIds, setSelectedPermissionIds] = useState<Set<number>>(new Set());\n\n  const { data: rolesData, isLoading: isLoadingRoles } = useRoles();\n  const { data: rolePermissions, isLoading: isLoadingPermissions } = useRolePermissions(selectedRoleId);\n  const upsertRoleMutation = useUpsertRole();\n  const updatePermissionsMutation = useUpdateRolePermissions();\n\n  useEffect(() => {\n    if (rolePermissions?.result) {\n      const initial = new Set<number>();\n      rolePermissions.result.forEach((mod) => {\n        mod.actions.forEach((act) => {\n          if (act.assigned) {\n            initial.add(act.id);\n          }\n        });\n      });\n      setSelectedPermissionIds(initial);\n    }\n  }, [rolePermissions]);\n\n  const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n\n  // Handlers\n  const handleAddDepartment = () => {\n    if (!newDeptName.trim()) return;\n    setDepartments([...departments, { id: Date.now().toString(), name: newDeptName, active: true }]);\n    setNewDeptName('');\n    setIsAddingDept(false);\n  };\n\n  const handleDeleteDepartment = (id: string) => {\n    setDepartments(departments.filter(d => d.id !== id));\n  };\n\n  const toggleDepartmentStatus = (id: string) => {\n    setDepartments(departments.map(d => d.id === id ? { ...d, active: !d.active } : d));\n  };\n\n  const handleAddDocument = () => {\n    if (!newDocName.trim()) return;\n    setRequiredDocuments([...requiredDocuments, { id: Date.now().toString(), name: newDocName, required: true }]);\n    setNewDocName('');\n    setIsAddingDoc(false);\n  };\n\n  const handleDeleteDocument = (id: string) => {\n    setRequiredDocuments(requiredDocuments.filter(d => d.id !== id));\n  };\n\n  const toggleDocumentRequired = (id: string) => {\n    setRequiredDocuments(requiredDocuments.map(d => d.id === id ? { ...d, required: !d.required } : d));\n  };\n\n  const toggleWorkingDay = (day: string) => {\n    if (workingDays.includes(day)) {\n      setWorkingDays(workingDays.filter(d => d !== day));\n    } else {\n      setWorkingDays([...workingDays, day]);\n    }\n  };\n\n  // Holiday Handlers\n  const handleAddHoliday = () => {\n    setEditingHoliday(null);\n    setHolidayForm({ name: '', date: null });\n    setIsHolidayModalOpen(true);\n  };\n\n  const handleEditHoliday = (holiday: Holiday) => {\n    setEditingHoliday(holiday);\n    setHolidayForm({\n      name: holiday.name,\n      date: dayjs(holiday.date)\n    });\n    setIsHolidayModalOpen(true);\n  };\n\n  const handleDeleteHoliday = (id: number | string) => {\n    Modal.confirm({\n      title: 'Delete Holiday',\n      content: 'Are you sure you want to delete this holiday?',\n      okText: 'Delete',\n      okType: 'danger',\n      cancelText: 'Cancel',\n      onOk() {\n        deleteHolidayMutation.mutate(Number(id));\n      }\n    });\n  };\n\n  const handleSaveHoliday = () => {\n    if (!holidayForm.name.trim()) {\n      message.error('Holiday name is required');\n      return;\n    }\n    if (!holidayForm.date) {\n      message.error('Holiday date is required');\n      return;\n    }\n\n    const payload = {\n      name: holidayForm.name.trim(),\n      date: holidayForm.date.format('YYYY-MM-DD')\n    };\n\n    if (editingHoliday) {\n      updateHolidayMutation.mutate(\n        { id: Number(editingHoliday.id), payload },\n        {\n          onSuccess: () => {\n            setIsHolidayModalOpen(false);\n            setEditingHoliday(null);\n            setHolidayForm({ name: '', date: null });\n          }\n        }\n      );\n    } else {\n      createHolidayMutation.mutate(payload, {\n        onSuccess: () => {\n          setIsHolidayModalOpen(false);\n          setHolidayForm({ name: '', date: null });\n        }\n      });\n    }\n  };\n\n  const handleSaveRole = () => {\n    if (!roleFormName.trim()) {\n      message.error('Role name is required');\n      return;\n    }\n\n    const payload = {\n      id: editingRole?.id,\n      name: roleFormName.trim(),\n      color: roleFormColor,\n    };\n\n    upsertRoleMutation.mutate(payload, {\n      onSuccess: () => {\n        message.success(`Role ${editingRole ? 'updated' : 'added'} successfully`);\n        setIsRoleModalOpen(false);\n        setRoleFormName('');\n        setRoleFormColor('#BBBBBB');\n        setEditingRole(null);\n      },\n      onError: (error: any) => {\n        message.error(error?.response?.data?.message || `Failed to ${editingRole ? 'update' : 'add'} role`);\n      },\n    });\n  };\n\n  const handleUpdateLeaveCount = (id: string, count: string) => {\n    setLeaves(leaves.map(l => l.id === id ? { ...l, count: parseInt(count) || 0 } : l));\n  };\n\n  const handleSaveChanges = async () => {\n    try {\n      // Prepare company update payload based on active tab\n      const payload: any = {};\n\n      if (activeTab === 'company') {\n        payload.name = companyName;\n        payload.tax_id = taxId;\n        payload.timezone = timeZone;\n        payload.currency = currency;\n        payload.country = country;\n        payload.address = address;\n      }\n\n      if (activeTab === 'security' && isAdmin) {\n        payload.default_employee_password = defaultEmployeePassword;\n      }\n      if (activeTab === 'leaves') {\n        payload.leaves = leaves;\n      }\n\n      if (activeTab === 'working-hours') {\n        payload.working_hours = {\n          start_time: workStartTime,\n          end_time: workEndTime,\n          working_days: workingDays,\n          break_time: breakTime\n        };\n      }\n\n      await updateCompanyMutation.mutateAsync(payload);\n      message.success('Settings saved successfully!');\n      setIsEditing(false);\n    } catch (error: any) {\n      const errorMessage = error?.response?.data?.message || \"Failed to update settings\";\n      message.error(errorMessage);\n    }\n  };\n\n  const handleCancelEdit = () => {\n    setIsEditing(false);\n    // Reset changes if needed\n  };\n\n  const handleEdit = () => {\n    setIsEditing(true);\n  };\n\n  const accountType = companyData?.result?.account_type || 'ORGANIZATION';\n  const isIndividual = accountType === 'INDIVIDUAL';\n\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] p-8 flex flex-col overflow-hidden relative font-['Manrope',sans-serif]\">\n      {/* Header Section */}\n      <div className=\"flex-none mb-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h1 className=\"text-[20px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n            {isIndividual ? 'Settings' : 'Company Settings'}\n          </h1>\n          {(activeTab === 'company' || (activeTab === 'security' && isAdmin)) && (\n            !isEditing ? (\n              <Button\n                onClick={handleEdit}\n                className=\"bg-[#111111] hover:bg-[#000000]/90 text-white font-['Manrope:SemiBold',sans-serif] px-6 h-10 rounded-full text-[13px] flex items-center gap-2 border-none\"\n              >\n                <Pencil className=\"w-4 h-4\" />\n                Edit\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-3\">\n                <Button\n                  onClick={handleCancelEdit}\n                  type=\"text\"\n                  className=\"text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] font-['Manrope:SemiBold',sans-serif] px-6 h-10 rounded-full text-[13px]\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={handleSaveChanges}\n                  loading={updateCompanyMutation.isPending}\n                  className=\"bg-[#ff3b3b] hover:bg-[#ff3b3b]/90 text-white font-['Manrope:SemiBold',sans-serif] px-8 h-10 rounded-full shadow-lg shadow-[#ff3b3b]/20 text-[13px] border-none\"\n                >\n                  Save Changes\n                </Button>\n              </div>\n            )\n          )}\n        </div>\n\n        {/* Tabs */}\n        <div className=\"flex items-center gap-8 border-b border-[#EEEEEE] overflow-x-auto\">\n          <button\n            onClick={() => handleTabChange('company')}\n            className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'company' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n              }`}\n          >\n            {isIndividual ? 'Details' : 'Company Details'}\n            {activeTab === 'company' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n          </button>\n\n          {!isIndividual && (\n            <>\n\n              <button\n                onClick={() => handleTabChange('notifications')}\n                className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'notifications' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                  }`}\n              >\n                Notifications\n                {activeTab === 'notifications' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n              </button>\n              <button\n                onClick={() => handleTabChange('security')}\n                className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'security' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                  }`}\n              >\n                Security\n                {activeTab === 'security' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n              </button>\n\n              <button\n                onClick={() => handleTabChange('leaves')}\n                className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'leaves' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                  }`}\n              >\n                Leaves\n                {activeTab === 'leaves' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n              </button>\n              <button\n                onClick={() => handleTabChange('working-hours')}\n                className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'working-hours' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                  }`}\n              >\n                Working Hours\n                {activeTab === 'working-hours' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n              </button>\n              {isAdmin && (\n                <button\n                  onClick={() => handleTabChange('access-management')}\n                  className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'access-management' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                    }`}\n                >\n                  Access Management\n                  {activeTab === 'access-management' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n                </button>\n              )}\n              <button\n                onClick={() => handleTabChange('integrations')}\n                className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors whitespace-nowrap ${activeTab === 'integrations' ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'\n                  }`}\n              >\n                Integrations\n                {activeTab === 'integrations' && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Content Area */}\n      <div className=\"flex-1 overflow-y-auto pr-2 pb-10\">\n\n        {/* Company Details Tab */}\n        {activeTab === 'company' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300\">\n            <section className=\"mb-10\">\n              <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">Company Information</h2>\n\n              <div className=\"grid grid-cols-2 gap-6 mb-6\">\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Company Name</span>\n                  <Input\n                    value={companyName}\n                    onChange={(e) => setCompanyName(e.target.value)}\n                    disabled={!isEditing}\n                    className={`h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px] ${!isEditing ? 'bg-[#FAFAFA] text-[#666666]' : 'bg-white'}`}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Tax ID</span>\n                  <Input\n                    value={taxId}\n                    onChange={(e) => setTaxId(e.target.value)}\n                    placeholder=\"Enter Tax ID\"\n                    disabled={!isEditing}\n                    className={`h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px] ${!isEditing ? 'bg-[#FAFAFA] text-[#666666]' : 'bg-white'}`}\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-6 mb-6\">\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Time Zone</span>\n                  <Select\n                    value={timeZone}\n                    onChange={(v) => setTimeZone(String(v))}\n                    disabled={!isEditing}\n                    className=\"w-full h-11\"\n                    showSearch={{\n                      filterOption: (input, option) => {\n                        const searchText = input.toLowerCase().trim();\n\n                        // If no search text, show all options\n                        if (!searchText) {\n                          return true;\n                        }\n\n                        // Get the label text\n                        const label = String(option?.label ?? option?.children ?? '').toLowerCase();\n                        const value = String(option?.value ?? '').toLowerCase();\n\n                        // Direct match in label or value\n                        if (label.includes(searchText) || value.includes(searchText)) {\n                          return true;\n                        }\n\n                        // Special handling for Indian timezone searches\n                        // \"kol\", \"cal\", \"calcutta\", \"kolkata\" should match \"Asia/Kolkata\"\n                        if (label.includes('kolkata')) {\n                          if (searchText.includes('kol') ||\n                            searchText.includes('cal') ||\n                            searchText.includes('kolkata') ||\n                            searchText.includes('calcutta') ||\n                            searchText.includes('india') ||\n                            searchText.includes('ist')) {\n                            return true;\n                          }\n                        }\n\n                        return false;\n                      }\n                    }}\n                    placeholder=\"Select timezone\"\n                    optionFilterProp=\"label\"\n                    notFoundContent=\"No timezone found\"\n                    popupMatchSelectWidth={true}\n                    virtual={false}\n                    listHeight={400}\n                  >\n                    {timezones.map((tz) => (\n                      <Option key={tz.value} value={tz.value} label={tz.label}>\n                        {tz.label}\n                      </Option>\n                    ))}\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Currency</span>\n                  <Select\n                    value={currency}\n                    onChange={(v) => setCurrency(String(v))}\n                    disabled={!isEditing}\n                    className=\"w-full h-11\"\n                  >\n                    <Option value=\"USD\">USD</Option>\n                    <Option value=\"EUR\">EUR</Option>\n                    <Option value=\"INR\">INR</Option>\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-6 mb-6\">\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Country</span>\n                  <Select\n                    value={country || undefined}\n                    onChange={(v) => setCountry(String(v))}\n                    disabled={!isEditing}\n                    className=\"w-full h-11\"\n                    showSearch={{\n                      filterOption: (input, option) => {\n                        const label = String(option?.label ?? '').toLowerCase();\n                        const value = String(option?.value ?? '').toLowerCase();\n                        return label.includes(input.toLowerCase()) || value.includes(input.toLowerCase());\n                      }\n                    }}\n                    placeholder=\"Select country\"\n                    optionFilterProp=\"label\"\n                  >\n                    {commonCountries.map((c) => (\n                      <Option key={c.code} value={c.name} label={c.name}>\n                        {c.name}\n                      </Option>\n                    ))}\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"mb-6 relative\">\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Address</span>\n                  <TextArea\n                    value={address}\n                    onChange={(e) => setAddress(e.target.value)}\n                    placeholder=\"Enter company address\"\n                    disabled={!isEditing}\n                    className={`min-h-[100px] rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Regular',sans-serif] text-[13px] resize-none p-3 pr-10 ${!isEditing ? 'bg-[#FAFAFA] text-[#666666]' : 'bg-white'}`}\n                  />\n                </div>\n                {isEditing && (\n                  <button className=\"absolute bottom-3 right-3 p-1.5 bg-[#F7F7F7] hover:bg-[#eeeeee] rounded-md transition-colors border border-[#EEEEEE]\">\n                    <div className=\"w-5 h-5 flex items-center justify-center\">\n                      <span className=\"text-[14px]\">📍</span>\n                    </div>\n                  </button>\n                )}\n              </div>\n            </section>\n\n            {/* Departments & Required Documents - Only for Organizations */}\n            {!isIndividual && (\n              <>\n                <Divider className=\"my-8 bg-[#EEEEEE]\" />\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12\">\n                  {/* Departments Column */}\n                  <section>\n                    <div className=\"flex items-center gap-2 mb-6\">\n                      <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                        Departments\n                      </h2>\n                      {!isAddingDept && (\n                        <button\n                          onClick={() => setIsAddingDept(true)}\n                          className=\"hover:scale-110 active:scale-95 transition-transform\"\n                        >\n                          <Plus className=\"w-5 h-5 text-[#ff3b3b]\" />\n                        </button>\n                      )}\n                    </div>\n\n                    <div className=\"space-y-6\">\n                      {departments.map((dept) => (\n                        <div key={dept.id} className=\"flex items-end gap-6 group\">\n                          <div className=\"space-y-2 flex-1\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                              Department Name\n                            </span>\n                            <Input\n                              value={dept.name}\n                              readOnly\n                              className=\"h-11 rounded-lg border-[#EEEEEE] bg-[#FAFAFA] text-[#666666] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                            />\n                          </div>\n                          <div className=\"flex items-center gap-4 pb-3 h-11\">\n                            <div className=\"flex flex-col items-center gap-1\">\n                              <span className=\"text-[11px] text-[#666666] font-['Manrope:Bold',sans-serif]\">\n                                Active\n                              </span>\n                              <Switch\n                                checked={dept.active}\n                                onChange={() => toggleDepartmentStatus(String(dept.id))}\n                                className=\"bg-gray-200 hover:bg-gray-300\"\n                                style={{\n                                  backgroundColor: dept.active ? \"#ff3b3b\" : undefined,\n                                }}\n                              />\n                            </div>\n                            <button className=\"p-2 hover:bg-[#F7F7F7] rounded-full transition-colors text-[#666666] hover:text-[#111111]\">\n                              <Edit className=\"w-4 h-4\" />\n                            </button>\n                            <button\n                              onClick={() => handleDeleteDepartment(String(dept.id))}\n                              className=\"p-2 hover:bg-[#F7F7F7] rounded-full transition-colors text-[#ff3b3b]\"\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n\n                      {isAddingDept && (\n                        <div className=\"flex items-end gap-6 animate-in fade-in slide-in-from-top-2 duration-200\">\n                          <div className=\"space-y-2 flex-1\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                              New Department Name\n                            </span>\n                            <Input\n                              value={newDeptName}\n                              onChange={(e) => setNewDeptName(e.target.value)}\n                              placeholder=\"e.g. Marketing\"\n                              autoFocus\n                              className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                              onKeyDown={(e) => e.key === \"Enter\" && handleAddDepartment()}\n                            />\n                          </div>\n                          <div className=\"flex items-center gap-2 pb-1 h-11\">\n                            <Button\n                              onClick={handleAddDepartment}\n                              className=\"h-9 px-4 bg-[#111111] hover:bg-[#000000]/90 text-white text-[12px] font-['Manrope:SemiBold',sans-serif] rounded-full border-none\"\n                            >\n                              Add\n                            </Button>\n                            <Button\n                              type=\"text\"\n                              onClick={() => setIsAddingDept(false)}\n                              className=\"h-9 px-4 text-[#666666] hover:text-[#111111] text-[12px] font-['Manrope:SemiBold',sans-serif] hover:bg-[#F7F7F7] rounded-full\"\n                            >\n                              Cancel\n                            </Button>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </section>\n\n                  {/* Required Documents Column */}\n                  <section className=\"lg:border-l lg:border-[#EEEEEE] lg:pl-12\">\n                    <div className=\"flex items-center gap-2 mb-6\">\n                      <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                        Required Documents\n                      </h2>\n                      {!isAddingDoc && (\n                        <button\n                          onClick={() => setIsAddingDoc(true)}\n                          className=\"hover:scale-110 active:scale-95 transition-transform\"\n                        >\n                          <Plus className=\"w-5 h-5 text-[#ff3b3b]\" />\n                        </button>\n                      )}\n                    </div>\n\n                    <div className=\"space-y-6\">\n                      {requiredDocuments.map((doc) => (\n                        <div key={doc.id} className=\"flex items-end gap-6 group\">\n                          <div className=\"space-y-2 flex-1\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                              Document Name\n                            </span>\n                            <Input\n                              value={doc.name}\n                              readOnly\n                              className=\"h-11 rounded-lg border-[#EEEEEE] bg-[#FAFAFA] text-[#666666] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                            />\n                          </div>\n                          <div className=\"flex items-center gap-4 pb-3 h-11\">\n                            <div className=\"flex flex-col items-center gap-1\">\n                              <span className=\"text-[11px] text-[#666666] font-['Manrope:Bold',sans-serif]\">\n                                Required\n                              </span>\n                              <Switch\n                                checked={doc.required}\n                                onChange={() => toggleDocumentRequired(doc.id)}\n                                className=\"bg-gray-200 hover:bg-gray-300\"\n                                style={{\n                                  backgroundColor: doc.required ? \"#ff3b3b\" : undefined,\n                                }}\n                              />\n                            </div>\n                            <button className=\"p-2 hover:bg-[#F7F7F7] rounded-full transition-colors text-[#666666] hover:text-[#111111]\">\n                              <Edit className=\"w-4 h-4\" />\n                            </button>\n                            <button\n                              onClick={() => handleDeleteDocument(doc.id)}\n                              className=\"p-2 hover:bg-[#F7F7F7] rounded-full transition-colors text-[#ff3b3b]\"\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n\n                      {isAddingDoc && (\n                        <div className=\"flex items-end gap-6 animate-in fade-in slide-in-from-top-2 duration-200\">\n                          <div className=\"space-y-2 flex-1\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                              New Document Name\n                            </span>\n                            <Input\n                              value={newDocName}\n                              onChange={(e) => setNewDocName(e.target.value)}\n                              placeholder=\"e.g. Passport\"\n                              autoFocus\n                              className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                              onKeyDown={(e) => e.key === \"Enter\" && handleAddDocument()}\n                            />\n                          </div>\n                          <div className=\"flex items-center gap-2 pb-1 h-11\">\n                            <Button\n                              onClick={handleAddDocument}\n                              className=\"h-9 px-4 bg-[#111111] hover:bg-[#000000]/90 text-white text-[12px] font-['Manrope:SemiBold',sans-serif] rounded-full border-none\"\n                            >\n                              Add\n                            </Button>\n                            <Button\n                              type=\"text\"\n                              onClick={() => setIsAddingDoc(false)}\n                              className=\"h-9 px-4 text-[#666666] hover:text-[#111111] text-[12px] font-['Manrope:SemiBold',sans-serif] hover:bg-[#F7F7F7] rounded-full\"\n                            >\n                              Cancel\n                            </Button>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </section>\n                </div>\n              </>\n            )}\n          </div>\n        )}\n\n        {/* Leaves Tab */}\n        {activeTab === 'leaves' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300 grid grid-cols-2 gap-12\">\n            {/* Leaves Column */}\n            <div className=\"space-y-6 sticky top-0 self-start\">\n              <div className=\"flex items-center gap-2\">\n                <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Leaves</h2>\n              </div>\n\n              {leaves.map((leave) => (\n                <div key={leave.id} className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">{leave.name}</span>\n                  <div className=\"flex items-center gap-3\">\n                    <Input\n                      value={leave.count}\n                      onChange={(e) => handleUpdateLeaveCount(leave.id, e.target.value)}\n                      className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                    />\n                    <button className=\"p-2 text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] rounded-full transition-colors\">\n                      <Edit className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n              ))}\n\n              <div className=\"pt-6\">\n                <div className=\"space-y-2\">\n                  <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#666666]\">Total Leaves</span>\n                  <div className=\"h-11 px-3 flex items-center rounded-lg border border-[#EEEEEE] bg-[#F7F7F7] text-[#666666] font-['Manrope:Medium',sans-serif] text-[13px]\">\n                    {leaves.reduce((acc, curr) => acc + curr.count, 0)} days\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Public Holidays Column */}\n            <div className=\"space-y-6 border-l border-[#EEEEEE] pl-12\">\n              <div className=\"flex items-center gap-2\">\n                <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Public Holidays</h2>\n                <button\n                  onClick={handleAddHoliday}\n                  className=\"hover:scale-110 active:scale-95 transition-transform\"\n                >\n                  <Plus className=\"w-5 h-5 text-[#ff3b3b]\" />\n                </button>\n              </div>\n\n              <div className=\"space-y-4\">\n                {isLoadingHolidays ? (\n                  <div className=\"text-center py-4 text-[13px] text-[#999999]\">Loading holidays...</div>\n                ) : publicHolidays.length > 0 ? (\n                  publicHolidays.map((holiday) => (\n                    <div key={holiday.id} className=\"p-4 border border-[#EEEEEE] rounded-[12px] flex items-center justify-between bg-white hover:shadow-sm transition-shadow\">\n                      <div>\n                        <div className=\"flex items-center gap-2\">\n                          <p className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">{holiday.name}</p>\n                          {holiday.is_api && (\n                            <span className=\"px-1.5 py-0.5 rounded-full bg-blue-100 text-blue-600 text-[10px] font-['Manrope:Bold',sans-serif]\">\n                              Public\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-[12px] text-[#666666] font-['Manrope:Medium',sans-serif]\">{new Date(holiday.date).toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric' })}</p>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        {!holiday.is_api && (\n                          <>\n                            <button\n                              onClick={() => handleEditHoliday(holiday)}\n                              className=\"p-2 text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] rounded-full transition-colors\"\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </button>\n                            <button\n                              onClick={() => handleDeleteHoliday(holiday.id)}\n                              className=\"p-2 text-[#ff3b3b] hover:bg-[#FFF5F5] rounded-full transition-colors\"\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </button>\n                          </>\n                        )}\n                        {holiday.is_api && (\n                           <button\n                             className=\"p-2 text-[#999999] cursor-not-allowed opacity-50\"\n                             title=\"Public holidays cannot be edited\"\n                           >\n                             <Lock className=\"w-4 h-4\" />\n                           </button>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"text-center py-4 text-[13px] text-[#999999]\">No holidays added yet</div>\n                )}\n              </div>\n\n              {/* Pagination placeholder */}\n              <div className=\"flex items-center justify-end gap-2 mt-4\">\n                <button className=\"w-8 h-8 flex items-center justify-center rounded-full text-[#999999] hover:bg-[#F7F7F7] disabled:opacity-50\" disabled>\n                  &lt;\n                </button>\n                <div className=\"w-8 h-8 flex items-center justify-center rounded-lg border border-[#ff3b3b] text-[#ff3b3b] font-bold text-[13px]\">\n                  1\n                </div>\n                <button className=\"w-8 h-8 flex items-center justify-center rounded-full text-[#999999] hover:bg-[#F7F7F7]\">\n                  &gt;\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Working Hours Tab */}\n        {activeTab === 'working-hours' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300 max-w-2xl\">\n            <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">Working Hours</h2>\n\n            <div className=\"space-y-8\">\n              {/* Working Days */}\n              <div className=\"space-y-3\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Working Days</span>\n                <div className=\"min-h-[48px] p-2 rounded-lg border border-[#EEEEEE] flex flex-wrap gap-2\">\n                  {workingDays.map(day => (\n                    <div key={day} className=\"h-8 px-3 bg-[#F0F0F0] rounded-md flex items-center gap-2 text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n                      {day}\n                      <button onClick={() => toggleWorkingDay(day)} className=\"hover:text-[#ff3b3b]\">\n                        <X className=\"w-3 h-3\" />\n                      </button>\n                    </div>\n                  ))}\n                  <div className=\"relative group\">\n                    <button className=\"h-8 w-8 flex items-center justify-center hover:scale-110 transition-transform\">\n                      <Plus className=\"w-5 h-5 text-[#ff3b3b]\" />\n                    </button>\n                    <div className=\"hidden group-hover:block absolute top-full left-0 mt-1 w-40 bg-white border border-[#EEEEEE] shadow-lg rounded-lg p-1 z-10\">\n                      {daysOfWeek.filter(d => !workingDays.includes(d)).map(day => (\n                        <button\n                          key={day}\n                          onClick={() => toggleWorkingDay(day)}\n                          className=\"w-full text-left px-3 py-2 text-[12px] hover:bg-[#F7F7F7] rounded-md\"\n                        >\n                          {day}\n                        </button>\n                      ))}\n                      {daysOfWeek.filter(d => !workingDays.includes(d)).length === 0 && (\n                        <div className=\"px-3 py-2 text-[12px] text-[#999999]\">All days selected</div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Working Hours */}\n              <div className=\"space-y-3\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Working Hours</span>\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"relative flex-1\">\n                    <Input\n                      type=\"time\"\n                      value={workStartTime}\n                      onChange={(e) => setWorkStartTime(e.target.value)}\n                      className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                    />\n                  </div>\n                  <span className=\"text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif]\">to</span>\n                  <div className=\"relative flex-1\">\n                    <Input\n                      type=\"time\"\n                      value={workEndTime}\n                      onChange={(e) => setWorkEndTime(e.target.value)}\n                      className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {/* Break Time */}\n              <div className=\"space-y-3\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Break Time (in minutes)</span>\n                <Input\n                  type=\"number\"\n                  value={breakTime}\n                  onChange={(e) => setBreakTime(e.target.value)}\n                  className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Integrations Tab Placeholder */}\n        {activeTab === 'integrations' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300 flex flex-col items-center justify-center py-20 text-center\">\n            <div className=\"w-16 h-16 bg-[#F7F7F7] rounded-full flex items-center justify-center mb-4\">\n              <Plus className=\"w-8 h-8 text-[#999999]\" />\n            </div>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <h3 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Integrations</h3>\n              <button className=\"hover:scale-110 active:scale-95 transition-transform\">\n                <Plus className=\"w-5 h-5 text-[#ff3b3b]\" />\n              </button>\n            </div>\n            <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif] max-w-sm\">\n              Connect your favorite tools and services to streamline your workflow.\n            </p>\n          </div>\n        )}\n\n        {/* Access Management Tab */}\n        {activeTab === 'access-management' && (\n          <div className=\"bg-white rounded-[24px] p-8 border border-[#EEEEEE] mb-6 animate-in fade-in slide-in-from-bottom-2 duration-300\">\n            <div className=\"flex items-center justify-between mb-10\">\n              <div>\n                <h2 className=\"text-[18px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Access Management</h2>\n                <p className=\"text-[13px] text-[#666666] mt-1 font-['Manrope:Regular',sans-serif]\">\n                  Manage roles and define specific permissions for your team.\n                </p>\n              </div>\n              <Button\n                onClick={() => {\n                  setEditingRole(null);\n                  setRoleFormName('');\n                  setIsRoleModalOpen(true);\n                }}\n                className=\"bg-[#111111] hover:bg-[#000000]/90 text-white font-['Manrope:SemiBold',sans-serif] px-6 h-11 rounded-full text-[13px] flex items-center gap-2 border-none transition-all shadow-md active:scale-95\"\n              >\n                <Plus className=\"w-4 h-4\" />\n                Add Role\n              </Button>\n            </div>\n\n            <div className=\"flex gap-8 h-[calc(100vh-500px)] min-h-[500px]\">\n              {/* Roles List - Sticky */}\n              <div className=\"w-1/3 flex flex-col\">\n                <div className=\"flex items-center h-10 mb-2 px-1\">\n                  <span className=\"text-[12px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider\">\n                    Roles\n                  </span>\n                </div>\n                <div className=\"flex-1 overflow-y-auto pr-2 custom-scrollbar\">\n                  <div className=\"space-y-1\">\n                    {rolesData?.result\n                      ?.filter((role: any) => role.name !== 'Super Admin')\n                      ?.sort((a: any, b: any) => {\n                        const order = ['Admin', 'Manager', 'Leader', 'Employee'];\n                        const aIdx = order.indexOf(a.name);\n                        const bIdx = order.indexOf(b.name);\n                        if (aIdx !== -1 && bIdx !== -1) return aIdx - bIdx;\n                        if (aIdx !== -1) return -1;\n                        if (bIdx !== -1) return 1;\n                        return a.name.localeCompare(b.name);\n                      })\n                      ?.map((role: any) => (\n                        <div\n                          key={role.id}\n                          onClick={() => setSelectedRoleId(role.id)}\n                          className={`group flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all ${selectedRoleId === role.id\n                            ? 'bg-[#111111] text-white shadow-lg'\n                            : 'hover:bg-[#F7F7F7] text-[#111111]'\n                            }`}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <Lock className={`w-4 h-4 ${selectedRoleId === role.id ? 'text-white/70' : 'text-[#666666]'}`} />\n                            <span className=\"text-[14px] font-['Manrope:Medium',sans-serif]\">{role.name}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                setEditingRole(role);\n                                setRoleFormName(role.name);\n                                setRoleFormColor(role.color || '#BBBBBB');\n                                setIsRoleModalOpen(true);\n                              }}\n                              className={`p-1.5 rounded-md hover:bg-white/20 ${selectedRoleId === role.id ? 'text-white' : 'text-[#666666]'}`}\n                            >\n                              <Edit className=\"w-3.5 h-3.5\" />\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n                    {isLoadingRoles && (\n                      <div className=\"py-8 text-center text-[#999999] text-[13px]\">Loading roles...</div>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Permissions Editor - Scrollable */}\n              <div className=\"w-2/3 flex flex-col\">\n                {selectedRoleId ? (\n                  <div className=\"flex flex-col h-full\">\n                    <div className=\"flex items-center justify-between h-10 mb-2 px-1\">\n                      <span className=\"text-[12px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider\">\n                        Permissions for {rolesData?.result?.find((r: any) => r.id === selectedRoleId)?.name}\n                      </span>\n                      <Button\n                        onClick={() => {\n                          updatePermissionsMutation.mutate({\n                            roleId: selectedRoleId,\n                            actions: Array.from(selectedPermissionIds),\n                          });\n                        }}\n                        loading={updatePermissionsMutation.isPending}\n                        className=\"bg-[#ff3b3b] hover:bg-[#ff3b3b]/90 text-white font-['Manrope:SemiBold',sans-serif] px-6 h-9 rounded-full text-[12px] border-none shadow-sm active:scale-95 transition-all\"\n                      >\n                        Save Permissions\n                      </Button>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-6\">\n                      {isLoadingPermissions ? (\n                        <div className=\"py-20 text-center text-[#999999] text-[13px]\">\n                          Loading permissions...\n                        </div>\n                      ) : (\n                        <Collapse\n                          ghost\n                          accordion\n                          expandIcon={({ isActive }) => (\n                            <div className={`transition-transform duration-200 ${isActive ? 'rotate-90' : ''}`}>\n                              <ChevronRight className=\"w-4 h-4 text-[#666666]\" />\n                            </div>\n                          )}\n                          className=\"custom-permissions-collapse\"\n                          items={rolePermissions?.result?.map((mod) => {\n                            const actionIds = mod.actions.map((a) => a.id);\n                            const allChecked = actionIds.every((id) => selectedPermissionIds.has(id));\n                            const indeterminate = actionIds.some((id) => selectedPermissionIds.has(id)) && !allChecked;\n\n                            return {\n                              key: mod.module,\n                              header: (\n                                <div className=\"flex items-center justify-between w-full pr-4\">\n                                  <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                                    {mod.module}\n                                  </span>\n                                  <div onClick={(e) => e.stopPropagation()}>\n                                    <Checkbox\n                                      indeterminate={indeterminate}\n                                      checked={allChecked}\n                                      onChange={(e) => {\n                                        const next = new Set(selectedPermissionIds);\n                                        actionIds.forEach((id) => {\n                                          if (e.target.checked) next.add(id);\n                                          else next.delete(id);\n                                        });\n                                        setSelectedPermissionIds(next);\n                                      }}\n                                    />\n                                  </div>\n                                </div>\n                              ),\n                              label: (\n                                <div className=\"flex items-center justify-between w-full pr-4\">\n                                  <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                                    {mod.module}\n                                  </span>\n                                  <div onClick={(e) => e.stopPropagation()}>\n                                    <Checkbox\n                                      indeterminate={indeterminate}\n                                      checked={allChecked}\n                                      onChange={(e) => {\n                                        const next = new Set(selectedPermissionIds);\n                                        actionIds.forEach((id) => {\n                                          if (e.target.checked) next.add(id);\n                                          else next.delete(id);\n                                        });\n                                        setSelectedPermissionIds(next);\n                                      }}\n                                    />\n                                  </div>\n                                </div>\n                              ),\n                              children: (\n                                <div className=\"grid grid-cols-2 gap-4 p-2\">\n                                  {mod.actions.map((act) => (\n                                    <div\n                                      key={act.id}\n                                      className=\"flex items-center gap-3 p-2 rounded-lg hover:bg-white transition-colors cursor-pointer\"\n                                      onClick={() => {\n                                        const next = new Set(selectedPermissionIds);\n                                        if (next.has(act.id)) next.delete(act.id);\n                                        else next.add(act.id);\n                                        setSelectedPermissionIds(next);\n                                      }}\n                                    >\n                                      <div className={`w-4 h-4 rounded border flex items-center justify-center transition-colors ${selectedPermissionIds.has(act.id)\n                                        ? 'bg-[#ff3b3b] border-[#ff3b3b]'\n                                        : 'bg-white border-[#DDDDDD]'\n                                        }`}>\n                                        {selectedPermissionIds.has(act.id) && <Check className=\"w-2.5 h-2.5 text-white stroke-[4]\" />}\n                                      </div>\n                                      <span className=\"text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif]\">\n                                        {act.name}\n                                      </span>\n                                    </div>\n                                  ))}\n                                </div>\n                              ),\n                              className: \"mb-2 bg-[#F9FAFB] rounded-xl border-none overflow-hidden\"\n                            };\n                          })}\n                        />\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"h-full min-h-[400px] flex flex-col items-center justify-center text-center p-8 bg-[#F9FAFB] rounded-2xl border border-dashed border-[#EEEEEE]\">\n                    <div className=\"w-12 h-12 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm\">\n                      <Shield className=\"w-6 h-6 text-[#999999]\" />\n                    </div>\n                    <h3 className=\"text-[15px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Select a role</h3>\n                    <p className=\"text-[13px] text-[#666666] mt-1 max-w-[240px]\">\n                      Select a role from the left to view and manage its permissions.\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n\n\n        {/* Notifications Tab */}\n        {activeTab === 'notifications' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300 max-w-2xl\">\n            <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">Notification Preferences</h2>\n            <div className=\"space-y-6\">\n              <div className=\"flex items-center justify-between p-4 border border-[#EEEEEE] rounded-xl\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-[#F7F7F7] rounded-full\"><Bell className=\"w-5 h-5 text-[#666666]\" /></div>\n                  <div>\n                    <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Email Notifications</h3>\n                    <p className=\"text-[12px] text-[#666666]\">Receive updates about leaves, payload, and announcements.</p>\n                  </div>\n                </div>\n                <Switch checked={notifications.email} onChange={(v) => setNotifications({ ...notifications, email: v })} />\n              </div>\n              <div className=\"flex items-center justify-between p-4 border border-[#EEEEEE] rounded-xl\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-[#F7F7F7] rounded-full\"><Bell className=\"w-5 h-5 text-[#666666]\" /></div>\n                  <div>\n                    <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Push Notifications</h3>\n                    <p className=\"text-[12px] text-[#666666]\">Receive real-time alerts on your device.</p>\n                  </div>\n                </div>\n                <Switch checked={notifications.push} onChange={(v) => setNotifications({ ...notifications, push: v })} />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Security Tab */}\n        {activeTab === 'security' && (\n          <div className=\"animate-in fade-in slide-in-from-bottom-2 duration-300 max-w-2xl\">\n            <h2 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-6\">Security Settings</h2>\n\n\n\n            <Divider />\n\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Two-Factor Authentication</h3>\n                <p className=\"text-[12px] text-[#666666]\">Add an extra layer of security to your account.</p>\n              </div>\n              <Switch checked={security.twoFactor} onChange={(v) => setSecurity({ ...security, twoFactor: v })} />\n            </div>\n\n            {isAdmin && (\n              <>\n                <Divider />\n                <div className=\"mt-8\">\n                  <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-4 flex items-center gap-2\">\n                    <People24Filled className=\"w-4 h-4 text-[#ff3b3b]\" color=\"#ff3b3b\" /> Default Employee Password\n                  </h3>\n                  <div className=\"max-w-md\">\n                    <p className=\"text-[12px] text-[#666666] mb-3\">This password will be pre-filled when creating new employees.</p>\n                    <Input\n                      placeholder=\"Default Password\"\n                      value={defaultEmployeePassword}\n                      onChange={(e) => setDefaultEmployeePassword(e.target.value)}\n                      disabled={!isEditing}\n                      className=\"h-11 rounded-lg\"\n                    />\n                  </div>\n                </div>\n              </>\n            )}\n\n            <Divider className=\"my-8\" />\n            \n            <div className=\"p-4 border border-[#ff3b3b]/20 bg-[#FFF5F5] rounded-xl flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-[#ff3b3b]/10 rounded-full\"><AlertTriangle className=\"w-5 h-5 text-[#ff3b3b]\" /></div>\n                <div>\n                  <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#ff3b3b]\">Delete Account</h3>\n                  <p className=\"text-[12px] text-[#ff3b3b]/80\">Permanently delete your account and all data.</p>\n                </div>\n              </div>\n              <Button danger type=\"primary\">Delete Account</Button>\n            </div>\n          </div>\n        )}\n\n        {/* Data Tab */}\n\n      </div>\n\n      {/* Holiday Modal */}\n      <Modal\n        title={null}\n        open={isHolidayModalOpen}\n        onCancel={() => {\n          setIsHolidayModalOpen(false);\n          setEditingHoliday(null);\n          setHolidayForm({ name: '', date: null });\n        }}\n        footer={null}\n        width={500}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        closeIcon={<X className=\"w-5 h-5 text-[#666666]\" />}\n        styles={{\n          body: { padding: 0 },\n        }}\n      >\n        <div className=\"flex flex-col bg-white\">\n          {/* Header */}\n          <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-6\">\n            <div className=\"flex items-center gap-2 text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">\n              <div className=\"p-2 rounded-full bg-[#F7F7F7]\">\n                <Plus className=\"w-5 h-5 text-[#666666]\" />\n              </div>\n              {editingHoliday ? 'Edit Holiday' : 'Add Holiday'}\n            </div>\n            <p className=\"text-[13px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-11\">\n              {editingHoliday ? 'Update holiday details' : 'Add a new public holiday for your company'}\n            </p>\n          </div>\n\n          {/* Form */}\n          <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n            <div className=\"space-y-5\">\n              {/* Holiday Name */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  <span className=\"text-[#ff3b3b]\">*</span> Holiday Name\n                </span>\n                <Input\n                  placeholder=\"e.g., New Year, Christmas\"\n                  className={`h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${holidayForm.name ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                  value={holidayForm.name}\n                  onChange={(e) => setHolidayForm({ ...holidayForm, name: e.target.value })}\n                />\n              </div>\n\n              {/* Holiday Date */}\n              <div className=\"space-y-2\">\n                <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                  <span className=\"text-[#ff3b3b]\">*</span> Date\n                </span>\n                <DatePicker\n                  format=\"YYYY-MM-DD\"\n                  placeholder=\"Select holiday date\"\n                  className={`w-full h-11 rounded-lg border border-[#EEEEEE] focus:border-[#EEEEEE] ${holidayForm.date ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                  value={holidayForm.date}\n                  onChange={(date) => setHolidayForm({ ...holidayForm, date })}\n                />\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex items-center justify-end gap-4 pt-6\">\n                <Button\n                  type=\"text\"\n                  onClick={() => {\n                    setIsHolidayModalOpen(false);\n                    setEditingHoliday(null);\n                    setHolidayForm({ name: '', date: null });\n                  }}\n                  className=\"h-[44px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"primary\"\n                  onClick={handleSaveHoliday}\n                  loading={createHolidayMutation.isPending || updateHolidayMutation.isPending}\n                  className=\"h-[44px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\"\n                >\n                  {editingHoliday ? 'Update' : 'Add'} Holiday\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Role Management Modal */}\n      <Modal\n        title={null}\n        open={isRoleModalOpen}\n        onCancel={() => {\n          setIsRoleModalOpen(false);\n          setRoleFormName('');\n          setEditingRole(null);\n        }}\n        footer={null}\n        width={400}\n        centered\n        className=\"rounded-2xl overflow-hidden\"\n        closeIcon={null}\n      >\n        <div className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h3 className=\"text-[18px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n              {editingRole ? 'Edit Role' : 'Add New Role'}\n            </h3>\n            <button\n              onClick={() => {\n                setIsRoleModalOpen(false);\n                setRoleFormName('');\n                setEditingRole(null);\n              }}\n              className=\"p-2 hover:bg-[#F7F7F7] rounded-full transition-colors\"\n            >\n              <X className=\"w-5 h-5 text-[#666666]\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                Role Name\n              </span>\n              <Input\n                placeholder=\"e.g. Project Manager\"\n                value={roleFormName}\n                onChange={(e) => setRoleFormName(e.target.value)}\n                className=\"h-11 rounded-lg border-[#EEEEEE] focus:border-[#ff3b3b] font-['Manrope:Medium',sans-serif] text-[13px]\"\n                onKeyDown={(e) => e.key === 'Enter' && handleSaveRole()}\n                autoFocus\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                Badge Color\n              </span>\n              <div className=\"flex items-center gap-2 overflow-x-auto pb-1 no-scrollbar\">\n                {['#BBBBBB', '#ff3b3b', '#2E90FA', '#12B76A', '#7F56D9', '#F79009', '#F04438', '#667085'].map((color) => (\n                  <button\n                    key={color}\n                    onClick={() => setRoleFormColor(color)}\n                    className={`w-5 h-5 rounded-full border-2 shrink-0 transition-all ${roleFormColor === color ? 'border-[#111111] scale-110' : 'border-transparent'\n                      }`}\n                    style={{ backgroundColor: color }}\n                  />\n                ))}\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-end gap-3 pt-4\">\n              <Button\n                type=\"text\"\n                onClick={() => {\n                  setIsRoleModalOpen(false);\n                  setRoleFormName('');\n                  setEditingRole(null);\n                }}\n                className=\"h-10 px-6 font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\"\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleSaveRole}\n                loading={upsertRoleMutation.isPending}\n                className=\"bg-[#111111] hover:bg-black text-white font-['Manrope:SemiBold',sans-serif] px-8 h-11 rounded-full text-[13px] border-none shadow-sm transition-all active:scale-95\"\n              >\n                {editingRole ? 'Update' : 'Add'} Role\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/tasks/TaskDetailsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is assigned a value but never used.","line":20,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'employeesData' is assigned a value but never used.","line":25,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'workspacesData' is assigned a value but never used.","line":26,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'requirementsData' is assigned a value but never used.","line":29,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3160,3163],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3160,3163],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9113,9116],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9113,9116],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":421,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":421,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19859,19862],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19859,19862],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":441,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":441,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20975,20978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20975,20978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabButton' is defined but never used.","line":467,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":467,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":467,"column":106,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":467,"endColumn":109,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21896,21899],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21896,21899],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showLabel' is defined but never used.","line":483,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":483,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":539,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":539,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23981,23984],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23981,23984],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport {\n  FileText, ListTodo, Calendar, Clock, CheckCircle2,\n  Loader2, AlertCircle, Briefcase, FolderOpen,\n  ArrowRight, Plus, Send, Paperclip, X, MessageSquare\n} from 'lucide-react';\nimport { Breadcrumb, Checkbox, Tooltip, App } from 'antd';\nimport { useTask, useTaskTimer } from '@/hooks/useTask';\nimport { useWorkspaces, useRequirements } from '@/hooks/useWorkspace';\nimport { useEmployees } from '@/hooks/useUser';\nimport { format } from 'date-fns';\nimport { PageLayout } from '../../layout/PageLayout';\n\nexport function TaskDetailsPage() {\n  const params = useParams();\n  const router = useRouter();\n  const { message } = App.useApp();\n  const taskId = Number(params.taskId);\n\n  const { data: taskData, isLoading } = useTask(taskId);\n  const { data: timerData } = useTaskTimer(taskId);\n  const { data: employeesData } = useEmployees();\n  const { data: workspacesData } = useWorkspaces();\n\n  const task = taskData?.result;\n  const { data: requirementsData } = useRequirements(task?.workspace_id || 0);\n  const timer = timerData?.result;\n\n  // Use pre-populated relation data from API\n  const assignee = task?.member_user || (task?.task_members?.[0]?.user);\n  const leader = task?.leader_user;\n  const workspace = task?.task_workspace;\n  const requirement = task?.task_requirement;\n\n  // Calculate progress\n  const estimatedHours = timer?.estimated_time || 0;\n  const workedSeconds = timer?.worked_time || 0;\n  const workedHours = workedSeconds / 3600;\n  const progressPercent = estimatedHours > 0\n    ? Math.min(Math.round((workedHours / estimatedHours) * 100), 100)\n    : 0;\n  const formattedLogged = workedHours < 0.1 && workedHours > 0 ? '< 0.1' : workedHours.toFixed(1);\n\n  const [activeTab, setActiveTab] = useState<'details' | 'steps'>('details');\n  const [selectedSteps, setSelectedSteps] = useState<string[]>([]);\n  const [messageText, setMessageText] = useState('');\n  const [attachments, setAttachments] = useState<File[]>([]);\n\n  if (isLoading) {\n    return <div className=\"p-8\">Loading...</div>;\n  }\n\n  if (!task) {\n    return <div className=\"p-8\">Task not found</div>;\n  }\n\n\n\n  // Mock activity data\n  const activityData = [\n    { id: 1, type: 'comment', user: 'Satyam Yadav', avatar: 'SY', date: '2 hours ago', message: 'Started working on the wireframes.', attachments: [] },\n    { id: 2, type: 'status', user: 'System', avatar: 'S', date: 'Yesterday', message: 'Status changed from \"Todo\" to \"In Progress\"', isSystem: true },\n  ];\n\n  const handleSendMessage = () => {\n    if (messageText.trim() || attachments.length > 0) {\n      setMessageText('');\n      setAttachments([]);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setAttachments([...attachments, ...Array.from(e.target.files)]);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  // Mock steps data - replace with actual data when available\n  const steps: any[] = [];\n\n  const rightDrawer = (\n    <div className=\"w-[400px] border-l border-[#EEEEEE] flex flex-col bg-white rounded-tr-[24px] rounded-br-[24px]\">\n      {/* Drawer Header */}\n      <div className=\"p-6 border-b border-[#EEEEEE]\">\n        <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n          <MessageSquare className=\"w-5 h-5 text-[#ff3b3b]\" />\n          Activity & Chat\n        </h3>\n        <p className=\"text-[12px] text-[#666666] font-['Inter:Regular',sans-serif] mt-1\">\n          Task updates and comments\n        </p>\n      </div>\n\n      {/* Activity Feed */}\n      <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n        {activityData.map((activity) => (\n          <div key={activity.id} className=\"flex gap-3\">\n            <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${activity.isSystem\n              ? 'bg-[#F0F0F0]'\n              : 'bg-gradient-to-br from-[#666666] to-[#999999]'\n              }`}>\n              <span className={`text-[11px] font-['Manrope:Bold',sans-serif] ${activity.isSystem ? 'text-[#999999]' : 'text-white'\n                }`}>\n                {activity.avatar}\n              </span>\n            </div>\n\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-baseline gap-2 mb-1\">\n                <span className={`text-[13px] font-['Manrope:SemiBold',sans-serif] ${activity.isSystem ? 'text-[#999999]' : 'text-[#111111]'\n                  }`}>\n                  {activity.user}\n                </span>\n                <span className=\"text-[11px] text-[#999999] font-['Inter:Regular',sans-serif]\">\n                  {activity.date}\n                </span>\n              </div>\n\n              <div className={`${activity.type === 'comment'\n                ? 'bg-[#F7F7F7] p-3 rounded-[12px] rounded-tl-none'\n                : ''\n                }`}>\n                <p className=\"text-[13px] text-[#444444] font-['Inter:Regular',sans-serif]\">\n                  {activity.message}\n                </p>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Message Input */}\n      <div className=\"p-4 border-t border-[#EEEEEE] bg-white\">\n        {attachments.length > 0 && (\n          <div className=\"mb-3 space-y-1\">\n            {attachments.map((file, index) => (\n              <div key={index} className=\"flex items-center justify-between p-2 bg-white rounded border border-[#EEEEEE]\">\n                <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                  <Paperclip className=\"w-3.5 h-3.5 text-[#666666] shrink-0\" />\n                  <span className=\"text-[11px] text-[#444444] truncate\">{file.name}</span>\n                </div>\n                <button\n                  onClick={() => setAttachments(attachments.filter((_, i) => i !== index))}\n                  className=\"p-1 hover:bg-[#FAFAFA] rounded transition-colors shrink-0\"\n                >\n                  <X className=\"w-3.5 h-3.5 text-[#999999]\" />\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n\n        <div className=\"relative\">\n          <textarea\n            value={messageText}\n            onChange={(e) => setMessageText(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Type a message or comment...\"\n            className=\"w-full min-h-[80px] p-3 pr-10 rounded-[12px] border border-[#DDDDDD] bg-[#FAFAFA] text-[13px] focus:outline-none focus:border-[#ff3b3b]/30 resize-none font-['Inter:Medium',sans-serif]\"\n          />\n          <div className=\"absolute bottom-3 right-3 flex gap-2\">\n            <label htmlFor=\"file-upload-task\" className=\"cursor-pointer text-[#999999] hover:text-[#666666] transition-colors\">\n              <Paperclip className=\"w-4 h-4\" />\n              <input\n                id=\"file-upload-task\"\n                type=\"file\"\n                multiple\n                className=\"hidden\"\n                onChange={handleFileSelect}\n              />\n            </label>\n            <button\n              onClick={handleSendMessage}\n              disabled={!messageText.trim() && attachments.length === 0}\n              className=\"text-[#ff3b3b] hover:text-[#E03131] disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              <Send className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <PageLayout\n      title={\n        <Breadcrumb\n          separator={<span className=\"text-[20px] font-['Manrope:SemiBold',sans-serif] text-[#999999]\">/</span>}\n          items={[\n            {\n              title: (\n                <span\n                  onClick={() => router.push('/dashboard/tasks')}\n                  className=\"cursor-pointer font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#999999] hover:text-[#666666] transition-colors\"\n                >\n                  Tasks\n                </span>\n              ),\n            },\n            {\n              title: (\n                <span className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111] line-clamp-1 max-w-[300px]\">\n                  {task.name || 'Untitled Task'}\n                </span>\n              ),\n            },\n          ]}\n        />\n      }\n      action={\n        <div className=\"flex items-center gap-4\">\n          <StatusBadge status={task.status || 'todo'} showLabel />\n          {task.is_high_priority && (\n            <span className=\"px-3 py-1.5 rounded-full text-[11px] font-['Manrope:SemiBold',sans-serif] uppercase tracking-wide bg-[#FFF5F5] text-[#ff3b3b]\">\n              HIGH PRIORITY\n            </span>\n          )}\n        </div>\n      }\n      tabs={[\n        { id: 'details', label: 'Details' },\n        { id: 'steps', label: `Steps (${steps.length})` }\n      ]}\n      activeTab={activeTab}\n      onTabChange={(id) => setActiveTab(id as any)}\n      sideContent={rightDrawer}\n    >\n      <div className=\"h-full overflow-y-auto p-0 bg-[#FAFAFA]\">\n        {activeTab === 'details' && (\n          <div className=\"space-y-8\">\n            {/* Description Section */}\n            <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n              <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-4 flex items-center gap-2\">\n                <FileText className=\"w-5 h-5 text-[#ff3b3b]\" />\n                Description\n              </h3>\n              <p className=\"text-[14px] text-[#444444] font-['Inter:Regular',sans-serif] leading-relaxed whitespace-pre-wrap\">\n                {task.description || \"No description provided.\"}\n              </p>\n            </div>\n\n            {/* Task Metadata */}\n            <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n                  <Briefcase className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Task Overview\n                </h3>\n              </div>\n\n              {/* Top Row: Context & People */}\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">\n                {/* Assigned To */}\n                <div className=\"bg-[#FAFAFA] rounded-xl p-4 border border-[#F5F5F5]\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">Assigned To</p>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center shadow-sm text-white font-['Manrope:Bold',sans-serif] text-[14px]\">\n                      {assignee?.name ? assignee.name.charAt(0).toUpperCase() : '?'}\n                    </div>\n                    <div className=\"overflow-hidden\">\n                      <p className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] truncate\" title={assignee?.name || 'Unassigned'}>\n                        {assignee?.name || 'Unassigned'}\n                      </p>\n                      <p className=\"text-[11px] text-[#666666] truncate\">Member</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Leader */}\n                <div className=\"bg-[#FAFAFA] rounded-xl p-4 border border-[#F5F5F5]\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">Leader</p>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-full bg-[#E0E0E0] border border-[#CCCCCC] flex items-center justify-center shadow-sm text-[#666666] font-['Manrope:Bold',sans-serif] text-[14px]\">\n                      {leader?.name ? leader.name.charAt(0) : 'U'}\n                    </div>\n                    <div className=\"overflow-hidden\">\n                      <p className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] truncate\">{leader?.name || 'Unknown'}</p>\n                      <p className=\"text-[11px] text-[#666666] truncate\">Creator</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Workspace */}\n                <div className=\"bg-[#FAFAFA] rounded-xl p-4 border border-[#F5F5F5]\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">Workspace</p>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-full bg-white border border-[#EEEEEE] flex items-center justify-center text-[#111111]\">\n                      <Briefcase className=\"w-4 h-4\" />\n                    </div>\n                    <div className=\"overflow-hidden\">\n                      <p className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] truncate\">\n                        {workspace?.name || 'No Workspace'}\n                      </p>\n                      <p className=\"text-[11px] text-[#666666] truncate\">Project</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Requirement */}\n                <div className=\"bg-[#FAFAFA] rounded-xl p-4 border border-[#F5F5F5]\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">Requirement</p>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-full bg-white border border-[#EEEEEE] flex items-center justify-center text-[#111111]\">\n                      <FolderOpen className=\"w-4 h-4\" />\n                    </div>\n                    <div className=\"overflow-hidden\">\n                      <p className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] truncate\">\n                        {requirement?.name || (task?.requirement_id ? `Req ${task.requirement_id}` : 'None')}\n                      </p>\n                      <p className=\"text-[11px] text-[#666666] truncate\">Scope</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Bottom Row: Timeline & Progress */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 pt-8 border-t border-[#EEEEEE]\">\n                {/* Timeline */}\n                <div className=\"flex flex-col\">\n                  <h4 className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-4 flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4 text-[#999999]\" />\n                    Timeline\n                  </h4>\n                  <div className=\"bg-[#FAFAFA] p-5 rounded-xl border border-[#F5F5F5] flex items-center justify-between flex-1 h-full\">\n                    <div>\n                      <p className=\"text-[11px] text-[#999999] mb-1\">Start Date</p>\n                      <p className=\"text-[14px] font-['Inter:SemiBold',sans-serif] text-[#111111]\">\n                        {task.start_date ? format(new Date(task.start_date), 'MMM d, yyyy') : 'Not set'}\n                      </p>\n                    </div>\n                    <div className=\"flex flex-col items-center px-4 opacity-30\">\n                      <span className=\"h-[1px] w-12 bg-black mb-1\"></span>\n                      <ArrowRight className=\"w-4 h-4\" />\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-[11px] text-[#999999] mb-1\">Due Date</p>\n                      <p className=\"text-[14px] font-['Inter:SemiBold',sans-serif] text-[#111111]\">\n                        {task.end_date ? format(new Date(task.end_date), 'MMM d, yyyy') : 'Not set'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Progress Metrics */}\n                <div className=\"flex flex-col\">\n                  <h4 className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-4 flex items-center gap-2\">\n                    <Clock className=\"w-4 h-4 text-[#999999]\" />\n                    Progress Tracking\n                  </h4>\n                  <div className=\"bg-[#FAFAFA] p-5 rounded-xl border border-[#F5F5F5] space-y-4 flex-1 h-full flex flex-col justify-center\">\n                    <div className=\"flex justify-between items-end w-full\">\n                      <div>\n                        <div className=\"flex items-baseline gap-1\">\n                          <span className=\"text-[24px] font-['Manrope:Bold',sans-serif] text-[#111111] leading-none\">{estimatedHours}</span>\n                          <span className=\"text-[13px] text-[#666666] font-['Inter:Medium',sans-serif]\">hrs estimated</span>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className={`text-[18px] font-['Manrope:Bold',sans-serif] leading-none ${task.status === 'delayed' ? 'text-[#ff3b3b]' :\n                          task.status === 'completed' ? 'text-[#0F9D58]' :\n                            'text-[#2F80ED]'\n                          }`}>\n                          {progressPercent}%\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"relative pt-2 w-full\">\n                      <div className=\"flex justify-between text-[10px] font-['Inter:SemiBold',sans-serif] text-[#999999] mb-1.5 uppercase tracking-wide\">\n                        <span>0h</span>\n                        <span>{formattedLogged}h logged</span>\n                      </div>\n                      <div className=\"w-full h-2 bg-[#E0E0E0] rounded-full overflow-hidden\">\n                        <div\n                          className={`h-full rounded-full transition-all duration-500 ${task.status === 'delayed' ? 'bg-[#ff3b3b]' :\n                            task.status === 'completed' ? 'bg-[#0F9D58]' :\n                              'bg-[#2F80ED]'\n                            }`}\n                          style={{ width: `${progressPercent}%` }}\n                        />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {activeTab === 'steps' && (\n          <div className=\"space-y-8\">\n            <div className=\"bg-white rounded-[16px] p-8 border border-[#EEEEEE] shadow-sm\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h3 className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111] flex items-center gap-2\">\n                  <ListTodo className=\"w-5 h-5 text-[#ff3b3b]\" />\n                  Steps Breakdown\n                </h3>\n                <button className=\"h-8 px-3 text-[12px] border border-[#EEEEEE] rounded-md hover:bg-[#FAFAFA] transition-colors flex items-center gap-2\">\n                  <Plus className=\"w-4 h-4\" /> Add Step\n                </button>\n              </div>\n\n              {/* Table Header */}\n              <div className=\"grid grid-cols-[40px_1fr_1.5fr_1fr_1fr] gap-4 px-4 pb-3 mb-2 border-b border-[#EEEEEE] items-center\">\n                <div className=\"flex justify-center\">\n                  <Checkbox\n                    checked={steps.length > 0 && selectedSteps.length === steps.length}\n                    onChange={(e) => {\n                      if (e.target.checked && steps.length > 0) {\n                        setSelectedSteps(steps.map((s: any) => s.id));\n                      } else {\n                        setSelectedSteps([]);\n                      }\n                    }}\n                    className=\"border-[#DDDDDD] [&.ant-checkbox-checked]:bg-[#ff3b3b] [&.ant-checkbox-checked]:border-[#ff3b3b]\"\n                  />\n                </div>\n                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Assignee</p>\n                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Role</p>\n                <div className=\"flex justify-center\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Est. Hours</p>\n                </div>\n                <div className=\"flex justify-center\">\n                  <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">Status</p>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                {steps.length > 0 ? (\n                  steps.map((step: any) => (\n                    <StepRow\n                      key={step.id}\n                      step={step}\n                      selected={selectedSteps.includes(step.id)}\n                      onSelect={() => {\n                        if (selectedSteps.includes(step.id)) {\n                          setSelectedSteps(selectedSteps.filter(id => id !== step.id));\n                        } else {\n                          setSelectedSteps([...selectedSteps, step.id]);\n                        }\n                      }}\n                    />\n                  ))\n                ) : (\n                  <div className=\"text-center py-8 text-[#999999] text-[13px]\">No steps defined</div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </PageLayout>\n  );\n}\n\nfunction TabButton({ active, onClick, icon: Icon, label }: { active: boolean; onClick: () => void; icon: any; label: string }) {\n  return (\n    <button\n      onClick={onClick}\n      className={`\n        flex items-center gap-2 pb-4 relative transition-colors\n        ${active ? 'text-[#ff3b3b]' : 'text-[#666666] hover:text-[#111111]'}\n      `}\n    >\n      <Icon className=\"w-4 h-4\" />\n      <span className=\"text-[13px] font-['Manrope:Bold',sans-serif]\">{label}</span>\n      {active && <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />}\n    </button>\n  );\n}\n\nfunction StatusBadge({ status, showLabel }: { status: string; showLabel?: boolean }) {\n  let color = \"bg-[#F7F7F7] text-[#666666]\";\n  let icon = <Clock className=\"w-3.5 h-3.5\" />;\n  let label = status;\n\n  switch (status?.toLowerCase()) {\n    case 'completed':\n    case 'done':\n      color = \"bg-[#E8F5E9] text-[#0F9D58]\";\n      icon = <CheckCircle2 className=\"w-3.5 h-3.5\" />;\n      label = \"Completed\";\n      break;\n    case 'delayed':\n      color = \"bg-[#FFF5F5] text-[#ff3b3b]\";\n      icon = <AlertCircle className=\"w-3.5 h-3.5\" />;\n      label = \"Delayed\";\n      break;\n    case 'in-progress':\n    case 'in_progress':\n      color = \"bg-[#E3F2FD] text-[#2F80ED]\";\n      icon = <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />;\n      label = \"In Progress\";\n      break;\n    case 'todo':\n    case 'pending':\n      color = \"bg-[#F7F7F7] text-[#666666]\";\n      icon = <Clock className=\"w-3.5 h-3.5\" />;\n      label = \"To Do\";\n      break;\n    case 'impediment':\n      color = \"bg-[#FFF5F5] text-[#ff3b3b]\";\n      icon = <AlertCircle className=\"w-3.5 h-3.5\" />;\n      label = \"Impediment\";\n      break;\n    case 'in-review':\n    case 'review':\n      color = \"bg-[#F3E5F5] text-[#9C27B0]\";\n      icon = <Loader2 className=\"w-3.5 h-3.5\" />;\n      label = \"In Review\";\n      break;\n  }\n\n  return (\n    <Tooltip title={label}>\n      <div className={`flex items-center justify-center w-7 h-7 rounded-full ${color} border border-current/10 cursor-help transition-transform hover:scale-110`}>\n        {icon}\n      </div>\n    </Tooltip>\n  );\n}\n\nfunction StepRow({\n  step,\n  selected = false,\n  onSelect\n}: {\n  step: any;\n  selected?: boolean;\n  onSelect?: () => void;\n}) {\n  return (\n    <div\n      onClick={onSelect}\n      className={`\n        group bg-white border rounded-[16px] p-4 transition-all duration-300 cursor-pointer relative z-10\n        ${selected\n          ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n          : 'border-[#EEEEEE] hover:border-[#ff3b3b]/20 hover:shadow-lg'\n        }\n      `}\n    >\n      <div className=\"grid grid-cols-[40px_1fr_1.5fr_1fr_1fr] gap-4 items-center\">\n        {/* Checkbox */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            checked={selected}\n            onChange={onSelect}\n            className=\"border-[#DDDDDD] [&.ant-checkbox-checked]:bg-[#ff3b3b] [&.ant-checkbox-checked]:border-[#ff3b3b]\"\n          />\n        </div>\n\n        {/* Assignee */}\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-7 h-7 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center\">\n            <span className=\"text-[11px] text-white font-['Manrope:Bold',sans-serif]\">\n              {step.assignee ? step.assignee.charAt(0) : 'U'}\n            </span>\n          </div>\n          <span className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">{step.assignee || 'Unassigned'}</span>\n        </div>\n\n        {/* Role */}\n        <div>\n          <span className=\"text-[13px] text-[#666666] font-['Inter:Medium',sans-serif]\">{step.role || 'N/A'}</span>\n        </div>\n\n        {/* Hours */}\n        <div className=\"flex justify-center\">\n          <span className=\"text-[13px] text-[#111111] font-['Inter:Medium',sans-serif]\">{step.estHours || 0} hrs</span>\n        </div>\n\n        {/* Status */}\n        <div className=\"flex justify-center\">\n          <StatusBadge status={step.status || 'todo'} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/tasks/TasksPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":1,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used.","line":2,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":2,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":2,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":82},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startOfWeek' is defined but never used.","line":21,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'endOfWeek' is defined but never used.","line":21,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startOfMonth' is defined but never used.","line":21,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'endOfMonth' is defined but never used.","line":21,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":66},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'subMonths' is defined but never used.","line":21,"column":68,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startOfYear' is defined but never used.","line":21,"column":79,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'endOfYear' is defined but never used.","line":21,"column":92,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":101},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1822,1825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1822,1825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":39,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":69,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":85,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":162,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6440,6443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6440,6443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":231,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8980,8983],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8980,8983],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":278,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":278,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10560,10563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10560,10563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":284,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":284,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":303,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":303,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":308,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":308,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":346,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":346,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12924,12927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12924,12927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":567,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":567,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20720,20723],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20720,20723],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":574,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":574,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20932,20935],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20932,20935],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":574,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":574,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20975,20978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20975,20978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":602,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":602,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21833,21836],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21833,21836],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":602,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":602,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21876,21879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21876,21879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":613,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":613,"endColumn":75,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[22153,22223],"text":"// @ts-expect-error - total_count might be on the response or the first item"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":614,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":614,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22249,22252],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22249,22252],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":665,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":665,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24433,24436],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24433,24436],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":798,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":798,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29003,29006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29003,29006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":804,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":804,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29244,29247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29244,29247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":821,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":821,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29844,29847],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29844,29847],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":896,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":896,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32752,32755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32752,32755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":902,"column":96,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":902,"endColumn":99,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33086,33089],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33086,33089],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":35,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useCallback } from 'react';\nimport { Plus, CheckSquare, Trash2, Users, ChevronDown, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { PaginationBar } from '../../ui/PaginationBar';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { Modal, Checkbox, App } from \"antd\";\nimport { DateRangeSelector } from '../../common/DateRangeSelector';\nimport { TaskForm } from '../../modals/TaskForm';\nimport { TaskRow } from './rows/TaskRow';\nimport { useTasks, useCreateTask, useDeleteTask, useUpdateTask } from '@/hooks/useTask';\nimport { useWorkspaces } from '@/hooks/useWorkspace';\nimport { searchEmployees } from '@/services/user';\nimport { getRoleFromUser } from '@/utils/roleUtils';\nimport { useUserDetails, useCurrentUserCompany } from '@/hooks/useUser';\nimport { getRequirementsDropdownByWorkspaceId } from '@/services/workspace';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport dayjs, { Dayjs } from 'dayjs';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore';\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter';\nimport { format, startOfWeek, endOfWeek, startOfMonth, endOfMonth, subMonths, startOfYear, endOfYear, differenceInCalendarDays } from 'date-fns';\n\ndayjs.extend(isoWeek);\ndayjs.extend(isSameOrBefore);\ndayjs.extend(isSameOrAfter);\n\nimport { Task, TaskStatus } from '@/types/domain';\n\n// Local alias if needed to avoid massive rename, or just use Task\n// transforming UITask -> Task in the code\ntype UITask = Task; \ntype ITaskStatus = TaskStatus;\n\ntype StatusTab = 'all' | 'In_Progress' | 'Completed' | 'Delayed';\n\n// Helper function to convert filter object to query params\nconst toQueryParams = (params: Record<string, any>): string => {\n  return Object.entries(params)\n    .filter(([_, value]) => value !== null && value !== \"\" && value !== undefined && value !== 'All')\n    .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)\n    .join(\"&\");\n};\n\nexport function TasksPage() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const { message } = App.useApp();\n  const createTaskMutation = useCreateTask();\n  const deleteTaskMutation = useDeleteTask();\n  const updateTaskMutation = useUpdateTask();\n  const { data: workspacesData } = useWorkspaces();\n  const { data: userDetailsData } = useUserDetails();\n  const { data: companyData } = useCurrentUserCompany();\n\n  // Get current user's company name as fallback for in-house tasks\n  const currentUserCompanyName = useMemo(() => {\n    // First try the company API endpoint\n    if (companyData?.result?.name) {\n      return companyData.result.name;\n    }\n    // Fallback to user details\n    try {\n      if (typeof window !== 'undefined') {\n        const localUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n        if (localUser?.company?.name) {\n          return localUser.company.name;\n        }\n      }\n    } catch (error) {\n      // Error reading company from localStorage\n    }\n    const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return apiUser?.company?.name || null;\n  }, [companyData, userDetailsData]);\n\n  // Get current user name\n  const currentUserName = useMemo(() => {\n    try {\n      if (typeof window !== 'undefined') {\n        const localUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n        if (localUser && localUser.name) {\n          return localUser.name;\n        }\n      }\n    } catch (error) {\n      // Error reading user from localStorage\n    }\n    const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return apiUser.name || apiUser.user_profile?.first_name || null;\n  }, [userDetailsData]);\n\n  // Read tab from URL params\n  const tabFromUrl = searchParams.get('tab');\n  const initialTab = (tabFromUrl === 'In_Progress' || tabFromUrl === 'Completed' || tabFromUrl === 'Delayed')\n    ? tabFromUrl as StatusTab\n    : 'all';\n  const [activeTab, setActiveTab] = useState<StatusTab>(initialTab);\n\n  // Update tab when URL changes\n  useEffect(() => {\n    const tabFromUrl = searchParams.get('tab');\n    if (tabFromUrl === 'In_Progress' || tabFromUrl === 'Completed' || tabFromUrl === 'Delayed') {\n      setActiveTab(tabFromUrl as StatusTab);\n    } else if (tabFromUrl === null) {\n      setActiveTab('all');\n    }\n  }, [searchParams]);\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Initialize filters\n  const [filters, setFilters] = useState<Record<string, string>>({\n    user: 'All',\n    company: 'All',\n    workspace: 'All',\n    status: 'All',\n    requirement: 'All'\n  });\n\n  // Track if filter has been initialized to avoid resetting user's manual changes\n  const [filterInitialized, setFilterInitialized] = useState(false);\n\n  const [selectedTasks, setSelectedTasks] = useState<string[]>([]);\n\n  // Pagination state\n  const [pagination, setPagination] = useState({\n    current: 1,\n    pageSize: 10,\n    limit: 10,\n    skip: 0,\n  });\n\n  // Date Picker State\n  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\n\n  // Modal State\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n\n  // Fetch users and requirements for form dropdowns\n  const [usersDropdown, setUsersDropdown] = useState<Array<{ id: number; name: string }>>([]);\n  const [requirementsDropdown, setRequirementsDropdown] = useState<Array<{ id: number; name: string }>>([]);\n\n  // Set initial filter to current user when page loads (only once)\n  // Skip auto-filter for Admin users - they should see all tasks by default\n  useEffect(() => {\n    // Wait for user details to be sure about the role\n    if (!filterInitialized && currentUserName && usersDropdown.length > 0 && userDetailsData) {\n      // Check if current user is Admin\n      const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n      const userRole = getRoleFromUser(apiUser);\n      const isAdmin = userRole?.toLowerCase() === 'admin';\n\n      if (!isAdmin) {\n        // Only auto-apply user filter for non-admin users\n        setFilters(prev => ({ ...prev, user: currentUserName }));\n      }\n      setFilterInitialized(true);\n    }\n  }, [currentUserName, filterInitialized, usersDropdown, userDetailsData]);\n\n  // Build query params for API call\n  const queryParams = useMemo(() => {\n    const params: Record<string, any> = {\n      limit: pagination.limit,\n      skip: pagination.skip,\n    };\n\n    // Add filters\n    if (filters.user !== 'All') {\n      const selectedUser = usersDropdown.find(u => u.name === filters.user);\n      if (selectedUser?.id) {\n        params.member_id = selectedUser.id;\n      }\n    }\n    if (filters.company !== 'All') {\n      // Need to find company ID from name - for now, we'll keep client-side filtering for company\n      // params.client_company_id = filters.company;\n    }\n    if (filters.workspace !== 'All') {\n      // Find workspace ID from name\n      const selectedWorkspace = workspacesData?.result?.workspaces?.find(\n        (p: { name: string; id: number }) => p.name === filters.workspace\n      );\n      if (selectedWorkspace?.id) {\n        params.workspace_id = selectedWorkspace.id;\n      }\n    }\n    if (filters.requirement !== 'All') {\n      const selectedReq = requirementsDropdown.find(r => r.name === filters.requirement);\n      if (selectedReq?.id) {\n        params.requirement_id = selectedReq.id;\n      }\n    }\n    // Add tab filter (status-based) - only if status filter is not explicitly set\n\n    if (activeTab !== 'all' && filters.status === 'All') {\n      if (activeTab === 'Completed') {\n        params.status = 'Completed';\n      }\n      // Note: In_Progress tab shows all tasks except Assigned and Completed - filter client-side\n      // Note: Delayed tab doesn't use status filter - it's time-based (end_date < today)\n      // We'll filter client-side after fetching all tasks\n    } else if (filters.status !== 'All') {\n      // Map UI status to backend status\n      const statusMap: Record<string, string> = {\n        'Assigned': 'Assigned',\n        'In Progress': 'In_Progress',\n        'Completed': 'Completed',\n        'Delayed': 'Delayed',\n        'Impediment': 'Impediment',\n        'Review': 'Review',\n        'Stuck': 'Stuck',\n      };\n      params.status = statusMap[filters.status] || filters.status;\n    }\n    if (searchQuery) {\n      params.name = searchQuery;\n    }\n\n    // Add date range filter if applicable\n    if (dateRange && dateRange[0] && dateRange[1]) {\n      params.start_date = dateRange[0].format('YYYY-MM-DD');\n      params.end_date = dateRange[1].format('YYYY-MM-DD');\n    }\n\n\n    return toQueryParams(params);\n  }, [pagination.limit, pagination.skip, filters, searchQuery, dateRange, activeTab, workspacesData]);\n\n  // Build query params for STATS (without status filter to get global counts)\n  const statsQueryParams = useMemo(() => {\n    const params: Record<string, any> = {\n      limit: 1, // Only need one item to get status_counts\n      skip: 0,\n    };\n\n    if (filters.user !== 'All') {\n      const selectedUser = usersDropdown.find(u => u.name === filters.user);\n      if (selectedUser?.id) {\n        params.member_id = selectedUser.id;\n      }\n    }\n    if (filters.workspace !== 'All') {\n      const selectedWorkspace = workspacesData?.result?.workspaces?.find(\n        (p: { name: string; id: number }) => p.name === filters.workspace\n      );\n      if (selectedWorkspace?.id) {\n        params.workspace_id = selectedWorkspace.id;\n      }\n    }\n    if (filters.requirement !== 'All') {\n      const selectedReq = requirementsDropdown.find(r => r.name === filters.requirement);\n      if (selectedReq?.id) {\n        params.requirement_id = selectedReq.id;\n      }\n    }\n    if (searchQuery) {\n      params.name = searchQuery;\n    }\n    if (dateRange && dateRange[0] && dateRange[1]) {\n      params.start_date = dateRange[0].format('YYYY-MM-DD');\n      params.end_date = dateRange[1].format('YYYY-MM-DD');\n    }\n\n    return toQueryParams(params);\n  }, [filters.workspace, searchQuery, dateRange, workspacesData]);\n\n  // Fetch tasks with query params\n  const { data: tasksData, isLoading } = useTasks(queryParams);\n\n  // Fetch stats separately (without status filter)\n  const { data: statsData } = useTasks(statsQueryParams);\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await searchEmployees();\n        if (response.success) {\n          const transformed = (response.result || []).map((item: any) => ({\n            id: item.value || item.id,\n            name: item.label || item.name,\n          }));\n          setUsersDropdown(transformed);\n        }\n      } catch (error) {\n        // Failed to fetch users\n      }\n    };\n    fetchUsers();\n  }, []);\n\n  useEffect(() => {\n    const fetchRequirements = async () => {\n      try {\n        if (!workspacesData?.result?.workspaces) return;\n        const allRequirements: Array<{ id: number; name: string }> = [];\n\n        for (const workspace of workspacesData.result.workspaces) {\n          try {\n            const response = await getRequirementsDropdownByWorkspaceId(workspace.id);\n            if (response.success && response.result) {\n              allRequirements.push(...response.result);\n            }\n          } catch (error) {\n            // Failed to fetch requirements for workspace\n          }\n        }\n        setRequirementsDropdown(allRequirements);\n      } catch (error) {\n        // Failed to fetch requirements\n      }\n    };\n    fetchRequirements();\n  }, [workspacesData]);\n\n  // Transform backend data to UI format\n  // Backend statuses: 'Assigned', 'In_Progress', 'Completed', 'Delayed', 'Impediment', 'Review', 'Stuck'\n  // Use backend statuses directly - no mapping needed\n  const normalizeBackendStatus = (status: string): ITaskStatus => {\n    if (!status) return 'Assigned';\n\n    // Normalize status (handle both 'In_Progress' and 'In Progress')\n    const normalizedStatus = status.replace(/\\s+/g, '_');\n\n    // Map to backend enum values\n    const validStatuses: ITaskStatus[] = ['Assigned', 'In_Progress', 'Completed', 'Delayed', 'Impediment', 'Review', 'Stuck'];\n    const matchedStatus = validStatuses.find(s => s === normalizedStatus || s.toLowerCase() === normalizedStatus.toLowerCase());\n\n    return matchedStatus || 'Assigned'; // Default to Assigned\n  };\n\n  // Create a map of requirement IDs to names for quick lookup\n  const requirementMap = useMemo(() => {\n    const map = new Map<number, string>();\n    requirementsDropdown.forEach(req => {\n      map.set(req.id, req.name);\n    });\n    return map;\n  }, [requirementsDropdown]);\n\n  const tasks: UITask[] = useMemo(() => {\n    if (!tasksData?.result) return [];\n\n    const today = new Date();\n    const todayMidnight = new Date(today.getFullYear(), today.getMonth(), today.getDate());\n\n    return tasksData.result.map((t: any) => {\n      const startDateObj = t.start_date ? new Date(t.start_date) : null;\n      const dueDateObj = t.end_date ? new Date(t.end_date) : null;\n\n      const startDate = startDateObj\n        ? startDateObj\n          .toLocaleDateString('en-GB', {\n            day: '2-digit',\n            month: 'short',\n            year: 'numeric',\n          })\n          .replace(/ /g, '-')\n        : 'TBD';\n\n      let dueDate = 'TBD';\n      let timelineDate = 'No due date';\n      let timelineLabel = 'No due date';\n      let isTimeOverdue = false;\n      let dueDateValue: number | null = null;\n\n      if (dueDateObj) {\n        const dueMidnight = new Date(\n          dueDateObj.getFullYear(),\n          dueDateObj.getMonth(),\n          dueDateObj.getDate()\n        );\n\n        dueDateValue = dueMidnight.getTime();\n\n        dueDate = dueDateObj\n          .toLocaleDateString('en-GB', {\n            day: '2-digit',\n            month: 'short',\n            year: 'numeric',\n          })\n          .replace(/ /g, '-');\n\n        timelineDate = format(dueDateObj, 'MMM d');\n\n        const diffDays = differenceInCalendarDays(todayMidnight, dueMidnight);\n\n        if (diffDays > 0) {\n          // Today is after due date\n          isTimeOverdue = true;\n          timelineLabel = `Overdue by ${diffDays} day${diffDays > 1 ? 's' : ''}`;\n        } else if (diffDays === 0) {\n          timelineLabel = 'Due today';\n        } else {\n          const daysLeft = Math.abs(diffDays);\n          timelineLabel = `Due in ${daysLeft} day${daysLeft > 1 ? 's' : ''}`;\n        }\n      }\n\n      const estTime = t.estimated_time || 0;\n      const timeSpent = t.time_spent || 0;\n      const isOverEstimate = estTime > 0 && timeSpent > estTime;\n\n      const baseStatus = normalizeBackendStatus(t.status);\n      const isDelayedByTime = isTimeOverdue || isOverEstimate;\n      // If task is delayed by time but status is not already Delayed/Impediment/Stuck, mark as Delayed\n      const uiStatus: ITaskStatus =\n        baseStatus === 'Completed'\n          ? 'Completed'\n          : isDelayedByTime && !['Delayed', 'Impediment', 'Stuck'].includes(baseStatus)\n            ? 'Delayed'\n            : baseStatus;\n\n      // Determine company/client name: if client exists, it's client work, otherwise show company name for in-house\n      // Client company comes from task_project.client_user.company.name\n      const clientCompanyName = t.task_project?.client_user?.company?.name ||\n        t.client?.name ||\n        t.client_company_name ||\n        null;\n\n      // For in-house tasks, get company name from task's company relation, project's company, or current user's company\n      const inHouseCompanyName = t.company?.name ||\n        t.company_name ||\n        t.task_project?.company?.name ||\n        t.task_project?.company_name ||\n        currentUserCompanyName ||\n        null;\n\n      // If there's a client company, it's client work; otherwise show in-house company name\n      const displayCompanyName = clientCompanyName || inHouseCompanyName || 'In-House';\n\n      // Get requirement name - check multiple possible paths\n      // First try from API response (nested relation)\n      let requirementName =\n        t.requirement?.name ||\n        t.task_requirement?.name ||\n        t.requirement_relation?.name ||\n        t.requirement_name ||\n        null;\n\n      // If not found in API response, look it up from the requirements dropdown map\n      if (!requirementName && t.requirement_id) {\n        requirementName = requirementMap.get(t.requirement_id) || null;\n      }\n\n      const requirementDisplay = requirementName\n        ? requirementName\n        : t.requirement_id\n          ? `Requirement ${t.requirement_id}`\n          : 'General';\n\n      return {\n        id: String(t.id),\n        name: t.name || t.title || '',\n        taskId: String(t.id),\n        client: displayCompanyName,\n        project: requirementDisplay,\n        leader:\n          t.leader?.name ||\n          t.leader_user?.name ||\n          'Unassigned',\n        assignedTo:\n          t.member_user?.name ||\n          (typeof t.assigned_to === 'object' ? t.assigned_to?.name : undefined) ||\n          t.assigned_to_user?.name ||\n          'Unassigned',\n        startDate,\n        dueDate,\n        estTime,\n        timeSpent,\n\n        activities: t.worklogs?.length || 0,\n        status: uiStatus,\n        is_high_priority: t.is_high_priority ?? false,\n        timelineDate,\n        timelineLabel,\n        dueDateValue,\n        // Store IDs for editing\n        workspace_id: t.workspace_id,\n        requirement_id: t.requirement_id,\n        member_id: t.member_user?.id || t.member_id,\n        leader_id: t.leader_user?.id || t.leader_id,\n        description: t.description || '',\n        endDateIso: t.end_date || '',\n        task_members: t.task_members || [],\n        total_seconds_spent: t.total_seconds_spent || 0,\n        execution_mode: t.execution_mode,\n      };\n    });\n  }, [tasksData, requirementMap, currentUserCompanyName]);\n\n  const currentUserId = userDetailsData?.result?.id || userDetailsData?.result?.user?.id;\n\n  useEffect(() => {\n    // side-effects after tasks change (currently none)\n  }, [tasks, tasksData]);\n\n  const users = useMemo(() => {\n    return ['All', ...usersDropdown.map(u => u.name).sort()];\n  }, [usersDropdown]);\n\n  const companies = useMemo(() => {\n    const companyNames = tasks.map(t => t.client).filter((name): name is string => typeof name === 'string' && name !== 'In-House');\n    return ['All', ...Array.from(new Set(companyNames))];\n  }, [tasks]);\n\n  const workspaces = useMemo(() => {\n    if (!workspacesData?.result?.workspaces) return ['All'];\n    return ['All', ...workspacesData.result.workspaces.map((p: { name: string }) => p.name)];\n  }, [workspacesData]);\n\n  const statuses = useMemo(() => ['All', 'Assigned', 'In Progress', 'Completed', 'Delayed', 'Impediment', 'Review', 'Stuck'], []);\n\n  const requirementsList = useMemo(() => {\n    return ['All', ...requirementsDropdown.map(r => r.name).sort()];\n  }, [requirementsDropdown]);\n\n  const filterOptions: FilterOption[] = [\n    { id: 'user', label: 'User', options: users, defaultValue: 'All' },\n    { id: 'company', label: 'Company', options: companies, placeholder: 'Company' },\n    { id: 'workspace', label: 'Workspace', options: workspaces, placeholder: 'Workspace' },\n    { id: 'requirement', label: 'Requirement', options: requirementsList, placeholder: 'Requirement' },\n    { id: 'status', label: 'Status', options: statuses, placeholder: 'Status' }\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n    // Reset to first page when filters change\n    setPagination(prev => ({ ...prev, current: 1, skip: 0 }));\n  };\n\n  // Reset pagination when search query or active tab changes\n  useEffect(() => {\n    setPagination(prev => ({ ...prev, current: 1, skip: 0 }));\n  }, [searchQuery, activeTab]);\n\n  const clearFilters = () => {\n    setFilters({\n      user: 'All',\n      company: 'All',\n      workspace: 'All',\n      status: 'All',\n      requirement: 'All'\n    });\n    setSearchQuery('');\n    // Reset to first page when clearing filters\n    setPagination(prev => ({ ...prev, current: 1, skip: 0 }));\n  };\n\n  // Handle pagination change\n  const handlePaginationChange = (page: number, pageSize: number) => {\n    setPagination({\n      current: page,\n      pageSize,\n      limit: pageSize,\n      skip: (page - 1) * pageSize,\n    });\n  };\n\n  const handleCreateTask = async (data: Partial<Task>) => {\n    // `TaskForm` already validates all required fields, but we keep a\n    // defensive check here to avoid sending an incomplete payload.\n    if (!data?.start_date) {\n      message.error(\"Start Date is required\");\n      return;\n    }\n\n    createTaskMutation.mutate(data as any, {\n      onSuccess: () => {\n        message.success(\"Task created successfully!\");\n        setIsDialogOpen(false);\n      },\n      onError: (error: Error) => {\n        const errorMessage =\n          (error as any)?.response?.data?.message || (error as any)?.message || \"Failed to create task\";\n        message.error(errorMessage);\n      },\n    });\n  };\n\n  // Handle edit task\n  const [editingTask, setEditingTask] = useState<UITask | null>(null);\n  const handleEditTask = (task: UITask) => {\n    setEditingTask(task);\n    setIsDialogOpen(true);\n  };\n\n  // Handle delete task\n  const handleDeleteTask = (taskId: string) => {\n    Modal.confirm({\n      title: 'Delete Task',\n      content: 'Are you sure you want to delete this task? This action cannot be undone.',\n      okText: 'Delete',\n      okType: 'danger',\n      cancelText: 'Cancel',\n      onOk: () => {\n        deleteTaskMutation.mutate(parseInt(taskId), {\n          onSuccess: () => {\n            message.success(\"Task deleted successfully!\");\n          },\n          onError: (error: Error) => {\n            const errorMessage =\n              (error as any)?.response?.data?.message || (error as any)?.message || \"Failed to delete task\";\n            message.error(errorMessage);\n          },\n        });\n      },\n    });\n  };\n\n  // Get total count from API response\n  const totalTasks = useMemo(() => {\n    const firstTask = tasksData?.result?.[0] as Task | undefined;\n    // @ts-ignore - total_count might be on the response or the first item\n    return (firstTask as any)?.total_count ?? tasks.length ?? 0;\n  }, [tasksData, tasks.length]);\n\n  // Apply client-side filters for user/company (since we can't easily map names to IDs)\n  // Workspace filtering is now done server-side via query params\n  const filteredTasks = useMemo(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const todayTime = today.getTime();\n\n    return tasks.filter(task => {\n      // Client-side filtering for items not supported by backend yet (e.g. company name match)\n      const matchesCompany = filters.company === 'All' || task.client === filters.company;\n\n      // Date filtering (client-side since API might not support it exactly as we need)\n      let matchesDate = true;\n      if (dateRange && dateRange[0] && dateRange[1]) {\n        const from = dateRange[0].startOf('day').toDate().getTime();\n        const to = dateRange[1].endOf('day').toDate().getTime();\n\n        if (task.dueDateValue == null) {\n          matchesDate = false;\n        } else {\n          matchesDate = task.dueDateValue >= from && task.dueDateValue <= to;\n        }\n      }\n\n      // In Progress tab: show all tasks except Assigned and Completed\n      if (activeTab === 'In_Progress') {\n        const isActiveTask = task.status !== 'Assigned' && task.status !== 'Completed';\n        if (!isActiveTask) return false;\n      }\n\n      // Delayed tab: show tasks where end_date has passed and task is NOT completed\n      if (activeTab === 'Delayed') {\n        const isOverdue = task.dueDateValue != null && task.dueDateValue < todayTime;\n        const isNotCompleted = task.status !== 'Completed';\n        if (!isOverdue || !isNotCompleted) return false;\n      }\n\n      return matchesCompany && matchesDate;\n    });\n  }, [tasks, filters, dateRange, activeTab]);\n\n  useEffect(() => {\n    // side-effects after filters, search, or date label change (currently none)\n  }, [tasks.length, filteredTasks.length, activeTab, searchQuery, filters]);\n\n  // Note: Stats are now fetched separately without status filter for stable tab counts\n  // Use statsData (global counts) instead of tasksData (filtered)\n  const stats = useMemo(() => {\n    const firstTask = statsData?.result?.[0] as any; // Stats usually come as metadata or first item\n    const backendCounts = firstTask?.status_counts || {};\n    const allTasks = (statsData?.result || []) as Task[];\n\n    // Calculate delayed count: tasks where end_date < today AND not completed\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const todayTime = today.getTime();\n\n    let delayedCount = 0;\n    allTasks.forEach((t: Task) => {\n      if (t.end_date && t.status !== 'Completed') {\n        const endDateObj = new Date(t.end_date);\n        endDateObj.setHours(0, 0, 0, 0);\n        if (endDateObj.getTime() < todayTime) {\n          delayedCount++;\n        }\n      }\n    });\n\n    // Calculate total from counts if available\n    const calculatedTotal = (backendCounts.All) ||\n      ((backendCounts.Assigned || 0) + (backendCounts.In_Progress || 0) +\n        (backendCounts.Completed || 0) + (backendCounts.Delayed || 0) +\n        (backendCounts.Impediment || 0) + (backendCounts.Stuck || 0) +\n        (backendCounts.Review || 0));\n\n    return {\n      all: backendCounts.All || calculatedTotal || totalTasks,\n      // In Progress = all tasks except Assigned and Completed\n      'In_Progress': (backendCounts.In_Progress || 0) + (backendCounts.Delayed || 0) +\n        (backendCounts.Impediment || 0) + (backendCounts.Stuck || 0) + (backendCounts.Review || 0),\n      'Completed': backendCounts.Completed || 0,\n      'Delayed': delayedCount > 0 ? delayedCount : ((backendCounts.Delayed || 0) + (backendCounts.Impediment || 0) + (backendCounts.Stuck || 0)),\n    };\n  }, [statsData, totalTasks]);\n\n  const toggleSelectAll = () => {\n    if (selectedTasks.length === filteredTasks.length) {\n      setSelectedTasks([]);\n    } else {\n      setSelectedTasks(filteredTasks.map(t => t.id));\n    }\n  };\n\n  const toggleSelect = (id: string) => {\n    if (selectedTasks.includes(id)) {\n      setSelectedTasks(selectedTasks.filter(taskId => taskId !== id));\n    } else {\n      setSelectedTasks([...selectedTasks, id]);\n    }\n  };\n\n  const DateFilter = (\n    <DateRangeSelector\n      value={dateRange}\n      onChange={setDateRange}\n      availablePresets={['today', 'yesterday', 'this_week', 'this_month', 'last_month', 'this_year', 'all_time', 'custom']}\n    />\n  );\n\n  return (\n    <PageLayout\n      title=\"Tasks\"\n      titleAction={{\n        onClick: () => {\n          setEditingTask(null);\n          setIsDialogOpen(true);\n        },\n        label: \"Add Task\"\n      }}\n      tabs={[\n        { id: 'all', label: 'All Tasks' },\n        { id: 'In_Progress', label: 'In Progress' },\n        { id: 'Completed', label: 'Completed' },\n        { id: 'Delayed', label: 'Delayed', count: stats.Delayed },\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => {\n        setActiveTab(tabId as StatusTab);\n        const params = new URLSearchParams(searchParams.toString());\n        if (tabId === 'all') {\n          params.delete('tab');\n        } else {\n          params.set('tab', tabId);\n        }\n        router.push(`?${params.toString()}`);\n      }}\n\n      customFilters={DateFilter}\n    >\n      <Modal\n        open={isDialogOpen}\n        onCancel={() => {\n          setIsDialogOpen(false);\n          setEditingTask(null);\n        }}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n        styles={{\n          body: {\n            padding: 0,\n            maxHeight: 'calc(100vh - 100px)',\n            display: 'flex',\n            flexDirection: 'column',\n          },\n        }}\n      >\n        <TaskForm\n          key={editingTask ? `edit-${editingTask.id}` : `new-${Date.now()}`}\n          initialData={editingTask ? {\n            name: editingTask.name,\n            workspace_id: String(editingTask.workspace_id || ''),\n            requirement_id: String(editingTask.requirement_id || ''),\n            assigned_members: [],\n            execution_mode: 'parallel',\n            member_id: String(editingTask.member_id || ''),\n            leader_id: String(editingTask.leader_id || ''),\n            end_date: editingTask.endDateIso || '',\n            estimated_time: String(editingTask.estTime || ''),\n            is_high_priority: editingTask.is_high_priority,\n            description: editingTask.description || '',\n          } : undefined}\n          isEditing={!!editingTask}\n          onSubmit={(data) => {\n            if (editingTask) {\n              // Update task\n              updateTaskMutation.mutate({\n                id: parseInt(editingTask.id),\n                ...data,\n                ...data,\n              } as unknown as any, {\n                onSuccess: () => {\n                  message.success(\"Task updated successfully!\");\n                  setIsDialogOpen(false);\n                  setEditingTask(null);\n                },\n                onError: (error: any) => {\n                  const errorMessage =\n                    error?.response?.data?.message || error?.message || \"Failed to update task\";\n                  message.error(errorMessage);\n                },\n              });\n            } else {\n              // Create task\n              handleCreateTask(data);\n            }\n          }}\n          onCancel={() => {\n            setIsDialogOpen(false);\n            setEditingTask(null);\n          }}\n          users={usersDropdown}\n          requirements={requirementsDropdown}\n          workspaces={workspacesData?.result?.workspaces?.map((p: any) => ({\n            id: p.id,\n            name: p.name,\n          })) || []}\n        />\n      </Modal>\n\n      {/* Filters Bar */}\n\n      {/* Filters Bar */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex-1\">\n            <FilterBar\n              filters={filterOptions}\n              selectedFilters={filters}\n              onFilterChange={handleFilterChange}\n              onClearFilters={clearFilters}\n              searchPlaceholder=\"Search\"\n              searchValue={searchQuery}\n              onSearchChange={setSearchQuery}\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Tasks List */}\n      <div className=\"flex-1 overflow-y-auto relative\">\n        {/* Table Header */}\n        <div className=\"sticky top-0 z-20 bg-white grid grid-cols-[40px_2.5fr_1.2fr_1.1fr_1fr_0.8fr_1.5fr_0.6fr_40px] gap-4 px-4 py-3 mb-2 items-center\">\n          <div className=\"flex justify-center\">\n            <Checkbox\n              checked={filteredTasks.length > 0 && selectedTasks.length === filteredTasks.length}\n              onChange={toggleSelectAll}\n              className=\"red-checkbox\"\n            />\n          </div>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n            Task\n          </p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n            Requirements\n          </p>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n            Due Date\n          </p>\n          <div className=\"flex justify-center\">\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n              Assigned\n            </p>\n          </div>\n          <div className=\"flex justify-center\">\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n              Duration\n            </p>\n          </div>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n            Progress\n          </p>\n          <div className=\"flex justify-center\">\n            <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n              Status\n            </p>\n          </div>\n          <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\"></p>\n        </div>\n\n        <div className=\"space-y-2\">\n          {tasks.map((task) => (\n            <TaskRow\n              key={task.id}\n              task={{\n                ...task,\n                status: (task.status === 'In Progress' ? 'In_Progress' : \n                         task.status === 'Todo' ? 'Assigned' : \n                         task.status) as any \n              }}\n              selected={selectedTasks.includes(task.id)}\n              onSelect={() => toggleSelect(task.id)}\n              onEdit={() => handleEditTask(task)}\n              onDelete={() => handleDeleteTask(task.id)}\n              onStatusChange={(status) => updateTaskMutation.mutate({ id: task.id, status } as any)}\n              currentUserId={currentUserId ? Number(currentUserId) : undefined}\n            />\n          ))}\n        </div>\n\n        {isLoading ? (\n          <div className=\"text-center py-12\">\n            <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">Loading tasks...</p>\n          </div>\n        ) : filteredTasks.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">\n              No tasks found\n            </p>\n          </div>\n        ) : null}\n\n        {/* Bulk Action Bar */}\n        {selectedTasks.length > 0 && (\n          <div className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-[#111111] text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-6 z-20 animate-in slide-in-from-bottom-4 duration-200\">\n            <div className=\"flex items-center gap-2 border-r border-white/20 pr-6\">\n              <div className=\"bg-[#ff3b3b] text-white text-[12px] font-bold px-2 py-0.5 rounded-full\">\n                {selectedTasks.length}\n              </div>\n              <span className=\"text-[14px] font-['Manrope:SemiBold',sans-serif]\">Selected</span>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors tooltip-trigger\" title=\"Mark as Completed\">\n                <CheckSquare className=\"w-4 h-4\" />\n              </button>\n              <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors\" title=\"Assign To\">\n                <Users className=\"w-4 h-4\" />\n              </button>\n              <button className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-[#ff3b3b]\" title=\"Delete\">\n                <Trash2 className=\"w-4 h-4\" />\n              </button>\n            </div>\n\n            <button onClick={() => setSelectedTasks([])} className=\"ml-2 text-[12px] text-[#999999] hover:text-white transition-colors\">\n              Cancel\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Pagination - Fixed at bottom */}\n      {!isLoading && (\n        <PaginationBar\n          currentPage={pagination.current}\n          totalItems={totalTasks}\n          pageSize={pagination.pageSize}\n          onPageChange={(page) => handlePaginationChange(page, pagination.pageSize)}\n          onPageSizeChange={(size) => handlePaginationChange(1, size)}\n          itemLabel=\"tasks\"\n        />\n      )}\n    </PageLayout>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/tasks/rows/SegmentedProgressBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/tasks/rows/TaskRow.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRightCircle' is defined but never used.","line":2,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ban' is defined but never used.","line":2,"column":99,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":102},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Play' is defined but never used.","line":2,"column":118,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":122},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CircleStop' is defined but never used.","line":2,"column":124,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":134},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateWorklog' is defined but never used.","line":7,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleTimerClick' is assigned a value but never used.","line":155,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":155,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleStuckClick' is assigned a value but never used.","line":166,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":166,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleCompleteClick' is assigned a value but never used.","line":177,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":177,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":203,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":203,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":384,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":384,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":501,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":501,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18866,18869],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18866,18869],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":572,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":572,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20637,20640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20637,20640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Checkbox, Tooltip, Dropdown, Popover, Input, Button, message, Avatar, Modal } from \"antd\";\nimport { AlertCircle, CheckCircle2, Clock, Loader2, MoreVertical, ArrowRightCircle, Eye, XCircle, Ban, Edit, Trash2, Play, CircleStop, RotateCcw } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport type { MenuProps } from \"antd\";\nimport { useState, useEffect } from \"react\";\nimport { provideEstimate, updateWorklog } from \"../../../../services/task\";\nimport { SegmentedProgressBar } from \"./SegmentedProgressBar\";\nimport { useTimer } from \"../../../../context/TimerContext\";\n\nexport interface Task {\n  id: string;\n  name: string;\n  taskId: string;\n  client: string;\n  project: string;\n  leader: string;\n  assignedTo: string;\n  startDate: string;\n  dueDate: string;\n  estTime: number; // Total Estimate Hours (Static)\n  timeSpent: number; // Legacy Total Time (Closed Logs), mapped from total_seconds_spent\n  total_seconds_spent: number; // Total Closed Seconds\n  activities: number;\n  status: 'Assigned' | 'In_Progress' | 'Completed' | 'Delayed' | 'Impediment' | 'Review' | 'Stuck';\n  is_high_priority: boolean;\n  timelineDate: string;\n  timelineLabel: string;\n  execution_mode?: 'parallel' | 'sequential';\n  task_members?: {\n    id: number;\n    user_id: number;\n    status: string;\n    estimated_time: number | null;\n    seconds_spent: number; // Closed logs seconds\n    active_worklog_start_time?: string | null; // If running\n    is_current_turn: boolean;\n    user: {\n      id: number;\n      name: string;\n      profile_pic?: string;\n    };\n  }[];\n}\n\ninterface TaskRowProps {\n  task: Task;\n  selected: boolean;\n  onSelect: () => void;\n  onEdit?: () => void;\n  onDelete?: () => void;\n  onStatusChange?: (status: string) => void;\n  currentUserId?: number;\n  hideRequirements?: boolean;\n  isSender?: boolean;\n  onRequestRevision?: () => void;\n}\n\nexport function TaskRow({\n  task,\n  selected,\n  onSelect,\n  onEdit,\n  onDelete,\n  onStatusChange,\n  currentUserId,\n  hideRequirements = false,\n  isSender = false,\n  onRequestRevision\n}: TaskRowProps) {\n  const router = useRouter();\n  const { timerState, startTimer, stopTimer } = useTimer();\n  const { taskId: activeTaskId, elapsedSeconds, isRunning } = timerState;\n  const [estimateOpen, setEstimateOpen] = useState(false);\n  const [estimateHours, setEstimateHours] = useState(\"\");\n  const [submissionLoading, setSubmissionLoading] = useState(false);\n\n  // Worklog modal state for Stuck/Complete actions\n  const [showWorklogModal, setShowWorklogModal] = useState(false);\n  const [worklogAction, setWorklogAction] = useState<'stuck' | 'complete' | null>(null);\n  const [worklogDescription, setWorklogDescription] = useState(\"\");\n  const [worklogSubmitting, setWorklogSubmitting] = useState(false);\n\n  // Local ticker state for re-rendering live times for OTHER members (not current user)\n  const [now, setNow] = useState(new Date());\n\n  useEffect(() => {\n    // Check if ANY member has an active start time\n    const hasActiveMembers = task.task_members?.some(m => m.active_worklog_start_time);\n\n    // Also if this task is the active one in context\n    const isContextActive = String(activeTaskId) === String(task.id);\n\n    if (hasActiveMembers || isContextActive) {\n      const interval = setInterval(() => {\n        setNow(new Date());\n      }, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [task.task_members, activeTaskId, task.id]);\n\n  // Calculate live data for all members\n  const liveMembers = (task.task_members || []).map(m => {\n    let liveSeconds = m.seconds_spent;\n\n    // Check if this member is currently running in global context (Current User)\n    const isCurrentUser = m.user_id === currentUserId; // currentUserId passed as prop (number)\n    const isContextActive = String(activeTaskId) === String(task.id) && isRunning;\n\n    if (isCurrentUser && isContextActive) {\n      // Use the global context elapsed time for perfect sync\n      // Context elapsedSeconds = Duration of active log\n      // Seconds Spent (backend) = Closed Logs Sum\n      liveSeconds += elapsedSeconds;\n    } else if (m.active_worklog_start_time) {\n      // For other members (or fallback), calculate from start time\n      const startTime = new Date(m.active_worklog_start_time).getTime();\n      const diff = Math.max(0, (now.getTime() - startTime) / 1000);\n      liveSeconds += diff;\n    }\n\n    return {\n      ...m,\n      seconds_spent: liveSeconds,\n      // Status overrides for SegmentedProgressBar color logic:\n      // If active (live seconds increasing), ensure status reflects 'In Progress' for color blue\n      isWorking: (isCurrentUser && isContextActive) || !!m.active_worklog_start_time\n    };\n  });\n\n  // Calculate Aggregated Totals\n  const totalSeconds = liveMembers.reduce((acc, m) => acc + m.seconds_spent, 0);\n  const totalHours = totalSeconds / 3600;\n\n  // Format helpers\n  const formatHours = (hours: number) => Number(hours.toFixed(1));\n  const formatDuration = (hours: number | string | null | undefined) => {\n    const num = Number(hours || 0);\n    return num % 1 === 0 ? num.toString() : num.toFixed(1);\n  };\n\n  // Determine row-level status (Aggregated)\n  // Priority: Stuck > Impediment > Delayed > Review > In_Progress > Assigned > Completed\n  // Or simply use the task.status which backend might already compute?\n  // User req: \"Show the Aggregated Status (e.g., if Mayur is \"Blocked\", the status badge for the whole row...\"\n  // Backend `task.status` is already computed by `calculateAggregatedTaskStatus`. We should trust it.\n\n  // Play/Stop Logic\n  // Disable if: Sequential & Not My Turn\n  const myMember = task.task_members?.find(m => m.user_id === currentUserId);\n  const isMyTurn = task.execution_mode === 'sequential' ? myMember?.is_current_turn : true;\n  const isPlayDisabled = task.execution_mode === 'sequential' && !isMyTurn;\n  const isActive = String(activeTaskId) === String(task.id);\n\n  const handleTimerClick = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (isActive) {\n      await stopTimer();\n    } else {\n      if (isPlayDisabled || isPendingEstimate) return;\n      await startTimer(Number(task.id), task.name, task.project); // Pass task info\n    }\n  };\n\n  // Handle Stuck action - stop timer and show worklog modal\n  const handleStuckClick = async () => {\n    // If timer is running on this task, stop it first\n    if (isActive) {\n      await stopTimer();\n    }\n    setWorklogAction('stuck');\n    setWorklogDescription('');\n    setShowWorklogModal(true);\n  };\n\n  // Handle Complete action - stop timer and show worklog modal  \n  const handleCompleteClick = async () => {\n    // If timer is running on this task, stop it first\n    if (isActive) {\n      await stopTimer();\n    }\n    setWorklogAction('complete');\n    setWorklogDescription('');\n    setShowWorklogModal(true);\n  };\n\n  // Handle worklog modal submission\n  const handleWorklogSubmit = async () => {\n    if (!worklogAction) return;\n\n    setWorklogSubmitting(true);\n    try {\n      // Determine the new status based on action\n      const newStatus = worklogAction === 'stuck' ? 'Stuck' : 'Review';\n\n      // Call the status change handler passed from parent\n      onStatusChange?.(newStatus);\n\n      message.success(worklogAction === 'stuck' ? 'Task marked as blocked' : 'Task marked for review');\n      setShowWorklogModal(false);\n      setWorklogAction(null);\n      setWorklogDescription('');\n    } catch (error) {\n      message.error('Failed to update task status');\n    } finally {\n      setWorklogSubmitting(false);\n    }\n  };\n\n  // Progress/Styling Logic (Moved to top level scope)\n  const percentage = task.estTime > 0 ? (totalSeconds / (task.estTime * 3600)) * 100 : 0;\n  const isOvertime = percentage > 100;\n  const isBlockedOrDelayed = ['Stuck', 'Impediment', 'Delayed'].includes(task.status);\n  const showRed = isOvertime || isBlockedOrDelayed;\n  const textColor = showRed ? 'text-[#ff3b3b]' : 'text-[#666666]';\n  const isPendingEstimate = myMember && myMember.status === 'PendingEstimate';\n\n  return (\n    <div\n      onClick={() => {\n        const targetUrl = `/dashboard/tasks/${task.id}`;\n        router.push(targetUrl);\n      }}\n      className={`\n        group bg-white border rounded-[16px] px-4 py-3 transition-all duration-300 cursor-pointer relative z-10\n        ${selected\n          ? 'border-[#ff3b3b] shadow-[0_0_0_1px_#ff3b3b] bg-[#FFF5F5]'\n          : 'border-[#EEEEEE] hover:border-[#ff3b3b]/20 hover:shadow-lg'\n        }\n      `}\n    >\n      <div className={`grid gap-4 items-center ${hideRequirements ? 'grid-cols-[40px_2.5fr_1.1fr_1fr_0.8fr_1.5fr_0.6fr_40px]' : 'grid-cols-[40px_2.5fr_1.2fr_1.1fr_1fr_0.8fr_1.5fr_0.6fr_40px]'}`}>\n        {/* Checkbox */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            checked={selected}\n            onChange={(e) => {\n              e.stopPropagation();\n              onSelect();\n            }}\n            className=\"red-checkbox\"\n          />\n        </div>\n\n        {/* Task Info */}\n        <div className=\"flex flex-col gap-0.5\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"font-['Manrope:Bold',sans-serif] text-[14px] !text-[#111111] group-hover:text-[#ff3b3b] transition-colors\">\n              {task.name}\n            </span>\n            {task.is_high_priority && (\n              <span className=\"bg-red-100 text-red-600 text-[10px] px-1.5 py-0.5 rounded-full font-bold border border-red-200\">\n                HIGH\n              </span>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n              #{task.taskId}\n            </span>\n            <Link\n              href=\"/dashboard/clients\"\n              onClick={(e) => e.stopPropagation()}\n              className=\"text-[11px] !text-[#111111] visited:!text-[#111111] font-['Manrope:Medium',sans-serif] hover:text-[#ff3b3b] hover:underline\"\n            >\n              • {task.client}\n            </Link>\n          </div>\n        </div>\n\n        {/* Project (Mapped to Requirements Header) */}\n        {!hideRequirements && (\n          <div>\n            <Link\n              href=\"/dashboard/workspace\"\n              onClick={(e) => e.stopPropagation()}\n              className=\"text-[13px] !text-[#111111] visited:!text-[#111111] font-['Manrope:Medium',sans-serif] truncate hover:text-[#ff3b3b] hover:underline\"\n            >\n              {task.project}\n            </Link>\n          </div>\n        )}\n\n        {/* Timeline */}\n        <div className=\"flex flex-col gap-0.5\">\n          <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n            {task.timelineDate}\n          </span>\n          <span\n            className={`text-[11px] font-['Manrope:Regular',sans-serif] ${task.status === 'Delayed' || task.status === 'Impediment' || task.status === 'Stuck'\n              ? 'text-[#dc2626]'\n              : task.status === 'Review'\n                ? 'text-[#fbbf24]'\n                : 'text-[#999999]'\n              }`}\n          >\n            {task.timelineLabel}\n          </span>\n        </div>\n\n        {/* Assigned To (Avatar Stack) */}\n        <div className=\"flex items-center justify-center\">\n          <Avatar.Group max={{ count: 3, style: { color: '#666666', backgroundColor: '#EEEEEE' } }}>\n            {task.task_members && task.task_members.length > 0 ? (\n              task.task_members.map((member) => (\n                <Tooltip key={member.id} title={`${isSender ? 'Partner Resource' : member.user.name} (${member.status})`}>\n                  <div className=\"relative\">\n                    {member.user.profile_pic && !isSender ? (\n                      <Avatar src={member.user.profile_pic} />\n                    ) : (\n                      <Avatar style={{ backgroundColor: '#CCCCCC' }}>\n                        {isSender ? 'P' : (member.user.name ? member.user.name.charAt(0).toUpperCase() : 'U')}\n                      </Avatar>\n                    )}\n                  </div>\n                </Tooltip>\n              ))\n            ) : (\n              <Tooltip title={isSender ? 'Partner Resource' : task.assignedTo}>\n                <Avatar style={{ backgroundColor: '#CCCCCC' }}>\n                  {isSender ? 'P' : (task.assignedTo ? task.assignedTo.charAt(0).toUpperCase() : 'U')}\n                </Avatar>\n              </Tooltip>\n            )}\n          </Avatar.Group>\n        </div>\n\n        {/* Duration Text */}\n        <div className=\"flex justify-center items-center\">\n          <span className={`text-[11px] font-['Manrope:Medium',sans-serif] ${textColor}`}>\n            {formatHours(totalHours)}h / {formatDuration(task.estTime)}h\n          </span>\n        </div>\n\n\n\n        {/* Progress Bar - Always Show */}\n        <div className=\"flex flex-col gap-1 w-full justify-center\">\n          <div className=\"flex flex-col gap-0.5\">\n            <div className=\"flex justify-end\">\n              <span className={`text-[10px] font-bold ${textColor}`}>\n                {Math.round(percentage)}%\n              </span>\n            </div>\n            <SegmentedProgressBar\n              members={liveMembers}\n              totalEstimate={task.estTime}\n              taskStatus={task.status}\n            />\n          </div>\n        </div>\n\n        {/* Status (Aggregated) or Estimate Button */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          {isPendingEstimate ? (\n            // ESTIMATE Button when pending\n            <Popover\n              open={estimateOpen}\n              onOpenChange={setEstimateOpen}\n              trigger=\"click\"\n              content={\n                <div className=\"p-2 w-48\">\n                  <p className=\"text-xs font-medium mb-2\">Your Estimate</p>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"Hours\"\n                    value={estimateHours}\n                    onChange={(e) => setEstimateHours(e.target.value)}\n                    className=\"mb-4 text-sm\"\n                  />\n                  <Button\n                    type=\"primary\"\n                    size=\"small\"\n                    loading={submissionLoading}\n                    className=\"w-full bg-[#EAB308] text-black\"\n                    onClick={async () => {\n                      if (!estimateHours) return;\n                      setSubmissionLoading(true);\n                      try {\n                        await provideEstimate(Number(task.id), Number(estimateHours));\n                        message.success(\"Estimate submitted\");\n                        setEstimateOpen(false);\n                        window.location.reload();\n                      } catch (err) {\n                        message.error(\"Failed\");\n                      } finally {\n                        setSubmissionLoading(false);\n                      }\n                    }}\n                  >\n                    Submit\n                  </Button>\n                </div>\n              }\n            >\n              <button\n                className=\"px-2 py-1 bg-yellow-400 hover:bg-yellow-500 text-black text-[10px] font-bold rounded-full flex items-center gap-1 shadow-sm transition-colors\"\n              >\n                <Clock className=\"w-3 h-3\" /> ESTIMATE\n              </button>\n            </Popover>\n          ) : (\n            <StatusBadge\n              status={task.status}\n            />\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end\" onClick={(e) => e.stopPropagation()}>\n          <Dropdown\n            menu={{\n              items: [\n                {\n                  key: 'edit',\n                  label: 'Edit',\n                  icon: <Edit className=\"w-3.5 h-3.5\" />,\n                  onClick: () => onEdit?.(),\n                  className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                },\n                {\n                  key: 'delete',\n                  label: 'Delete',\n                  icon: <Trash2 className=\"w-3.5 h-3.5\" />,\n                  onClick: () => onDelete?.(),\n                  danger: true,\n                  className: \"text-[13px] font-['Manrope:Medium',sans-serif]\"\n                },\n                {\n                  key: 'revision',\n                  label: 'Request Revision',\n                  icon: <RotateCcw className=\"w-3.5 h-3.5\" />,\n                  onClick: () => onRequestRevision?.(),\n                  disabled: task.status !== 'Review', // Typical threshold for revision\n                  className: \"text-[13px] font-['Manrope:Medium',sans-serif] text-[#ff3b3b]\"\n                }\n              ] as MenuProps['items']\n            }}\n            trigger={['click']}\n            placement=\"bottomRight\"\n          >\n            <button className=\"w-7 h-7 flex items-center justify-center rounded-full hover:bg-[#F7F7F7] transition-colors\">\n              <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n            </button>\n          </Dropdown>\n        </div>\n      </div>\n\n      {/* Worklog Modal for Stuck/Complete actions */}\n      <Modal\n        title={worklogAction === 'stuck' ? 'Mark as Blocked' : 'Mark as Complete'}\n        open={showWorklogModal}\n        onCancel={() => {\n          setShowWorklogModal(false);\n          setWorklogAction(null);\n          setWorklogDescription('');\n        }}\n        onOk={handleWorklogSubmit}\n        okText={worklogAction === 'stuck' ? 'Mark Blocked' : 'Mark Complete'}\n        okButtonProps={{\n          loading: worklogSubmitting,\n          danger: worklogAction === 'stuck',\n          style: worklogAction === 'complete' ? { backgroundColor: '#16a34a', borderColor: '#16a34a' } : undefined\n        }}\n        cancelButtonProps={{ disabled: worklogSubmitting }}\n      >\n        <div className=\"py-4\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Add a note (optional)\n          </label>\n          <Input.TextArea\n            value={worklogDescription}\n            onChange={(e) => setWorklogDescription(e.target.value)}\n            placeholder={worklogAction === 'stuck'\n              ? \"Describe what's blocking this task...\"\n              : \"Add final notes about this task...\"}\n            rows={4}\n            className=\"w-full\"\n          />\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nfunction StatusBadge({\n  status,\n}: {\n  status: string;\n}) {\n  // Map backend statuses to UI configuration with icons and colors matching old frontend\n  // User Req: \"Map both Stuck and Impediment to a single visual 'Blocked' badge\"\n\n  // Normalize status for UI\n  let uiStatus = status;\n  if (status === 'Stuck' || status === 'Impediment') {\n    uiStatus = 'Blocked';\n  }\n\n  const config: Record<string, {\n    icon: any;\n    bgColor: string;\n    iconColor: string;\n    label: string;\n    showCircle: boolean;\n    animate?: boolean;\n    pulse?: boolean;\n    val: string;\n  }> = {\n    'Assigned': {\n      icon: Clock,\n      bgColor: 'bg-transparent',\n      iconColor: 'text-[#0284c7]',\n      label: 'Assigned',\n      showCircle: false,\n      val: 'Assigned'\n    },\n    'In_Progress': {\n      icon: Loader2,\n      bgColor: 'bg-transparent',\n      iconColor: 'text-[#0284c7]',\n      label: 'In Progress',\n      showCircle: false,\n      animate: true,\n      val: 'In_Progress'\n    },\n    'Completed': {\n      icon: CheckCircle2,\n      bgColor: 'bg-[#16a34a]',\n      iconColor: 'text-white',\n      label: 'Completed',\n      showCircle: true,\n      val: 'Completed'\n    },\n    'Delayed': {\n      icon: AlertCircle,\n      bgColor: 'bg-[#dc2626]',\n      iconColor: 'text-white',\n      label: 'Delayed',\n      showCircle: true,\n      val: 'Delayed'\n    },\n    'Blocked': {\n      icon: XCircle,\n      bgColor: 'bg-[#ef4444]',\n      iconColor: 'text-white',\n      label: 'Blocked',\n      showCircle: true,\n      pulse: true,\n      val: 'Stuck'\n    },\n    'Review': {\n      icon: Eye,\n      bgColor: 'bg-transparent',\n      iconColor: 'text-[#fbbf24]',\n      label: 'Review',\n      showCircle: false,\n      val: 'Review'\n    }\n  };\n\n  const style = config[uiStatus] || config['Assigned'];\n  const Icon = style.icon;\n\n  return (\n    <div className=\"flex items-center justify-center\">\n      {style.showCircle ? (\n        <div className={`w-5 h-5 rounded-full ${style.bgColor} flex items-center justify-center ${style.pulse ? 'animate-pulse' : ''}`}>\n          <Icon className={`w-3 h-3 ${style.iconColor}`} />\n        </div>\n      ) : (\n        <Icon className={`w-4 h-4 ${style.iconColor} ${(style as any).animate ? 'animate-spin' : ''}`} />\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/workload/WorkloadChartPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSearchParams' is defined but never used.","line":4,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":666,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":666,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19667,19670],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19667,19670],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { useTabSync } from '@/hooks/useTabSync';\nimport { Users, TrendingUp, Clock, AlertCircle } from 'lucide-react';\nimport { PageLayout } from '../../layout/PageLayout';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Cell, LineChart, Line, Area, AreaChart } from 'recharts';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { Modal } from 'antd';\n\ninterface EmployeeWorkload {\n  id: string;\n  name: string;\n  role: string;\n  monday: number;\n  tuesday: number;\n  wednesday: number;\n  thursday: number;\n  friday: number;\n  saturday: number;\n  sunday: number;\n  total: number;\n  capacity: number;\n  week1: number;\n  week2: number;\n  week3: number;\n  week4: number;\n}\n\nconst employeeWorkloadData: EmployeeWorkload[] = [\n  {\n    id: '1',\n    name: 'Satyam Yadav',\n    role: 'Designer',\n    monday: 8,\n    tuesday: 7.5,\n    wednesday: 8,\n    thursday: 6,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 37.5,\n    capacity: 40,\n    week1: 38,\n    week2: 40,\n    week3: 37.5,\n    week4: 36\n  },\n  {\n    id: '2',\n    name: 'Appurva Panchabhai',\n    role: 'Project Manager',\n    monday: 8,\n    tuesday: 8,\n    wednesday: 8,\n    thursday: 8,\n    friday: 7,\n    saturday: 0,\n    sunday: 0,\n    total: 39,\n    capacity: 40,\n    week1: 40,\n    week2: 39,\n    week3: 39,\n    week4: 38.5\n  },\n  {\n    id: '3',\n    name: 'Pranita Kadav',\n    role: 'SEO Executive',\n    monday: 7,\n    tuesday: 8,\n    wednesday: 7.5,\n    thursday: 8,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 38.5,\n    capacity: 40,\n    week1: 39,\n    week2: 38.5,\n    week3: 38.5,\n    week4: 37\n  },\n\n  {\n    id: '4',\n    name: 'Sharifudeen',\n    role: 'Developer',\n    monday: 9,\n    tuesday: 8.5,\n    wednesday: 9,\n    thursday: 8,\n    friday: 9,\n    saturday: 4,\n    sunday: 0,\n    total: 47.5,\n    capacity: 40,\n    week1: 45,\n    week2: 47.5,\n    week3: 48,\n    week4: 46\n  },\n  {\n    id: '5',\n    name: 'Farheen',\n    role: 'Web Developer',\n    monday: 7,\n    tuesday: 7,\n    wednesday: 6.5,\n    thursday: 7,\n    friday: 7,\n    saturday: 0,\n    sunday: 0,\n    total: 34.5,\n    capacity: 40,\n    week1: 35,\n    week2: 34.5,\n    week3: 34,\n    week4: 36\n  },\n  {\n    id: '6',\n    name: 'Siddique Ahmed',\n    role: 'Full Stack Developer',\n    monday: 8.5,\n    tuesday: 9,\n    wednesday: 8,\n    thursday: 9,\n    friday: 8.5,\n    saturday: 0,\n    sunday: 0,\n    total: 43,\n    capacity: 40,\n    week1: 42,\n    week2: 43,\n    week3: 43.5,\n    week4: 41\n  },\n  {\n    id: '7',\n    name: 'Yusuf Sheikh',\n    role: 'Backend Developer',\n    monday: 8,\n    tuesday: 7.5,\n    wednesday: 8,\n    thursday: 7,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 38.5,\n    capacity: 40,\n    week1: 39,\n    week2: 38.5,\n    week3: 38,\n    week4: 39.5\n  },\n  {\n    id: '8',\n    name: 'Priya Sharma',\n    role: 'UI/UX Designer',\n    monday: 7.5,\n    tuesday: 8,\n    wednesday: 7,\n    thursday: 8,\n    friday: 7.5,\n    saturday: 0,\n    sunday: 0,\n    total: 38,\n    capacity: 40,\n    week1: 37.5,\n    week2: 38,\n    week3: 38.5,\n    week4: 37\n  },\n  {\n    id: '9',\n    name: 'Rahul Verma',\n    role: 'DevOps Engineer',\n    monday: 9,\n    tuesday: 9,\n    wednesday: 8.5,\n    thursday: 9,\n    friday: 9,\n    saturday: 5,\n    sunday: 0,\n    total: 49.5,\n    capacity: 40,\n    week1: 48,\n    week2: 49.5,\n    week3: 50,\n    week4: 47\n  },\n  {\n    id: '10',\n    name: 'Neha Patel',\n    role: 'Content Writer',\n    monday: 6.5,\n    tuesday: 7,\n    wednesday: 6,\n    thursday: 7,\n    friday: 6.5,\n    saturday: 0,\n    sunday: 0,\n    total: 33,\n    capacity: 40,\n    week1: 34,\n    week2: 33,\n    week3: 32.5,\n    week4: 35\n  },\n  {\n    id: '11',\n    name: 'Amit Kumar',\n    role: 'QA Engineer',\n    monday: 8,\n    tuesday: 8,\n    wednesday: 7.5,\n    thursday: 8,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 39.5,\n    capacity: 40,\n    week1: 40,\n    week2: 39.5,\n    week3: 39,\n    week4: 40\n  },\n  {\n    id: '12',\n    name: 'Sneha Desai',\n    role: 'Marketing Manager',\n    monday: 7.5,\n    tuesday: 8,\n    wednesday: 8,\n    thursday: 7,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 38.5,\n    capacity: 40,\n    week1: 39,\n    week2: 38.5,\n    week3: 38,\n    week4: 39\n  },\n  {\n    id: '13',\n    name: 'Arjun Singh',\n    role: 'Frontend Developer',\n    monday: 8.5,\n    tuesday: 8,\n    wednesday: 9,\n    thursday: 8.5,\n    friday: 8,\n    saturday: 0,\n    sunday: 0,\n    total: 42,\n    capacity: 40,\n    week1: 41,\n    week2: 42,\n    week3: 42.5,\n    week4: 40.5\n  },\n  {\n    id: '14',\n    name: 'Kavya Nair',\n    role: 'Graphic Designer',\n    monday: 6,\n    tuesday: 6.5,\n    wednesday: 6,\n    thursday: 5.5,\n    friday: 6,\n    saturday: 0,\n    sunday: 0,\n    total: 30,\n    capacity: 40,\n    week1: 31,\n    week2: 30,\n    week3: 29.5,\n    week4: 32\n  },\n  {\n    id: '15',\n    name: 'Vikram Malhotra',\n    role: 'Business Analyst',\n    monday: 8,\n    tuesday: 7.5,\n    wednesday: 8,\n    thursday: 8,\n    friday: 7.5,\n    saturday: 0,\n    sunday: 0,\n    total: 39,\n    capacity: 40,\n    week1: 38.5,\n    week2: 39,\n    week3: 39.5,\n    week4: 38\n  }\n];\n\nexport function WorkloadChartPage() {\n  const [activeTab, setActiveTab] = useTabSync<'daily' | 'week' | 'analytics' | 'monthly'>({\n    defaultTab: 'analytics',\n    validTabs: ['daily', 'week', 'analytics', 'monthly']\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    role: 'All',\n    utilization: 'All'\n  });\n  const [selectedEmployee, setSelectedEmployee] = useState<EmployeeWorkload | null>(null);\n\n  // Calculate statistics\n  const totalWeeklyHours = employeeWorkloadData.reduce((sum, emp) => sum + emp.total, 0);\n  const averageUtilization = (totalWeeklyHours / (employeeWorkloadData.length * 40)) * 100;\n  const overloadedEmployees = employeeWorkloadData.filter(emp => emp.total > emp.capacity).length;\n  // const underutilizedEmployees = employeeWorkloadData.filter(emp => emp.total < emp.capacity * 0.8).length; // Unused\n\n  const getBarColor = (hours: number, capacity: number) => {\n    const utilization = (hours / capacity) * 100;\n    if (utilization > 100) return '#ff3b3b';\n    if (utilization >= 90) return '#FF9800';\n    if (utilization >= 70) return '#4CAF50';\n    return '#2196F3';\n  };\n\n  const filteredEmployees = employeeWorkloadData.filter(emp => {\n    const matchesSearch = searchQuery === '' ||\n      emp.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      emp.role.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesRole = filters.role === 'All' || emp.role === filters.role;\n\n    const empUtilization = (emp.total / emp.capacity) * 100;\n    let matchesUtilization = true;\n    if (filters.utilization === 'Overloaded') matchesUtilization = empUtilization > 100;\n    else if (filters.utilization === 'High') matchesUtilization = empUtilization >= 90 && empUtilization <= 100;\n    else if (filters.utilization === 'Normal') matchesUtilization = empUtilization >= 70 && empUtilization < 90;\n    else if (filters.utilization === 'Low') matchesUtilization = empUtilization < 70;\n\n    return matchesSearch && matchesRole && matchesUtilization;\n  });\n\n  // Get unique roles for filter\n  const roles = ['All', ...Array.from(new Set(employeeWorkloadData.map(e => e.role)))];\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'role',\n      label: 'Role',\n      options: roles,\n      placeholder: 'Role',\n      defaultValue: 'All'\n    },\n    {\n      id: 'utilization',\n      label: 'Utilization',\n      options: ['All', 'Overloaded', 'High', 'Normal', 'Low'],\n      placeholder: 'Utilization Level',\n      defaultValue: 'All'\n    }\n  ];\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n  };\n\n  const clearFilters = () => {\n    setFilters({ role: 'All', utilization: 'All' });\n    setSearchQuery('');\n  };\n\n  // Prepare data for different views\n  const getDailyChartData = () => {\n    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n    const dayKeys = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] as const;\n\n    return days.map((day, index) => {\n      const totalHours = employeeWorkloadData.reduce((sum, emp) => sum + (emp[dayKeys[index]] as number), 0);\n      return {\n        day: day.substring(0, 3),\n        hours: totalHours,\n        average: totalHours / employeeWorkloadData.length\n      };\n    });\n  };\n\n  const getWeeklyChartData = () => {\n    return employeeWorkloadData.map(emp => ({\n      name: emp.name.split(' ')[0],\n      hours: emp.total,\n      capacity: emp.capacity,\n      utilization: (emp.total / emp.capacity) * 100\n    }));\n  };\n\n  const getMonthlyChartData = () => {\n    return ['Week 1', 'Week 2', 'Week 3', 'Week 4'].map((week, index) => {\n      const weekKey = `week${index + 1}` as keyof EmployeeWorkload;\n      const totalHours = employeeWorkloadData.reduce((sum, emp) => sum + (emp[weekKey] as number), 0);\n      return {\n        week,\n        hours: totalHours,\n        average: totalHours / employeeWorkloadData.length,\n        capacity: employeeWorkloadData.length * 40\n      };\n    });\n  };\n\n  const renderChart = () => {\n    if (activeTab === 'daily') {\n      const dailyData = getDailyChartData();\n      return (\n        <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-6 mb-6\">\n          <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[15px] text-[#111111] mb-4\">\n            Daily Workload Distribution\n          </h3>\n          <ResponsiveContainer width=\"100%\" height={300} minHeight={300} minWidth={0}>\n            <AreaChart data={dailyData}>\n              <defs>\n                <linearGradient id=\"colorHours\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                  <stop offset=\"5%\" stopColor=\"#ff3b3b\" stopOpacity={0.3} />\n                  <stop offset=\"95%\" stopColor=\"#ff3b3b\" stopOpacity={0} />\n                </linearGradient>\n              </defs>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#EEEEEE\" />\n              <XAxis\n                dataKey=\"day\"\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n              />\n              <YAxis\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n                label={{ value: 'Total Hours', angle: -90, position: 'insideLeft', style: { fill: '#666666', fontSize: 12 } }}\n              />\n              <Tooltip\n                contentStyle={{\n                  backgroundColor: '#ffffff',\n                  border: '1px solid #EEEEEE',\n                  borderRadius: '8px',\n                  fontSize: '12px'\n                }}\n              />\n              <Area\n                type=\"monotone\"\n                dataKey=\"hours\"\n                stroke=\"#ff3b3b\"\n                strokeWidth={2}\n                fillOpacity={1}\n                fill=\"url(#colorHours)\"\n                name=\"Total Hours\"\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"average\"\n                stroke=\"#666666\"\n                strokeDasharray=\"5 5\"\n                strokeWidth={1.5}\n                dot={false}\n                name=\"Average\"\n              />\n            </AreaChart>\n          </ResponsiveContainer>\n        </div>\n      );\n    } else if (activeTab === 'week') {\n      const weeklyData = getWeeklyChartData();\n      return (\n        <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-6 mb-6\">\n          <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[15px] text-[#111111] mb-4\">\n            Weekly Workload Overview\n          </h3>\n          <ResponsiveContainer width=\"100%\" height={300} minHeight={300}>\n            <BarChart data={weeklyData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#EEEEEE\" />\n              <XAxis\n                dataKey=\"name\"\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n              />\n              <YAxis\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n                label={{ value: 'Hours', angle: -90, position: 'insideLeft', style: { fill: '#666666', fontSize: 12 } }}\n              />\n              <Tooltip\n                contentStyle={{\n                  backgroundColor: '#ffffff',\n                  border: '1px solid #EEEEEE',\n                  borderRadius: '8px',\n                  fontSize: '12px'\n                }}\n              />\n              <Legend\n                wrapperStyle={{ fontSize: '12px', fontFamily: 'Manrope' }}\n              />\n              <Bar dataKey=\"hours\" name=\"Actual Hours\" radius={[8, 8, 0, 0]}>\n                {weeklyData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={getBarColor(entry.hours, entry.capacity)} />\n                ))}\n              </Bar>\n              <Bar dataKey=\"capacity\" name=\"Capacity\" fill=\"#DDDDDD\" radius={[8, 8, 0, 0]} />\n            </BarChart>\n          </ResponsiveContainer>\n\n          {/* Legend */}\n          <div className=\"flex items-center justify-center gap-6 mt-6\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#2196F3]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Under 70%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#4CAF50]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                70-90%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#FF9800]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                90-100%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#ff3b3b]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Over 100%\n              </span>\n            </div>\n          </div>\n        </div>\n      );\n    } else if (activeTab === 'monthly') {\n      const monthlyData = getMonthlyChartData();\n      return (\n        <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-6 mb-6\">\n          <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[15px] text-[#111111] mb-4\">\n            Monthly Workload Trend\n          </h3>\n          <ResponsiveContainer width=\"100%\" height={300} minHeight={300} minWidth={0}>\n            <LineChart data={monthlyData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#EEEEEE\" />\n              <XAxis\n                dataKey=\"week\"\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n              />\n              <YAxis\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n                label={{ value: 'Total Hours', angle: -90, position: 'insideLeft', style: { fill: '#666666', fontSize: 12 } }}\n              />\n              <Tooltip\n                contentStyle={{\n                  backgroundColor: '#ffffff',\n                  border: '1px solid #EEEEEE',\n                  borderRadius: '8px',\n                  fontSize: '12px'\n                }}\n              />\n              <Legend\n                wrapperStyle={{ fontSize: '12px', fontFamily: 'Manrope' }}\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"hours\"\n                stroke=\"#ff3b3b\"\n                strokeWidth={3}\n                dot={{ fill: '#ff3b3b', r: 5 }}\n                name=\"Total Hours\"\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"capacity\"\n                stroke=\"#DDDDDD\"\n                strokeWidth={2}\n                strokeDasharray=\"5 5\"\n                dot={{ fill: '#DDDDDD', r: 4 }}\n                name=\"Team Capacity\"\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n      );\n    } else {\n      // Analytics view - combined view\n      const weeklyData = getWeeklyChartData();\n      return (\n        <div className=\"bg-white border border-[#EEEEEE] rounded-[16px] p-6 mb-6\">\n          <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[15px] text-[#111111] mb-4\">\n            Team Workload Analytics\n          </h3>\n          <ResponsiveContainer width=\"100%\" height={300} minHeight={300}>\n            <BarChart data={weeklyData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#EEEEEE\" />\n              <XAxis\n                dataKey=\"name\"\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n              />\n              <YAxis\n                tick={{ fill: '#666666', fontSize: 12, fontFamily: 'Manrope' }}\n                label={{ value: 'Hours', angle: -90, position: 'insideLeft', style: { fill: '#666666', fontSize: 12 } }}\n              />\n              <Tooltip\n                contentStyle={{\n                  backgroundColor: '#ffffff',\n                  border: '1px solid #EEEEEE',\n                  borderRadius: '8px',\n                  fontSize: '12px'\n                }}\n              />\n              <Legend\n                wrapperStyle={{ fontSize: '12px', fontFamily: 'Manrope' }}\n              />\n              <Bar dataKey=\"hours\" name=\"Actual Hours\" radius={[8, 8, 0, 0]}>\n                {weeklyData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={getBarColor(entry.hours, entry.capacity)} />\n                ))}\n              </Bar>\n              <Bar dataKey=\"capacity\" name=\"Capacity\" fill=\"#DDDDDD\" radius={[8, 8, 0, 0]} />\n            </BarChart>\n          </ResponsiveContainer>\n\n          {/* Legend */}\n          <div className=\"flex items-center justify-center gap-6 mt-6\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#2196F3]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Under 70%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#4CAF50]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                70-90%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#FF9800]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                90-100%\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-3 h-3 rounded bg-[#ff3b3b]\" />\n              <span className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                Over 100%\n              </span>\n            </div>\n          </div>\n        </div>\n      );\n    }\n  };\n\n  return (\n    <PageLayout\n      title=\"Workload Chart\"\n      tabs={[\n        { id: 'daily', label: 'Daily' },\n        { id: 'week', label: 'Week' },\n        { id: 'analytics', label: 'Analytics' },\n        { id: 'monthly', label: 'Monthly' }\n      ]}\n      activeTab={activeTab}\n      onTabChange={(tabId) => setActiveTab(tabId as any)}\n    >\n      {/* Filter Bar */}\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={handleFilterChange}\n          onClearFilters={clearFilters}\n          searchPlaceholder=\"Search employees...\"\n          searchValue={searchQuery}\n          onSearchChange={setSearchQuery}\n        />\n      </div>\n\n      {/* Statistics Cards */}\n      <div className=\"grid grid-cols-4 gap-4 mb-6\">\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Users className=\"w-5 h-5 text-[#666666]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Total Employees\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            {employeeWorkloadData.length}\n          </p>\n        </div>\n\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Clock className=\"w-5 h-5 text-[#4CAF50]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Total Hours\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            {totalWeeklyHours.toFixed(1)}h\n          </p>\n        </div>\n\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <TrendingUp className=\"w-5 h-5 text-[#2196F3]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Avg Utilization\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            {averageUtilization.toFixed(1)}%\n          </p>\n        </div>\n\n        <div className=\"border border-[#EEEEEE] rounded-[16px] p-5\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <AlertCircle className=\"w-5 h-5 text-[#ff3b3b]\" />\n            <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#999999]\">\n              Overloaded\n            </span>\n          </div>\n          <p className=\"font-['Manrope:Bold',sans-serif] text-[24px] text-[#111111]\">\n            {overloadedEmployees}\n          </p>\n        </div>\n      </div>\n\n      {/* Chart based on active tab */}\n      {renderChart()}\n\n      {/* Employee Workload Details */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[15px] text-[#111111] mb-4\">\n          Employee Details\n        </h3>\n        <div className=\"space-y-3\">\n          {filteredEmployees.map((employee) => {\n            const utilization = (employee.total / employee.capacity) * 100;\n            const utilizationColor =\n              utilization > 100\n                ? '#ff3b3b'\n                : utilization >= 90\n                  ? '#FF9800'\n                  : utilization >= 70\n                    ? '#4CAF50'\n                    : '#2196F3';\n\n            return (\n              <div\n                key={employee.id}\n                onClick={() => setSelectedEmployee(employee)}\n                className=\"bg-[#F7F7F7] rounded-[16px] p-5 hover:bg-[#EEEEEE] transition-all cursor-pointer\"\n              >\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div>\n                    <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] mb-1\">\n                      {employee.name}\n                    </h4>\n                    <p className=\"text-[12px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                      {employee.role}\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"font-['Manrope:Bold',sans-serif] text-[18px] text-[#111111]\">\n                      {employee.total}h\n                    </p>\n                    <p className=\"text-[11px] font-['Manrope:Regular',sans-serif] text-[#666666]\">\n                      of {employee.capacity}h\n                    </p>\n                  </div>\n                </div>\n\n                {/* Utilization Bar */}\n                <div className=\"mb-3\">\n                  <div className=\"flex items-center justify-between mb-1\">\n                    <span className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                      Utilization\n                    </span>\n                    <span\n                      className=\"text-[11px] font-['Manrope:SemiBold',sans-serif]\"\n                      style={{ color: utilizationColor }}\n                    >\n                      {utilization.toFixed(1)}%\n                    </span>\n                  </div>\n                  <div className=\"w-full h-2 bg-white rounded-full overflow-hidden\">\n                    <div\n                      className=\"h-full rounded-full transition-all\"\n                      style={{\n                        width: `${Math.min(utilization, 100)}%`,\n                        backgroundColor: utilizationColor\n                      }}\n                    />\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Employee Details Modal */}\n      <Modal\n        open={!!selectedEmployee}\n        onCancel={() => setSelectedEmployee(null)}\n        width={500}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n      >\n        {selectedEmployee && (\n          <div className=\"p-0\">\n            <div className=\"flex items-center justify-between mb-6\">\n              <div>\n                <h2 className=\"text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111]\">{selectedEmployee.name}</h2>\n                <p className=\"text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif]\">{selectedEmployee.role}</p>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-[24px] font-['Manrope:Bold',sans-serif] text-[#111111]\">{selectedEmployee.total}h</p>\n                <p className=\"text-[12px] text-[#666666] font-['Manrope:Regular',sans-serif]\">Total Hours</p>\n              </div>\n            </div>\n\n            <h3 className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#111111] mb-3\">Daily Breakdown</h3>\n            <div className=\"space-y-2\">\n              {['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'].map((day) => {\n                const key = day.toLowerCase() as keyof EmployeeWorkload;\n                const hours = selectedEmployee[key] as number;\n                return (\n                  <div key={day} className=\"flex items-center justify-between p-3 bg-[#F7F7F7] rounded-lg\">\n                    <span className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#666666]\">{day}</span>\n                    <span className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">{hours > 0 ? `${hours}h` : '-'}</span>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        )}\n      </Modal>\n\n    </PageLayout>\n  );\n}\n\nexport default WorkloadChartPage;","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/workspaces/WorkspacePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is assigned a value but never used.","line":18,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1568,1571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1568,1571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2575,2578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2575,2578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3130,3133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3130,3133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3224,3227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3224,3227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3770,3773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3770,3773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4170,4173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4170,4173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":118,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":121,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5876,5879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5876,5879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6173,6176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6173,6176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":171,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6234,6237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6234,6237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":279,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10642,10645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10642,10645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11362,11365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11362,11365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":299,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11499,11502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11499,11502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":300,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":300,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11587,11590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11587,11590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":320,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":320,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12565,12568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12565,12568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { FolderOpen, Plus, LayoutGrid, List, MoreVertical, Edit, Trash2, RotateCcw } from 'lucide-react';\nimport { PaginationBar } from '../../ui/PaginationBar';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { Modal, Dropdown, MenuProps, Checkbox, App } from \"antd\";\nimport { WorkspaceForm } from '@/components/modals/WorkspaceForm';\n\nimport { useWorkspaces, useDeleteWorkspace, useReactivateWorkspace } from '@/hooks/useWorkspace';\nimport { usePartners, useCurrentUserCompany } from '@/hooks/useUser';\nimport { useQueries } from '@tanstack/react-query';\nimport { getRequirementsByWorkspaceId } from '@/services/workspace';\n\nimport { Workspace } from '@/types/domain';\nexport function WorkspacePage() {\n  const { message } = App.useApp();\n\n  const { data: partnersData } = usePartners();\n  const { data: companyData } = useCurrentUserCompany();\n  const router = useRouter();\n\n  const [activeTab, setActiveTab] = useState<'active' | 'archived'>('active');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [filters, setFilters] = useState<Record<string, string>>({});\n  const [selectedWorkspaces, setSelectedWorkspaces] = useState<number[]>([]);\n\n  // Modal State\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [selectedWorkspaceForEdit, setSelectedWorkspaceForEdit] = useState<any>(null);\n\n  const [pageSize, setPageSize] = useState(10);\n\n  // Build query string for API\n  const queryParams = useMemo(() => {\n    const params = new URLSearchParams();\n    \n    // Pagination (Backend expects skip/limit, frontend uses page/pageSize)\n    const skip = (currentPage - 1) * pageSize;\n    params.append('skip', skip.toString());\n    params.append('limit', pageSize.toString());\n\n    // Status / Tab\n    if (activeTab === 'active') {\n      params.append('is_active', 'true');\n    } else {\n      params.append('is_active', 'false');\n    }\n\n    // Search\n    if (searchQuery) {\n      params.append('name', searchQuery);\n    }\n\n    // Filters\n    if (filters.organization && filters.organization !== 'All') {\n       const selfLabel = `${companyData?.result?.name || 'Current Company'} (Self)`;\n       if (filters.organization === selfLabel || filters.organization === 'Self') {\n         params.append('in_house', 'true');\n       } else {\n         const partner = partnersData?.result?.find((p: any) => (p.name || p.partner_company?.name || p.email) === filters.organization);\n         if (partner) params.append('partner_id', partner.id.toString());\n       }\n    }\n\n\n    return params.toString();\n  }, [activeTab, currentPage, pageSize, searchQuery, filters, partnersData]);\n\n\n  const { data: workspacesData, isLoading, refetch } = useWorkspaces(queryParams);\n\n  useEffect(() => {\n    refetch();\n  }, [queryParams, refetch]);\n\n\n  // Get all workspace IDs\n  const workspaceIds = useMemo(() => {\n    return workspacesData?.result?.workspaces?.map((w: any) => w.id) || [];\n  }, [workspacesData]);\n\n  const totalItems = (workspacesData?.result as any)?.total_count || 0;\n\n  // Fetch requirements for all workspaces\n  const requirementQueries = useQueries({\n    queries: workspaceIds.map((id: number) => ({\n      queryKey: ['requirements', id],\n      queryFn: () => getRequirementsByWorkspaceId(id),\n      enabled: !!id && workspaceIds.length > 0,\n    })),\n  });\n\n  // Transform backend data to frontend format with requirements counts\n  const workspaces = useMemo((): Workspace[] => {\n    if (!workspacesData?.result?.workspaces) return [];\n    return workspacesData.result.workspaces.map((w: any) => {\n      // Find requirements for this workspace\n      const reqQuery = requirementQueries.find((q, idx) => workspaceIds[idx] === w.id);\n      const requirements = reqQuery?.data?.result || [];\n\n      // Calculate requirement counts\n      const totalRequirements = requirements.length;\n      let inProgressRequirements = 0;\n      let delayedRequirements = 0;\n\n      requirements.forEach((req: any) => {\n        const status = (req.status || '').toLowerCase();\n        if (status.includes('completed') || status === 'done') {\n          // Completed - don't count in progress or delayed\n        } else if (status.includes('delayed') || status.includes('stuck') || status.includes('impediment')) {\n          delayedRequirements++;\n        } else {\n          // In progress, assigned, etc.\n          inProgressRequirements++;\n        }\n      });\n\n      return {\n        id: w.id,\n        name: w.name,\n        taskCount: w.total_task || 0,\n        inProgressCount: w.total_task_in_progress || 0,\n        delayedCount: w.total_task_delayed || 0,\n        completedCount: w.total_task_completed || 0,\n        // Requirements data\n        totalRequirements,\n        inProgressRequirements,\n        delayedRequirements,\n        // Use exact status from backend\n        status: w.status || 'Assigned',\n        isActive: w.is_active ?? true, \n        description: w.description || '',\n        partner_id: w.partner_id,\n        in_house: w.in_house,\n        partner_name: w.partner_name,\n        company_name: w.company_name\n      };\n    });\n  }, [workspacesData, requirementQueries, workspaceIds]);\n\n  const handleFilterChange = (filterId: string, value: string) => {\n    setFilters(prev => ({ ...prev, [filterId]: value }));\n    setCurrentPage(1);\n  };\n\n  const clearFilters = () => {\n    setFilters({});\n    setSearchQuery('');\n    setCurrentPage(1);\n    setSelectedWorkspaces([]);\n  };\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'organization',\n      label: 'Organization',\n      options: ['All', `${companyData?.result?.name || 'Current Company'} (Self)`, ...(partnersData?.result?.map((p: any) => p.name || p.partner_company?.name || p.email) || [])],\n      defaultValue: 'All'\n    }\n  ];\n\n  // No client-side filtering needed anymore as it's handled by API\n\n  const toggleSelectAllWorkspaces = () => {\n    if (workspaces.length === 0) return;\n    const currentIds = workspaces.map((w: any) => w.id);\n    const allSelected = currentIds.every((id: any) => selectedWorkspaces.includes(id));\n\n    if (allSelected) {\n      // Deselect only the ones on this page\n      setSelectedWorkspaces((prev) => prev.filter((id) => !currentIds.includes(id)));\n    } else {\n      // Add all current page ids\n      setSelectedWorkspaces((prev) => Array.from(new Set([...prev, ...currentIds])));\n    }\n  };\n\n  const toggleSelectWorkspaceRow = (id: number) => {\n    setSelectedWorkspaces((prev) =>\n      prev.includes(id) ? prev.filter((wId) => wId !== id) : [...prev, id]\n    );\n  };\n\n  const handleSelectWorkspace = (workspace: Workspace) => {\n    router.push(`/dashboard/workspace/${workspace.id}/requirements`);\n  };\n\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] p-8 flex flex-col overflow-hidden\">\n      {/* Header Section */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-2\">\n            <h2 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">Workspace</h2>\n            <button onClick={() => { setSelectedWorkspaceForEdit(null); setIsDialogOpen(true); }} className=\"hover:scale-110 active:scale-95 transition-transform\">\n              <Plus className=\"size-5 text-[#ff3b3b]\" strokeWidth={2} />\n            </button>\n            <WorkspaceForm\n              open={isDialogOpen}\n              initialData={selectedWorkspaceForEdit}\n              onCancel={() => { setIsDialogOpen(false); setSelectedWorkspaceForEdit(null); }}\n              onSuccess={() => {\n                setIsDialogOpen(false);\n                setSelectedWorkspaceForEdit(null);\n                refetch();\n              }}\n            />\n          </div>\n\n          {/* View Toggle */}\n          <div className=\"flex items-center bg-[#F7F7F7] p-1 rounded-lg border border-[#EEEEEE]\">\n            <button\n              onClick={() => setViewMode('grid')}\n              className={`p-1.5 rounded-md transition-all ${viewMode === 'grid' ? 'bg-white text-[#ff3b3b] shadow-sm' : 'text-[#999999] hover:text-[#111111]'}`}\n            >\n              <LayoutGrid className=\"w-4 h-4\" />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={`p-1.5 rounded-md transition-all ${viewMode === 'list' ? 'bg-white text-[#ff3b3b] shadow-sm' : 'text-[#999999] hover:text-[#111111]'}`}\n            >\n              <List className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"flex items-center\">\n          <div className=\"flex items-center gap-8 border-b border-[#EEEEEE]\">\n            <button\n              onClick={() => { setActiveTab('active'); setCurrentPage(1); }}\n              className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors ${activeTab === 'active'\n                ? 'text-[#ff3b3b]'\n                : 'text-[#666666] hover:text-[#111111]'\n                }`}\n            >\n              Active\n              {activeTab === 'active' && (\n                <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />\n              )}\n            </button>\n            <button\n              onClick={() => { setActiveTab('archived'); setCurrentPage(1); }}\n              className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors ${activeTab === 'archived'\n                ? 'text-[#ff3b3b]'\n                : 'text-[#666666] hover:text-[#111111]'\n                }`}\n            >\n              Archived\n              {activeTab === 'archived' && (\n                <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters Bar */}\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={handleFilterChange}\n          onClearFilters={clearFilters}\n          searchPlaceholder=\"Search workspace...\"\n          searchValue={searchQuery}\n          onSearchChange={setSearchQuery}\n        />\n      </div>\n\n      {/* Workspace Content */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {viewMode === 'grid' ? (\n          <div className=\"grid grid-cols-4 gap-4\">\n            {workspaces.map((workspace: any) => (\n              <WorkspaceCard\n                key={workspace.id}\n                workspace={workspace}\n                onClick={() => handleSelectWorkspace(workspace)}\n              />\n            ))}\n          </div>\n        ) : (\n          <div className=\"flex flex-col gap-3\">\n            {/* List header – aligned with rows, matches dashboard style */}\n            <div className=\"grid grid-cols-[40px_1.5fr_1.8fr_0.8fr_0.5fr_40px] gap-4 px-4 py-3 items-center bg-white\">\n              <div className=\"flex justify-center\">\n                <Checkbox\n                  className=\"red-checkbox\"\n                  checked={\n                    workspaces.length > 0 &&\n                    workspaces.every((w: any) => selectedWorkspaces.includes(w.id))\n                  }\n                  indeterminate={\n                    workspaces.some((w: any) => selectedWorkspaces.includes(w.id)) &&\n                    !workspaces.every((w: any) => selectedWorkspaces.includes(w.id))\n                  }\n                  onChange={toggleSelectAllWorkspaces}\n                />\n              </div>\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                Workspace Name\n              </p>\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                Requirements\n              </p>\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                Organization\n              </p>\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n                Status\n              </p>\n              <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\" />\n            </div>\n\n            {workspaces.map((workspace: any) => (\n              <WorkspaceListItem\n                key={workspace.id}\n                workspace={workspace}\n                selected={selectedWorkspaces.includes(workspace.id)}\n                onToggleSelect={() => toggleSelectWorkspaceRow(workspace.id)}\n                onClick={() => handleSelectWorkspace(workspace)}\n              />\n            ))}\n          </div>\n        )}\n\n        {isLoading ? (\n          <div className=\"text-center py-12\">\n            <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">Loading workspaces...</p>\n          </div>\n        ) : workspaces.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <FolderOpen className=\"w-12 h-12 text-[#DDDDDD] mx-auto mb-3\" />\n            <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">\n              No workspaces found\n            </p>\n          </div>\n        ) : null}\n      </div>\n\n      {/* Pagination */}\n      {totalItems > 0 && (\n        <PaginationBar\n          currentPage={currentPage}\n          totalItems={totalItems}\n          pageSize={pageSize}\n          onPageChange={setCurrentPage}\n          onPageSizeChange={(size) => {\n            setPageSize(size);\n            setCurrentPage(1);\n          }}\n          itemLabel=\"workspaces\"\n        />\n      )}\n    </div>\n  );\n}\n\nfunction WorkspaceRequirementsSummary({\n  total,\n  inProgress,\n  delayed\n}: {\n  total: number;\n  inProgress: number;\n  delayed: number;\n}) {\n  return (\n    <div>\n      <p className=\"text-[10px] text-[#999999] font-['Manrope:Bold',sans-serif] uppercase tracking-wider text-center mb-3\">Requirements</p>\n      <div className=\"grid grid-cols-3 divide-x divide-[#EEEEEE]\">\n        <div className=\"flex flex-col items-center px-1\">\n          <span className=\"text-[10px] text-[#999999] font-['Inter:Medium',sans-serif] uppercase tracking-wider mb-0.5\">Total</span>\n          <span className=\"text-[13px] text-[#111111] font-['Manrope:Bold',sans-serif]\">{total}</span>\n        </div>\n        <div className=\"flex flex-col items-center px-1\">\n          <span className=\"text-[10px] text-[#999999] font-['Inter:Medium',sans-serif] uppercase tracking-wider mb-0.5\">Progress</span>\n          <span className=\"text-[13px] text-[#0284C7] font-['Manrope:Bold',sans-serif]\">{inProgress}</span>\n        </div>\n        <div className=\"flex flex-col items-center px-1\">\n          <span className=\"text-[10px] text-[#999999] font-['Inter:Medium',sans-serif] uppercase tracking-wider mb-0.5\">Delayed</span>\n          <span className=\"text-[13px] text-[#DC2626] font-['Manrope:Bold',sans-serif]\">{delayed}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction WorkspaceCard({ workspace, onClick }: { workspace: Workspace; onClick?: () => void }) {\n  const { message } = App.useApp();\n  const deleteMutation = useDeleteWorkspace();\n  const reactivateMutation = useReactivateWorkspace();\n  const [isEditOpen, setIsEditOpen] = useState(false);\n\n  const handleAction = async (key: string) => {\n    if (key === 'delete') {\n      const reqCount = workspace.totalRequirements || 0;\n      if (reqCount === 0) {\n        Modal.confirm({\n          title: 'Delete Workspace',\n          content: `You are about to delete \"${workspace.name}\". This action is permanent.`,\n          okText: 'Delete',\n          okType: 'danger',\n          cancelText: 'Cancel',\n          onOk: () => {\n            deleteMutation.mutate(workspace.id, {\n              onSuccess: () => message.success('Workspace deleted successfully'),\n            });\n          },\n        });\n      } else {\n        Modal.confirm({\n          title: 'Cannot Delete Workspace',\n          content: `This workspace has ${reqCount} requirements. You cannot delete it, but you can archive it instead.`,\n          okText: 'Archive',\n          cancelText: 'Cancel',\n          onOk: () => {\n            deleteMutation.mutate(workspace.id, {\n              onSuccess: () => message.success('Workspace archived successfully'),\n            });\n          },\n        });\n      }\n    } else if (key === 'restore') {\n      reactivateMutation.mutate(workspace.id, {\n        onSuccess: () => message.success('Workspace restored successfully'),\n      });\n    } else if (key === 'edit') {\n      setIsEditOpen(true);\n    }\n  };\n\n  const items: MenuProps['items'] = workspace.isActive \n    ? [\n        { key: 'edit', label: 'Edit Details', icon: <Edit className=\"w-4 h-4\" /> },\n        { key: 'delete', label: 'Delete', icon: <Trash2 className=\"w-4 h-4\" />, danger: true }\n      ]\n    : [\n        { key: 'edit', label: 'Edit Details', icon: <Edit className=\"w-4 h-4\" /> },\n        { key: 'restore', label: 'Restore', icon: <RotateCcw className=\"w-4 h-4\" /> }\n      ];\n\n  return (\n    <>\n      <div\n        role=\"button\"\n        tabIndex={0}\n        onClick={onClick}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter' || e.key === ' ') {\n            e.preventDefault();\n            onClick?.();\n          }\n        }}\n        className=\"group relative bg-white border border-[#EEEEEE] rounded-[16px] p-5 hover:border-[#ff3b3b] hover:shadow-lg hover:shadow-[#ff3b3b]/10 transition-all cursor-pointer overflow-hidden flex flex-col h-[180px]\"\n      >\n        {/* Accent bar */}\n        <div className=\"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-[#ff3b3b] to-[#ff6b6b] opacity-0 group-hover:opacity-100 transition-opacity\" />\n\n        {/* Action Menu - Absolute Positioned */}\n        <div className=\"absolute top-3 right-3 z-20\" onClick={(e) => e.stopPropagation()}>\n          <Dropdown menu={{ items, onClick: ({ key }) => handleAction(key) }} trigger={['click']} placement=\"bottomRight\">\n            <button className=\"w-8 h-8 rounded-lg hover:bg-[#F7F7F7] flex items-center justify-center transition-colors opacity-0 group-hover:opacity-100\">\n              <MoreVertical className=\"w-5 h-5 text-[#666666]\" />\n            </button>\n          </Dropdown>\n        </div>\n\n        <div className=\"flex flex-col h-full\">\n          {/* Header: Icon + Details Side-by-Side */}\n          <div className=\"flex items-start gap-4 mb-auto pr-8\">\n            {/* Folder Icon */}\n            <div className=\"shrink-0 w-12 h-12 rounded-[14px] bg-[#FEF3F2] border border-[#ff3b3b]/10 flex items-center justify-center group-hover:bg-[#ff3b3b] transition-all duration-300\">\n              <FolderOpen className=\"w-6 h-6 text-[#ff3b3b] group-hover:text-white transition-colors\" />\n            </div>\n\n            {/* Text Details */}\n            <div className=\"flex flex-col pt-0.5 min-w-0\">\n              <h3 className=\"font-['Manrope:Bold',sans-serif] text-[16px] text-[#111111] leading-snug mb-0.5 truncate w-full\">\n                {workspace.name}\n              </h3>\n              <p className=\"text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif] truncate\">\n                {workspace.in_house ? workspace.company_name : workspace.partner_name || 'Organization'}\n              </p>\n            </div>\n          </div>\n\n          {/* Footer: Stats */}\n          <div className=\"border-t border-[#EEEEEE] pt-4 mt-auto\">\n            <WorkspaceRequirementsSummary\n              total={workspace.totalRequirements || 0}\n              inProgress={workspace.inProgressRequirements || 0}\n              delayed={workspace.delayedRequirements || 0}\n            />\n          </div>\n        </div>\n      </div>\n      <WorkspaceForm\n        open={isEditOpen}\n        initialData={workspace}\n        onCancel={() => setIsEditOpen(false)}\n        onSuccess={() => setIsEditOpen(false)}\n      />\n    </>\n  );\n}\n\nfunction WorkspaceListItem({\n  workspace,\n  selected,\n  onToggleSelect,\n  onClick,\n}: {\n  workspace: Workspace;\n  selected: boolean;\n  onToggleSelect: () => void;\n  onClick?: () => void;\n}) {\n  const deleteMutation = useDeleteWorkspace();\n  const reactivateMutation = useReactivateWorkspace();\n  const { message } = App.useApp();\n  const [isEditOpen, setIsEditOpen] = useState(false);\n\n  const handleAction = async (key: string) => {\n    if (key === 'delete') {\n      const reqCount = workspace.totalRequirements || 0;\n      if (reqCount === 0) {\n        Modal.confirm({\n          title: 'Delete Workspace',\n          content: `You are about to delete \"${workspace.name}\". This action is permanent.`,\n          okText: 'Delete',\n          okType: 'danger',\n          cancelText: 'Cancel',\n          onOk: () => {\n            deleteMutation.mutate(workspace.id, {\n              onSuccess: () => message.success('Workspace deleted successfully'),\n            });\n          },\n        });\n      } else {\n        Modal.confirm({\n          title: 'Cannot Delete Workspace',\n          content: `This workspace has ${reqCount} requirements. You cannot delete it, but you can archive it instead.`,\n          okText: 'Archive',\n          cancelText: 'Cancel',\n          onOk: () => {\n            deleteMutation.mutate(workspace.id, {\n              onSuccess: () => message.success('Workspace archived successfully'),\n            });\n          },\n        });\n      }\n    } else if (key === 'restore') {\n      reactivateMutation.mutate(workspace.id, {\n        onSuccess: () => message.success('Workspace restored successfully'),\n      });\n    } else if (key === 'edit') {\n      setIsEditOpen(true);\n    }\n  };\n\n  const items: MenuProps['items'] = workspace.isActive \n    ? [\n        { key: 'edit', label: 'Edit Details', icon: <Edit className=\"w-4 h-4\" /> },\n        { key: 'delete', label: 'Delete', icon: <Trash2 className=\"w-4 h-4\" />, danger: true }\n      ]\n    : [\n        { key: 'edit', label: 'Edit Details', icon: <Edit className=\"w-4 h-4\" /> },\n        { key: 'restore', label: 'Restore', icon: <RotateCcw className=\"w-4 h-4\" /> }\n      ];\n\n\n\n  return (\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onClick={onClick}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onClick?.();\n        }\n      }}\n      className=\"group bg-white border border-[#F3F4F6] rounded-[12px] px-4 py-3 hover:border-[#ff3b3b] hover:shadow-md transition-all cursor-pointer\"\n    >\n      <div className=\"grid grid-cols-[40px_1.5fr_1.8fr_0.8fr_0.5fr_40px] items-center gap-4\">\n        {/* Checkbox */}\n        <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n          <Checkbox\n            className=\"red-checkbox\"\n            checked={selected}\n            onChange={onToggleSelect}\n          />\n        </div>\n\n        {/* Workspace name */}\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-[10px] bg-[#FEF3F2] border border-[#ff3b3b]/20 flex items-center justify-center shrink-0 group-hover:bg-[#ff3b3b] transition-colors\">\n            <FolderOpen className=\"w-5 h-5 text-[#ff3b3b] group-hover:text-white transition-colors\" />\n          </div>\n          <div className=\"flex flex-col\">\n            <h3 className=\"font-['Manrope:SemiBold',sans-serif] text-[14px] text-[#111111] line-clamp-1\">\n              {workspace.name}\n            </h3>\n          </div>\n        </div>\n\n        {/* Requirements Stats */}\n        <div className=\"flex items-center gap-6\">\n          <div className=\"flex flex-col\">\n            <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif] mb-0.5\">\n              Total\n            </span>\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n              {workspace.totalRequirements || 0}\n            </span>\n          </div>\n          <div className=\"flex flex-col\">\n            <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif] mb-0.5\">\n              Progress\n            </span>\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#2F80ED]\">\n              {workspace.inProgressRequirements || 0}\n            </span>\n          </div>\n          <div className=\"flex flex-col\">\n            <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif] mb-0.5\">\n              Delayed\n            </span>\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#ff3b3b]\">\n              {workspace.delayedRequirements || 0}\n            </span>\n          </div>\n        </div>\n\n        {/* Organization */}\n        <div className=\"flex items-center\">\n          <p className=\"text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif] truncate\">\n            {workspace.in_house ? workspace.company_name : workspace.partner_name || 'Organization'}\n          </p>\n        </div>\n\n        {/* Status */}\n        <div className=\"flex items-center\">\n          <span\n            className={`inline-flex items-center px-3 py-1 rounded-full text-[12px] font-['Manrope:SemiBold',sans-serif] whitespace-nowrap ${\n              workspace.isActive\n                ? 'bg-[#ECFDF3] text-[#16A34A]'\n                : 'bg-[#F3F4F6] text-[#6B7280]'\n              }`}\n          >\n            {workspace.status.replace(/_/g, ' ')}\n          </span>\n        </div>\n\n        {/* Action */}\n        <div className=\"flex justify-end\">\n          <Dropdown menu={{ items, onClick: ({ key }) => handleAction(key) }} trigger={['click']} placement=\"bottomRight\">\n            <button\n              onClick={(e) => e.stopPropagation()}\n              className=\"w-8 h-8 rounded-lg hover:bg-[#F7F7F7] flex items-center justify-center transition-colors opacity-0 group-hover:opacity-100\"\n            >\n              <MoreVertical className=\"w-5 h-5 text-[#666666]\" />\n            </button>\n          </Dropdown>\n        </div>\n      </div>\n      <WorkspaceForm\n        open={isEditOpen}\n        initialData={workspace}\n        onCancel={() => setIsEditOpen(false)}\n        onSuccess={() => setIsEditOpen(false)}\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/features/workspaces/WorkspaceRequirementsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2244,2247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2244,2247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5350,5353],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5350,5353],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5373,5376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5373,5376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":173,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6032,6035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6032,6035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6075,6078],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6075,6078],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { useRouter, useParams } from 'next/navigation';\nimport {\n  ArrowUp,\n  ArrowDown,\n  MoreVertical,\n  CheckCircle2,\n  AlertCircle,\n  Loader2,\n  Calendar as CalendarIcon,\n} from 'lucide-react';\nimport { Breadcrumb, Checkbox, Dropdown, MenuProps, Progress, Tooltip } from 'antd';\nimport { TabBar } from '../../layout/TabBar';\nimport { FilterBar, FilterOption } from '../../ui/FilterBar';\nimport { useWorkspace, useRequirements } from '@/hooks/useWorkspace';\nimport { format } from 'date-fns';\n\nexport function WorkspaceRequirementsPage() {\n  const params = useParams();\n  const workspaceId = Number(params.workspaceId);\n  const router = useRouter();\n\n  const { data: workspaceData, isLoading: isLoadingWorkspace } = useWorkspace(workspaceId);\n  const { data: requirementsData, isLoading: isLoadingRequirements } = useRequirements(workspaceId);\n\n  const [activeTab, setActiveTab] = useState<'all' | 'in-progress' | 'completed' | 'delayed'>('all');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    priority: 'All',\n  });\n  const [sortColumn, setSortColumn] = useState<string | null>(null);\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\n\n  // Map backend status to UI buckets\n  const mapRequirementStatus = (status: string): 'in-progress' | 'completed' | 'delayed' => {\n    const statusLower = status?.toLowerCase() || '';\n    if (statusLower.includes('completed') || statusLower === 'done') return 'completed';\n    if (\n      statusLower.includes('delayed') ||\n      statusLower.includes('stuck') ||\n      statusLower.includes('impediment')\n    ) {\n      return 'delayed';\n    }\n    return 'in-progress';\n  };\n\n  const workspace = useMemo(() => {\n    if (!workspaceData?.result) return null;\n    return {\n      id: workspaceData.result.id,\n      name: workspaceData.result.name || '',\n      client:\n        workspaceData.result.client_user?.name ||\n        workspaceData.result.client_company_name ||\n        'N/A',\n    };\n  }, [workspaceData]);\n\n  const requirements = useMemo(() => {\n    if (!requirementsData?.result) return [];\n\n    return requirementsData.result.map((req: any) => {\n      const assigned: string[] = [];\n      if (req.manager?.name) assigned.push(req.manager.name);\n      if (req.leader?.name && !assigned.includes(req.leader.name)) assigned.push(req.leader.name);\n\n      const start = req.start_date ? new Date(req.start_date) : null;\n      const end = req.end_date ? new Date(req.end_date) : null;\n\n      let timeline = 'No date';\n      if (start && end) {\n        timeline = `${format(start, 'MMM d')} - ${format(end, 'MMM d')}`;\n      } else if (start) {\n        timeline = `From ${format(start, 'MMM d')}`;\n      } else if (end) {\n        timeline = `Until ${format(end, 'MMM d')}`;\n      }\n\n      const progress = req.progress || 0;\n      const totalTasks = req.total_tasks || 0;\n      const completedTasks = totalTasks ? Math.floor((totalTasks * progress) / 100) : 0;\n\n      const status = mapRequirementStatus(req.status || '');\n      const priority = (req.priority?.toLowerCase() as 'high' | 'medium' | 'low') || 'medium';\n      const department = req.department?.name || null;\n      const client =\n        req.project?.client?.name || req.client_company_name || workspace?.client || 'In-House';\n\n      // Use real budget/estimate data from backend when available instead of mock values\n      const rawBudget = req.estimated_cost ?? req.budget ?? null;\n      const budgetValue =\n        rawBudget !== null && rawBudget !== undefined ? Number(rawBudget) || 0 : 0;\n      const budgetFormatted =\n        rawBudget !== null && rawBudget !== undefined\n          ? `$${budgetValue.toLocaleString('en-US')}`\n          : 'N/A';\n\n      return {\n        id: req.id,\n        title: req.name || req.title || '',\n        description: req.description || '',\n        assignedTo: assigned,\n        // for sorting\n        startDateValue: start ? start.getTime() : 0,\n        // displayed\n        timeline,\n        progress,\n        tasksCompleted: completedTasks,\n        tasksTotal: totalTasks,\n        status,\n        priority,\n        department,\n        client,\n        budgetValue,\n        budgetFormatted,\n      };\n    });\n  }, [requirementsData, workspace]);\n\n  const statusCounts = useMemo(\n    () => ({\n      all: requirements.length,\n      inProgress: requirements.filter((r) => r.status === 'in-progress').length,\n      completed: requirements.filter((r) => r.status === 'completed').length,\n      delayed: requirements.filter((r) => r.status === 'delayed').length,\n    }),\n    [requirements],\n  );\n\n  const filteredAndSortedRequirements = useMemo(() => {\n    let filtered = requirements.filter((req) => {\n      const matchesTab = activeTab === 'all' || req.status === activeTab;\n      const matchesSearch =\n        searchQuery === '' ||\n        req.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        req.description.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesPriority =\n        filters.priority === 'All' || req.priority === filters.priority.toLowerCase();\n\n      return matchesTab && matchesSearch && matchesPriority;\n    });\n\n    if (sortColumn) {\n      filtered = [...filtered].sort((a, b) => {\n        let aVal: any;\n        let bVal: any;\n\n        switch (sortColumn) {\n          case 'timeline':\n            aVal = a.startDateValue;\n            bVal = b.startDateValue;\n            break;\n          case 'budget':\n            aVal = a.budgetValue;\n            bVal = b.budgetValue;\n            break;\n          case 'progress':\n            aVal = a.progress || 0;\n            bVal = b.progress || 0;\n            break;\n          case 'title':\n            aVal = a.title.toLowerCase();\n            bVal = b.title.toLowerCase();\n            break;\n          case 'status':\n            aVal = a.status;\n            bVal = b.status;\n            break;\n          default:\n            aVal = (a as any)[sortColumn];\n            bVal = (b as any)[sortColumn];\n        }\n\n        if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;\n        if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;\n        return 0;\n      });\n    }\n\n    return filtered;\n  }, [requirements, activeTab, searchQuery, filters, sortColumn, sortDirection]);\n\n  const handleSort = (column: string) => {\n    if (sortColumn === column) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortColumn(column);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (column: string) => {\n    if (sortColumn !== column) return null;\n    return sortDirection === 'asc' ? (\n      <ArrowUp className=\"w-3 h-3 inline ml-1\" />\n    ) : (\n      <ArrowDown className=\"w-3 h-3 inline ml-1\" />\n    );\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return (\n          <div className=\"w-5 h-5 rounded-full bg-[#0F9D58] flex items-center justify-center\">\n            <CheckCircle2 className=\"w-3 h-3 text-white\" />\n          </div>\n        );\n      case 'delayed':\n        return (\n          <div className=\"w-5 h-5 rounded-full bg-[#EB5757] flex items-center justify-center\">\n            <AlertCircle className=\"w-3 h-3 text-white\" />\n          </div>\n        );\n      default:\n        return <Loader2 className=\"w-5 h-5 text-[#2F80ED] animate-spin\" />;\n    }\n  };\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'priority',\n      label: 'Priority',\n      options: ['All', 'High', 'Medium', 'Low'],\n      placeholder: 'Priority',\n    },\n  ];\n\n  if (isLoadingWorkspace || isLoadingRequirements) {\n    return <div className=\"p-8\">Loading requirements...</div>;\n  }\n\n  if (!workspace) {\n    return <div className=\"p-8\">Workspace not found</div>;\n  }\n\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] p-8 flex flex-col overflow-hidden\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <Breadcrumb\n            separator={\n              <span className=\"text-[20px] font-['Manrope:SemiBold',sans-serif] text-[#999999]\">/\n              </span>\n            }\n            items={[\n              {\n                title: (\n                  <span\n                    className=\"cursor-pointer font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#999999] hover:text-[#666666] transition-colors\"\n                    onClick={() => router.push('/dashboard/workspace')}\n                  >\n                    Workspaces\n                  </span>\n                ),\n              },\n              {\n                title: (\n                  <span className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">\n                    {workspace.name}\n                  </span>\n                ),\n              },\n            ]}\n          />\n        </div>\n\n        <div className=\"mb-2 -mt-2\">\n          <TabBar\n            tabs={[\n              { id: 'all', label: 'All Requirements', count: statusCounts.all },\n              { id: 'in-progress', label: 'In Progress', count: statusCounts.inProgress },\n              { id: 'completed', label: 'Completed', count: statusCounts.completed },\n              { id: 'delayed', label: 'Delayed', count: statusCounts.delayed },\n            ]}\n            activeTab={activeTab}\n            onTabChange={(tabId: string) =>\n              setActiveTab(tabId as 'all' | 'in-progress' | 'completed' | 'delayed')\n            }\n          />\n        </div>\n      </div>\n\n      {/* Filters bar */}\n      <div className=\"mb-6\">\n        <FilterBar\n          filters={filterOptions}\n          selectedFilters={filters}\n          onFilterChange={(id, val) => setFilters((prev) => ({ ...prev, [id]: val }))}\n          onClearFilters={() => setFilters({ priority: 'All' })}\n          searchPlaceholder=\"Search requirements...\"\n          searchValue={searchQuery}\n          onSearchChange={setSearchQuery}\n          showClearButton\n        />\n      </div>\n\n      {/* Table */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {/* Header row */}\n        <div className=\"sticky top-0 z-10 bg-white grid grid-cols-[40px_2.6fr_1.6fr_1.2fr_1.4fr_1.4fr_0.7fr_0.3fr] gap-4 px-4 py-3 mb-2 items-center\">\n          <div className=\"flex justify-center\">\n            <Checkbox />\n          </div>\n          <button\n            onClick={() => handleSort('title')}\n            className=\"text-left text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide hover:text-[#111111] transition-colors flex items-center\"\n          >\n            Requirement {getSortIcon('title')}\n          </button>\n          <button\n            onClick={() => handleSort('timeline')}\n            className=\"text-left text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide hover:text-[#111111] transition-colors flex items-center justify-start\"\n          >\n            Timeline {getSortIcon('timeline')}\n          </button>\n          <button\n            onClick={() => handleSort('budget')}\n            className=\"text-left text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide hover:text-[#111111] transition-colors flex items-center justify-start\"\n          >\n            Budget {getSortIcon('budget')}\n          </button>\n          <div className=\"text-center text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide\">\n            Team\n          </div>\n          <button\n            onClick={() => handleSort('progress')}\n            className=\"text-center text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide hover:text-[#111111] transition-colors flex items-center justify-center\"\n          >\n            Progress {getSortIcon('progress')}\n          </button>\n          <button\n            onClick={() => handleSort('status')}\n            className=\"text-center text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wide hover:text-[#111111] transition-colors flex items-center justify-center\"\n          >\n            Status {getSortIcon('status')}\n          </button>\n          <div />\n        </div>\n\n        {/* Rows */}\n        <div className=\"space-y-2\">\n          {filteredAndSortedRequirements.length === 0 ? (\n            <div className=\"text-center py-12 text-[#999999] text-[13px]\">No requirements found</div>\n          ) : (\n            filteredAndSortedRequirements.map((req) => (\n              <div\n                key={req.id}\n                onClick={() =>\n                  router.push(`/dashboard/workspace/${workspaceId}/requirements/${req.id}`)\n                }\n                className=\"group bg-white border border-[#EEEEEE] rounded-[16px] p-4 transition-all duration-300 cursor-pointer relative z-10 hover:border-[#ff3b3b]/20 hover:shadow-lg\"\n              >\n                <div className=\"grid grid-cols-[40px_2.6fr_1.6fr_1.2fr_1.4fr_1.4fr_0.7fr_0.3fr] gap-4 items-center\">\n                  <div className=\"flex justify-center\" onClick={(e) => e.stopPropagation()}>\n                    <Checkbox />\n                  </div>\n\n                  {/* Requirement + client */}\n                  <div className=\"flex items-start gap-3\">\n                    <span\n                      className={`mt-1 w-2.5 h-2.5 rounded-full ${\n                        req.priority === 'high'\n                          ? 'bg-[#ff3b3b]'\n                          : req.priority === 'low'\n                          ? 'bg-[#FACC15]'\n                          : 'bg-[#F59E0B]'\n                      }`}\n                    />\n                    <div>\n                      <h3 className=\"font-['Manrope:Bold',sans-serif] text-[14px] text-[#111111] group-hover:text-[#ff3b3b] transition-colors mb-1.5\">\n                        {req.title}\n                      </h3>\n                      <div className=\"flex items-center gap-2 flex-wrap\">\n                        <span className=\"text-[11px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                          {req.client}\n                        </span>\n                        {req.department && (\n                          <span className=\"px-2 py-0.5 rounded-full bg-[#F7F7F7] text-[10px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                            {req.department}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Timeline */}\n                  <div className=\"flex items-center gap-2 text-[13px] text-[#666666] font-['Manrope:Medium',sans-serif]\">\n                    <CalendarIcon className=\"w-4 h-4 text-[#999999]\" />\n                    <span>{req.timeline}</span>\n                  </div>\n\n                  {/* Budget */}\n                  <div className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#16A34A]\">\n                    {req.budgetFormatted}\n                  </div>\n\n                  {/* Team */}\n                  <div className=\"flex items-center justify-center\">\n                    {req.assignedTo.length > 0 ? (\n                      <div className=\"flex items-center -space-x-2\">\n                        {req.assignedTo.slice(0, 4).map((person: string, i: number) => {\n                          const initials = person\n                            .split(' ')\n                            .map((n: string) => n[0])\n                            .join('')\n                            .toUpperCase()\n                            .slice(0, 2);\n\n                          return (\n                            <Tooltip key={i} title={person}>\n                              <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center border-2 border-white shadow-sm relative z-[5] hover:z-10 transition-all\">\n                                <span className=\"text-[11px] text-white font-['Manrope:Bold',sans-serif]\">\n                                  {initials}\n                                </span>\n                              </div>\n                            </Tooltip>\n                          );\n                        })}\n                        {req.assignedTo.length > 4 && (\n                          <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-[#ff3b3b] to-[#ff6b6b] flex items-center justify-center border-2 border-white shadow-sm relative z-[1]\">\n                            <span className=\"text-[11px] text-white font-['Manrope:Bold',sans-serif]\">\n                              +{req.assignedTo.length - 4}\n                            </span>\n                          </div>\n                        )}\n                      </div>\n                    ) : (\n                      <span className=\"text-[13px] text-[#999999] font-['Manrope:Regular',sans-serif]\">\n                        N/A\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Progress */}\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"flex-1 min-w-[80px]\">\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"text-[11px] text-[#666666] font-['Manrope:Medium',sans-serif]\">\n                          {req.tasksCompleted}/{req.tasksTotal} Tasks\n                        </span>\n                        <span className=\"text-[11px] text-[#111111] font-['Manrope:Bold',sans-serif]\">\n                          {req.progress}%\n                        </span>\n                      </div>\n                      <Progress\n                        percent={req.progress}\n                        showInfo={false}\n                        strokeColor={\n                          req.status === 'completed'\n                            ? '#0F9D58'\n                            : req.status === 'delayed'\n                            ? '#EB5757'\n                            : '#2F80ED'\n                        }\n                        railColor=\"#F7F7F7\"\n                        size=\"small\"\n                      />\n                    </div>\n                  </div>\n\n                  {/* Status */}\n                  <div className=\"flex items-center justify-center\">{getStatusIcon(req.status)}</div>\n\n                  {/* Actions */}\n                  <div className=\"flex justify-end\" onClick={(e) => e.stopPropagation()}>\n                    <Dropdown\n                      menu={{\n                        items: [\n                          { key: 'edit', label: 'Edit Details' },\n                          { key: 'priority', label: 'Set Priority' },\n                          { type: 'divider' as const },\n                          { key: 'delete', label: 'Delete', danger: true },\n                        ] as MenuProps['items'],\n                      }}\n                      trigger={['click']}\n                      placement=\"bottomRight\"\n                    >\n                      <button className=\"w-8 h-8 rounded-lg hover:bg-[#F7F7F7] flex items-center justify-center transition-colors opacity-0 group-hover:opacity-100\">\n                        <MoreVertical className=\"w-4 h-4 text-[#666666]\" />\n                      </button>\n                    </Dropdown>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/layout/GlobalTimerPlayer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pause' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Play' is defined but never used.","line":5,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Square' is defined but never used.","line":5,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":6,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stopTimer' is assigned a value but never used.","line":9,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatTime' is assigned a value but never used.","line":13,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useTimer } from \"../../context/TimerContext\";\nimport { Button } from \"antd\";\nimport { Pause, Play, Square } from \"lucide-react\";\nimport React from \"react\";\n\nexport function GlobalTimerPlayer() {\n    const { timerState, stopTimer } = useTimer();\n\n    if (!timerState.isRunning) return null;\n\n    const formatTime = (seconds: number) => {\n        const h = Math.floor(seconds / 3600);\n        const m = Math.floor((seconds % 3600) / 60);\n        const s = seconds % 60;\n        return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n    };\n\n    return null;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/layout/NavigationIcons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/layout/PageLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'customTabRender' is defined but never used.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  Add24Filled,\n  ArrowDownload24Filled,\n  Search24Filled,\n  Filter24Filled\n} from '@fluentui/react-icons';\nimport { ReactNode } from 'react';\n\ninterface PageLayoutProps {\n  title: ReactNode;\n  children: ReactNode;\n  tabs?: Array<{\n    id: string;\n    label: string;\n    count?: number;\n  }>;\n  activeTab?: string;\n  onTabChange?: (tabId: string) => void;\n  searchPlaceholder?: string;\n  searchValue?: string;\n  onSearchChange?: (value: string) => void;\n  showFilter?: boolean;\n  onFilterClick?: () => void;\n  showExport?: boolean;\n  onExportClick?: () => void;\n  titleAction?: {\n    onClick: () => void;\n    label?: string;\n    icon?: ReactNode;\n    variant?: string;\n  };\n  secondaryActions?: Array<{\n    label: string;\n    onClick: () => void;\n    icon?: ReactNode;\n  }>;\n  customFilters?: ReactNode;\n  customTabRender?: (tab: { id: string; label: string; count?: number }, isActive: boolean, onClick: () => void) => ReactNode;\n  action?: ReactNode;\n  sideContent?: ReactNode;\n  titleExtra?: ReactNode;\n}\n\nexport function PageLayout({\n  title,\n  children,\n  tabs,\n  activeTab,\n  onTabChange,\n  searchPlaceholder = 'Search...',\n  searchValue = '',\n  onSearchChange,\n  showFilter = false,\n  onFilterClick,\n  showExport = false,\n  onExportClick,\n  titleAction,\n  secondaryActions,\n  customFilters,\n  customTabRender,\n  action,\n  sideContent,\n  titleExtra\n}: PageLayoutProps) {\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] flex overflow-hidden\">\n      <div className=\"flex-1 p-8 flex flex-col overflow-hidden\">\n        {/* Header Section */}\n        <div className={tabs || onSearchChange || showFilter || customFilters || secondaryActions || showExport || action ? \"mb-6\" : \"mb-2\"}>\n          {/* Title Row */}\n          <div className={`flex items-center justify-between ${tabs || onSearchChange || showFilter || customFilters || secondaryActions || showExport || action ? \"mb-4\" : \"mb-1\"}`}>\n            <div className=\"flex items-center gap-2\">\n              <h2 className=\"font-['Manrope:SemiBold',sans-serif] text-[20px] text-[#111111]\">\n                {title}\n              </h2>\n              {/* Title Action - Plus icon next to title */}\n              {titleAction && (\n                <button\n                  onClick={titleAction.onClick}\n                  className=\"hover:scale-110 active:scale-95 transition-transform\"\n                  title={titleAction.label}\n                >\n                  {titleAction.icon ? titleAction.icon : <Add24Filled className=\"size-5 text-[#ff3b3b]\" />}\n                </button>\n              )}\n            </div>\n            {titleExtra}\n          </div>\n\n          {/* Tabs and Search Bar Row */}\n          {(tabs || onSearchChange || showFilter || customFilters || secondaryActions || showExport || action) && (\n            <div className=\"flex items-center justify-between\">\n              {/* Left: Tabs */}\n              {tabs && tabs.length > 0 ? (\n                <div className=\"flex items-center\">\n                  <div className=\"flex items-center gap-8 border-b border-[#EEEEEE]\">\n                    {tabs.map((tab) => (\n                      <button\n                        key={tab.id}\n                        onClick={() => onTabChange?.(tab.id)}\n                        className={`pb-3 px-1 relative font-['Manrope:SemiBold',sans-serif] text-[14px] transition-colors flex items-center gap-2 ${activeTab === tab.id\n                          ? 'text-[#ff3b3b]'\n                          : 'text-[#666666] hover:text-[#111111]'\n                          }`}\n                      >\n                        {tab.label}\n                        {tab.count !== undefined && (\n                          <span className={`w-5 h-5 rounded-full flex items-center justify-center text-[11px] font-['Manrope:SemiBold',sans-serif] leading-none ${activeTab === tab.id\n                            ? 'bg-[#ff3b3b] text-white'\n                            : 'bg-[#F7F7F7] text-[#666666]'\n                            }`}>\n                            {tab.count}\n                          </span>\n                        )}\n                        {activeTab === tab.id && (\n                          <div className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-[#ff3b3b]\" />\n                        )}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              ) : (\n                <div /> // Spacer to keep search/action on the right\n              )}\n\n              {/* Right: Search and Action buttons */}\n              <div className=\"flex items-center gap-3\">\n                {/* Search */}\n                {onSearchChange && (\n                  <div className=\"relative\">\n                    <Search24Filled className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[#999999]\" />\n                    <input\n                      type=\"text\"\n                      value={searchValue}\n                      onChange={(e) => onSearchChange(e.target.value)}\n                      placeholder={searchPlaceholder}\n                      className=\"pl-10 pr-4 py-2.5 bg-white border border-[#EEEEEE] rounded-full text-[14px] font-['Manrope:Regular',sans-serif] text-[#111111] placeholder:text-[#999999] focus:outline-none focus:border-[#ff3b3b] w-[280px]\"\n                    />\n                  </div>\n                )}\n\n                {/* Filter */}\n                {showFilter && (\n                  <button\n                    onClick={onFilterClick}\n                    className=\"flex items-center gap-2 px-4 py-2.5 bg-white border border-[#EEEEEE] rounded-[12px] hover:bg-[#F7F7F7] transition-colors\"\n                  >\n                    <Filter24Filled className=\"w-4 h-4 text-[#666666]\" />\n                    <span className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\">\n                      Filter\n                    </span>\n                  </button>\n                )}\n\n                {/* Custom Filters */}\n                {customFilters}\n\n                {/* Secondary Actions */}\n                {secondaryActions?.map((action, index) => (\n                  <button\n                    key={index}\n                    onClick={action.onClick}\n                    className=\"flex items-center gap-2 px-4 py-2.5 bg-white border border-[#EEEEEE] rounded-full hover:bg-[#F7F7F7] transition-colors\"\n                  >\n                    {action.icon}\n                    <span className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\">\n                      {action.label}\n                    </span>\n                  </button>\n                ))}\n\n                {/* Export */}\n                {showExport && (\n                  <button\n                    onClick={onExportClick}\n                    className=\"flex items-center gap-2 px-4 py-2.5 bg-white border border-[#EEEEEE] rounded-full hover:bg-[#F7F7F7] transition-colors\"\n                  >\n                    <ArrowDownload24Filled className=\"w-4 h-4 text-[#666666]\" />\n                    <span className=\"font-['Manrope:SemiBold',sans-serif] text-[13px] text-[#666666]\">\n                      Export\n                    </span>\n                  </button>\n                )}\n\n                {/* Primary Action */}\n                {action}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Content Area */}\n        <div className=\"flex-1 overflow-hidden relative flex flex-col\">\n          {children}\n        </div>\n      </div>\n      {sideContent}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/layout/TabBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/ClientProjectsForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":55,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1186,1189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1186,1189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { Button, Input, Select, App } from \"antd\";\nimport { Briefcase } from \"lucide-react\";\n\nconst { Option } = Select;\n\nexport interface ClientFormData {\n  firstName: string;\n  lastName: string;\n  company: string;\n  email: string;\n  countryCode: string;\n  phone: string;\n  country: string;\n  requirements: string;\n  onboarding: string;\n}\n\ninterface ClientFormProps {\n  initialData?: ClientFormData;\n  onSubmit: (data: ClientFormData) => void;\n  onCancel: () => void;\n  isEditing?: boolean;\n}\n\nconst defaultFormData: ClientFormData = {\n  firstName: \"\",\n  lastName: \"\",\n  company: \"\",\n  email: \"\",\n  countryCode: \"+91\",\n  phone: \"\",\n  country: \"\",\n  requirements: \"0\",\n  onboarding: new Date()\n    .toLocaleDateString(\"en-GB\", {\n      day: \"2-digit\",\n      month: \"short\",\n      year: \"numeric\",\n    })\n    .replace(/ /g, \"-\"),\n};\n\nexport function ClientForm({\n  initialData,\n  onSubmit,\n  onCancel,\n  isEditing = false,\n}: ClientFormProps) {\n  const { message } = App.useApp();\n  const [formData, setFormData] = useState<ClientFormData>(defaultFormData);\n\n  useEffect(() => {\n    if (initialData) {\n      const nameParts = ((initialData as any).name || \"\").split(\" \");\n      let phone = initialData.phone || \"\";\n      let countryCode = initialData.countryCode || \"+91\";\n\n      if (phone && phone.startsWith(\"+\")) {\n        // Try to match \n        const codes = [\"+91\", \"+1\", \"+44\", \"+61\", \"+971\"];\n        const matched = codes.find(c => phone.startsWith(c));\n        if (matched) {\n          countryCode = matched;\n          phone = phone.slice(matched.length).trim();\n        }\n      }\n\n      setFormData({\n        ...defaultFormData,\n        ...initialData,\n        firstName: initialData.firstName || nameParts[0] || \"\",\n        lastName: initialData.lastName || nameParts.slice(1).join(\" \") || \"\",\n        phone,\n        countryCode\n      });\n    } else {\n      setFormData(defaultFormData);\n    }\n  }, [initialData]);\n\n  // Email regex for validation\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n  // Validate form and return true if valid, false otherwise\n  const validateForm = (): boolean => {\n    const trimmedEmail = formData.email.trim();\n    const trimmedFirstName = formData.firstName.trim();\n\n    // Email is always required\n    if (!trimmedEmail) {\n      message.error(\"Email address is required\");\n      return false;\n    }\n\n    // Validate email format\n    if (!emailRegex.test(trimmedEmail)) {\n      message.error(\"Please enter a valid email address\");\n      return false;\n    }\n\n    // First name is required when editing\n    if (isEditing && !trimmedFirstName) {\n      message.error(\"First name is required\");\n      return false;\n    }\n\n    return true;\n  };\n\n  // Check if form is valid (for button disabled state)\n  const isFormValid = (): boolean => {\n    const trimmedEmail = formData.email.trim();\n    const trimmedFirstName = formData.firstName.trim();\n\n    // Email must be present and valid\n    if (!trimmedEmail || !emailRegex.test(trimmedEmail)) {\n      return false;\n    }\n\n    // First name required when editing\n    if (isEditing && !trimmedFirstName) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleSubmit = () => {\n    // Validate form before submitting\n    if (!validateForm()) {\n      return;\n    }\n\n    // Trim values before submitting\n    const trimmedData: ClientFormData = {\n      ...formData,\n      firstName: formData.firstName.trim(),\n      lastName: formData.lastName.trim(),\n      company: formData.company.trim(),\n      email: formData.email.trim(),\n      phone: formData.phone.trim(),\n      country: formData.country.trim(),\n    };\n\n    onSubmit(trimmedData);\n  };\n\n  return (\n    <div className=\"flex flex-col h-full bg-white\">\n      {/* Fixed Header */}\n      <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2 text-[17px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n            <div className=\"p-1.5 rounded-full bg-[#F7F7F7]\">\n              <Briefcase className=\"w-3.5 h-3.5 text-[#666666]\" />\n            </div>\n            {isEditing ? 'Edit Client Details' : 'Invite Client'}\n          </div>\n        </div>\n        <p className=\"text-[12px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-9\">\n          {isEditing ? 'Update client profile and contact information.' : 'An invitation link will be sent to this email for the client to complete their profile.'}\n        </p>\n      </div>\n\n      {/* Scrollable Body */}\n      <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n        {!isEditing ? (\n          // Simplified Add Flow: Only Email\n          <div className=\"space-y-4\">\n            <div className=\"space-y-1.5\">\n              <label\n                className=\"text-[12px] font-bold text-[#111111] block\"\n              >\n                Client Email Address <span className=\"text-[#ff3b3b]\">*</span>\n              </label>\n              <Input\n                placeholder=\"email@company.com\"\n                className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                value={formData.email}\n                onChange={(e) =>\n                  setFormData({ ...formData, email: e.target.value })\n                }\n              />\n            </div>\n          </div>\n        ) : (\n          // Full Edit Flow\n          <>\n            {/* Row 1 */}\n            <div className=\"grid grid-cols-2 gap-6 mb-6\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-[12px] font-bold text-[#111111] block\">\n                    First Name <span className=\"text-[#ff3b3b]\">*</span>\n                  </label>\n                  <Input\n                    placeholder=\"John\"\n                    className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                    value={formData.firstName}\n                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-[12px] font-bold text-[#111111] block\">\n                    Last Name\n                  </label>\n                  <Input\n                    placeholder=\"Doe\"\n                    className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                    value={formData.lastName}\n                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-1.5\">\n                <label\n                  className=\"text-[12px] font-bold text-[#111111] block\"\n                >\n                  Business Name\n                </label>\n                <Select\n                  value={formData.company}\n                  onChange={(v) => setFormData({ ...formData, company: String(v) })}\n                  className=\"w-full h-11\"\n                  placeholder=\"Select company\"\n                  suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                >\n                  <Option value=\"Triem Security\">Triem Security</Option>\n                  <Option value=\"Eventus Security\">Eventus Security</Option>\n                  <Option value=\"TechCorp Inc.\">TechCorp Inc.</Option>\n                  <Option value=\"Digibranders\">Digibranders</Option>\n                </Select>\n              </div>\n            </div>\n\n            {/* Row 2 */}\n            <div className=\"grid grid-cols-2 gap-6 mb-6\">\n              <div className=\"space-y-1.5\">\n                <label\n                  className=\"text-[12px] font-bold text-[#111111] block\"\n                >\n                  Email <span className=\"text-[#ff3b3b]\">*</span>\n                </label>\n                <Input\n                  placeholder=\"email@company.com\"\n                  className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                  value={formData.email}\n                  onChange={(e) =>\n                    setFormData({ ...formData, email: e.target.value })\n                  }\n                />\n              </div>\n              <div className=\"space-y-1.5\">\n                <label\n                  className=\"text-[12px] font-bold text-[#111111] block\"\n                >\n                  Contact (Phone)\n                </label>\n                <div className=\"flex gap-2\">\n                  <Select\n                    className=\"w-[85px] h-11\"\n                    value={formData.countryCode}\n                    onChange={(v) => setFormData({ ...formData, countryCode: String(v) })}\n                    suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                  >\n                    <Option value=\"+91\">+91 IN</Option>\n                    <Option value=\"+1\">+1 US</Option>\n                    <Option value=\"+44\">+44 UK</Option>\n                    <Option value=\"+61\">+61 AU</Option>\n                    <Option value=\"+971\">+971 AE</Option>\n                  </Select>\n                  <Input\n                    placeholder=\"8698027152\"\n                    className=\"flex-1 h-11 rounded-lg border border-[#EEEEEE]\"\n                    value={formData.phone}\n                    onChange={(e) =>\n                      setFormData({ ...formData, phone: e.target.value })\n                    }\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Row 3 */}\n            <div className=\"grid grid-cols-2 gap-6 mb-6\">\n              <div className=\"space-y-1.5\">\n                <label\n                  className=\"text-[12px] font-bold text-[#111111] block\"\n                >\n                  Country\n                </label>\n                <Select\n                  value={formData.country}\n                  onChange={(v) => setFormData({ ...formData, country: String(v) })}\n                  className=\"w-full h-11\"\n                  placeholder=\"Select country\"\n                  suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n                >\n                  <Option value=\"USA\">USA</Option>\n                  <Option value=\"India\">India</Option>\n                  <Option value=\"UK\">UK</Option>\n                  <Option value=\"UAE\">UAE</Option>\n                </Select>\n              </div>\n              <div className=\"space-y-1.5\">\n                <label\n                  className=\"text-[12px] font-bold text-[#111111] block\"\n                >\n                  Onboarding Date\n                </label>\n                <Input\n                  placeholder=\"DD-MMM-YYYY\"\n                  className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                  value={formData.onboarding}\n                  onChange={(e) =>\n                    setFormData({ ...formData, onboarding: e.target.value })\n                  }\n                />\n              </div>\n            </div>\n\n            {/* Row 4 */}\n            <div className=\"space-y-1.5 mb-6\">\n              <label\n                className=\"text-[12px] font-bold text-[#111111] block\"\n              >\n                Requirements (Count)\n              </label>\n              <Input\n                type=\"number\"\n                placeholder=\"Number of requirements\"\n                className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                value={formData.requirements}\n                onChange={(e) =>\n                  setFormData({ ...formData, requirements: e.target.value })\n                }\n              />\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Fixed Footer */}\n      <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-4 flex items-center justify-end bg-white gap-4\">\n        <Button\n          type=\"text\"\n          onClick={onCancel}\n          className=\"h-[40px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n        >\n          Cancel\n        </Button>\n        <Button\n          type=\"primary\"\n          onClick={handleSubmit}\n          disabled={!isFormValid()}\n          className=\"h-[40px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none disabled:bg-gray-300 disabled:cursor-not-allowed\"\n        >\n          {isEditing ? \"Update Client\" : \"Send Invitation\"}\n        </Button>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/EmployeeDetailsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1148,1151],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1148,1151],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":102,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":286,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":286,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12338,12341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12338,12341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\nimport { Modal, Button, App } from 'antd';\nimport { Briefcase, Mail, Phone, Calendar, DollarSign, Clock, CalendarDays, X, FileText, Users, Globe, ShieldAlert, Linkedin, Github } from 'lucide-react';\nimport { AccessBadge } from '../ui/AccessBadge';\nimport { Employee, UserDocument } from '@/types/genericTypes';\nimport { DocumentCard } from '@/components/ui/DocumentCard';\nimport { DocumentPreviewModal } from '@/components/ui/DocumentPreviewModal';\n\ninterface EmployeeDetailsModalProps {\n  open: boolean;\n  onClose: () => void;\n  employee: Employee | null;\n  onEdit: () => void;\n}\n\nexport function EmployeeDetailsModal({\n  open,\n  onClose,\n  employee,\n  onEdit,\n}: EmployeeDetailsModalProps) {\n  const { message } = App.useApp();\n  // Documents state\n  const [selectedDocument, setSelectedDocument] = useState<UserDocument | null>(null);\n  const [isPreviewModalOpen, setIsPreviewModalOpen] = useState(false);\n\n  // Mock documents data - TODO: Replace with actual API call when available\n  const documents = useMemo(() => {\n    // Check if employee data has documents\n    const employeeDocs = (employee as any)?.documents || [];\n    if (Array.isArray(employeeDocs) && employeeDocs.length > 0) {\n      return employeeDocs;\n    }\n    // Mock documents from docs folder - all 4 types\n    const mockDocuments: UserDocument[] = [\n      {\n        id: '1',\n        documentTypeId: '1',\n        documentTypeName: 'Resume',\n        fileName: 'Resume_Updated.pdf',\n        fileSize: 2400000, // 2.4 MB\n        fileUrl: '/documents/Jayendra_Jadhav_Resume.pdf',\n        uploadedDate: '2024-10-24T00:00:00Z',\n        fileType: 'pdf',\n        isRequired: true,\n      },\n      {\n        id: '2',\n        documentTypeId: '2',\n        documentTypeName: 'ID Proof',\n        fileName: 'Identity_Proof.jpeg',\n        fileSize: 1000000, // 1 MB\n        fileUrl: '/documents/profile.jpeg',\n        uploadedDate: '2024-01-15T00:00:00Z',\n        fileType: 'image',\n        isRequired: true,\n      },\n      {\n        id: '3',\n        documentTypeId: '3',\n        documentTypeName: 'Contract',\n        fileName: 'Employment_Contract.docx',\n        fileSize: 206000, // 206 KB\n        fileUrl: '/documents/AI Agent Documentation.docx',\n        uploadedDate: '2024-01-20T00:00:00Z',\n        fileType: 'docx',\n        isRequired: true,\n      },\n      {\n        id: '4',\n        documentTypeId: '4',\n        documentTypeName: 'Supporting Docs',\n        fileName: 'ollama_data.csv',\n        fileSize: 50000, // 50 KB\n        fileUrl: '/documents/ollama_filtered_json_support.csv',\n        uploadedDate: '2024-12-17T00:00:00Z',\n        fileType: 'csv',\n        isRequired: false,\n      },\n    ];\n    return mockDocuments;\n  }, [employee]);\n\n  if (!employee) return null;\n\n  // Format date of joining\n  const formatDate = (dateString: string) => {\n    if (!dateString || dateString === 'N/A') return 'N/A';\n    try {\n      const parts = dateString.split('-');\n      if (parts.length === 3) {\n        return dateString;\n      }\n      const date = new Date(dateString);\n      if (!isNaN(date.getTime())) {\n        const day = date.getDate().toString().padStart(2, '0');\n        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n        const month = monthNames[date.getMonth()];\n        const year = date.getFullYear();\n        return `${day}-${month}-${year}`;\n      }\n    } catch (e) {\n      // Error formatting date\n    }\n    return dateString;\n  };\n\n  // Parse skillsets\n  const skills = employee.skillsets && employee.skillsets !== 'None'\n    ? employee.skillsets.split(',').map(s => s.trim()).filter(s => s.length > 0)\n    : [];\n\n  // Format hourly rate\n  const hourlyRate = employee.hourlyRate && employee.hourlyRate !== 'N/A'\n    ? employee.hourlyRate\n    : 'N/A';\n\n  // Format experience\n  const experience = employee.experience ? `${employee.experience} Years` : 'N/A';\n\n  // Format working hours\n  const workingHours = (() => {\n    if (employee.rawWorkingHours?.start_time && employee.rawWorkingHours?.end_time) {\n      return `${employee.rawWorkingHours.start_time} - ${employee.rawWorkingHours.end_time}`;\n    }\n    return employee.workingHours ? `${employee.workingHours}h / week` : 'N/A';\n  })();\n\n  // Format leaves\n  const leavesTaken = employee.leaves ? `${employee.leaves} Days` : '0 Days';\n\n  const handleDocumentPreview = (document: UserDocument) => {\n    setSelectedDocument(document);\n    setIsPreviewModalOpen(true);\n  };\n\n  const handleDocumentDownload = (document: UserDocument) => {\n    if (document.fileUrl) {\n      window.open(document.fileUrl, '_blank');\n    } else {\n      message.warning('Document URL not available');\n    }\n  };\n\n  const handleDocumentUpload = (documentTypeId: string) => {\n    message.info(`Upload functionality for document type ${documentTypeId} - To be implemented`);\n  };\n\n  return (\n    <Modal\n      open={open}\n      onCancel={onClose}\n      footer={null}\n      width={700}\n      centered\n      className=\"rounded-[16px] overflow-hidden\"\n      closeIcon={<X className=\"w-5 h-5 text-[#666666]\" />}\n      styles={{\n        body: {\n          padding: 0,\n        }\n      }}\n    >\n      <div className=\"flex flex-col max-h-[90vh] bg-white\">\n        {/* Fixed Header - Reduced padding */}\n        <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-4 bg-white\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-11 h-11 rounded-full overflow-hidden border border-[#EEEEEE] bg-[#F7F7F7] flex-shrink-0\">\n                <img\n                  src={employee.profile_pic || `https://ui-avatars.com/api/?name=${encodeURIComponent(employee.name)}&background=f7f7f7&color=666`}\n                  alt={employee.name}\n                  className=\"w-full h-full object-cover\"\n                />\n              </div>\n              <div>\n                <h2 className=\"text-[18px] font-['Manrope:Bold',sans-serif] text-[#111111] leading-tight\">\n                  {employee.name}\n                </h2>\n                <div className=\"flex items-center gap-2 mt-0.5\">\n                  <AccessBadge role={employee.access} color={employee.roleColor} />\n                  <span\n                    className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[9px] font-['Manrope:SemiBold',sans-serif] ${employee.status === 'active'\n                      ? 'bg-[#ECFDF3] text-[#12B76A]'\n                      : 'bg-[#FEF3F2] text-[#F04438]'\n                      }`}\n                  >\n                    <span className=\"w-1 h-1 rounded-full bg-current\"></span>\n                    {employee.status === 'active' ? 'Active' : 'Inactive'}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-1 pr-6\">\n              <Button\n                type=\"text\"\n                icon={<Mail className=\"w-4 h-4 text-[#666666]\" />}\n                onClick={() => window.location.href = `mailto:${employee.email}`}\n                className=\"hover:bg-[#F7F7F7] rounded-full w-8 h-8 flex items-center justify-center p-0\"\n                aria-label={`Send email to ${employee.name}`}\n              />\n              <Button\n                type=\"text\"\n                icon={<Phone className=\"w-4 h-4 text-[#666666]\" />}\n                onClick={() => window.location.href = `tel:${employee.phone}`}\n                className=\"hover:bg-[#F7F7F7] rounded-full w-8 h-8 flex items-center justify-center p-0\"\n                aria-label={`Call ${employee.name}`}\n              />\n\n              {(employee.linkedin || employee.github || employee.portfolio) && (\n                <>\n                  <div className=\"mx-1.5 w-[1px] h-4 bg-[#EEEEEE]\"></div>\n                  {employee.linkedin && (\n                    <Button\n                      type=\"text\"\n                      icon={<Linkedin className=\"w-4 h-4 text-[#0077B5]\" />}\n                      onClick={() => window.open(employee.linkedin!.startsWith('http') ? employee.linkedin : `https://linkedin.com/in/${employee.linkedin}`, '_blank')}\n                      className=\"hover:bg-[#F7F7F7] rounded-full w-8 h-8 flex items-center justify-center p-0\"\n                      aria-label={`Visit ${employee.name}'s LinkedIn profile`}\n                    />\n                  )}\n                  {employee.github && (\n                    <Button\n                      type=\"text\"\n                      icon={<Github className=\"w-4 h-4 text-[#111111]\" />}\n                      onClick={() => window.open(employee.github!.startsWith('http') ? employee.github : `https://github.com/${employee.github}`, '_blank')}\n                      className=\"hover:bg-[#F7F7F7] rounded-full w-8 h-8 flex items-center justify-center p-0\"\n                      aria-label={`Visit ${employee.name}'s GitHub profile`}\n                    />\n                  )}\n                  {employee.portfolio && (\n                    <Button\n                      type=\"text\"\n                      icon={<Globe className=\"w-4 h-4 text-[#666666]\" />}\n                      onClick={() => window.open(employee.portfolio!.startsWith('http') ? employee.portfolio : `https://${employee.portfolio}`, '_blank')}\n                      className=\"hover:bg-[#F7F7F7] rounded-full w-8 h-8 flex items-center justify-center p-0\"\n                      aria-label={`Visit ${employee.name}'s portfolio`}\n                    />\n                  )}\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Scrollable Body - Ensuring flex-1 and overflow-y-auto */}\n        <div className=\"flex-1 overflow-y-auto px-6 py-6 scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent space-y-8\">\n          {/* Section 1: Basic Information */}\n          <section>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-1 h-4 bg-[#111111] rounded-full\"></div>\n              <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Basic Information</h3>\n            </div>\n            <div className=\"grid grid-cols-2 gap-y-5 gap-x-12 pl-3\">\n              <DetailItem label=\"Email Address\" value={employee.email} icon={<Mail className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Phone Number\" value={employee.phone} icon={<Phone className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Department\" value={employee.department} icon={<Users className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Designation\" value={employee.role} icon={<Briefcase className=\"w-3.5 h-3.5\" />} />\n            </div>\n            {employee.bio && (\n              <div className=\"mt-5 pl-3\">\n                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-2\">\n                  Professional Bio\n                </p>\n                <p className=\"text-[13px] text-[#444444] leading-relaxed font-['Manrope:Regular',sans-serif] bg-[#F9FAFB] p-4 rounded-xl border border-[#EEEEEE]\">\n                  {employee.bio}\n                </p>\n              </div>\n            )}\n          </section>\n\n          {/* Section 2: Employment & HR Details */}\n          <section>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-1 h-4 bg-[#111111] rounded-full\"></div>\n              <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Employment & HR Details</h3>\n            </div>\n            <div className=\"grid grid-cols-3 gap-4 mb-6 pl-3\">\n              <StatCard label=\"Experience\" value={experience} icon={<Briefcase className=\"w-4 h-4 text-gray-400\" />} />\n              <StatCard label=\"Total Leaves\" value={leavesTaken} icon={<CalendarDays className=\"w-4 h-4 text-gray-400\" />} />\n              <StatCard label=\"Working Hours\" value={workingHours} icon={<Clock className=\"w-4 h-4 text-gray-400\" />} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-y-5 gap-x-12 pl-3\">\n              <DetailItem label=\"Date of Joining\" value={formatDate(employee.dateOfJoining)} icon={<Calendar className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Annual Salary\" value={employee.salary ? `${(employee as any).currency || '$'}${Number(employee.salary).toLocaleString()}` : 'N/A'} icon={<DollarSign className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Hourly Cost\" value={hourlyRate} icon={<DollarSign className=\"w-3.5 h-3.5\" />} />\n              <DetailItem label=\"Employment Type\" value={employee.employmentType || \"Full-time\"} icon={<Briefcase className=\"w-3.5 h-3.5\" />} />\n              {employee.timezone && (\n                <DetailItem label=\"Local Timezone\" value={employee.timezone} icon={<Globe className=\"w-3.5 h-3.5\" />} />\n              )}\n            </div>\n\n            {/* Emergency Contact Sub-section */}\n            {(employee.emergencyContactName || employee.emergencyContactPhone) && (\n              <div className=\"mt-6 ml-3 p-4 bg-[#FEF3F2] rounded-xl border border-[#FEE4E2] flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-white flex items-center justify-center text-[#F04438] shadow-sm\">\n                    <ShieldAlert className=\"w-5 h-5\" />\n                  </div>\n                  <div>\n                    <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#B42318] uppercase tracking-wider\">Emergency Contact</p>\n                    <p className=\"text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#912018]\">{employee.emergencyContactName || 'N/A'}</p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-[13px] font-['Manrope:Medium',sans-serif] text-[#B42318]\">{employee.emergencyContactPhone || '-'}</p>\n                </div>\n              </div>\n            )}\n          </section>\n\n          {/* Section 3: Skills & Assets */}\n          <section>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-1 h-4 bg-[#111111] rounded-full\"></div>\n              <h3 className=\"text-[14px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Skills & Documents</h3>\n            </div>\n            <div className=\"space-y-6 pl-3\">\n              {/* Skillsets */}\n              <div>\n                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">\n                  Professional Skillsets\n                </p>\n                <div className=\"flex flex-wrap gap-2\">\n                  {skills.length > 0 ? (\n                    skills.map((skill, index) => (\n                      <span\n                        key={index}\n                        className=\"px-3 py-1 bg-[#F9FAFB] text-[#111111] text-[12px] font-['Manrope:Medium',sans-serif] rounded-full border border-[#EEEEEE]\"\n                      >\n                        {skill}\n                      </span>\n                    ))\n                  ) : (\n                    <span className=\"text-[12px] text-[#999999] italic\">No skills specified</span>\n                  )}\n                </div>\n              </div>\n\n              {/* Documents */}\n              <div>\n                <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-3\">\n                  Uploaded Documents\n                </p>\n                {documents && documents.length > 0 ? (\n                  <div className=\"grid grid-cols-2 gap-3 pb-4\">\n                    {documents.map((doc: UserDocument) => (\n                      <DocumentCard\n                        key={doc.id}\n                        document={doc}\n                        onPreview={handleDocumentPreview}\n                        onDownload={handleDocumentDownload}\n                        showUpload={!doc.fileUrl}\n                        onUpload={handleDocumentUpload}\n                      />\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"border border-[#EEEEEE] border-dashed rounded-xl p-6 bg-[#FAFAFA] text-center\">\n                    <FileText className=\"w-8 h-8 text-[#CCCCCC] mx-auto mb-2\" />\n                    <p className=\"text-[12px] font-['Manrope:Medium',sans-serif] text-[#666666]\">\n                      No documents available\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </section>\n        </div>\n\n        {/* Fixed Footer */}\n        <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-4 flex items-center justify-end bg-white gap-3 rounded-b-[16px]\">\n          <Button\n            onClick={onClose}\n            className=\"h-10 px-6 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] border border-[#EEEEEE] hover:bg-[#F9FAFB] rounded-lg\"\n          >\n            Close\n          </Button>\n          <Button\n            type=\"primary\"\n            onClick={() => {\n              onClose();\n              onEdit();\n            }}\n            className=\"h-10 px-8 rounded-lg bg-[#111111] hover:bg-[#000000] text-white text-[14px] font-['Manrope:SemiBold',sans-serif] border-none active:scale-95 transition-transform\"\n          >\n            Edit Profile\n          </Button>\n        </div>\n      </div>\n\n      <DocumentPreviewModal\n        open={isPreviewModalOpen}\n        onClose={() => {\n          setIsPreviewModalOpen(false);\n          setSelectedDocument(null);\n        }}\n        document={selectedDocument}\n      />\n    </Modal>\n  );\n}\n\nfunction DetailItem({ label, value, icon }: { label: string; value: string | null; icon: React.ReactNode }) {\n  return (\n    <div className=\"flex items-start gap-3\">\n      <div className=\"mt-1 text-[#666666] flex-shrink-0\">\n        {icon}\n      </div>\n      <div>\n        <p className=\"text-[11px] font-['Manrope:Bold',sans-serif] text-[#999999] uppercase tracking-wider mb-0.5\">\n          {label}\n        </p>\n        <p className=\"text-[14px] font-['Manrope:Medium',sans-serif] text-[#111111]\">\n          {value || 'N/A'}\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction StatCard({ label, value, icon }: { label: string; value: string; icon: React.ReactNode }) {\n  return (\n    <div className=\"bg-[#F9FAFB] rounded-xl p-4 border border-[#EEEEEE] flex items-center gap-3\">\n      <div className=\"w-10 h-10 rounded-full bg-white flex items-center justify-center border border-[#EEEEEE] flex-shrink-0\">\n        {icon}\n      </div>\n      <div>\n        <p className=\"text-[11px] font-['Manrope:Medium',sans-serif] text-[#666666] mb-0.5\">{label}</p>\n        <p className=\"text-[16px] font-['Manrope:Bold',sans-serif] text-[#111111]\">{value}</p>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/EmployeesForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":3,"column":75,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":82},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Employee' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TextArea' is assigned a value but never used.","line":13,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1243,1246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1243,1246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingCompany' is assigned a value but never used.","line":88,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'employeesData' is assigned a value but never used.","line":90,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":90,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3558,3561],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3558,3561],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3624,3627],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3624,3627],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5691,5694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5691,5694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AccessIcon' is assigned a value but never used.","line":263,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":263,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":382,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":382,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15697,15700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15697,15700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from \"react\";\nimport { Button, Input, Select, DatePicker, TimePicker, App, Space } from \"antd\";\nimport { ShieldCheck, Briefcase, User, Users, Calendar, User as UserIcon, Loader2 } from \"lucide-react\";\nimport dayjs from \"dayjs\";\nimport customParseFormat from \"dayjs/plugin/customParseFormat\";\nimport PhoneNumberInput from \"@/components/ui/PhoneNumberInput\";\nimport { useCurrentUserCompany, useRoles, useEmployees } from \"@/hooks/useUser\";\nimport { currencies, getCurrencySymbol } from \"@/utils/currencyUtils\";\nimport { Employee, Role } from '@/types/domain';\n\ndayjs.extend(customParseFormat);\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nexport interface EmployeeFormData {\n  firstName: string;\n  lastName: string;\n  role: string;\n  email: string;\n  phone: string;\n  countryCode: string;\n  department: string;\n  hourlyRate: string;\n  dateOfJoining: string;\n  experience: string;\n  skillsets: string;\n  access: string;\n  salary: string;\n  currency: string;\n  workingHoursStart: string;\n  workingHoursEnd: string;\n  leaves: string;\n  role_id?: number;\n  manager_id?: number;\n  employmentType?: 'Full-time' | 'Part-time' | 'Contract' | 'Intern';\n}\n\ninterface EmployeeFormProps {\n  initialData?: any; // Allow loose typing for mapping input data\n  onSubmit: (data: EmployeeFormData) => void;\n  onCancel: () => void;\n  isEditing?: boolean;\n  departments?: string[];\n  roles?: { id: number; name: string }[];\n}\n\nconst defaultFormData: EmployeeFormData = {\n  firstName: \"\",\n  lastName: \"\",\n  role: \"\",\n  email: \"\",\n  phone: \"\",\n  countryCode: \"+91\",\n  department: \"\",\n  hourlyRate: \"\",\n  dateOfJoining: \"\",\n  experience: \"\",\n  skillsets: \"\",\n  access: \"\", // Will default to first available or empty\n  salary: \"\",\n  currency: \"INR\",\n  workingHoursStart: \"\",\n  workingHoursEnd: \"\",\n  leaves: \"\",\n  role_id: undefined,\n  manager_id: undefined,\n  employmentType: undefined,\n};\n\nconst countryCodes = [\n  { code: \"+1\", country: \"US\" },\n  { code: \"+91\", country: \"IN\" },\n  { code: \"+44\", country: \"UK\" },\n  { code: \"+61\", country: \"AU\" },\n  { code: \"+81\", country: \"JP\" },\n  { code: \"+49\", country: \"DE\" },\n];\n\nexport function EmployeeForm({\n  initialData,\n  onSubmit,\n  onCancel,\n  isEditing = false,\n  departments = [],\n}: EmployeeFormProps) {\n  const [formData, setFormData] = useState<EmployeeFormData>(defaultFormData);\n  const { data: companyData, isLoading: isLoadingCompany } = useCurrentUserCompany();\n  const { data: rolesData, isLoading: isLoadingRoles } = useRoles();\n  const { data: employeesData } = useEmployees(\"is_active=true&limit=1000\"); // Fetch all active employees for manager list\n  const { message } = App.useApp();\n\n  const fetchedRoles = useMemo((): Role[] => {\n    return rolesData?.result || [];\n  }, [rolesData]);\n\n  // Helper to calculate hourly rate from salary and company settings\n\n  const formatTimeForState = (time: string) => {\n    if (!time) return \"\";\n    let d = dayjs(time, 'HH:mm', true);\n    if (!d.isValid()) d = dayjs(time, 'h:mm A', true);\n    if (!d.isValid()) d = dayjs(time, 'h:mm a', true);\n    return d.isValid() ? d.format('h:mm a') : time;\n  };\n\n  // Handle form data initialization (Edit mode or Company defaults for new employee)\n  useEffect(() => {\n    if (initialData) {\n      // Parse initial data to fit new form structure\n      let start = \"\";\n      let end = \"\";\n\n      // Handle working hours if it comes as an object or string\n      if (initialData.workingHours && typeof initialData.workingHours === 'object') {\n        start = (initialData.workingHours as any).start_time || \"\";\n        end = (initialData.workingHours as any).end_time || \"\";\n      } else if (initialData.workingHoursStart) {\n        start = initialData.workingHoursStart;\n        end = initialData.workingHoursEnd;\n      }\n\n      // Handle phone number splitting if needed\n      let phone = initialData.phone || \"\";\n      let countryCode = initialData.countryCode || \"+91\";\n\n      // Simple logic to extract country code if phone starts with +\n      if (phone && phone.startsWith(\"+\") && !initialData.countryCode) {\n        // Try to match known codes\n        const matched = countryCodes.find(c => phone.startsWith(c.code));\n        if (matched) {\n          countryCode = matched.code;\n          phone = phone.slice(matched.code.length).trim();\n        }\n      }\n\n      const nameParts = (initialData.name || \"\").split(\" \");\n\n      setFormData({\n        ...defaultFormData,\n        ...initialData,\n        firstName: initialData.firstName || nameParts[0] || \"\",\n        lastName: initialData.lastName || nameParts.slice(1).join(\" \") || \"\",\n        workingHoursStart: formatTimeForState(start),\n        workingHoursEnd: formatTimeForState(end),\n        phone,\n        countryCode,\n        salary: String(initialData.salary || \"\"),\n        hourlyRate: String(initialData.hourlyRate || \"\").replace(\"/Hr\", \"\").replace(\"N/A\", \"\"),\n        leaves: String(initialData.leaves || \"\"),\n        experience: String(initialData.experience || \"\"),\n        currency: initialData.currency || \"INR\",\n        // Map access string to role if available, or keep as is\n        access: initialData.access || (initialData.role_id ? fetchedRoles.find((r: Role) => r.id === initialData.role_id)?.name : \"\") || \"Employee\",\n        manager_id: initialData.manager_id,\n      });\n    } else if (companyData?.result && !isEditing) {\n      // New employee initialization from company settings\n      const company = companyData.result;\n      const { working_hours, leaves: companyLeaves, currency } = company;\n      \n      const totalLeaves = Array.isArray(companyLeaves) && companyLeaves.length > 0\n        ? companyLeaves.reduce((sum: number, leave: any) => sum + (Number(leave.count) || 0), 0)\n        : 15; // Match SettingsPage default\n\n      const stateStart = working_hours?.start_time ? formatTimeForState(working_hours.start_time) : \"\";\n      const stateEnd = working_hours?.end_time ? formatTimeForState(working_hours.end_time) : \"\";\n\n      setFormData({\n        ...defaultFormData,\n        currency: currency || \"INR\",\n        workingHoursStart: stateStart || \"9:00 am\",\n        workingHoursEnd: stateEnd || \"6:00 pm\",\n        leaves: totalLeaves.toString(),\n        access: \"Employee\" // Default\n      });\n    } else if (!isEditing) {\n      setFormData(defaultFormData);\n    }\n  }, [initialData, companyData, isEditing, fetchedRoles]);\n\n  // Handle Hourly Cost Auto-calculation\n  useEffect(() => {\n    const salary = Number(formData.salary);\n    if (!salary || !formData.workingHoursStart || !formData.workingHoursEnd || !companyData?.result) {\n      if (formData.hourlyRate !== \"\") {\n        setFormData(prev => ({ ...prev, hourlyRate: \"\" }));\n      }\n      return;\n    }\n\n    try {\n      const company = companyData.result;\n      const workingHours = company.working_hours || {};\n      // Default to 5 days if settings missing\n      const workingDaysCount = Array.isArray(workingHours.working_days) && workingHours.working_days.length > 0\n        ? workingHours.working_days.length \n        : 5;\n      const breakTimeMinutes = Number(workingHours.break_time) || 0;\n\n      const start = dayjs(formData.workingHoursStart, 'h:mm a');\n      const end = dayjs(formData.workingHoursEnd, 'h:mm a');\n\n      if (start.isValid() && end.isValid()) {\n        let diffMinutes = end.diff(start, 'minute');\n        // Handle case where end time is cross-day (standardized shift)\n        if (diffMinutes < 0) diffMinutes += 1440; \n        \n        const netWorkingMinutesPerDay = Math.max(0, diffMinutes - breakTimeMinutes);\n        const hoursPerDay = netWorkingMinutesPerDay / 60;\n        \n        // Calculate annual working hours: hours/day * days/week * 52 weeks\n        const totalHoursPerYear = hoursPerDay * workingDaysCount * 52;\n        \n        if (totalHoursPerYear > 0) {\n          const calculatedHourlyRate = Math.round(salary / totalHoursPerYear).toString();\n          if (formData.hourlyRate !== calculatedHourlyRate) {\n            setFormData(prev => ({ ...prev, hourlyRate: calculatedHourlyRate }));\n          }\n        }\n      }\n    } catch (e) {\n      console.error(\"Hourly calculation error:\", e);\n    }\n  }, [formData.salary, formData.workingHoursStart, formData.workingHoursEnd, companyData]);\n\n\n  const handleSubmit = () => {\n    if (!formData.firstName) {\n      message.error(\"First Name is required\");\n      return;\n    }\n    if (!formData.email) {\n      message.error(\"Email is required\");\n      return;\n    }\n    if (!formData.employmentType) {\n      message.error(\"Employment Type is required\");\n      return;\n    }\n    // Set role_id based on selected access name if needed\n    const selectedRole = fetchedRoles.find((r: Role) => r.name === formData.access);\n    if (selectedRole) {\n      formData.role_id = selectedRole.id;\n    }\n\n    onSubmit(formData);\n  };\n\n  // Helper function to get access level icon and color\n  const getAccessLevelConfig = (access: string) => {\n    const normalize = (str: string) => str?.toLowerCase().trim() || \"\";\n    const acc = normalize(access);\n    \n    if (acc === \"admin\") return { icon: ShieldCheck, color: \"#ff3b3b\", bgColor: \"#FFF5F5\" };\n    if (acc === \"manager\") return { icon: Briefcase, color: \"#2E90FA\", bgColor: \"#EFF8FF\" };\n    if (acc === \"leader\") return { icon: Users, color: \"#7F56D9\", bgColor: \"#F9F5FF\" };\n    // Default or Employee\n    return { icon: User, color: \"#12B76A\", bgColor: \"#ECFDF3\" };\n  };\n\n  const accessConfig = getAccessLevelConfig(formData.access);\n  const AccessIcon = accessConfig.icon;\n\n  const currencySymbol = getCurrencySymbol(formData.currency);\n\n  const CurrencySelector = (\n    <Select\n      value={formData.currency}\n      onChange={(val) => setFormData({ ...formData, currency: val })}\n      className=\"currency-select-addon\"\n      variant=\"borderless\"\n      popupMatchSelectWidth={false}\n      style={{ width: 80 }}\n    >\n      {currencies.map(c => (\n        <Option key={c} value={c}>{c}</Option>\n      ))}\n    </Select>\n  );\n\n  return (\n    <div className=\"flex flex-col h-full bg-white\">\n      {/* Fixed Header */}\n      <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-3\">\n        <div className=\"flex items-center justify-between mb-0.5\">\n          <div className=\"flex items-center gap-2 text-[17px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n            <div className=\"p-1.5 rounded-full bg-[#F7F7F7]\">\n              <UserIcon className=\"w-3.5 h-3.5 text-[#666666]\" />\n            </div>\n            {isEditing ? 'Edit Employee Details' : 'Add Employee'}\n          </div>\n        </div>\n        <p className=\"text-[11px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-9\">\n          {isEditing ? 'Update employee profile, access, and HR details.' : 'Onboard a new employee to the organization.'}\n        </p>\n      </div>\n\n      {/* Scrollable Body */}\n      <div className=\"flex-1 overflow-y-auto px-6 py-5 scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent\">\n        <div className=\"grid grid-cols-12 gap-x-4 gap-y-4\">\n          {/* Row 1: First Name & Last Name */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">First Name <span className=\"text-[#ff3b3b]\">*</span></span>\n            <Input\n              placeholder=\"First name\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.firstName ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.firstName}\n              onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n            />\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Last Name</span>\n            <Input\n              placeholder=\"Last name\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.lastName ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.lastName}\n              onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n            />\n          </div>\n\n          {/* Row 2: Email & Contact */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Email Address <span className=\"text-[#ff3b3b]\">*</span></span>\n            <Input\n              placeholder=\"email@company.com\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.email ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.email}\n              onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n            />\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Contact Number</span>\n            <PhoneNumberInput\n              placeholder=\"123 456 7890\"\n              value={`${formData.countryCode} ${formData.phone}`}\n              onChange={(val) => {\n                const parts = val.split(' ');\n                const code = parts[0];\n                const num = parts.slice(1).join(' ');\n                setFormData({ ...formData, countryCode: code, phone: num });\n              }}\n              className={`w-full h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.phone ? 'bg-white' : 'bg-[#F9FAFB]'} focus-within:border-[#111111] focus-within:bg-white focus-within:shadow-none transition-all`}\n            />\n          </div>\n\n          {/* Row 3: Access Level & Employment Type */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Access Level <span className=\"text-[#ff3b3b]\">*</span></span>\n            <Select\n              className={`w-full h-11 access-level-select employee-form-select ${formData.access ? 'employee-form-select-filled' : ''}`}\n              classNames={{ popup: { root: 'access-level-popup' } }}\n              placeholder={isLoadingRoles ? \"Loading roles...\" : \"Select access\"}\n              loading={isLoadingRoles}\n              value={formData.access}\n              onChange={(v) => {\n                const role = fetchedRoles.find((r: Role) => r.name === v);\n                setFormData({ ...formData, access: v as string, role_id: role?.id });\n              }}\n              suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n            >\n              {fetchedRoles.map((role: Role) => {\n                  const config = getAccessLevelConfig(role.name);\n                  const Icon = config.icon;\n                  return (\n                    <Option key={role.id} value={role.name}>\n                        <div className=\"flex items-center gap-2\">\n                        <Icon className=\"w-4 h-4\" style={{ color: config.color }} />\n                        <span style={{ color: config.color }}>{role.name}</span>\n                        </div>\n                    </Option>\n                  );\n              })}\n            </Select>\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Employment Type <span className=\"text-[#ff3b3b]\">*</span></span>\n            <Select\n              className={`w-full h-11 employee-form-select ${formData.employmentType ? 'employee-form-select-filled' : ''}`}\n              placeholder=\"Select type\"\n              value={formData.employmentType}\n              onChange={(v) => setFormData({ ...formData, employmentType: v as any })}\n              suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n            >\n              <Option value=\"Full-time\">Full Time</Option>\n              <Option value=\"Part-time\">Part Time</Option>\n              <Option value=\"Contract\">Contract</Option>\n              <Option value=\"Intern\">Intern</Option>\n            </Select>\n          </div>\n\n          {/* Row 4: Designation & Department */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Designation</span>\n            <Input\n              placeholder=\"e.g. Senior Developer\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.role ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.role}\n              onChange={(e) => setFormData({ ...formData, role: e.target.value })}\n            />\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Department</span>\n            <Select\n              showSearch\n              className={`w-full h-11 employee-form-select ${formData.department ? 'employee-form-select-filled' : ''}`}\n              placeholder=\"Select department\"\n              value={formData.department || undefined}\n              onChange={(v) => setFormData({ ...formData, department: String(v) })}\n              suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n            >\n              {departments.length > 0 ? (\n                departments.map((dept) => (\n                  <Option key={dept} value={dept}>{dept}</Option>\n                ))\n              ) : (\n                <Option value=\"\" disabled>No departments found</Option>\n              )}\n            </Select>\n          </div>\n\n\n          {/* Row 5: Manager & Experience */}\n          {/* <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Manager</span>\n            <Select\n              showSearch\n              className={`w-full h-11 employee-form-select ${formData.manager_id ? 'employee-form-select-filled' : ''}`}\n              placeholder=\"Select manager\"\n              optionFilterProp=\"children\"\n              filterOption={(input: string, option: any) => \n                (option?.label ?? '').toString().toLowerCase().includes(input.toLowerCase())\n              }\n              value={formData.manager_id || undefined}\n              onChange={(v) => setFormData({ ...formData, manager_id: v })}\n              suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n          {/* Row 5: Experience & Date of Joining */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Experience (Years)</span>\n            <Input\n              type=\"number\"\n              placeholder=\"e.g. 5\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.experience ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.experience}\n              onChange={(e) => setFormData({ ...formData, experience: e.target.value })}\n            />\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Date of Joining</span>\n            <DatePicker\n              className={`w-full h-11 employee-form-datepicker ${formData.dateOfJoining ? 'employee-form-datepicker-filled' : ''}`}\n              placeholder=\"dd/mm/yyyy\"\n              format=\"DD/MM/YYYY\"\n              value={formData.dateOfJoining ? dayjs(formData.dateOfJoining) : null}\n              onChange={(date) => setFormData({ ...formData, dateOfJoining: date ? date.format('YYYY-MM-DD') : '' })}\n              suffixIcon={<Calendar className=\"w-4 h-4 text-[#999999]\" />}\n            />\n          </div>\n\n          {/* Row 6: Salary & Total Leaves */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Salary (CTC) <span className=\"text-[#666666] font-normal text-[11px] ml-1\">(Annual)</span></span>\n            <Space.Compact className=\"w-full\">\n              {CurrencySelector}\n              <Input\n                type=\"number\"\n                placeholder=\"e.g. 1200000\"\n                className={`h-11 rounded-r-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.salary ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n                style={{ borderLeft: 0 }}\n                value={formData.salary}\n                onChange={(e) => setFormData({ ...formData, salary: e.target.value })}\n                prefix={<span className=\"text-gray-400 mr-1\">{currencySymbol}</span>}\n              />\n            </Space.Compact>\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Total Leaves</span>\n            <Input\n              type=\"number\"\n              placeholder=\"Days\"\n              className={`h-11 rounded-lg border border-[#EEEEEE] font-['Manrope:Medium',sans-serif] ${formData.leaves ? 'bg-white' : 'bg-[#F9FAFB]'}`}\n              value={formData.leaves}\n              onChange={(e) => setFormData({ ...formData, leaves: e.target.value })}\n            />\n          </div>\n\n          {/* Row 7: Working Hours & Hourly Cost */}\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Working Hours</span>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <TimePicker\n                placeholder=\"Start\"\n                format=\"h:mm a\"\n                className={`w-full h-11 employee-form-datepicker ${formData.workingHoursStart ? 'employee-form-datepicker-filled' : ''}`}\n                value={formData.workingHoursStart ? dayjs(formData.workingHoursStart, 'h:mm a') : null}\n                onChange={(time) => setFormData({ ...formData, workingHoursStart: time ? time.format('h:mm a') : '' })}\n                suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n              />\n              <TimePicker\n                placeholder=\"End\"\n                format=\"h:mm a\"\n                className={`w-full h-11 employee-form-datepicker ${formData.workingHoursEnd ? 'employee-form-datepicker-filled' : ''}`}\n                value={formData.workingHoursEnd ? dayjs(formData.workingHoursEnd, 'h:mm a') : null}\n                onChange={(time) => setFormData({ ...formData, workingHoursEnd: time ? time.format('h:mm a') : '' })}\n                suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n              />\n            </div>\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Hourly Cost <span className=\"text-[#666666] font-normal text-[11px] ml-1\">(Calculated)</span></span>\n            <Input\n              placeholder=\"e.g. 25/Hr\"\n              readOnly\n              className={`h-11 rounded-lg border border-[#EEEEEE] bg-[#F9FAFB] text-[#666666] font-['Manrope:Medium',sans-serif] cursor-not-allowed`}\n              value={formData.hourlyRate ? `${formData.hourlyRate}/Hr` : \"\"}\n              prefix={<span className=\"text-gray-400 mr-1\">{currencySymbol}</span>}\n            />\n          </div>\n          <div className=\"col-span-6 space-y-1\">\n            {/* Empty or Spacer if needed? For now, we need to place Skillsets at the end. \n                If Skillsets is full width, it should be in a new row. \n                If 'Hourly Cost' is left alone, we can leave an empty space or put Skillsets next to it? \n                Skillsets is typically long (tags). \n                Let's put Skillsets in full width at bottom as requested \"to the last\", \n                Leaving a blank space next to Hourly Cost, or making Hourly Cost full width?\n                Let's make Hourly Cost 6, and leave 6 empty. Or maybe put something else there? \n                Actually, currency selector can be separate? No.\n                Let's leave it as is -> Hourly Cost (6) + Empty (6)\n                Then Skillsets (12)\n            */}\n          </div>\n\n          {/* Row 9: Professional Skillsets */}\n          <div className=\"col-span-12 space-y-1\">\n            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Professional Skillsets</span>\n            <Select\n              mode=\"tags\"\n              className={`w-full employee-form-select linkedin-skill-select ${formData.skillsets ? 'employee-form-select-filled' : ''}`}\n              classNames={{ popup: { root: 'linkedin-skill-dropdown' } }}\n              placeholder=\"Type and press enter (e.g. React, UX Design, etc.)\"\n              value={formData.skillsets ? formData.skillsets.split(',').filter(s => s.trim()) : []}\n              onChange={(v) => setFormData({ ...formData, skillsets: v.join(',') })}\n              suffixIcon={null}\n              maxTagCount=\"responsive\"\n            >\n              <Option value=\"React\">React</Option>\n              <Option value=\"Node.js\">Node.js</Option>\n              <Option value=\"TypeScript\">TypeScript</Option>\n              <Option value=\"UI/UX Design\">UI/UX Design</Option>\n              <Option value=\"Product Management\">Product Management</Option>\n              <Option value=\"Python\">Python</Option>\n              <Option value=\"AWS\">AWS</Option>\n            </Select>\n          </div>\n        </div>\n\n\n        <style jsx global>{`\n          /* Force standard 44px height for all form elements */\n          :global(.ant-input), \n          :global(.ant-select),\n          :global(.ant-select-selector), \n          :global(.ant-picker) {\n            height: 44px !important;\n          }\n          \n          :global(.ant-select-selector), \n          :global(.ant-picker) {\n            min-height: 44px !important;\n            display: flex !important;\n            align-items: center !important;\n            padding-top: 0 !important;\n            padding-bottom: 0 !important;\n          }\n          \n          /* Ensure content inside Select is centered */\n          :global(.ant-select-selection-item), \n          :global(.ant-select-selection-placeholder),\n          :global(.ant-select-selection-search-input) {\n            display: flex !important;\n            align-items: center !important;\n          }\n          \n          :global(.ant-select-selection-placeholder) {\n            height: 100% !important;\n            top: 0 !important;\n            display: flex !important;\n            align-items: center !important;\n          }\n          \n          :global(.ant-select-selection-search) {\n            height: 100% !important;\n            top: 0 !important;\n            display: flex !important;\n            align-items: center !important;\n            margin-top: 0 !important;\n            margin-bottom: 0 !important;\n          }\n          \n          /* Tags should stay centered */\n          :global(.ant-select-selection-overflow) {\n            height: 100% !important;\n            display: flex !important;\n            align-items: center !important;\n            flex-wrap: nowrap !important;\n            padding-top: 0 !important;\n            padding-bottom: 0 !important;\n          }\n\n          /* LinkedIn Style Skills Tags */\n          :global(.linkedin-skill-select .ant-select-selection-item) {\n            background: #E7F3FF !important;\n            border: 1px solid #70B5FF !important;\n            border-radius: 4px !important;\n            color: #004182 !important;\n            font-family: 'Manrope:SemiBold', sans-serif !important;\n            font-size: 12px !important;\n            height: 24px !important;\n            line-height: 22px !important;\n            margin: 0 4px 0 0 !important;\n            padding-inline-start: 8px !important;\n            display: flex !important;\n            align-items: center !important;\n            overflow: visible !important;\n          }\n          :global(.linkedin-skill-select .ant-select-selection-item-remove) {\n            color: #004182 !important;\n            transition: all 0.2s;\n          }\n          :global(.linkedin-skill-select .ant-select-selection-item-remove:hover) {\n            color: #ff3b3b !important;\n          }\n          :global(.linkedin-skill-select .ant-select-selection-overflow-item) {\n            display: flex !important;\n            align-items: center !important;\n          }\n          :global(.linkedin-skill-select .ant-select-selector) {\n            padding-top: 0 !important;\n            padding-bottom: 0 !important;\n            padding-left: 11px !important;\n            overflow: hidden !important;\n          }\n          /* Gray background for all Select dropdowns (default) */\n          .employee-form-select .ant-select-selector {\n            background-color: #F9FAFB !important;\n            border-color: #EEEEEE !important;\n          }\n          .employee-form-select .ant-select-selector:hover {\n            border-color: #EEEEEE !important;\n          }\n          .employee-form-select.ant-select-focused .ant-select-selector {\n            border-color: #EEEEEE !important;\n            box-shadow: none !important;\n          }\n          \n          /* White background for filled Select dropdowns */\n          .employee-form-select-filled .ant-select-selector {\n            background-color: white !important;\n          }\n          \n          /* Gray background for DatePicker (default) */\n          .employee-form-datepicker .ant-picker {\n            background-color: #F9FAFB !important;\n            border-color: #EEEEEE !important;\n          }\n          .employee-form-datepicker .ant-picker:hover {\n            border-color: #EEEEEE !important;\n          }\n          .employee-form-datepicker .ant-picker-focused {\n            border-color: #EEEEEE !important;\n            box-shadow: none !important;\n          }\n          \n          /* White background for filled DatePicker */\n          .employee-form-datepicker-filled .ant-picker {\n            background-color: white !important;\n          }\n          \n          /* Remove extra borders on Input focus */\n          .ant-input:focus {\n            border-color: #EEEEEE !important;\n            box-shadow: none !important;\n          }\n\n          /* Currency Select styling */\n          :global(.currency-select-addon .ant-select-selector) {\n            background-color: transparent !important;\n            border: none !important;\n            padding: 0 4px !important;\n            height: 42px !important; /* Match input height */\n            display: flex !important;\n            align-items: center !important;\n            box-shadow: none !important;\n          }\n          \n          :global(.currency-select-addon) {\n             display: flex !important;\n             align-items: center !important;\n          }\n          \n          /* Access Level dropdown styling - remove extra background and checkboxes */\n          :global(.access-level-popup), :global(.linkedin-skill-dropdown) {\n            box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;\n            border: 1px solid #EEEEEE !important;\n            border-radius: 8px !important;\n            padding: 4px !important;\n            background: white !important;\n          }\n          :global(.access-level-popup .ant-select-item), :global(.linkedin-skill-dropdown .ant-select-item) {\n            background: white !important;\n            padding: 8px 12px !important;\n            border-radius: 6px !important;\n            margin-bottom: 2px !important;\n          }\n          :global(.access-level-popup .ant-select-item:hover), :global(.linkedin-skill-dropdown .ant-select-item:hover) {\n            background: #F7F7F7 !important;\n            height: auto !important;\n          }\n          :global(.access-level-popup .ant-select-item-option-selected), :global(.linkedin-skill-dropdown .ant-select-item-option-selected) {\n            background: #F9FAFB !important;\n            font-weight: 600 !important;\n          }\n          /* Show exactly one checkmark - standard antd checkmark is in .ant-select-item-option-state */\n          :global(.access-level-popup .ant-select-item-option-state),\n          :global(.linkedin-skill-dropdown .ant-select-item-option-state) {\n            display: flex !important;\n          }\n        `}</style>\n      </div>\n\n      {/* Fixed Footer */}\n      <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-4 flex items-center justify-end bg-white gap-4\">\n        <Button\n          type=\"text\"\n          onClick={onCancel}\n          className=\"h-[40px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n        >\n          Cancel\n        </Button>\n        <Button\n          type=\"primary\"\n          onClick={handleSubmit}\n          className=\"h-[40px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none\"\n        >\n          {isEditing ? \"Update Profile\" : \"Create Employee\"}\n        </Button>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/RequirementsForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":5,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":6,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":59},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":54,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1818,1821],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1818,1821],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":55,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1931,1934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1931,1934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2845,2848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2845,2848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2914,2917],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2914,2917],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4944,4947],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4944,4947],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4989,4992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4989,4992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10555,10558],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10555,10558],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":233,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11140,11143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11140,11143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":242,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":242,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11756,11759],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11756,11759],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport dayjs from 'dayjs';\nimport { Input, Select, Button, Upload, DatePicker, Checkbox } from 'antd';\nimport { Upload as UploadIcon, FileText, ChevronDown, User } from 'lucide-react';\nimport { useOutsourcePartners, useEmployees } from '@/hooks/useUser';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nexport interface RequirementFormData {\n    title: string;\n    workspace: string | number | undefined;\n    type: 'inhouse' | 'outsourced';\n    contactPerson?: string;\n    contact_person_id?: number;\n    dueDate: string;\n    budget?: string;\n    is_high_priority?: boolean;\n    description: string;\n    status?: string;\n    receiver_company_id?: number;\n}\n\ninterface RequirementsFormProps {\n    initialData?: RequirementFormData;\n    onSubmit: (data: RequirementFormData) => void;\n    onCancel: () => void;\n    workspaces: { id: number | string; name: string }[];\n    isLoading?: boolean;\n    isEditing?: boolean;\n}\n\nexport function RequirementsForm({\n    initialData,\n    onSubmit,\n    onCancel,\n    workspaces,\n    isLoading = false,\n    isEditing = false,\n}: Readonly<RequirementsFormProps>) {\n    const { data: partnersData, isLoading: isLoadingPartners, refetch: refetchPartners } = useOutsourcePartners();\n    const { data: employeesData, isLoading: isLoadingEmployees } = useEmployees();\n\n    // Refetch partners when form opens to ensure fresh data (especially after status changes)\n    useEffect(() => {\n        refetchPartners();\n    }, [refetchPartners]);\n\n    // Process partners - filter for active and ensure unique IDs\n    const partners = (partnersData?.result || [])\n        // Relaxed filter: Allow if status is ACCEPTED OR if is_active is explicitly true (handling potential missing status in legacy data)\n        .filter((item: any) => (item.status === 'ACCEPTED' || item.is_active === true) && item.is_active !== false)\n        .map((item: any) => {\n            // Fix: Backend returns client_id/outsource_id/association_id/invite_id, not user_... prefixes\n            const id = item.partner_user_id ?? item.user_id ?? item.client_id ?? item.outsource_id ?? item.association_id ?? item.invite_id ?? item.id;\n            return {\n                id: (typeof id === 'number' ? id : undefined) as number | undefined,\n                name: (item.partner_user?.name || item.name || item.partner_user?.company || item.company || 'Unknown Partner') as string,\n                company: (item.partner_user?.company || item.company) as string | undefined,\n                company_id: item.company_id as number | undefined // Preserve company_id for receiver_company_id logic\n            };\n        })\n        .filter((p: { id?: number }) => p.id !== undefined);\n\n    // Process employees\n    const employees = (employeesData?.result || [])\n        .filter((item: any) => item.user_employee?.is_active !== false)\n        .map((item: any) => {\n            const id = item.user_id ?? item.id;\n            return {\n                id: (typeof id === 'number' ? id : undefined) as number | undefined,\n                name: (item.name || 'Unknown Employee') as string,\n                designation: item.designation as string | undefined\n            };\n        })\n        .filter((e: { id?: number }) => e.id !== undefined);\n\n    const [formData, setFormData] = useState<RequirementFormData>({\n        title: '',\n        workspace: undefined,\n        type: 'inhouse',\n        contactPerson: undefined,\n        dueDate: '',\n        budget: '',\n        is_high_priority: false,\n        description: '',\n        ...initialData,\n    });\n\n    // Reset form when initialData changes (for editing mode switching)\n    useEffect(() => {\n        if (initialData) {\n            setFormData((prev) => ({ \n                ...prev, \n                ...initialData,\n                contact_person_id: initialData.contact_person_id ?? undefined,\n                workspace: initialData.workspace ?? undefined\n            }));\n        }\n    }, [initialData]);\n\n    const handleSubmit = () => {\n        // Find the selected partner to extract receiver_company_id\n        const selectedPartner = partners.find(p => p.id === formData.contact_person_id);\n        \n        console.log('RequirementsForm handleSubmit DEBUG:', {\n            formDataType: formData.type,\n            formDataContactPersonId: formData.contact_person_id,\n            formDataWorkspace: formData.workspace,\n            partnersCount: partners.length,\n            selectedPartner,\n            derivedReceiverCompanyId: selectedPartner?.company_id,\n        });\n\n        // Build payload with workspace_id\n        const payload = {\n            ...formData,\n            workspace_id: formData.workspace ? Number(formData.workspace) : undefined,\n            receiver_company_id: selectedPartner?.company_id \n        };\n\n        // Remove the 'workspace' key as the backend uses 'workspace_id'\n        delete (payload as any).workspace;\n\n        onSubmit(payload as any);\n    };\n\n\n    return (\n        <div className=\"flex flex-col h-full bg-white\">\n            {/* Fixed Header */}\n            <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-3\">\n                <div className=\"flex items-center justify-between mb-0.5\">\n                    <div className=\"flex items-center gap-2 text-[17px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                        <div className=\"p-1.5 rounded-full bg-[#F7F7F7]\">\n                            <FileText className=\"w-3.5 h-3.5 text-[#666666]\" />\n                        </div>\n                        {isEditing ? 'Edit Requirement' : 'New Requirement'}\n                    </div>\n                </div>\n                <p className=\"text-[11px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-9\">\n                    Define a new requirement and send it for approval/processing.\n                </p>\n            </div>\n\n            {/* Scrollable Body */}\n            <div className=\"flex-1 overflow-y-auto px-6 py-5 scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent\">\n                {/* Row 1: Title & Workspace */}\n                <div className=\"grid grid-cols-2 gap-x-6 gap-y-4 mb-4\">\n                    <div className=\"space-y-1.5\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Requirement Title</span>\n                        <Input\n                            placeholder=\"Enter requirement title\"\n                            className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                            value={formData.title}\n                            onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                        />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Workspace</span>\n                        <Select\n                            showSearch={{\n                                filterOption: (input, option) =>\n                                    (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                            }}\n                            className=\"w-full h-11\"\n                            placeholder=\"Select workspace\"\n                            value={formData.workspace ? String(formData.workspace) : undefined}\n                            onChange={(v) => setFormData({ ...formData, workspace: v })}\n                            popupStyle={{ zIndex: 2000 }}\n                            suffixIcon={<ChevronDown className=\"w-4 h-4 text-gray-400\" />}\n                            disabled={formData.type === 'outsourced'}\n                        >\n                            {workspaces && workspaces.length > 0 ? (\n                                workspaces.map((w) => (\n                                    <Option key={String(w.id)} value={String(w.id)}>\n                                        {w.name}\n                                    </Option>\n                                ))\n                            ) : (\n                                <Option value=\"none\" disabled>\n                                    No workspaces available\n                                </Option>\n                            )}\n                        </Select>\n                    </div>\n                </div>\n\n                {/* Row 2: Requirement Type & Contact Person */}\n                <div className=\"grid grid-cols-2 gap-x-6 gap-y-4 mb-4\">\n                    <div className=\"space-y-1.5\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Requirement Type</span>\n                        <Select\n                            className=\"w-full h-11\"\n                            placeholder=\"Select type\"\n                            value={formData.type}\n                            onChange={(v) => setFormData({ \n                                ...formData, \n                                type: v, \n                                contact_person_id: undefined, \n                                contactPerson: undefined,\n                                // If outsourced, clear workspace (Receiver assigns it)\n                                workspace: v === 'outsourced' ? undefined : formData.workspace \n                            })}\n                            suffixIcon={<ChevronDown className=\"w-4 h-4 text-gray-400\" />}\n                        >\n                            <Option value=\"inhouse\">In-house</Option>\n                            <Option value=\"outsourced\">Partner (Outsourced)</Option>\n                        </Select>\n                    </div>\n\n                    <div className=\"space-y-1.5\" id=\"contact-person-selection\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Contact Person</span>\n                        <Select\n                            showSearch={{\n                                filterOption: (input, option) =>\n                                    (String(option?.label ?? '')).toLowerCase().includes(input.toLowerCase())\n                            }}\n                            className=\"w-full h-11\"\n                            placeholder={`Select ${formData.type === 'inhouse' ? 'employee' : 'partner'}`}\n                            value={typeof formData.contact_person_id === 'number' ? formData.contact_person_id : undefined}\n                            onChange={(v, option: any) => setFormData({\n                                ...formData,\n                                contact_person_id: typeof v === 'number' ? v : undefined,\n                                contactPerson: option?.label\n                            })}\n                            loading={formData.type === 'inhouse' ? isLoadingEmployees : isLoadingPartners}\n                            suffixIcon={<ChevronDown className=\"w-4 h-4 text-gray-400\" />}\n                        >\n                            {formData.type === 'inhouse' ? (\n                                employees.map((e: any) => (\n                                    <Option key={e.id} value={e.id} label={e.name}>\n                                        <div className=\"flex flex-col py-1\">\n                                            <span className=\"font-semibold\">{e.name}</span>\n                                            {e.designation && <span className=\"text-[10px] text-gray-400 font-normal\">{e.designation}</span>}\n                                        </div>\n                                    </Option>\n                                ))\n                            ) : (\n                                partners.map((p: any) => (\n                                    <Option key={p.id} value={p.id} label={p.name}>\n                                        <div className=\"flex flex-col py-1\">\n                                            <span className=\"font-semibold\">{p.name}</span>\n                                            {p.company && <span className=\"text-[10px] text-gray-400 font-normal\">{p.company}</span>}\n                                        </div>\n                                    </Option>\n                                ))\n                            )}\n                        </Select>\n                    </div>\n                </div>\n                {/* Row 3: Standard Fields (Due Date & Priority) */}\n                <div className=\"grid grid-cols-2 gap-x-6 gap-y-4 mb-4\">\n                    <div className=\"space-y-1.5\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Due Date</span>\n                        <DatePicker\n                            placeholder=\"Select due date\"\n                            className=\"w-full h-11 rounded-lg border-[#EEEEEE]\"\n                            value={formData.dueDate ? dayjs(formData.dueDate) : null}\n                            onChange={(date, dateString) => setFormData({ ...formData, dueDate: Array.isArray(dateString) ? dateString[0] : dateString })}\n                        />\n                    </div>\n                    <div className=\"space-y-1.5 flex flex-col justify-center\">\n                        <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">Priority</span>\n                        <Checkbox\n                            checked={formData.is_high_priority}\n                            onChange={(e) => setFormData({ ...formData, is_high_priority: e.target.checked })}\n                            className=\"font-medium text-sm\"\n                        >\n                            High Priority\n                        </Checkbox>\n                    </div>\n                </div>\n\n                {/* Row 4: Budget (Outsourced only) - Only show when editing */}\n                {formData.type === 'outsourced' && isEditing && (\n                    <div className=\"grid grid-cols-2 gap-x-6 gap-y-4 mb-4\">\n                        <div className=\"space-y-1.5\">\n                            <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Target Budget</span>\n                            <Input\n                                type=\"number\"\n                                prefix=\"$\"\n                                placeholder=\"0.00\"\n                                className=\"h-11 rounded-lg border border-[#EEEEEE]\"\n                                value={formData.budget}\n                                onChange={(e) => setFormData({ ...formData, budget: e.target.value })}\n                            />\n                        </div>\n                    </div>\n                )}\n\n                {/* Description */}\n                <div className=\"space-y-1.5 mb-4\">\n                    <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Description</span>\n                    <TextArea\n                        placeholder=\"Describe the requirement...\"\n                        className=\"min-h-[100px] rounded-lg border border-[#EEEEEE] resize-none p-3.5\"\n                        rows={3}\n                        value={formData.description}\n                        onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    />\n                </div>\n\n                {/* Upload Documents */}\n                <div className=\"space-y-1.5\">\n                    <span className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Upload Documents</span>\n                    <div className=\"border-2 border-dashed border-[#EEEEEE] rounded-xl p-3 flex flex-col items-center justify-center text-center hover:border-[#ff3b3b]/30 hover:bg-[#FFFAFA] transition-colors cursor-pointer bg-white group\">\n                        <div className=\"w-8 h-8 rounded-full bg-[#F7F7F7] group-hover:bg-white flex items-center justify-center mb-1.5 transition-colors\">\n                            <UploadIcon className=\"w-4 h-4 text-[#999999] group-hover:text-[#ff3b3b] transition-colors\" />\n                        </div>\n                        <p className=\"text-[12px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-0.5\">\n                            Choose a file or drag & drop it here\n                        </p>\n                        <p className=\"text-[10px] text-[#999999] font-['Inter:Regular',sans-serif]\">\n                            txt, docx, pdf, jpeg, xlsx - Up to 50MB\n                        </p>\n                        <Button className=\"mt-2.5 h-7 px-4 bg-white border border-[#EEEEEE] text-[11px] font-['Manrope:SemiBold',sans-serif] text-[#111111] hover:bg-[#F7F7F7] hover:text-[#ff3b3b] hover:border-[#ff3b3b]/20 rounded-md\">\n                            Browse files\n                        </Button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Fixed Footer */}\n            <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-4 flex items-center justify-end bg-white gap-4\">\n                <Button\n                    type=\"text\"\n                    onClick={onCancel}\n                    className=\"h-[40px] px-4 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n                >\n                    Cancel\n                </Button>\n                <Button\n                    type=\"primary\"\n                    onClick={handleSubmit}\n                    loading={isLoading}\n                    disabled={isLoading}\n                    className=\"h-[40px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-['Manrope:SemiBold',sans-serif] transition-transform active:scale-95 border-none disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                    {isEditing ? 'Update Requirement' : 'Save Requirement'}\n                </Button>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/TaskForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Radio' is defined but never used.","line":2,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tooltip' is defined but never used.","line":2,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":74},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1050,1053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1050,1053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onCancel' is defined but never used.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":76,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":216,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8201,8204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8201,8204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from \"react\";\nimport { Button, Input, Select, Checkbox, DatePicker, App, Radio, Tooltip, Avatar } from 'antd';\nimport { CheckSquare, Calendar, Users, ArrowRight, Layers, UserPlus, X } from 'lucide-react';\nimport dayjs from 'dayjs';\nimport { useUserDetails } from '@/hooks/useUser';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\n// Backend fields based on TaskCreateSchema\nexport interface TaskFormData {\n  name: string;\n  workspace_id: string; // Workspace\n  requirement_id: string; // Requirement\n  member_id: string; // Legacy: Primary Assignee (optional or first member)\n  assigned_members: number[]; // New: Squad Members\n  execution_mode: \"parallel\" | \"sequential\"; // New: Execution Mode\n  leader_id: string; // Leader\n  end_date: string; // Due Date (replaced start_date)\n  estimated_time: string; // Estimated Time (in hours)\n  is_high_priority: boolean; // Priority boolean\n  description: string; // Description\n}\n\ninterface TaskFormProps {\n  initialData?: TaskFormData;\n  onSubmit: (data: any) => void;\n  onCancel: () => void;\n  isEditing?: boolean;\n  users?: Array<{ id: number; name: string; profile_pic?: string }>;\n  requirements?: Array<{ id: number; name: string }>;\n  workspaces?: Array<{ id: number; name: string }>;\n  disabledFields?: {\n    workspace?: boolean;\n    requirement?: boolean;\n  };\n}\n\nconst defaultFormData: TaskFormData = {\n  name: \"\",\n  workspace_id: \"\",\n  requirement_id: \"\",\n  member_id: \"\",\n  assigned_members: [],\n  execution_mode: \"parallel\",\n  leader_id: \"\",\n  end_date: \"\",\n  estimated_time: \"\",\n  is_high_priority: false,\n  description: \"\",\n};\n\nexport function TaskForm({\n  initialData,\n  onSubmit,\n  onCancel,\n  isEditing = false,\n  users = [],\n  requirements = [],\n  workspaces = [],\n  disabledFields = {},\n}: TaskFormProps) {\n  const { message } = App.useApp();\n  const { data: userDetailsData } = useUserDetails();\n  const [formData, setFormData] = useState<TaskFormData>(defaultFormData);\n\n  // Get current logged-in user ID\n  const currentUserId = useMemo(() => {\n    try {\n      if (typeof window !== 'undefined') {\n        const localUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n        if (localUser && localUser.id) {\n          return String(localUser.id);\n        }\n      }\n    } catch (error) {\n      // Error reading user from localStorage\n    }\n    const apiUser = userDetailsData?.result?.user || userDetailsData?.result || {};\n    return apiUser.id ? String(apiUser.id) : '';\n  }, [userDetailsData]);\n\n  useEffect(() => {\n    if (initialData) {\n      setFormData({\n        ...initialData,\n        leader_id: currentUserId || initialData.leader_id, // Auto-set leader to current user\n        assigned_members: initialData.assigned_members || (initialData.member_id ? [parseInt(initialData.member_id)] : []),\n        execution_mode: initialData.execution_mode || \"parallel\",\n      });\n    } else {\n      setFormData({\n        ...defaultFormData,\n        leader_id: currentUserId, // Auto-set leader to current user\n      });\n    }\n  }, [initialData, currentUserId]);\n\n  const handleSubmit = () => {\n    // Validate required fields\n    const missingFields: string[] = [];\n    if (!formData.name) missingFields.push('Task Title');\n    if (!formData.workspace_id) missingFields.push('Workspace');\n    if (!formData.end_date) missingFields.push('Due Date');\n    // Estimated time is conditional now, but if visible, it should be validated.\n    // However, validation logic needs to know if it's visible. \n    // We'll rely on backend or simple check: if user is assigned, check it?\n    // User Instructions: \"The 'Estimated Time' input should only be visible ... if the currentUserId is present ... If... not ... hide this field.\"\n    // If hidden, it's not required.\n    const isCurrentUserAssigned = formData.assigned_members.includes(parseInt(currentUserId));\n    if (isCurrentUserAssigned && (!formData.estimated_time || isNaN(parseFloat(formData.estimated_time)))) {\n      missingFields.push('My Hours');\n    }\n    // Ensure at least one member is assigned (either legacy member_id or new assigned_members)\n    if ((!formData.assigned_members || formData.assigned_members.length === 0) && !formData.member_id) {\n      missingFields.push('At least one squad member');\n    }\n\n    if (missingFields.length > 0) {\n      message.error(`Please fill in required fields: ${missingFields.join(', ')}`);\n      return;\n    }\n\n    // Transform form data to backend format\n    const backendData = {\n      name: formData.name,\n      workspace_id: formData.workspace_id ? parseInt(formData.workspace_id) : undefined,\n      requirement_id: formData.requirement_id ? parseInt(formData.requirement_id) : null,\n      leader_id: parseInt(currentUserId), // STRICTLY current user\n      end_date: formData.end_date, // Map to end_date\n      start_date: new Date().toISOString(), // Default start_date to now if required by backend/schema (user said remove from UI only)\n      estimated_time: (formData.estimated_time && isCurrentUserAssigned) ? parseFloat(formData.estimated_time) : 0,\n      is_high_priority: formData.is_high_priority,\n      description: formData.description || \"\",\n      execution_mode: formData.execution_mode,\n      assigned_members: formData.assigned_members,\n      member_id: formData.assigned_members.length > 0 ? formData.assigned_members[0] : null // Legacy fallback\n    };\n\n    onSubmit(backendData);\n  };\n\n  const handleReset = () => {\n    setFormData({\n      ...defaultFormData,\n      leader_id: currentUserId, // Keep leader set to current user on reset\n    });\n  };\n\n  // Helper to remove member\n  const removeMember = (id: number) => {\n    setFormData(prev => ({\n      ...prev,\n      assigned_members: prev.assigned_members.filter(m => m !== id)\n    }));\n  };\n\n  // Helper to add member\n  const addMember = (id: number) => {\n    if (formData.assigned_members.includes(id)) return;\n    setFormData(prev => ({\n      ...prev,\n      assigned_members: [...prev.assigned_members, id]\n    }));\n  };\n\n  return (\n    <div className=\"flex flex-col h-full bg-white\">\n      {/* Fixed Header */}\n      <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2 text-[17px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n            <div className=\"p-1.5 rounded-full bg-[#F7F7F7]\">\n              <CheckSquare className=\"w-3.5 h-3.5 text-[#666666]\" />\n            </div>\n            {isEditing ? 'Edit Task' : 'New Task'}\n          </div>\n        </div>\n        <p className=\"text-[11px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-9\">\n          {isEditing ? 'Update task parameters and squad.' : 'Define objective and assemble your squad.'}\n        </p>\n      </div>\n\n      {/* Scrollable Body - Reduced padding */}\n      <div className=\"flex-1 overflow-y-auto px-5 py-4 font-['Manrope',sans-serif]\">\n\n        {/* Compact Grid Layout */}\n        <div className=\"grid grid-cols-12 gap-x-4 gap-y-4 mb-5\">\n\n          {/* Task Title: Col Span 12 (Full Row) */}\n          <div className=\"col-span-12 space-y-1.5\">\n            <span className=\"text-[12px] font-bold text-[#111111]\">\n              Task Title <span className=\"text-red-500\">*</span>\n            </span>\n            <Input\n              placeholder=\"e.g. Implement Payment Gateway\"\n              className=\"w-full h-11 rounded-lg border-[#EEEEEE] text-sm\"\n              value={formData.name}\n              onChange={(e) => {\n                setFormData({ ...formData, name: e.target.value });\n              }}\n            />\n          </div>\n\n          {/* Requirement: Col Span 6 */}\n          <div className=\"col-span-12 sm:col-span-6 space-y-1.5\">\n            <span className=\"text-[12px] font-bold text-[#111111]\">\n              Requirement\n            </span>\n            <Select\n              className=\"w-full h-11\"\n              placeholder=\"Select requirement\"\n              value={formData.requirement_id || undefined}\n              onChange={(val) => {\n                const reqId = parseInt(String(val));\n                const selectedReq = requirements.find(r => r.id === reqId) as any;\n                setFormData(prev => ({\n                  ...prev,\n                  requirement_id: String(val),\n                  workspace_id: selectedReq?.workspace_id ? String(selectedReq.workspace_id) : prev.workspace_id\n                }));\n              }}\n              disabled={disabledFields.requirement}\n              suffixIcon={<div className=\"text-gray-400\">⌄</div>}\n              allowClear\n              onClear={() => setFormData(prev => ({ ...prev, requirement_id: \"\" }))}\n              showSearch={{\n                filterOption: (input, option) =>\n                  (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n              }}\n            >\n              {requirements.length > 0 ? (\n                requirements.map((req) => (\n                  <Option key={req.id} value={req.id.toString()}>\n                    {req.name}\n                  </Option>\n                ))\n              ) : (\n                <Option value=\"none\" disabled>No requirements available</Option>\n              )}\n            </Select>\n          </div>\n\n          {/* Workspace: Col Span 6 */}\n          <div className=\"col-span-12 sm:col-span-6 space-y-1.5\">\n            <span className=\"text-[12px] font-bold text-[#111111]\">\n              Workspace <span className=\"text-red-500\">*</span>\n            </span>\n            <Select\n              className=\"w-full h-11\"\n              placeholder=\"Select workspace\"\n              value={formData.workspace_id || undefined}\n              onChange={(val) => {\n                setFormData({ ...formData, workspace_id: String(val) });\n              }}\n              disabled={disabledFields.workspace}\n              suffixIcon={formData.requirement_id ? null : <div className=\"text-gray-400\">⌄</div>}\n              showSearch={{\n                filterOption: (input, option) =>\n                  (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n              }}\n            >\n              {workspaces.length > 0 ? (\n                workspaces.map((workspace) => (\n                  <Option key={workspace.id} value={workspace.id.toString()}>\n                    {workspace.name}\n                  </Option>\n                ))\n              ) : (\n                <Option value=\"none\" disabled>No workspaces available</Option>\n              )}\n            </Select>\n          </div>\n\n          {/* Row 3: Due Date | Priority | My Hours */}\n\n          {/* Due Date: Col Span 4 */}\n          <div className=\"col-span-12 sm:col-span-4 space-y-1.5\">\n            <span className=\"text-[12px] font-bold text-[#111111]\">\n              Due Date <span className=\"text-red-500\">*</span>\n            </span>\n            <DatePicker\n              className=\"w-full h-11 rounded-lg\"\n              value={formData.end_date ? dayjs(formData.end_date) : null}\n              onChange={(date) => {\n                setFormData({ ...formData, end_date: date ? date.toISOString() : '' });\n              }}\n              suffixIcon={<Calendar className=\"w-4 h-4 text-[#999999]\" />}\n            />\n          </div>\n\n          {/* Priority: Col Span 4 */}\n          <div className=\"col-span-12 sm:col-span-4 space-y-1.5 flex flex-col justify-center\">\n            <span className=\"text-[12px] font-bold text-[#111111] mb-2\">Priority</span>\n            <Checkbox\n              checked={formData.is_high_priority}\n              onChange={(e) => setFormData({ ...formData, is_high_priority: e.target.checked })}\n              className=\"font-medium text-sm\"\n            >\n              High Priority\n            </Checkbox>\n          </div>\n\n          {/* My Hours: Col Span 4 (Reduced width) */}\n          <div className=\"col-span-12 sm:col-span-4 space-y-1.5\">\n            <span className={`text-[12px] font-bold ${formData.assigned_members.includes(parseInt(currentUserId)) ? 'text-[#111111]' : 'text-gray-400'}`}>\n              My Hours <span className={`${formData.assigned_members.includes(parseInt(currentUserId)) ? 'text-red-500' : 'hidden'}`}>*</span>\n            </span>\n            <Input\n              type=\"number\"\n              step=\"0.1\"\n              min=\"0\"\n              placeholder={formData.assigned_members.includes(parseInt(currentUserId)) ? \"0\" : \"-\"}\n              className=\"w-full h-11 rounded-lg border border-[#EEEEEE] text-sm\"\n              value={formData.estimated_time}\n              onChange={(e) => {\n                setFormData({ ...formData, estimated_time: e.target.value });\n              }}\n              disabled={!formData.assigned_members.includes(parseInt(currentUserId))}\n            />\n          </div>\n\n        </div>\n\n        {/* --- SQUAD BUILDER SECTION (Compact) --- */}\n        <div className=\"mb-5 border border-[#EEEEEE] rounded-xl p-4 bg-[#FAFAFA]\">\n          <div className=\"flex justify-between items-center mb-3\">\n            <h3 className=\"text-[13px] font-bold text-[#111111] flex items-center gap-2\">\n              <Users className=\"w-4 h-4\" /> Squad Assembly\n            </h3>\n\n            {/* Execution Mode Toggle */}\n            <div className=\"flex bg-white rounded-lg p-0.5 border border-[#EEEEEE]\">\n              <button\n                type=\"button\"\n                onClick={() => setFormData({ ...formData, execution_mode: \"parallel\" })}\n                className={`flex items-center gap-1.5 px-2.5 py-1 rounded-[6px] text-[11px] font-medium transition-all ${formData.execution_mode === \"parallel\" ? 'bg-[#E6F4FF] text-[#0091FF]' : 'text-gray-500 hover:bg-gray-50'}`}\n              >\n                <Layers className=\"w-3 h-3\" /> Parallel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setFormData({ ...formData, execution_mode: \"sequential\" })}\n                className={`flex items-center gap-1.5 px-2.5 py-1 rounded-[6px] text-[11px] font-medium transition-all ${formData.execution_mode === \"sequential\" ? 'bg-[#FFF2E8] text-[#FA541C]' : 'text-gray-500 hover:bg-gray-50'}`}\n              >\n                <ArrowRight className=\"w-3 h-3\" /> Sequential\n              </button>\n            </div>\n          </div>\n\n          {/* Member Selection */}\n          <div className=\"space-y-3\">\n            <Select\n              className=\"w-full\"\n              placeholder={\n                <div className=\"flex items-center gap-2 text-gray-400 text-[13px]\">\n                  <UserPlus className=\"w-4 h-4\" /> <span>Add squad members...</span>\n                </div>\n              }\n              value={null}\n              onChange={(val) => val && addMember(parseInt(val))}\n              suffixIcon={null}\n              dropdownStyle={{ borderRadius: '8px', padding: '8px' }}\n              showSearch={{\n                filterOption: (input, option) => {\n                  const label = option?.label as string;\n                  return label.toLowerCase().includes(input.toLowerCase());\n                }\n              }}\n            >\n              {users\n                .filter(u => !formData.assigned_members.includes(u.id))\n                .map((user) => (\n                  <Option key={user.id} value={user.id.toString()} label={user.name}>\n                    <div className=\"flex items-center gap-3 py-1\">\n                      <Avatar size=\"small\" src={user.profile_pic}>{user.name.charAt(0)}</Avatar>\n                      <span className=\"font-medium text-gray-700\">{user.name}</span>\n                    </div>\n                  </Option>\n                ))}\n            </Select>\n\n            {/* Selected Squad List */}\n            <div className=\"space-y-2\">\n              {formData.assigned_members.map((memberId, index) => {\n                const user = users.find(u => u.id === memberId);\n                if (!user) return null;\n                return (\n                  <div key={memberId} className=\"flex items-center justify-between bg-white p-2 px-3 rounded-lg border border-[#E5E7EB] shadow-sm\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex items-center justify-center w-5 h-5 rounded-full bg-gray-100 text-[9px] font-bold text-gray-500\">\n                        {formData.execution_mode === 'sequential' ? index + 1 : '•'}\n                      </div>\n                      <Avatar size=\"small\" shape=\"circle\" className=\"w-6 h-6 text-[10px]\" src={user.profile_pic}>{user.name.charAt(0)}</Avatar>\n                      <span className=\"text-[13px] font-semibold text-gray-800\">{user.name}</span>\n                      {String(user.id) !== currentUserId && (\n                        <span className=\"xs:inline hidden text-[9px] text-amber-500 bg-amber-50 px-1.5 py-0.5 rounded-full border border-amber-100\">\n                          Estimate Pending\n                        </span>\n                      )}\n                    </div>\n                    <button\n                      onClick={() => removeMember(memberId)}\n                      className=\"p-1 px-2 text-gray-400 hover:text-red-500 transition-colors\"\n                    >\n                      <X className=\"w-3.5 h-3.5\" />\n                    </button>\n                  </div>\n                )\n              })}\n              {formData.assigned_members.length === 0 && (\n                <div className=\"text-center py-4 text-gray-400 text-[12px] border border-dashed border-gray-300 rounded-lg\">\n                  No active agents assigned.\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Collapsible Description */}\n        <div className=\"space-y-1.5\">\n          <span className=\"text-[12px] font-bold text-[#111111]\">Description</span>\n          <TextArea\n            placeholder=\"Describe the mission objectives...\"\n            className=\"font-['Manrope:Regular',sans-serif] rounded-lg border border-[#EEEEEE]\"\n            rows={formData.description ? 3 : 1}\n            onFocus={(e) => e.target.rows = 3}\n            value={formData.description}\n            onChange={(e) => {\n              setFormData({ ...formData, description: e.target.value });\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Fixed Footer */}\n      <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-4 flex items-center justify-end bg-white gap-4\">\n        <Button\n          type=\"text\"\n          onClick={handleReset}\n          className=\"h-[40px] px-4 text-[14px] font-semibold text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] transition-colors rounded-lg\"\n        >\n          Reset Data\n        </Button>\n        <Button\n          type=\"primary\"\n          onClick={handleSubmit}\n          className=\"h-[40px] px-8 rounded-lg bg-[#111111] hover:bg-[#000000]/90 text-white text-[14px] font-semibold transition-transform active:scale-95 border-none\"\n        >\n          {isEditing ? 'Update Task' : 'Submit'}\n        </Button>\n      </div>\n    </div >\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/WorklogModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/modals/WorkspaceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[467,470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[467,470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":16,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[499,502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[499,502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":71,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2379,2382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2379,2382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2432,2435],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2432,2435],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2681,2684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2681,2684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6837,6840],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6837,6840],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Modal, Button, Input, Select, App } from \"antd\";\nimport { FolderOpen } from 'lucide-react';\nimport { useCreateWorkspace, useUpdateWorkspace } from '@/hooks/useWorkspace';\nimport { usePartners, useCurrentUserCompany } from '@/hooks/useUser';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\ninterface WorkspaceFormProps {\n    open: boolean;\n    onCancel: () => void;\n    onSuccess?: (data?: any) => void;\n    initialData?: any; // Added for edit mode\n}\n\nconst defaultWorkspaceData = {\n    id: null as number | null,\n    name: '',\n    description: '',\n    partner_id: null as number | null,\n    inHouse: true,\n};\n\nexport function WorkspaceForm({ open, onCancel, onSuccess, initialData }: WorkspaceFormProps) {\n    const { message } = App.useApp();\n    const { data: partnersData } = usePartners();\n    const { data: companyData } = useCurrentUserCompany();\n    const createWorkspaceMutation = useCreateWorkspace();\n    const updateWorkspaceMutation = useUpdateWorkspace();\n\n    const [newWorkspace, setNewWorkspace] = useState(defaultWorkspaceData);\n\n    // Sync form with initialData when opened\n    useEffect(() => {\n        if (open) {\n            if (initialData) {\n                setNewWorkspace({\n                    id: initialData.id,\n                    name: initialData.name || '',\n                    description: initialData.description || '',\n                    partner_id: initialData.partner_id || null,\n                    inHouse: initialData.in_house ?? !initialData.partner_id,\n                });\n            } else {\n                setNewWorkspace(defaultWorkspaceData);\n            }\n        }\n    }, [open, initialData]);\n\n\n    const handleAction = async () => {\n        if (!newWorkspace.name) {\n            message.error(\"Workspace name is required\");\n            return;\n        }\n\n        const payload = {\n            name: newWorkspace.name,\n            description: newWorkspace.description || '',\n            partner_id: newWorkspace.inHouse ? null : newWorkspace.partner_id,\n            in_house: newWorkspace.inHouse,\n        };\n\n        const mutation = initialData ? updateWorkspaceMutation : createWorkspaceMutation;\n        const mutationParams = initialData ? { id: initialData.id, ...payload } : payload;\n\n        mutation.mutate(\n            mutationParams as any,\n            {\n                onSuccess: (data: any) => {\n                    message.success(`Workspace ${initialData ? 'updated' : 'created'} successfully!`);\n                    if (onSuccess) onSuccess(data);\n                    onCancel();\n                },\n                onError: (error: any) => {\n                    const errorMessage = error?.response?.data?.message || `Failed to ${initialData ? 'update' : 'create'} workspace`;\n                    message.error(errorMessage);\n                },\n            }\n        );\n    };\n\n    return (\n        <Modal\n            open={open}\n            onCancel={onCancel}\n            footer={null}\n            title={null}\n            width={600}\n            centered\n            className=\"workspace-form-modal rounded-[16px] overflow-hidden\"\n            closable={true}\n            styles={{\n                body: {\n                    padding: 0,\n                    maxHeight: 'calc(100vh - 100px)',\n                    display: 'flex',\n                    flexDirection: 'column',\n                },\n            }}\n        >\n            <div className=\"flex flex-col h-full bg-white\">\n                {/* Fixed Header */}\n                <div className=\"flex-shrink-0 border-b border-[#EEEEEE] px-6 py-4\">\n                    <div className=\"flex items-center gap-2 text-[17px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n                        <div className=\"p-1.5 rounded-full bg-[#F7F7F7]\">\n                            <FolderOpen className=\"w-4 h-4 text-[#666666]\" />\n                        </div>\n                        {initialData ? 'EDIT WORKSPACE' : 'CREATE WORKSPACE'}\n                    </div>\n                    <p className=\"text-[12px] text-[#666666] font-['Manrope:Regular',sans-serif] ml-10 mt-1\">\n                        {initialData ? 'Update your workspace details.' : 'Create a new workspace to organize your Requirements.'}\n                    </p>\n                </div>\n\n                {/* Scrollable Body */}\n                <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n                    <div className=\"grid grid-cols-2 gap-6\">\n                        {/* Workspace Name */}\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Workspace Name</label>\n                            <Input\n                                placeholder=\"e.g. Website Redesign\"\n                                className=\"h-11 rounded-xl border-[#EEEEEE] font-['Manrope:Medium',sans-serif]\"\n                                value={newWorkspace.name}\n                                onChange={(e) => setNewWorkspace({ ...newWorkspace, name: e.target.value })}\n                            />\n                        </div>\n\n                        {/* Organization (Partner Company) */}\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Organization</label>\n                            <Select\n                                showSearch={{\n                                    filterOption: (input, option) =>\n                                        (option?.children as unknown as string).toLowerCase().includes(input.toLowerCase())\n                                }}\n                                className=\"w-full h-11\"\n                                placeholder=\"Select organization\"\n                                value={newWorkspace.inHouse ? 'self' : newWorkspace.partner_id}\n                                onChange={(val) => {\n                                    if (val === 'self') {\n                                        setNewWorkspace({ ...newWorkspace, inHouse: true, partner_id: null });\n                                    } else {\n                                        setNewWorkspace({ ...newWorkspace, inHouse: false, partner_id: val as number });\n                                    }\n                                }}\n                                styles={{ popup: { root: { borderRadius: '12px', padding: '8px' } } }}\n                            >\n                                <Option value=\"self\" className=\"rounded-lg mb-1\">\n                                    {companyData?.result?.name || 'My Company'} (Self)\n                                </Option>\n                                {partnersData?.result?.map((partner: any) => (\n                                    <Option key={partner.partner_user_id || partner.id} value={partner.partner_user_id || partner.id} className=\"rounded-lg mb-1\">\n                                        {partner.company || partner.partner_company?.name || partner.name || partner.email}\n                                    </Option>\n                                ))}\n                            </Select>\n                        </div>\n\n                        {/* Description - Full Width */}\n                        <div className=\"col-span-2 space-y-2\">\n                            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Description</label>\n                            <TextArea\n                                placeholder=\"Describe your workspace...\"\n                                className=\"rounded-xl border-[#EEEEEE] font-['Manrope:Medium',sans-serif] py-3\"\n                                rows={4}\n                                value={newWorkspace.description}\n                                onChange={(e) => setNewWorkspace({ ...newWorkspace, description: e.target.value })}\n                            />\n                        </div>\n                    </div>\n                </div>\n\n                {/* Fixed Footer */}\n                <div className=\"flex-shrink-0 border-t border-[#EEEEEE] px-6 py-5 flex items-center justify-end bg-white gap-3\">\n                    <Button\n                        type=\"text\"\n                        onClick={onCancel}\n                        className=\"h-11 px-6 text-[14px] font-['Manrope:SemiBold',sans-serif] text-[#666666] hover:text-[#111111] hover:bg-[#F7F7F7] rounded-xl transition-all\"\n                    >\n                        Cancel\n                    </Button>\n                    <Button\n                        type=\"primary\"\n                        onClick={handleAction}\n                        loading={createWorkspaceMutation.isPending || updateWorkspaceMutation.isPending}\n                        className=\"h-11 px-8 rounded-xl bg-[#111111] hover:bg-[#000000] text-white text-[14px] font-['Manrope:SemiBold',sans-serif] border-none shadow-none transition-all active:scale-95\"\n                    >\n                        {initialData ? 'Update Workspace' : 'Create Workspace'}\n                    </Button>\n                </div>\n            </div>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/AccessBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/DocumentCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/DocumentPreviewModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/FilterBar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":64,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\nimport { Search24Filled, ChevronDown24Filled } from '@fluentui/react-icons';\nimport { X } from 'lucide-react';\n\nexport interface FilterOption {\n  id: string;\n  label: string;\n  options: (string | { label: string; value: string })[];\n  defaultValue?: string;\n  placeholder?: string;\n}\n\ninterface FilterBarProps {\n  filters?: FilterOption[];\n  selectedFilters?: Record<string, string>;\n  onFilterChange?: (filterId: string, value: string) => void;\n  onClearFilters?: () => void;\n  searchPlaceholder?: string;\n  searchValue?: string;\n  onSearchChange?: (value: string) => void;\n  showClearButton?: boolean;\n}\n\nexport function FilterBar({\n  filters = [],\n  selectedFilters = {},\n  onFilterChange,\n  onClearFilters,\n  searchPlaceholder = 'Search...',\n  searchValue = '',\n  onSearchChange,\n  showClearButton = true\n}: FilterBarProps) {\n  const [openDropdown, setOpenDropdown] = useState<string | null>(null);\n  const dropdownRefs = useRef<Record<string, HTMLDivElement | null>>({});\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (openDropdown) {\n        const dropdownEl = dropdownRefs.current[openDropdown];\n        if (dropdownEl && !dropdownEl.contains(event.target as Node)) {\n          setOpenDropdown(null);\n        }\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [openDropdown]);\n\n  const hasActiveFilters = filters.some(filter => {\n    const value = selectedFilters[filter.id];\n    return value && value !== 'All' && value !== filter.defaultValue;\n  });\n\n  if (filters.length === 0 && !onSearchChange) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex items-center gap-3 pb-4 border-b border-[#EEEEEE]\">\n      {/* Filter Dropdowns */}\n      {filters.map((filter, index) => {\n        // Helper to get value and label from an option\n        const getOptionValue = (opt: string | { label: string; value: string }) => typeof opt === 'string' ? opt : opt.value;\n        const getOptionLabel = (opt: string | { label: string; value: string }) => typeof opt === 'string' ? opt : opt.label;\n\n        // Determine current selected value (defaults to first option's value)\n        const firstOptionValue = filter.options.length > 0 ? getOptionValue(filter.options[0]) : '';\n        const selectedValue = selectedFilters[filter.id] || filter.defaultValue || firstOptionValue;\n        \n        // Find selected option object to display correct label\n        const selectedOptionObj = filter.options.find(opt => getOptionValue(opt) === selectedValue);\n        const displayLabel = selectedOptionObj ? getOptionLabel(selectedOptionObj) : selectedValue;\n\n        const isDefault = selectedValue === 'All' || selectedValue === filter.defaultValue; // Simplified check\n        const hasSelection = !isDefault;\n\n        return (\n          <div\n            key={filter.id}\n            className=\"relative\"\n            ref={(el) => { dropdownRefs.current[filter.id] = el; }}\n          >\n            <button\n              onClick={() => setOpenDropdown(openDropdown === filter.id ? null : filter.id)}\n              className={`flex items-center gap-2 px-3 py-1.5 border rounded-lg text-[13px] font-['Manrope:Regular',sans-serif] transition-colors justify-between min-w-[120px] ${hasSelection\n                ? 'bg-[#111111] text-white border-[#111111]'\n                : 'bg-white text-[#666666] border-[#EEEEEE] hover:border-[#111111] hover:text-[#111111]'\n                }`}\n            >\n              <span className=\"truncate\">\n                {isDefault ? (filter.placeholder || filter.label) : displayLabel}\n              </span>\n              <ChevronDown24Filled className={`w-4 h-4 flex-shrink-0 transition-transform ${openDropdown === filter.id ? 'rotate-180' : ''}`} />\n            </button>\n\n            {/* Dropdown Menu */}\n            {openDropdown === filter.id && (\n              <div className=\"absolute top-full mt-2 left-0 bg-white border border-[#EEEEEE] rounded-[12px] shadow-lg w-[200px] py-2 z-50 max-h-[300px] overflow-y-auto\">\n                {filter.options.map((option, idx) => {\n                    const optValue = getOptionValue(option);\n                    const optLabel = getOptionLabel(option);\n                    return (\n                        <button\n                            key={`${optValue}-${idx}`}\n                            onClick={() => {\n                            onFilterChange?.(filter.id, optValue);\n                            setOpenDropdown(null);\n                            }}\n                            className={`w-full text-left px-4 py-2.5 font-['Manrope:Regular',sans-serif] text-[14px] hover:bg-[#F7F7F7] transition-colors ${selectedValue === optValue\n                            ? 'text-[#ff3b3b] bg-[#FEF3F2]'\n                            : 'text-[#666666]'\n                            }`}\n                        >\n                            {optLabel}\n                        </button>\n                    )\n                })}\n              </div>\n            )}\n          </div>\n        );\n      })}\n\n      {/* Clear Filter Button - Moved to right of all filters */}\n      {showClearButton && hasActiveFilters && onClearFilters && (\n        <button\n          onClick={onClearFilters}\n          className=\"w-8 h-8 rounded-full bg-[#FEF3F2] hover:bg-[#FEE4E2] transition-colors flex items-center justify-center\"\n          title=\"Clear filters\"\n        >\n          <X className=\"w-4 h-4 text-[#ff3b3b]\" />\n        </button>\n      )}\n\n      {/* Search Bar */}\n      {onSearchChange && (\n        <div className=\"relative ml-auto\">\n          <Search24Filled className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[#999999]\" />\n          <input\n            type=\"text\"\n            value={searchValue}\n            onChange={(e) => onSearchChange(e.target.value)}\n            placeholder={searchPlaceholder}\n            className=\"pl-9 pr-4 py-1.5 bg-white border border-[#EEEEEE] rounded-lg text-[13px] font-['Manrope:Medium',sans-serif] text-[#111111] placeholder:text-[#999999] focus:outline-none focus:border-[#111111] w-[240px]\"\n          />\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/PaginationBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/PhoneNumberInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/PillTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/ProgressCircle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/ui/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/components/workspace/ProjectCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":5,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used.","line":5,"column":145,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":156},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":5,"column":158,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":163},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MenuProps' is defined but never used.","line":7,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":62},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Avatar' is defined but never used.","line":7,"column":88,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":94},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TaskType' is defined but never used.","line":15,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2584,2587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2584,2587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5743,5746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5743,5746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Calendar as CalendarIcon, Clock, CheckCircle2, AlertCircle, Plus, MoreHorizontal, Paperclip, ChevronRight, LayoutGrid, List, UserPlus, ChevronDown, Check, FolderOpen, MoreVertical, Edit, Trash2 } from 'lucide-react';\nimport { FilterBar, FilterOption } from '../ui/FilterBar';\nimport { Button, Input, Select, Checkbox, Dropdown, MenuProps, Breadcrumb, DatePicker, Avatar, Tooltip, Progress, Tabs, App, Modal } from 'antd';\nimport { useWorkspaces, useWorkspaceTasks } from '@/hooks/useWorkspace';\nimport { useCreateTask, useDeleteTask } from '@/hooks/useTask';\nimport { useEmployees } from '@/hooks/useUser';\nimport { format } from 'date-fns';\n\nimport dayjs from 'dayjs';\nimport { Workspace, Task as DomainTask } from '@/types/domain';\nimport { TaskType } from '@/services/task';\nimport { TaskDto } from '@/types/dto/task.dto';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\n\n\ninterface ProjectTaskUI {\n  id: string;\n  title: string;\n  name?: string;\n  taskId: string;\n  client: string;\n  project: string;\n  leader: string;\n  assignedTo: string;\n  assignee: {\n    name: string;\n    avatar?: string;\n  };\n  startDate: string;\n  dueDate: string;\n  estTime: number;\n  timeSpent: number;\n  activities: number;\n  status: 'In Progress' | 'Completed' | 'Review' | 'Todo';\n  priority: 'High' | 'Medium' | 'Low';\n  comments: number;\n  attachments: number;\n  is_high_priority: boolean;\n  timelineDate: string;\n  timelineLabel: string;\n  dueDateValue: number;\n  description?: string;\n  total_seconds_spent: number;\n}\n\nexport function WorkspaceDetailsPage({ id }: { id: string }) {\n  const router = useRouter();\n  const { modal, message } = App.useApp();\n  const { data: workspacesData } = useWorkspaces();\n  const { data: tasksData, isLoading: tasksLoading } = useWorkspaceTasks(Number(id));\n  const { data: employeesData } = useEmployees();\n  const createTaskMutation = useCreateTask();\n  const deleteTaskMutation = useDeleteTask();\n\n  const [activeTab, setActiveTab] = useState('tasks');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('list');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState<Record<string, string>>({\n    status: 'All',\n    priority: 'All',\n    assignee: 'All'\n  });\n\n  const [isTaskModalOpen, setIsTaskModalOpen] = useState(false);\n  const [newTask, setNewTask] = useState({\n    name: '',\n    description: '',\n    assigneeId: '',\n    status: 'Todo',\n    priority: 'Medium',\n    dueDate: null as any\n  });\n\n  const workspace = useMemo((): Workspace | undefined => {\n    return workspacesData?.result?.workspaces?.find((p: Workspace) => String(p.id) === id);\n  }, [workspacesData, id]);\n\n  const tasks = useMemo((): ProjectTaskUI[] => {\n    if (!tasksData?.result) return [];\n    return tasksData.result.map((t: DomainTask) => {\n      const assignedName = t.assignedTo || 'Unassigned';\n      \n      return {\n      // Map service TaskType to UI Task\n      id: String(t.id),\n      title: t.title || t.name || 'Untitled', \n      name: t.title || t.name || 'Untitled', // Keep name for DomainTask compatibility if needed\n      taskId: String(t.id),\n      client: 'Unknown', // Default or fetch\n      project: workspace?.name || 'Unknown',\n      leader: 'Unknown',\n      assignedTo: assignedName,\n      assignee: {\n        name: assignedName,\n        avatar: undefined\n      },\n      startDate: t.start_date || '',\n      dueDate: t.dueDate || '',\n      estTime: t.estTime || 0,\n      timeSpent: t.timeSpent || 0,\n      activities: t.activities || 0,\n      status: t.status as ProjectTaskUI['status'],\n      priority: t.is_high_priority ? 'High' : 'Medium',\n      is_high_priority: t.is_high_priority || false,\n      timelineDate: '',\n      timelineLabel: '',\n      dueDateValue: t.dueDate ? new Date(t.dueDate).getTime() : 0,\n      description: t.description || '',\n      total_seconds_spent: 0,\n      comments: 0,\n      attachments: 0\n    }}); \n  }, [tasksData, workspace]);\n\n  // Filter Options\n  const assignees = ['All', ...Array.from(new Set(tasks.map((t: ProjectTaskUI) => t.assignee.name)))];\n\n  const filterOptions: FilterOption[] = [\n    {\n      id: 'status',\n      label: 'Status',\n      options: ['All', 'Todo', 'In Progress', 'Review', 'Completed'],\n      placeholder: 'Status',\n      defaultValue: 'All'\n    },\n    {\n      id: 'priority',\n      label: 'Priority',\n      options: ['All', 'High', 'Medium', 'Low'],\n      placeholder: 'Priority',\n      defaultValue: 'All'\n    },\n    {\n      id: 'assignee',\n      label: 'Assignee',\n      options: assignees as string[],\n      placeholder: 'Assignee',\n      defaultValue: 'All'\n    }\n  ];\n\n  const handleCreateTask = () => {\n    if (!newTask.name) {\n      message.error('Task name is required');\n      return;\n    }\n\n    createTaskMutation.mutate({\n      title: newTask.name,\n      description: newTask.description,\n      workspace_id: Number(id),\n      assigned_to: newTask.assigneeId ? Number(newTask.assigneeId) : undefined,\n      start_date: new Date().toISOString(),\n      end_date: newTask.dueDate ? newTask.dueDate.toISOString() : new Date().toISOString(),\n      status: newTask.status,\n      priority: newTask.priority.toUpperCase(),\n    } as unknown as Partial<TaskDto>, { // Assuming create payload is partial task\n      onSuccess: () => {\n        message.success('Task created successfully');\n        setIsTaskModalOpen(false);\n        setNewTask({\n          name: '',\n          description: '',\n          assigneeId: '',\n          status: 'Todo',\n          priority: 'Medium',\n          dueDate: null\n        });\n      },\n      onError: (error: Error) => {\n        message.error((error as any)?.response?.data?.message || 'Failed to create task');\n      }\n    });\n  };\n\n  const handleDeleteTask = (taskId: string) => {\n    modal.confirm({\n      title: 'Delete Task',\n      content: 'Are you sure you want to delete this task?',\n      okText: 'Delete',\n      okType: 'danger',\n      cancelText: 'Cancel',\n      onOk: () => {\n        deleteTaskMutation.mutate(Number(taskId), {\n          onSuccess: () => message.success('Task deleted successfully'),\n          onError: () => message.error('Failed to delete task')\n        });\n      }\n    });\n  };\n\n\n  const filteredTasks = tasks.filter((task: ProjectTaskUI) => {\n    const matchesSearch = searchQuery === '' || task.title.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = filters.status === 'All' || task.status === filters.status;\n    const matchesPriority = filters.priority === 'All' || task.priority === filters.priority;\n    const matchesAssignee = filters.assignee === 'All' || task.assignee.name === filters.assignee;\n    return matchesSearch && matchesStatus && matchesPriority && matchesAssignee;\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'Completed': return 'bg-[#F0FDF4] text-[#16A34A] border-[#BBF7D0]';\n      case 'In Progress': return 'bg-[#F0F9FF] text-[#0284C7] border-[#B9E6FE]';\n      case 'Review': return 'bg-[#FFFBEB] text-[#D97706] border-[#FDE68A]';\n      default: return 'bg-[#F7F7F7] text-[#666666] border-[#EEEEEE]';\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'High': return 'text-[#ff3b3b] bg-[#FEF3F2] border-[#FECACA]';\n      case 'Medium': return 'text-[#F59E0B] bg-[#FFFBEB] border-[#FDE68A]';\n      case 'Low': return 'text-[#10B981] bg-[#ECFDF5] border-[#A7F3D0]';\n      default: return 'text-[#666666] bg-[#F7F7F7] border-[#EEEEEE]';\n    }\n  };\n\n  if (!workspace) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">Workspace not found</p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"w-full h-full bg-white rounded-[24px] border border-[#EEEEEE] flex flex-col overflow-hidden\">\n      {/* Header */}\n      <div className=\"p-6 border-b border-[#EEEEEE]\">\n        {/* Breadcrumb */}\n        <div className=\"mb-6\">\n          <Breadcrumb\n            items={[\n              { title: <a onClick={() => router.push('/dashboard/workspace')} className=\"cursor-pointer font-['Manrope:Medium',sans-serif]\">Workspaces</a> },\n              { title: <span className=\"font-['Manrope:Bold',sans-serif] text-[#111111]\">{workspace.name}</span> }\n            ]}\n            separator={<ChevronRight className=\"w-4 h-4 text-[#999999]\" />}\n          />\n        </div>\n\n        <div className=\"flex flex-col gap-6\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex items-start gap-4\">\n              <div className=\"w-16 h-16 rounded-[16px] bg-[#FEF3F2] border border-[#ff3b3b]/20 flex items-center justify-center\">\n                <FolderOpen className=\"w-8 h-8 text-[#ff3b3b]\" />\n              </div>\n              <div>\n                <h1 className=\"text-[24px] font-['Manrope:Bold',sans-serif] text-[#111111] mb-2\">{workspace.name}</h1>\n                <div className=\"flex items-center gap-4 text-[13px] text-[#666666]\">\n                  <span className=\"flex items-center gap-1.5 font-['Manrope:Medium',sans-serif]\">\n                    <UserPlus className=\"w-4 h-4\" />\n                    {workspace.client_company_name || 'No Client'}\n                  </span>\n                  <span className=\"w-1 h-1 rounded-full bg-[#DDDDDD]\" />\n                  <span className=\"flex items-center gap-1.5 font-['Manrope:Medium',sans-serif]\">\n                    <CalendarIcon className=\"w-4 h-4\" />\n                    Due {workspace.end_date ? format(new Date(workspace.end_date), 'MMM d, yyyy') : 'No Date'}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex -space-x-2 mr-2\">\n                {/* Assigned Users Avatars could go here */}\n                {workspace.assigned_users?.slice(0, 3).map((user: { name: string }, i: number) => (\n                  <div key={i} className=\"w-8 h-8 rounded-full border-2 border-white bg-[#F7F7F7] flex items-center justify-center text-[10px] font-['Manrope:Bold',sans-serif] text-[#666666]\">\n                    {user.name?.[0]}\n                  </div>\n                ))}\n                {(workspace.assigned_users?.length || 0) > 3 && (\n                  <div className=\"w-8 h-8 rounded-full border-2 border-white bg-[#F0F9FF] flex items-center justify-center text-[10px] font-['Manrope:Bold',sans-serif] text-[#0284C7]\">\n                    +{(workspace.assigned_users?.length || 0) - 3}\n                  </div>\n                )}\n              </div>\n              <Button\n                onClick={() => setIsTaskModalOpen(true)}\n                className=\"bg-[#111111] hover:bg-[#000000]/90 text-white border-none h-10 px-4 rounded-lg flex items-center gap-2 font-['Manrope:SemiBold',sans-serif]\"\n                icon={<Plus className=\"w-4 h-4\" />}\n              >\n                New Task\n              </Button>\n            </div>\n          </div>\n\n          {/* Progress Bar */}\n          <div className=\"w-full max-w-2xl\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">Project Progress</span>\n              <span className=\"text-[13px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">\n                {(workspace.total_task || 0) > 0 ? Math.round(((workspace.total_task_completed || 0) / (workspace.total_task || 1)) * 100) : 0}%\n              </span>\n            </div>\n            <Progress percent={(workspace.total_task || 0) > 0 ? Math.round(((workspace.total_task_completed || 0) / (workspace.total_task || 1)) * 100) : 0} showInfo={false} strokeColor=\"#ff3b3b\" trailColor=\"#F7F7F7\" size=\"small\" />\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"mt-8\">\n          <Tabs\n            activeKey={activeTab}\n            onChange={setActiveTab}\n            items={[\n              { key: 'tasks', label: 'Tasks' },\n              { key: 'files', label: 'Files' },\n              { key: 'activity', label: 'Activity' },\n              { key: 'settings', label: 'Settings' }\n            ]}\n            className=\"custom-tabs\"\n          />\n        </div>\n      </div>\n\n      {/* Content Area */}\n      <div className=\"flex-1 overflow-y-auto p-6 bg-[#FAFAFA]\">\n        {activeTab === 'tasks' && (\n          <>\n            {/* Filter & View Toolbar */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <FilterBar\n                filters={filterOptions}\n                selectedFilters={filters}\n                onFilterChange={(id, val) => setFilters(prev => ({ ...prev, [id]: val }))}\n                onClearFilters={() => setFilters({ status: 'All', priority: 'All', assignee: 'All' })}\n                searchPlaceholder=\"Search tasks...\"\n                searchValue={searchQuery}\n                onSearchChange={setSearchQuery}\n              />\n              <div className=\"flex items-center bg-white p-1 rounded-lg border border-[#EEEEEE] ml-4\">\n                <button\n                  onClick={() => setViewMode('grid')}\n                  className={`p-1.5 rounded-md transition-all ${viewMode === 'grid' ? 'bg-[#F7F7F7] text-[#ff3b3b]' : 'text-[#999999] hover:text-[#111111]'}`}\n                >\n                  <LayoutGrid className=\"w-4 h-4\" />\n                </button>\n                <button\n                  onClick={() => setViewMode('list')}\n                  className={`p-1.5 rounded-md transition-all ${viewMode === 'list' ? 'bg-[#F7F7F7] text-[#ff3b3b]' : 'text-[#999999] hover:text-[#111111]'}`}\n                >\n                  <List className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n\n            {tasksLoading ? (\n              <div className=\"text-center py-12\">\n                <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">Loading tasks...</p>\n              </div>\n            ) : filteredTasks.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <CheckCircle2 className=\"w-12 h-12 text-[#DDDDDD] mx-auto mb-3\" />\n                <p className=\"text-[#999999] font-['Manrope:Regular',sans-serif]\">No tasks found</p>\n              </div>\n            ) : viewMode === 'list' ? (\n              <div className=\"space-y-3\">\n                {filteredTasks.map((task: ProjectTaskUI) => (\n                  <div key={task.id} className=\"group bg-white border border-[#EEEEEE] rounded-[12px] p-4 hover:border-[#ff3b3b] hover:shadow-sm transition-all flex items-center gap-4\">\n                    <Checkbox className=\"custom-checkbox\" />x1\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[#111111] text-[14px] truncate\">{task.title}</h4>\n                      <div className=\"flex items-center gap-3 mt-1 text-[12px] text-[#666666]\">\n                        <span className={`px-2 py-0.5 rounded-full border text-[10px] font-['Manrope:Bold',sans-serif] ${getStatusColor(task.status)}`}>\n                          {task.status}\n                        </span>\n                        <span className={`px-2 py-0.5 rounded-full border text-[10px] font-['Manrope:Bold',sans-serif] ${getPriorityColor(task.priority)}`}>\n                          {task.priority}\n                        </span>\n                        {task.dueDate && (\n                          <span className=\"flex items-center gap-1\">\n                            <CalendarIcon className=\"w-3 h-3\" />\n                            {format(new Date(task.dueDate), 'MMM d')}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-4\">\n                      {task.assignee && (\n                        <Tooltip title={task.assignee.name}>\n                          <div className=\"w-8 h-8 rounded-full bg-[#F7F7F7] flex items-center justify-center text-[10px] font-['Manrope:Bold',sans-serif] text-[#666666]\">\n                            {task.assignee.name[0]}\n                          </div>\n                        </Tooltip>\n                      )}\n                      <Dropdown\n                        menu={{\n                          items: [\n                            { key: 'edit', label: 'Edit', icon: <Edit className=\"w-4 h-4\" /> },\n                            { key: 'delete', label: 'Delete', icon: <Trash2 className=\"w-4 h-4\" />, danger: true, onClick: () => handleDeleteTask(task.id) }\n                          ]\n                        }}\n                        trigger={['click']}\n                        placement=\"bottomRight\"\n                      >\n                        <button className=\"w-8 h-8 rounded-lg hover:bg-[#F7F7F7] flex items-center justify-center transition-colors text-[#999999] opacity-0 group-hover:opacity-100\">\n                          <MoreVertical className=\"w-4 h-4\" />\n                        </button>\n                      </Dropdown>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-3 gap-4\">\n                {filteredTasks.map((task: ProjectTaskUI) => (\n                  <div key={task.id} className=\"group bg-white border border-[#EEEEEE] rounded-[16px] p-5 hover:border-[#ff3b3b] hover:shadow-sm transition-all flex flex-col h-full\">\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <span className={`px-2 py-0.5 rounded-full border text-[10px] font-['Manrope:Bold',sans-serif] ${getPriorityColor(task.priority)}`}>\n                        {task.priority}\n                      </span>\n                      <Dropdown\n                        menu={{\n                          items: [\n                            { key: 'edit', label: 'Edit', icon: <Edit className=\"w-4 h-4\" /> },\n                            { key: 'delete', label: 'Delete', icon: <Trash2 className=\"w-4 h-4\" />, danger: true, onClick: () => handleDeleteTask(task.id) }\n                          ]\n                        }}\n                        trigger={['click']}\n                        placement=\"bottomRight\"\n                      >\n                        <button className=\"w-6 h-6 rounded hover:bg-[#F7F7F7] flex items-center justify-center transition-colors text-[#999999] opacity-0 group-hover:opacity-100\">\n                          <MoreHorizontal className=\"w-4 h-4\" />\n                        </button>\n                      </Dropdown>\n                    </div>\n                    <h4 className=\"font-['Manrope:SemiBold',sans-serif] text-[#111111] text-[15px] mb-2 line-clamp-2 flex-grow\">{task.title}</h4>\n                    <div className=\"flex items-center gap-2 mb-4\">\n                      <span className={`px-2 py-0.5 rounded-full border text-[10px] font-['Manrope:Bold',sans-serif] ${getStatusColor(task.status)}`}>\n                        {task.status}\n                      </span>\n                    </div>\n                    <div className=\"pt-3 border-t border-[#EEEEEE] flex items-center justify-between mt-auto\">\n                      {task.dueDate && (\n                        <span className=\"flex items-center gap-1.5 text-[12px] text-[#666666] font-['Manrope:Medium',sans-serif]\">\n                          <Clock className=\"w-3.5 h-3.5\" />\n                          {format(new Date(task.dueDate), 'MMM d')}\n                        </span>\n                      )}\n                      {task.assignee && (\n                        <Tooltip title={task.assignee.name}>\n                          <div className=\"w-6 h-6 rounded-full bg-[#F7F7F7] flex items-center justify-center text-[9px] font-['Manrope:Bold',sans-serif] text-[#666666]\">\n                            {task.assignee.name[0]}\n                          </div>\n                        </Tooltip>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </>\n        )}\n\n        {/* Other Tabs Placeholders */}\n        {activeTab === 'files' && (\n          <div className=\"flex flex-col items-center justify-center h-64 text-center\">\n            <Paperclip className=\"w-12 h-12 text-[#DDDDDD] mb-3\" />\n            <h3 className=\"text-[16px] font-['Manrope:SemiBold',sans-serif] text-[#111111]\">No files uploaded</h3>\n            <p className=\"text-[13px] text-[#666666]\">Upload files to share with your team.</p>\n            <Button className=\"mt-4 font-['Manrope:SemiBold',sans-serif]\" icon={<Plus className=\"w-4 h-4\" />}>Upload File</Button>\n          </div>\n        )}\n      </div>\n\n      {/* Create Task Modal */}\n      <Modal\n        title={\n          <div className=\"flex items-center gap-2 text-[20px] font-['Manrope:Bold',sans-serif] text-[#111111]\">\n            <div className=\"p-2 rounded-full bg-[#F7F7F7]\">\n              <CheckCircle2 className=\"w-5 h-5 text-[#666666]\" />\n            </div>\n            Create New Task\n          </div>\n        }\n        open={isTaskModalOpen}\n        onCancel={() => setIsTaskModalOpen(false)}\n        footer={null}\n        width={600}\n        centered\n        className=\"rounded-[16px] overflow-hidden\"\n      >\n        <div className=\"mt-6 space-y-4\">\n          <div className=\"space-y-2\">\n            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Task Title <span className=\"text-[#ff3b3b]\">*</span></label>\n            <Input\n              placeholder=\"E.g. Design Homepage Mockups\"\n              className=\"h-10 font-['Manrope:Regular',sans-serif]\"\n              value={newTask.name}\n              onChange={(e) => setNewTask({ ...newTask, name: e.target.value })}\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Assignee</label>\n              <Select\n                className=\"w-full h-10\"\n                placeholder=\"Select assignee\"\n                value={newTask.assigneeId || undefined}\n                onChange={(val) => setNewTask({ ...newTask, assigneeId: val })}\n              >\n                {employeesData?.result?.map((emp: { id: number; name: string }) => (\n                  <Option key={emp.id} value={String(emp.id)}>{emp.name}</Option>\n                ))}\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Due Date</label>\n              <DatePicker\n                className=\"w-full h-10 font-['Manrope:Regular',sans-serif]\"\n                value={newTask.dueDate ? dayjs(newTask.dueDate) : null}\n                onChange={(date) => setNewTask({ ...newTask, dueDate: date ? date.toDate() : null })}\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Status</label>\n              <Select\n                className=\"w-full h-10\"\n                value={newTask.status}\n                onChange={(val) => setNewTask({ ...newTask, status: val })}\n              >\n                <Option value=\"Todo\">Todo</Option>\n                <Option value=\"In Progress\">In Progress</Option>\n                <Option value=\"Review\">Review</Option>\n                <Option value=\"Completed\">Completed</Option>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Priority</label>\n              <Select\n                className=\"w-full h-10\"\n                value={newTask.priority}\n                onChange={(val) => setNewTask({ ...newTask, priority: val as 'High' | 'Medium' | 'Low' })}\n              >\n                <Option value=\"Low\">Low</Option>\n                <Option value=\"Medium\">Medium</Option>\n                <Option value=\"High\">High</Option>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <label className=\"text-[13px] font-['Manrope:Bold',sans-serif] text-[#111111]\">Description</label>\n            <TextArea\n              placeholder=\"Add task details...\"\n              className=\"min-h-[100px] font-['Manrope:Regular',sans-serif] py-2\"\n              value={newTask.description}\n              onChange={(e) => setNewTask({ ...newTask, description: e.target.value })}\n            />\n          </div>\n\n          <div className=\"flex items-center justify-end gap-3 pt-6 border-t border-[#EEEEEE]\">\n            <Button\n              onClick={() => setIsTaskModalOpen(false)}\n              className=\"h-10 px-4 font-['Manrope:SemiBold',sans-serif] text-[#666666] border-none hover:bg-[#F7F7F7]\"\n            >\n              Cancel\n            </Button>\n            <Button\n              type=\"primary\"\n              onClick={handleCreateTask}\n              loading={createTaskMutation.isPending}\n              className=\"h-10 px-6 bg-[#111111] hover:bg-[#000000]/90 text-white font-['Manrope:SemiBold',sans-serif] border-none rounded-lg\"\n            >\n              Create Task\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/config/axios.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/config/axios.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/constants/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/constants/documentTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/constants/iconPaths.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/constants/pagination.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/constants/placeholders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/context/DataContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/context/TimerContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/data/defaultData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useAuth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'axiosApi' is defined but never used.","line":5,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useRouter } from \"next/navigation\";\nimport { doLogin, doSignup, forgetPassword, doCompleteSignup, verifyRegisterToken } from \"../services/auth\";\nimport { setToken, deleteToken, getToken } from \"../services/cookies\";\nimport axiosApi, { setAuthToken } from \"../config/axios\";\nimport { getUserDetails } from \"../services/user\";\n\nexport const useLogin = () => {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (credentials: { email: string; password: string; redirect?: string }) => doLogin(credentials),\n    onSuccess: (data, variables) => {\n      if (data.success && data.result.token) {\n        setToken(data.result.token);\n        setAuthToken(data.result.token);\n        queryClient.setQueryData([\"user\"], data.result.user);\n\n        const redirect = variables.redirect || \"/dashboard\";\n        router.push(redirect);\n      }\n    },\n  });\n};\n\nexport const useRegister = () => {\n  return useMutation({\n    mutationFn: (params: { firstName: string; lastName: string; email: string; password: string; token: string | null }) =>\n      doSignup(params.firstName, params.lastName, params.email, params.password, params.token),\n  });\n};\n\nexport const useForgotPassword = () => {\n  return useMutation({\n    mutationFn: (email: string) => forgetPassword(email),\n  });\n};\n\nexport const useLogout = () => {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n\n  return () => {\n    deleteToken();\n    setAuthToken(null);\n    queryClient.clear();\n    // Clear profile completion banner dismissal so it shows again on next login\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('profileCompletionBannerDismissed');\n    }\n    router.push(\"/login\");\n  };\n};\n\nexport const useUser = () => {\n  const token = getToken();\n\n  return useQuery({\n    queryKey: [\"user\"],\n    queryFn: getUserDetails,\n    enabled: !!token,\n    retry: false,\n  });\n};\n\nexport const useVerifyToken = (token: string | null) => {\n  return useQuery({\n    queryKey: [\"verify-token\", token],\n    queryFn: () => verifyRegisterToken(token!),\n    enabled: !!token,\n    retry: false,\n  });\n};\n\nexport const useCompleteSignup = () => {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: {\n      registerToken: string | null;\n      companyName: string;\n      businessType: string;\n      accountType: string;\n      country: string;\n      timezone: string;\n      firstName?: string;\n      lastName?: string;\n      phone?: string;\n    }) =>\n      doCompleteSignup(\n        params.registerToken,\n        params.companyName,\n        params.businessType,\n        params.accountType,\n        params.country,\n        params.timezone,\n        params.firstName,\n        params.lastName,\n        params.phone\n      ),\n    onSuccess: (data) => {\n      if (data.success && data.result.token) {\n        setToken(data.result.token);\n        setAuthToken(data.result.token);\n        if (data.result.user) {\n          queryClient.setQueryData([\"user\"], data.result.user);\n          localStorage.setItem(\"user\", JSON.stringify(data.result.user));\n        }\n        // Redirect to dashboard after successful signup\n        router.push(\"/dashboard\");\n      }\n    },\n  });\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useCalendar.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useFeedback.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useHoliday.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useLeave.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useMeeting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useNotification.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Notification' is defined but never used.","line":6,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  fetchNotifications,\n  markAllNotificationsRead,\n  markNotificationRead,\n  type Notification,\n} from \"../services/notification\";\n\nexport const useNotifications = () => {\n  return useQuery({\n    queryKey: [\"notifications\"],\n    queryFn: () => fetchNotifications(),\n    staleTime: 30_000, // 30 seconds\n  });\n};\n\nexport const useMarkAllNotificationsRead = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: () => markAllNotificationsRead(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"notifications\"] });\n    },\n  });\n};\n\nexport const useMarkNotificationRead = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: number) => markNotificationRead(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"notifications\"] });\n    },\n  });\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useTabSync.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useTask.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TaskType' is defined but never used.","line":15,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  getTasks,\n  getTaskById,\n  createTask,\n  updateTask,\n  deleteTaskById,\n  updateTaskStatusById,\n  getWorkLogByTaskId,\n  provideEstimate,\n  startWorkLog,\n  updateWorklog,\n  getAssignedTaskDetail,\n  requestRevision,\n  type TaskType,\n} from \"../services/task\";\n\n// Re-export useClients for convenience\n// useClients removed\nexport { usePartners } from \"./useUser\";\n\nimport { mapTaskDtoToDomain } from \"../utils/mappers/task.mapper\";\n\nexport const useTasks = (options: string = \"\") => {\n  return useQuery({\n    queryKey: [\"tasks\", options],\n    queryFn: () => getTasks(options),\n    select: (data) => ({\n      ...data,\n      result: data.result ? data.result.map(mapTaskDtoToDomain) : []\n    })\n  });\n};\n\nexport const useTask = (id: number) => {\n  return useQuery({\n    queryKey: [\"task\", id],\n    queryFn: () => getTaskById(id),\n    enabled: !!id,\n  });\n};\n\nimport { TaskDto } from \"../types/dto/task.dto\";\n\n// ...\n\nexport const useCreateTask = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: Partial<TaskDto>) => createTask(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"assignedTasks\"] });\n    },\n  });\n};\n\nexport const useUpdateTask = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, ...params }: Partial<TaskDto> & { id: number }) => updateTask({ id, ...params } as TaskDto), // Cast to TaskDto as service expects full? No, service likely updated to Partial. I'll check service.\n    // Wait, service updateTask takes TaskDto (strict). I should update service to Partial first? \n    // Step 272 updated service but might be strict.\n    // I updated workspace service to Partial.\n    // I should update task service to Partial.\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.id] });\n    },\n  });\n};\n\nexport const useDeleteTask = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: number) => deleteTaskById(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n    },\n  });\n};\n\nexport const useUpdateTaskStatus = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, status }: { id: number; status: string }) => updateTaskStatusById(id, status),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"assignedTasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.id] });\n      queryClient.invalidateQueries({ queryKey: [\"taskDetail\"] });\n    },\n  });\n};\n\n\nexport const useWorklogs = (taskId: number, limit = 50, skip = 0) => {\n  return useQuery({\n    queryKey: [\"worklogs\", taskId, limit, skip],\n    queryFn: () => getWorkLogByTaskId(taskId, limit, skip),\n    enabled: !!taskId,\n  });\n};\n\nexport const useProvideEstimate = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, hours }: { id: number; hours: number }) => provideEstimate(id, hours),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.id] });\n    },\n  });\n};\n\nexport const useStartWorkLog = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ task_id, start_datetime }: { task_id: number; start_datetime: string }) =>\n      startWorkLog(task_id, start_datetime),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.task_id] });\n      queryClient.invalidateQueries({ queryKey: [\"worklogs\", variables.task_id] });\n    },\n  });\n};\n\nexport const useUpdateWorkLog = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, ...params }: { id: number; task_id: number; start_datetime: string; end_datetime: string; description: string }) =>\n      updateWorklog(params, id),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.task_id] });\n      queryClient.invalidateQueries({ queryKey: [\"worklogs\", variables.task_id] });\n    },\n  });\n};\n\nexport const useTaskTimer = (taskId: number) => {\n  return useQuery({\n    queryKey: [\"taskTimer\", taskId],\n    queryFn: () => getAssignedTaskDetail(taskId),\n    enabled: !!taskId,\n  });\n};\n\nexport const useRequestRevision = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, revisionNotes }: { id: number; revisionNotes: string }) => requestRevision(id, revisionNotes),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"tasks\"] });\n      queryClient.invalidateQueries({ queryKey: [\"task\", variables.id] });\n    },\n  });\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useUser.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ClientOrOutsourceType' is defined but never used.","line":19,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CompanyDepartmentType' is defined but never used.","line":20,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ModuleActionGroup' is defined but never used.","line":198,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":198,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  getEmployees,\n  getUserById,\n  getPartners,\n  createUser,\n  updateUserById,\n  getUserDetails,\n  updateCurrentUserProfile,\n  updateCurrentUserPassword,\n  getCompanyDepartments,\n  updateUserStatus,\n  inviteUser,\n  updateCurrentUserCompany,\n  getCurrentUserCompany,\n  getRoles,\n  // updatePassword,\n  type UserType,\n  type ClientOrOutsourceType,\n  type CompanyDepartmentType,\n} from \"../services/user\";\nimport { ProfileUpdateInput, CompanyUpdateInput } from \"../types/genericTypes\";\n\nimport { mapUserDtoToEmployee } from \"../utils/mappers/user.mapper\";\n\nexport const useEmployees = (options: string = \"\") => {\n  return useQuery({\n    queryKey: [\"employees\", options],\n    queryFn: () => getEmployees(options),\n    staleTime: 5 * 1000, // 5 seconds\n    select: (data) => ({\n      ...data,\n      result: data.result ? data.result.map(mapUserDtoToEmployee) : []\n    })\n  });\n};\n\nexport const useEmployee = (id: number) => {\n  return useQuery({\n    queryKey: [\"employee\", id],\n    queryFn: () => getUserById(id),\n    enabled: !!id,\n  });\n};\n\nexport const usePartners = (options: string = \"\") => {\n  return useQuery({\n    queryKey: [\"partners\", options],\n    queryFn: () => getPartners(options),\n    staleTime: 5 * 1000,\n  });\n};\n\nexport const useOutsourcePartners = (options: string = \"\") => {\n  return useQuery({\n    queryKey: [\"partners\", options],\n    queryFn: () => getPartners(options),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n\nimport { UserDto } from \"../types/dto/user.dto\";\n\n// ...\n\nexport const useCreateEmployee = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: Partial<UserDto>) => createUser(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"employees\"] });\n    },\n  });\n};\n\nexport const useUpdateEmployee = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, ...params }: { id: number } & Partial<UserDto>) => updateUserById(id, params),\n    onSuccess: (_, variables) => {\n      // Invalidate all employee queries (both active and inactive)\n      queryClient.invalidateQueries({ queryKey: [\"employees\"] });\n      queryClient.invalidateQueries({ queryKey: [\"employee\", variables.id] });\n      // Also invalidate user details if updating current user's own data\n      queryClient.invalidateQueries({ queryKey: [\"user\", \"details\"] });\n    },\n  });\n};\n\nexport const useUpdateProfile = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: ProfileUpdateInput) => updateCurrentUserProfile(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"user\"] });\n    },\n  });\n};\n\nexport const useUpdatePassword = () => {\n  return useMutation({\n    mutationFn: (params: { password: string, currentPassword?: string }) => updateCurrentUserPassword(params),\n  });\n};\n\nexport const useCompanyDepartments = () => {\n  return useQuery({\n    queryKey: [\"companyDepartments\"],\n    queryFn: getCompanyDepartments,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n\nexport const useUpdateEmployeeStatus = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: { user_id: number; is_active: boolean }) => updateUserStatus(params),\n    onSuccess: () => {\n      // Invalidate all employee queries (both active and inactive) when status changes\n      queryClient.invalidateQueries({ queryKey: [\"employees\"] });\n    },\n  });\n};\n\nexport const useUserDetails = () => {\n  return useQuery({\n    queryKey: [\"user\", \"details\"],\n    queryFn: () => getUserDetails(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n\n// Invite user\nexport const useInviteUser = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: { email: string; requestSentFor: string }) =>\n      inviteUser(params.email, params.requestSentFor),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"clients\"] });\n    },\n  });\n};\n\n// Create client\nexport const useCreateClient = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: UserType) => createUser(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"clients\"] });\n    },\n  });\n};\n\n// Get current user company\nexport const useCurrentUserCompany = () => {\n  return useQuery({\n    queryKey: [\"user\", \"company\"],\n    queryFn: () => getCurrentUserCompany(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n\n// Update company details\nexport const useUpdateCompany = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: CompanyUpdateInput) => updateCurrentUserCompany(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"user\", \"company\"] });\n      queryClient.invalidateQueries({ queryKey: [\"user\", \"details\"] });\n    },\n  });\n};\n// Get all roles\nexport const useRoles = () => {\n  return useQuery({\n    queryKey: [\"roles\"],\n    queryFn: () => getRoles(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n\n// Role permission hooks\nimport {\n  upsertRole,\n  getRolePermissions,\n  updateRolePermissions,\n  type RoleType,\n  type ModuleActionGroup,\n} from \"../services/user\";\n\nexport const useRolePermissions = (roleId: number | null) => {\n  return useQuery({\n    queryKey: [\"rolePermissions\", roleId],\n    queryFn: () => getRolePermissions(roleId!),\n    enabled: !!roleId,\n    staleTime: 5 * 60 * 1000,\n  });\n};\n\nexport const useUpsertRole = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (params: Partial<RoleType>) => upsertRole(params),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"roles\"] });\n    },\n  });\n};\n\nexport const useUpdateRolePermissions = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ roleId, actions }: { roleId: number; actions: number[] }) =>\n      updateRolePermissions(roleId, actions),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"rolePermissions\", variables.roleId] });\n    },\n  });\n};\n\n// End of file\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/hooks/useWorkspace.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/provider/ReactQueryClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/proxy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/assistant.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/calendar.ts","messages":[],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":59,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":67,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":72,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":77,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":82,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":87,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":105,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":110,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/cookies.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/cookies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/feedback.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/holiday.ts","messages":[],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":23,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":28,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":33,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":38,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":43,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":48,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":53,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":58,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/leave.ts","messages":[],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":28,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":33,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":38,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":43,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":48,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":53,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":58,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":63,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":68,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":73,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":86,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":91,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/meeting.ts","messages":[],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":22,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":27,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":32,"column":5,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":37,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/notes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/notification.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/report.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1037,1040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1037,1040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2425,2428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2425,2428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4061,4064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4061,4064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5002,5005],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5002,5005],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axiosApi from \"../config/axios\";\n\nexport interface RequirementReport {\n    id: number;\n    requirement: string;\n    partner: string;\n    manager: string | null;\n    startDate: string | null;\n    endDate: string | null;\n    status: string;\n    allottedHrs: number;\n    engagedHrs: number;\n    extraHrs: number;\n    revenue: number;\n    revision: number;\n}\n\nexport interface ReportKPI {\n    totalRequirements: number;\n    onTimeCompleted: number;\n    delayedCompleted: number;\n    totalExtraHrs: number;\n    efficiency: number;\n}\n\nexport interface RequirementReportsResponse {\n    kpi: ReportKPI;\n    data: RequirementReport[];\n}\n\ninterface GetRequirementReportsParams {\n    search?: string;\n    partner_id?: string;\n    status?: string;\n    start_date?: string;\n    end_date?: string;\n}\n\ninterface ApiResponse<T> {\n  success: boolean;\n  message: string;\n  result: T;\n}\n\nexport const getRequirementReports = async (params: GetRequirementReportsParams): Promise<RequirementReportsResponse> => {\n    const queryParams: Record<string, any> = {};\n    if (params.search) queryParams.search = params.search;\n    if (params.partner_id && params.partner_id !== 'All') queryParams.partner_id = params.partner_id;\n    if (params.status && params.status !== 'All') queryParams.status = params.status;\n    if (params.start_date) queryParams.start_date = params.start_date;\n    if (params.end_date) queryParams.end_date = params.end_date;\n\n    const response = await axiosApi.get<ApiResponse<RequirementReportsResponse>>('/report/requirements', {\n        params: queryParams\n    });\n    \n    return response.data.result;\n};\n\nexport interface TaskReport {\n    id: number;\n    task: string;\n    requirement: string;\n    leader: string;\n    assigned: string;\n    allottedHrs: number;\n    engagedHrs: number;\n    extraHrs: number;\n    status: string;\n    dueDate?: string | null;\n}\n\nexport interface TaskReportsResponse {\n    kpi: {\n        totalTasks: number;\n        onTimeCompleted: number;\n        delayedCompleted: number;\n        totalExtraHrs: number;\n        efficiency: number;\n    };\n    data: TaskReport[];\n}\n\ninterface GetTaskReportsParams {\n    search?: string;\n    leader_id?: string;\n    assigned_id?: string;\n    status?: string;\n    start_date?: string;\n    end_date?: string;\n}\n\nexport const getTaskReports = async (params: GetTaskReportsParams): Promise<TaskReportsResponse> => {\n    const queryParams: Record<string, any> = {};\n    if (params.search) queryParams.search = params.search;\n    if (params.leader_id && params.leader_id !== 'All') queryParams.leader_id = params.leader_id;\n    if (params.assigned_id && params.assigned_id !== 'All') queryParams.assigned_id = params.assigned_id;\n    if (params.status && params.status !== 'All') queryParams.status = params.status;\n    if (params.start_date) queryParams.start_date = params.start_date;\n    if (params.end_date) queryParams.end_date = params.end_date;\n\n    const response = await axiosApi.get<ApiResponse<TaskReportsResponse>>('/report/tasks', {\n        params: queryParams\n    });\n    \n    return response.data.result;\n};\n\n\nexport interface EmployeeReport {\n    id: number;\n    member: string;\n    designation: string;\n    department: string;\n    department_id: number | null;\n    utilization: number;\n    hourlyCost: number;\n    revenue: number;\n    profit: number;\n    margin: number;\n    engagedHrs: number;\n    taskStats: {\n        assigned: number;\n        completed: number;\n        inProgress: number;\n        delayed: number;\n    };\n}\n\nexport interface EmployeeKPI {\n    totalInvestment: number;\n    totalRevenue: number;\n    netProfit: number;\n    avgRatePerHr: number;\n}\n\nexport interface EmployeeReportsResponse {\n    kpi: EmployeeKPI;\n    data: EmployeeReport[];\n}\n\ninterface GetEmployeeReportsParams {\n    search?: string;\n    department_id?: string;\n    member_id?: string;\n    start_date?: string;\n    end_date?: string;\n}\n\nexport const getEmployeeReports = async (params: GetEmployeeReportsParams): Promise<EmployeeReportsResponse> => {\n    const queryParams: Record<string, any> = {};\n    if (params.search) queryParams.search = params.search;\n    if (params.department_id && params.department_id !== 'All') queryParams.department_id = params.department_id;\n    if (params.member_id && params.member_id !== 'All') queryParams.member_id = params.member_id;\n    if (params.start_date) queryParams.start_date = params.start_date;\n    if (params.end_date) queryParams.end_date = params.end_date;\n\n    const response = await axiosApi.get<ApiResponse<EmployeeReportsResponse>>('/report/employees', {\n        params: queryParams\n    });\n    \n    return response.data.result;\n};\n\nexport interface MemberWorklog {\n    id: string;\n    date: string;\n    task: string;\n    details: string;\n    startTime: string;\n    endTime: string;\n    engagedTime: string;\n}\n\nexport const getMemberWorklogs = async (memberId: string, startDate?: string, endDate?: string): Promise<MemberWorklog[]> => {\n    const queryParams: Record<string, any> = { member_id: memberId };\n    if (startDate) queryParams.start_date = startDate;\n    if (endDate) queryParams.end_date = endDate;\n\n    const response = await axiosApi.get<ApiResponse<MemberWorklog[]>>('/report/member/worklogs', {\n        params: queryParams\n    });\n    \n    return response.data.result;\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/task.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_title' is assigned a value but never used.","line":106,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":106,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_name' is assigned a value but never used.","line":106,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":106,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":541,"column":95,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":541,"endColumn":98,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14137,14140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14137,14140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":544,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":544,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14233,14236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14233,14236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport axiosApi from \"../config/axios\";\nimport { ApiResponse } from \"../constants/constants\";\nimport { ApiError, NetworkError, getErrorMessage, isAxiosError } from \"../types/errors\";\n\nexport interface TaskType {\n  id: number;\n  title?: string;\n  name?: string;\n  description?: string;\n  status?: string;\n  is_high_priority?: boolean;\n  workspace_id?: number;\n  requirement_id?: number;\n  assigned_to?: number;\n  member_id?: number;\n  leader_id?: number;\n  due_date?: string;\n  start_date?: string;\n  end_date?: string;\n  created_by?: number;\n  created_at?: string;\n  updated_at?: string;\n}\n\nexport interface Worklog {\n  id: number;\n  task_id: number;\n  user_id: number;\n  hours?: number;\n  time_in_seconds?: number;\n  description?: string;\n  date?: string;\n  start_datetime?: string;\n  end_datetime?: string;\n  created_user?: number;\n  created_at?: string;\n}\n\nexport interface Comment {\n  id: number;\n  task_id: number;\n  user_id: number;\n  content: string;\n  created_at: string;\n  updated_at?: string;\n}\n\nexport interface TaskDetailType extends TaskType {\n  worklogs?: Worklog[];\n  comments?: Comment[];\n  // Pre-populated relation fields from API\n  leader_user?: { id: number; name?: string; email?: string };\n  member_user?: { id: number; name?: string; email?: string };\n  task_workspace?: { id: number; name?: string };\n  task_requirement?: { id: number; name?: string };\n  task_members?: Array<{\n    id: number;\n    user_id: number;\n    status?: string;\n    estimated_time?: number;\n    user?: { id: number; name?: string; email?: string };\n  }>;\n}\n\n/**\n * Validate task ID\n */\nfunction validateTaskId(id: number): void {\n  if (!Number.isInteger(id) || id <= 0) {\n    throw new ApiError(`Invalid task ID: ${id}`, 400);\n  }\n}\n\n/**\n * Validate pagination parameters\n */\nfunction validatePagination(limit: number, skip: number): void {\n  if (!Number.isInteger(skip) || skip < 0) {\n    throw new ApiError(`Invalid skip parameter: ${skip}`, 400);\n  }\n  if (!Number.isInteger(limit) || limit <= 0 || limit > 1000) {\n    throw new ApiError(`Invalid limit parameter: ${limit}. Must be between 1 and 1000`, 400);\n  }\n}\n\n/**\n * Create a new task\n */\nimport { TaskDto } from \"../types/dto/task.dto\";\n\n/**\n * Create a new task\n */\nexport const createTask = async (params: Partial<TaskDto> & { name?: string }): Promise<ApiResponse<TaskDto>> => {\n  try {\n    // Handle both 'name' (from form) and 'title' (from TaskType interface) - backend expects 'name'\n    const taskName = params.name || params.title;\n\n    // Validate name/title field\n    if (!taskName || (typeof taskName === 'string' && taskName.trim().length === 0)) {\n      throw new ApiError('Task title is required', 400);\n    }\n\n    // Map to backend 'name' field (remove title from params, then add name)\n    const { title: _title, name: _name, ...restParams } = params;\n    const payload = {\n      ...restParams,\n      name: taskName,\n    };\n\n    const { data } = await axiosApi.post<ApiResponse<TaskDto>>(\"/task/create\", payload);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Update an existing task\n */\nexport const updateTask = async (params: TaskDto): Promise<ApiResponse<TaskDto>> => {\n  try {\n    validateTaskId(params.id);\n\n    const { data } = await axiosApi.put<ApiResponse<TaskDto>>(`/task/update/${params.id}`, params);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Update task status\n */\nexport const updateTaskStatusById = async (id: number, status: string): Promise<ApiResponse<TaskDto>> => {\n  try {\n    validateTaskId(id);\n\n    if (!status || status.trim().length === 0) {\n      throw new ApiError('Task status is required', 400);\n    }\n\n    const { data } = await axiosApi.post<ApiResponse<TaskDto>>(`/task/${id}/update/${status}`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Delete a task\n */\nexport const deleteTaskById = async (id: number): Promise<ApiResponse<TaskDto>> => {\n  try {\n    validateTaskId(id);\n\n    const { data } = await axiosApi.delete<ApiResponse<TaskDto>>(`/task/delete/${id}`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Get tasks with optional query parameters\n */\nexport const getTasks = async (options: string = \"\"): Promise<ApiResponse<TaskDto[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<TaskDto[]>>(`/task?${options}`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Get task by ID\n */\nexport const getTaskById = async (id: number): Promise<ApiResponse<TaskDetailType>> => {\n  try {\n    validateTaskId(id);\n\n    const { data } = await axiosApi.get<ApiResponse<TaskDetailType>>(`/task/${id}`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    // Normalizing name (ensure name is set, fallback to title)\n    if (data.result) {\n      data.result.name = data.result.name || data.result.title;\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Create a worklog/activity for a task\n */\nexport const createActivity = async (params: Partial<TaskType>): Promise<ApiResponse<TaskType>> => {\n  try {\n    if (!params.id) {\n      throw new ApiError('Task ID is required', 400);\n    }\n\n    validateTaskId(params.id);\n\n    const { data } = await axiosApi.post<ApiResponse<TaskType>>(\"/task/worklog/create\", params);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Get worklogs for a task\n */\nexport const getWorkLogByTaskId = async (\n  taskId: number,\n  limit = 25,\n  skip = 0\n): Promise<ApiResponse<Worklog[]>> => {\n  try {\n    validateTaskId(taskId);\n    validatePagination(limit, skip);\n\n    const { data } = await axiosApi.get<ApiResponse<Worklog[]>>(\n      `/task/${taskId}/worklog?limit=${limit}&skip=${skip}`\n    );\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Get tasks assigned to the current logged-in user\n */\nexport const getAssignedTasks = async (): Promise<ApiResponse<TaskType[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<TaskType[]>>(`/task/assigned`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Get assigned task detail with timer information\n * Returns: estimated_time, worked_time, active worklog, etc.\n */\nexport interface AssignedTaskDetailType {\n  estimated_time: number; // in hours\n  worked_time: number; // in seconds\n  status: string;\n  worked_sessions: number;\n  task_worklog?: {\n    id: number | null;\n    task_id: number;\n    description: string;\n    end_datetime: string | null;\n    start_datetime: string;\n    time_in_seconds: number | null;\n  } | null;\n}\n\nexport const getAssignedTaskDetail = async (taskId: number): Promise<ApiResponse<AssignedTaskDetailType>> => {\n  try {\n    validateTaskId(taskId);\n\n    const { data } = await axiosApi.get<ApiResponse<AssignedTaskDetailType>>(`/task/${taskId}/timer`);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Start a worklog/timer for a task\n */\nexport const startWorkLog = async (task_id: number, start_datetime: string): Promise<ApiResponse<Worklog>> => {\n  try {\n    validateTaskId(task_id);\n\n    const { data } = await axiosApi.post<ApiResponse<Worklog>>(`/task/worklog/create`, {\n      task_id,\n      start_datetime\n    });\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Update a worklog\n */\nexport interface UpdateWorklogPayload {\n  task_id: number;\n  start_datetime: string;\n  end_datetime: string;\n  description: string;\n}\n\nexport const updateWorklog = async (params: UpdateWorklogPayload, worklogId: number): Promise<ApiResponse<Worklog>> => {\n  try {\n    validateTaskId(params.task_id);\n\n    if (!worklogId || worklogId <= 0) {\n      throw new ApiError(`Invalid worklog ID: ${worklogId}`, 400);\n    }\n\n    const { data } = await axiosApi.put<ApiResponse<Worklog>>(`/task/worklog/update/${worklogId}`, params);\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n/**\n * Provide estimate for a task (Time Handshake)\n */\nexport const provideEstimate = async (id: number, hours: number): Promise<ApiResponse<void>> => {\n  try {\n    validateTaskId(id);\n\n    if (typeof hours !== 'number' || hours < 0) {\n      throw new ApiError('Hours must be a positive number', 400);\n    }\n\n    const { data } = await axiosApi.post<ApiResponse<void>>(`/task/${id}/estimate`, { hours });\n\n    if (!data || typeof data !== 'object') {\n      throw new ApiError('Invalid response format from server', 500);\n    }\n\n    return data;\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\nexport const getCurrentActiveTimer = async () => {\n  const { data } = await axiosApi.get('/task/active-timer');\n  return data;\n};\n\n/**\n * Request a revision for a task\n */\nexport const requestRevision = async (id: number, revisionNotes: string): Promise<ApiResponse<any>> => {\n  try {\n    validateTaskId(id);\n    const { data } = await axiosApi.post<ApiResponse<any>>(`/task/${id}/revision`, { revisionNotes });\n    return data;\n  } catch (error) {\n    if (isAxiosError(error)) {\n      const statusCode = error.response?.status || 500;\n      const message = getErrorMessage(error);\n      throw new ApiError(message, statusCode, error.response?.data);\n    }\n    throw new NetworkError(getErrorMessage(error));\n  }\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/user.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[523,526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[523,526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4605,4608],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4605,4608],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":53,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":58,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":68,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":73,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":78,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":83,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":88,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":93,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":98,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":103,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":108,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":115,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":120,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":128,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":133,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":138,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":143,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":148,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":155,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":165,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":171,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":176,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":181,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":186,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":191,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":196,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":211,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":216,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":221,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":226,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":231,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":236,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":241,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":246,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":251,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":256,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":279,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":284,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":289,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":294,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":299,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":304,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":328,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":333,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":338,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":343,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":359,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":364,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable no-useless-catch */\nimport axiosApi from \"../config/axios\";\nimport { ApiResponse } from \"../constants/constants\";\nimport { ProfileUpdateInput, CompanyUpdateInput } from \"../types/genericTypes\";\nimport { CompanyProfile } from \"../types/auth\";\n\nexport interface UserType {\n  id: number;\n  name: string;\n  email: string;\n  phone?: string;\n  mobile_number?: string;\n  designation?: string;\n  is_active?: boolean;\n  role?: string;\n  role_id?: number;\n  roleColor?: string;\n  status?: string;\n  user_employee?: any; // Keeping as any for nested object until further typed\n  department_id?: number;\n  department?: { id: number; name: string };\n  manager_id?: number | null;\n  employment_type?: string;\n  salary_yearly?: number;\n  hourly_rates?: number;\n  working_hours?: { start_time: string; end_time: string };\n  no_of_leaves?: number;\n  joining_date?: string;\n  experience?: string;\n  skills?: string[];\n  address?: string;\n  city?: string;\n  state?: string;\n  zipcode?: string;\n  country?: string;\n  profile_pic?: string;\n  date_of_joining?: string;\n  [key: string]: unknown;\n}\n\nexport interface ClientOrOutsourceType {\n  id: number;\n  name: string;\n  email: string;\n  company?: string;\n  phone?: string;\n  country?: string;\n  [key: string]: unknown;\n}\n\n// Get user details\nexport const getUserDetails = async () => {\n  try {\n    const { data } = await axiosApi.get(\"/user/details\");\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Create user/employee\nimport { UserDto } from \"../types/dto/user.dto\";\n\n// ... imports\n\n// Create user/employee\nexport const createUser = async (params: Partial<UserDto>): Promise<ApiResponse<UserDto>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<UserDto>>(\"/user/create\", params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update user by ID\nexport const updateUserById = async (id: number, params: Partial<UserDto>): Promise<ApiResponse<UserDto>> => {\n  try {\n    const { data } = await axiosApi.put<ApiResponse<UserDto>>(`/user/update/${id}`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get employees\nexport const getEmployees = async (options: string = \"\"): Promise<ApiResponse<UserDto[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<UserDto[]>>(`/user?${options}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get user by id\nexport const getUserById = async (id: number): Promise<ApiResponse<UserDto>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<UserDto>>(`/user/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get partners\nexport const getPartners = async (options: string = \"\"): Promise<ApiResponse<ClientOrOutsourceType[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<ClientOrOutsourceType[]>>(\n      `/user/partners${options ? `?${options}` : \"\"}`\n    );\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Invite user (partner)\nexport const inviteUser = async (email: string, requestSentFor: string) => {\n  try {\n    const { data } = await axiosApi.post(\"/user/invite\", {\n      email,\n      requestSentFor: requestSentFor,\n    });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Search partners dropdown\nexport const searchPartners = async (): Promise<ApiResponse<{ label: string; value: number }[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<{ label: string; value: number }[]>>(`/user/partners/dropdown`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Search employees dropdown\nexport const searchEmployees = async (): Promise<ApiResponse<{ label: string; value: number }[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<{ label: string; value: number }[]>>(`/user/user-dropdown`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update user profile\nexport const updateCurrentUserProfile = async (\n  params: ProfileUpdateInput\n): Promise<ApiResponse<UserType>> => {\n  try {\n    // Ensure mobile_number is sent if phone is provided\n    const payload = {\n      ...params,\n      mobile_number: params.mobile_number || params.phone,\n    };\n    const { data } = await axiosApi.post<ApiResponse<UserType>>(`/user/profile`, payload);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update user password\n// Update user password\nexport const updateCurrentUserPassword = async (params: { password: string, currentPassword?: string }): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<any>>(`/user/password`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get company details\nexport const getCurrentUserCompany = async (): Promise<ApiResponse<CompanyProfile>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<CompanyProfile>>(`/user/company`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update company details\nexport const updateCurrentUserCompany = async (params: CompanyUpdateInput): Promise<ApiResponse<CompanyProfile>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<CompanyProfile>>(`/user/company`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get company departments\nexport interface CompanyDepartmentType {\n  id?: number | null;\n  name: string;\n  company_id: number;\n  created_at?: string;\n  updated_at?: string;\n  is_active?: boolean;\n  is_deleted?: boolean;\n}\n\nexport const getCompanyDepartments = async (): Promise<ApiResponse<CompanyDepartmentType[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<CompanyDepartmentType[]>>(`/user/company/departments-dropdown`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update user status (activate/deactivate)\nexport const updateUserStatus = async (params: { user_id: number; is_active: boolean }): Promise<ApiResponse<UserType>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<UserType>>(`/user/update/status`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update partner status (activate/deactivate)\nexport const updatePartnerStatus = async (params: { association_id: number; is_active: boolean }): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<unknown>>(`/user/partners/status`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get all roles\nexport const getRoles = async (): Promise<ApiResponse<{ id: number; name: string }[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<{ id: number; name: string }[]>>(`/role`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Accept invitation\nexport const acceptInvitation = async (token: string) => {\n  try {\n    const { data } = await axiosApi.post(\"/auth/accept-invite\", { token });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Role types for access management\nexport interface RoleType {\n  id?: number;\n  name: string;\n  color?: string;\n}\n\nexport interface PermissionAction {\n  id: number;\n  name: string;\n  assigned: boolean;\n}\n\nexport interface ModuleActionGroup {\n  module: string;\n  actions: PermissionAction[];\n}\n\n// Create or update role\nexport const upsertRole = async (params: Partial<RoleType>): Promise<ApiResponse<RoleType>> => {\n  try {\n    const { data } = await axiosApi.put<ApiResponse<RoleType>>(\"/role\", params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get permissions for a role\nexport const getRolePermissions = async (roleId: number): Promise<ApiResponse<ModuleActionGroup[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<ModuleActionGroup[]>>(`/role/${roleId}/actions`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update permissions for a role\nexport const updateRolePermissions = async (roleId: number, actions: number[]): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.put<ApiResponse<unknown>>(`/role/${roleId}/actions`, { actions });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get received invites\nexport const getReceivedInvites = async (): Promise<ApiResponse<{\n  id: number;\n  inviterName: string;\n  inviterCompany: string;\n  inviterImage: string | null;\n  type: string;\n  date: string\n}[]>> => {\n  try {\n    const { data } = await axiosApi.get(\"/user/invites/received\");\n    return data;\n  } catch (error) {\n    // Gracefully handle missing endpoint or server errors\n    console.warn('Failed to fetch received invites:', error);\n    return { success: true, message: 'No invites', result: [] };\n  }\n};\n\n// Accept invite by ID\nexport const acceptInviteById = async (inviteId: number): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.post(\"/user/invite/accept-id\", { inviteId });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Decline invite by ID\nexport const declineInviteById = async (inviteId: number): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.post(\"/user/invite/decline-id\", { inviteId });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update user password\n// Update user password - DEPRECATED: Use updateCurrentUserPassword instead\n// export const updatePassword = async (password: string): Promise<ApiResponse<null>> => {\n//   try {\n//     const { data } = await axiosApi.patch<ApiResponse<null>>(\"/user/update/password\", { password });\n//     return data;\n//   } catch (error) {\n//     throw error;\n//   }\n// };\n\n// Delete partner (or cancel request)\nexport const deletePartner = async (params: { userType: 'PARTNER'; partnerUserId?: number; inviteId?: number }): Promise<ApiResponse<unknown>> => {\n  try {\n    const { data } = await axiosApi.delete<ApiResponse<unknown>>(\"/user/partners\", { data: params });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/services/workspace.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[762,765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[762,765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1368,1371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1368,1371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":69,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":74,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":79,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":84,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":89,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":94,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":99,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":104,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":113,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":118,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":123,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":128,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":133,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":138,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":143,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":148,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":152,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":157,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":161,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":169,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":176,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":184,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":188,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":193,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":197,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":202,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":207,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":212,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":217,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":222,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":226,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":231,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":238,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":243,"endColumn":4,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable no-useless-catch */\nimport axiosApi from \"../config/axios\";\nimport { ApiResponse } from \"../constants/constants\";\n\n// Workspace/Project types (simplified - will expand based on actual backend types)\nexport interface WorkspaceType {\n  id: number;\n  name: string;\n  description?: string;\n  status?: string;\n  client_id?: number;\n  start_date?: string;\n  end_date?: string;\n  total_count?: number;\n  total_task?: number;\n  total_task_in_progress?: number;\n  total_task_delayed?: number;\n  total_task_completed?: number;\n  in_house?: boolean;\n  partner_name?: string;\n  company_name?: string;\n  partner_id?: number;\n  is_active?: boolean;\n  client_user?: { name: string; [key: string]: unknown };\n  client_company_name?: string;\n  assigned_users?: any[];\n  [key: string]: unknown;\n}\n\nexport interface RequirementType {\n  id: number;\n  title: string;\n  description?: string;\n  workspace_id: number;\n  status?: string;\n  priority?: string;\n  pricing_model?: string;\n  budget?: number;\n  start_date?: string;\n  end_date?: string;\n  quoted_price?: number;\n  total_task?: number;\n  sender_company_id?: number;\n  sender_company?: { name: string; [key: string]: unknown };\n  leader_user?: { name: string; [key: string]: unknown };\n  manager_user?: { name: string; [key: string]: unknown };\n  document_link?: string;\n  is_high_priority?: boolean;\n  assignedTo?: any[];\n  [key: string]: unknown;\n}\n\nexport interface CommentType {\n  id: number;\n  comment: string;\n  type: \"PROJECT\" | \"TASK\" | \"WORKSPACE\";\n  reference_id: number;\n  [key: string]: unknown;\n}\n\n// Create workspace\nimport { WorkspaceDto } from \"../types/dto/workspace.dto\";\nimport { RequirementDto } from \"../types/dto/requirement.dto\";\n\n// ... imports\n\n// Create workspace\nexport const createWorkspace = async (params: WorkspaceDto): Promise<ApiResponse<WorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<WorkspaceDto>>(\"/workspace/create\", params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Update workspace\nexport const updateWorkspace = async (params: WorkspaceDto): Promise<ApiResponse<WorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.put<ApiResponse<WorkspaceDto>>(`/workspace/update/${params.id}`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Delete workspace\nexport const deleteWorkspace = async (id: number): Promise<ApiResponse<WorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.delete<ApiResponse<WorkspaceDto>>(`/workspace/delete/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Reactivate workspace\nexport const reactivateWorkspace = async (id: number): Promise<ApiResponse<WorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<WorkspaceDto>>(`/workspace/reactivate/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get workspaces\ntype TeamWorkspaceDto = {\n  workspaces: WorkspaceDto[];\n};\n\nexport const getWorkspace = async (options: string = \"\"): Promise<ApiResponse<TeamWorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<TeamWorkspaceDto>>(`/workspace?${options}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get workspace by id\nexport const getWorkspaceById = async (id: number): Promise<ApiResponse<WorkspaceDto>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<WorkspaceDto>>(`/workspace/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Search workspaces\nexport const searchWorkspaces = async (name = \"\"): Promise<ApiResponse<WorkspaceDto[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<WorkspaceDto[]>>(`/workspace/dropdown?name=${name}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Requirement operations\nexport const addRequirementToWorkspace = async (params: Partial<RequirementDto>): Promise<ApiResponse<RequirementDto>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<RequirementDto>>(\"/requirement\", params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const updateRequirementById = async (params: Partial<RequirementDto>): Promise<ApiResponse<RequirementDto>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<RequirementDto>>(`/requirement/update/${params.id}`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const deleteRequirementById = async (id: number, workspace_id: number): Promise<ApiResponse<RequirementDto>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<RequirementDto>>(`/workspace/requirement/update/${id}`, {\n      is_deleted: true,\n      workspace_id: workspace_id,\n    });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const approveRequirement = async (\n  requirement_id: number,\n  status: \"Assigned\" | \"Rejected\"\n): Promise<ApiResponse<RequirementDto>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<RequirementDto>>(\"/workspace/requirement/approve\", {\n      requirement_id,\n      status,\n    });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const getRequirementsByWorkspaceId = async (workspaceId: number): Promise<ApiResponse<RequirementDto[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<RequirementDto[]>>(`/requirement/${workspaceId}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const getCollaborativeRequirements = async (): Promise<ApiResponse<RequirementDto[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<RequirementDto[]>>(`/requirement/collaborative`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get requirements dropdown by workspace ID\nexport const getRequirementsDropdownByWorkspaceId = async (workspaceId: number): Promise<ApiResponse<{ name: string; id: number }[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<{ name: string; id: number }[]>>(`/requirement/${workspaceId}/requirement/dropdown`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Comment operations\nexport const addCommentToProject = async (params: CommentType): Promise<ApiResponse<CommentType>> => {\n  try {\n    const { data } = await axiosApi.post<ApiResponse<CommentType>>(`/comment/create`, params);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const updateCommentById = async (comment: string, id: number): Promise<ApiResponse<CommentType>> => {\n  try {\n    const { data } = await axiosApi.patch<ApiResponse<CommentType>>(`/comment/update/${id}`, { comment });\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const getCommentById = async (\n  id: number,\n  type: \"PROJECT\" | \"TASK\" | \"WORKSPACE\"\n): Promise<ApiResponse<CommentType[]>> => {\n  try {\n    const { data } = await axiosApi.get<ApiResponse<CommentType[]>>(`/comment/${type}/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/auth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[539,542],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[539,542],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Auth and User Session related types\n */\n\nexport interface SessionUser {\n  id: number;\n  name: string;\n  email: string;\n  role: string;\n  avatar?: string;\n}\n\nexport interface CompanyProfile {\n  id?: number;\n  name: string;\n  address?: string;\n  website?: string;\n  logo?: string;\n  email?: string;\n  phone?: string;\n  description?: string;\n  industry?: string;\n  size?: string;\n  tax_id?: string;\n  timezone?: string;\n  currency?: string;\n  country?: string;\n  default_employee_password?: string;\n  account_type?: string;\n  leaves?: any[]; // Defined more specifically if possible\n  working_hours?: {\n    start_time?: string;\n    end_time?: string;\n    working_days?: string[];\n    break_time?: string;\n    [key: string]: unknown;\n  };\n  founded?: string;\n  // Add flexible index signature only if absolutely needed, but prefer explicit typing\n  [key: string]: unknown;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/domain.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/dto/requirement.dto.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[720,723],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[720,723],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface RequirementDto {\n  id: number;\n  title: string;\n  name?: string; // Payload often sends name\n  description?: string;\n  workspace_id: number;\n  status?: string;\n  priority?: string;\n  pricing_model?: string;\n  budget?: number;\n  start_date?: string;\n  end_date?: string;\n  quoted_price?: number;\n  total_task?: number;\n  \n  sender_company_id?: number;\n  sender_company?: { name: string; id?: number };\n  \n  leader_user?: { name: string; id?: number; avatar?: string };\n  manager?: { name: string; id?: number };\n  leader?: { name: string; id?: number };\n  manager_user?: { name: string; id?: number; avatar?: string };\n  \n  document_link?: string;\n  is_high_priority?: boolean;\n  assignedTo?: string[] | any[]; // DTOs may be loose here initially if backend is inconsistent\n  \n  // Observed in RequirementsPage\n  company?: string;\n  client?: string;\n  dueDate?: string;\n  createdDate?: string;\n  type?: string;\n  category?: string;\n  departments?: string[];\n  progress?: number;\n  tasksCompleted?: number;\n  tasksTotal?: number;\n  workspaceId?: number;\n  workspace?: string;\n  approvalStatus?: string;\n  invoiceStatus?: string;\n  estimatedCost?: number;\n  hourlyRate?: number;\n  estimatedHours?: number;\n  pricingModel?: string;\n  contactPerson?: string;\n  rejectionReason?: string;\n  headerContact?: string;\n  headerCompany?: string;\n  quotedPrice?: number;\n  rawStatus?: string;\n  client_id?: number;\n  contact_person_id?: number;\n  receiver_company_id?: number;\n  receiver_workspace_id?: number;\n  negotiation_reason?: string;\n  isReceiver?: boolean;\n  isSender?: boolean;\n  receiver_project_id?: number;\n  \n  // Relations\n  receiver_company?: { name: string; id: number };\n  created_user?: { name: string; id: number };\n  created_user_data?: { name: string; id: number };\n  approved_by?: { id: number; name?: string };\n  invoice?: { status: string; id?: number };\n  invoice_id?: number;\n  contact_person?: { name: string; id: number };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/dto/task.dto.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/dto/user.dto.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/dto/workspace.dto.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/errors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/genericTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/guards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/notes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/types/styled-jsx.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/calendarPolyfill.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/colorUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/currencyUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/mappers/requirement.mapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/mappers/task.mapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/mappers/user.mapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/mappers/workspace.mapper.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/navUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/noteUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/roleUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/roleUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/sanitizeHtml.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/sanitizeHtml.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/apple/Desktop/Alsonotify/alsonotify-new-ui/src/utils/validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]